\documentclass[a4paper,12pt,draft]{article}
\usepackage[simple]{dmvn}

\title{Задачи с некоторых семинаров по дискретной математике}
\author{Преподаватель\т Александр Викторович Чашкин}
\date{7 семестр, 2005 г.}

\begin{document}
\maketitle

{\footnotesize
Эти задачи вместе с решениями были записаны и набраны Сергеем Гладких, в дальнейшем текст был
немного перевёрстан DMVN Corporation. Исправлены замеченные опечатки.\par}


\medskip
\dmvntrail

\section{Булев куб}

\begin{df}
Булев куб: $\{0,1 \}^n=:\B^n=:E_2^n$\т множество
последовательностей из нулей и единиц длины $n$.

Расстояние Хемминга: $\al,\beta \in \{0,1 \}^n,d(\al,\beta) = \sum\limits_{i=1}^n|\al_i-\beta_i|$\т число
несовпадающих координат.

Вес набора: $||\al||=w(\al)=\sum\al_i$\т число ненулевых координат.
$k$-й слой булевого куба: все наборы с весом $k$.

Будем говорить, что $\al \le \beta$, если для каждого $i$
выполняется $\al_i \le \beta_i$.

Два набора $\al$ и $\beta$ будем называть сравнимыми, если
$\al \le \beta$ либо $\beta \le \al$, в противном случае\т
несравнимыми.

Цепь\т множество попарно сравнимых наборов, антицепь\т множество попарно несравнимых.

Для сравнимых наборов $\al$ и $\beta$ определим интервал
$I=\hc{\ga|\al \le \ga \le \beta}$, $|I|=2^{d(\al,\ \beta)}$.
$I$ также называют гранью, а $d(\al, \beta)$\т ее размерностью.
\end{df}


\begin{problem}\label{problem.5.1}
Найти число $k$-мерных подпространств в $n$\д мерном
пространстве над $\Z_2$.
\end{problem}

\begin{solution}
Каждое $k$\д мерное подпространство задается своим базисом.
Посчитаем, сколькими способами можно выбрать $k$ линейно независимых
векторов в $n$-мерном булевом пространстве. Для первого вектора
имеем $2^n-1$ возможностей\т можем брать все, кроме нулевого. Для
второго $2^n-2$\т все, кроме кратных первому. Для $i$-го\т $2^n-2^{i-1}$\т все, кроме линейной оболочки первых $i-1$. таким
образом, общее число $k$-мерных базисов в $n$-мерном пространстве
равно $(2^n-1)(2^n-2)\ldots(2^n-2^{k-1})$. Но не все они задают
различные подпространства. Число $k$-мерных базисов в каждом
$k$-мерно подпространстве равно $(2^k-1)(2^k-2)\ldots(2^-2^{k-1})$,
и все они будут эквивалентны. Отсюда получаем, что число $k$-мерных
подпространств равно отношению этих чисел, то есть
\begin{equation}\label{drob}
\frac{(2^n-1)(2^n-2)\ldots(2^n-2^{k-1})}{(2^k-1)(2^k-2)\ldots(2^-2^{k-1})}.
\end{equation}
\hfill\end{solution}


\begin{df}
Сферой радиуса $k$ с центром в $\al$ в булевом кубе будем называть множество
\eqn{S_k(\al)=\{\beta| d(\al, \beta)=k\}.}
Очевидно,
$|S_k(\al)|=\Cb_k^n$. Аналогично, шар\т это $B_k(\al)=\{\beta| d(\al, \beta) \le k\}$.
\end{df}

\begin{problem}
Найти среднее расстояние между двумя вершинами.
\end{problem}
\begin{solution}
Заметим, что среднее расстояние между двумя вершинами в точности
равно среднему расстоянию от некоторой фиксированной вершины до
остальных. В качестве такой фиксированной вершины возьмем
$(0,\ldots,0)$. Сумма расстояний от нее до остальных равна $\sum
kC_k^n=n2^{n-1}$. Эту величину надо поделить на количество вершин\т в результате получим $\frac{n2^{n-1}}{2^n}=\frac{n}{2}$.
\end{solution}

\begin{problem}
Найти число $k$\д мерных граней, проходящих через
фиксированную вершину.
\end{problem}
\begin{answer}
$\Cb^n_k$.
\end{answer}

\begin{problem}
Найти число $k$\д мерных подпространств, проходящих через фиксированную вершину.
\end{problem}
\begin{solution}
Вспомним задачу \ref{problem.5.1}. Ситуация та же, только теперь в каждом
базисе один вектор (с концом в этой вершине)\т фиксирован. То есть
из числителя и знаменателя дроби \eqref{drob} нужно убрать первый
сомножитель:
\begin{equation}
\frac{(2^n-2)(2^n-3)\ldots(2^n-2^{k-1})}{(2^k-2)(2^k-3)\ldots(2^-2^{k-1})}.
\end{equation}
\end{solution}

\begin{problem}\label{problem.5.3}
Найти порядок дроби (1).
\end{problem}
\begin{solution}
\eqn{\frac{(2^n-1)(2^n-2)\ldots(2^n-2^{k-1})}{(2^k-1)(2^k-2)\ldots(2^-2^{k-1})}=
2^{n(n-k)}\frac{\prod\limits_{i=1}^n \left(1-\frac{1}{2^i}
\right)}{\prod\limits_{i=1}^{n-k} \left(1-\frac{1}{2^i}
\right)\prod\limits_{i=1}^k \left(1-\frac{1}{2^i}
\right)}=2^{n(n-k)}\frac{C_n}{C_{n-k}C_{k}},}
где $C_r=\prod\limits_{i=1}^r \left(1-\frac{1}{2^i} \right)$. Оценка
дроби $\frac{C_n}{C_{n-k}C_{k}}$ будет зависеть от отношения $k$ к
$n$. Если $k=\bar{o}(n)$, то нам хватит очевидной оценки
$\frac{C_n}{C_{n-k}C_{k}} < 2^k$, так как эта величина не повлияет
на порядок. В общем случае нам понадобится более точная оценка на
$C_n$. Получим ее.
\mln{C_n=C_{n-1}-\frac{C_{n-1}}{2^n}=C_{n-2}-\frac{C_{n-2}}{2^{n-1}}-\frac{C_{n-2}}{2^{n}}+\frac{C_{n-2}}{2^{2n-1}}
\ge \\ \ge
C_{n-2}-C_{n-2}\left(\frac{1}{2^{n-1}}+\frac{1}{2^n}\right) \ge
\ldots \ge C_2-C_2\left(\frac{1}{4}+\ldots+\frac{1}{2^n}\right) \ge
\frac{1}{4}.}
Таким образом,
\eqn{\frac{C_n}{C_{n-k}C_{k}} \le \frac{1}{C_{k}} \le 4.}
\hfill\end{solution}

\begin{df}
Эллипсом с фокусами $\al, \beta$ будем называть, как
обычно, множество всех наборов с условием, чтобы сумма расстояний до
фокусов была равна некоторой фиксированной константе $k$.
\end{df}

\begin{problem}
Найти количество наборов в $n$-мерном булевом эллипсе.
\end{problem}
\begin{solution}
Итак, эллипс $V_k(\al, \beta) = \{\gamma| d(\al, \gamma)+d(\beta, \gamma)=k\}$. Будем рассматривать нетривиальный
случай, когда $l=d(\al, \beta)<k$. Зафиксируем те $n-l$ координат,
которые являются общими у $\al$ и $\beta$ и рассмотрим
соответствующее подпространство $E_l(\al, \beta)$. В нем, кроме
самих фокусов, будет $2^l-2$ элементов. Сумма расстояний от каждого
из них до фокусов будет равна $l$. Зафиксируем один из таких
элементов $\gamma$, и рассмотрим подпространство $E_{n-l}(\gamma)$
всего булевого куба, ортогональное к $E_l$ и проходящее через
$\gamma$. Для любого элемента $\gamma'$ из этого подпространства
сумма его расстояний до фокусов будет равна $l+d(\gamma, \gamma')$.
Значит, в нашем эллипсе будут лежать такие $\gamma'$, для которых
$d(\gamma, \gamma')=k-l$. Их число\т это число элементов сферы
радиуса $k-l$ в $(n-l)$\д мерном пространстве, то есть $\Cb_{k-l}^{n-l}$.
Таким образом мы получили $(2^l-2)\Cb_{k-l}^{n-l}$ наборов, лежащих в
$V_k$. Однако, нерассмотренными остались еще элементы подпространств
$E_{n-l}(\al)$ и $E_{n-l}(\beta)$, порождённых самими фокусами.
Пусть $\al' \in E_{n-l}(\al)$ и $d(\al, \al')=a$, тогда $d(\al,
\al')+d(\beta, \al')=2a+l$. То есть нас интересуют те $\al'$, для
которых $2a=k-l$. Если $k-l$ нечетно, таких не существует вовсе, а
если четно, их будет $\Cb_{\frac{k-l}{2}}^{n-l}$. Таким образом,
окончательный ответ будет выглядеть так:
\begin{equation}
|V_k|=(2^l-2)\Cb_{k-l}^{n-l}+\left\{\begin{array}{ll}
    0, & \hbox{$k-l=2m+1$;} \\
    \Cb_{\frac{k-l}{2}}^{n-l}, & \hbox{$k-l=2m$.}
  \end{array}
\right.
\end{equation}
\end{solution}

\section{Булев куб. Графы.}

\begin{df}
$k$-м слоем булевого куба $\hc{0, 1}^n$ называют множество
всех его вершин, вес которых (число ненулевых координат) равен $k$.

Пусть $A$\т подмножество $k$-го слоя, причем $k<\frac{n}{2}$. Подмножество $B$ $k+1$-го слоя называется \emph{тенью}
множества $A$, если расстояние (число различающихся координат) между
любыми двумя вершинами этих множеств равно 1.
\end{df}

\begin{problem}
Доказать, что $|A|(n-k)\le |B|\cdot (k+1)$.
\end{problem}
\begin{solution}
Рассмотрим множество всех ребер, соединяющих вершины из $A$ с
вершинами из $B$. Так как из каждой вершины, лежащей в $A$, выходит
ровно $n-k$ ребер (столько, сколько нулевых координат у этой
вершины), то их общее число равно $|A|(n-k)$. С другой стороны из
каждой вершины, лежащей в $B$ выходит не более $|B|(k+1)$ ребер (по
числу ее ненулевых координат), а значит $|A|(n-k)\le |B|(k+1)$, что
и требовалось доказать.
\end{solution}

\begin{df}
Будем называть антицепью набор вершин, любые две из которых
несравнимы.
\end{df}

\begin{problem}
Мощность максимальной антицепи в $\B^n$ не превышает $\Cb^n_{[n/2]}$.
\end{problem}
\begin{solution}
Для произвольной антицепи $L$ построим антицепь, содержащую не
меньше элементов, чем в было в исходной, и при этом не превышающей
по мощности $\Cb^n_{[n/2]}$. Пусть $A_1$\т подмножество элементов $L$,
лежащее на первом слое, а $B_2$\т его тень. Заметим, что $A_2\bigcap
B_2=\es$, так как иначе $A_2$ содержало бы элементы, сравнимые
с элементами из $A_1$. Более того, элементы $L$ с весом больше 2х
должны быть несравнимы с элементами $B_2$, так как если бы они были
больше каких-то элементов из $B_2$, то тем более были бы больше
соответствующих элементов из $A_1$. Все это означает, что исключив
из $L$ множество $A_1$ и добавив вместо него $B_2$, мы снова получим
антицепь, причем с мощностью не меньшей, чем мощность $L$. Продолжая
действовать аналогичным образом, мы рано или поздно поднимемся к
слою с максимальной мощностью. Такую же операцию произведем,
спускаясь сверху. Если $n$ нечетно, из двух максимальных слоев
выберем любой, и спроектируем все на него. Получим антицепь с
максимальной мощностью $\Cb^n_{[n/2]}$.
\end{solution}


\begin{df}
Гранью планарного графа называют цикл, не содержащий внутри себя
вершин.
\end{df}

\begin{problem}
Доказать формулу Эйлера $В-Р+Г=2$ для графов на плоскости.
\end{problem}
\begin{solution}
Докажем по индукции по числу граней. Если грань одна (база
индукции), то $В-Р=1$ и соотношение выполнено. Пусть теперь
утверждение доказано для $k$ граней. Если есть $k+1$ грань, уберем
любое ребро, разделяющее две грани, при этом число граней также
уменьшится на один и по предположению индукции получим
$В-(Р-1)+(Г-1)=2$, а значит и $В-Р+Г=2$.
\end{solution}

\begin{problem}
Доказать непланарность $K_{3,3}$ и $K_5$.
\end{problem}
\begin{solution}
Предположим, что $K_{3,3}$ планарен, тогда, согласно формулы
Эйлера, он должен содержать 5 граней. Из каждой вершины $K_{3,3}$
выходит три ребра, т. е. каждой вершине соответствует 4 грани.
Откуда получаем на число вершин следующее условие: $\text{В}\le
\Cb_{\text{Г}}^{4}=\Cb_5^4=5$, что неверно. Значит, $K_{3,3}$ не
планарен. Непланарность $K_5$ будет доказана в ходе решения
следующей задачи.
\end{solution}

\begin{problem}
Доказать достаточность пяти красок для раскраски вершин планарного графа с условием,
чтобы никакие две вершины одного цвета не принадлежали одному ребру.
\end{problem}
\begin{solution}
Доказывать будем по индукции по числу вершин. Сначала докажем,
что найдется вершина, из которой выходит не более 5 ребер. Пусть
$\Gamma_1,\ldots,\Gamma_m$\т множество граней графа,
$B_1,\ldots,B_n$\т множество его вершин, и $P_1,\ldots,P_k$\т множество его ребер. Пусть также
$P(B_i)$\т число ребер, выходящих
из $i$-й вершины, а $P(\Gamma_i)$\т число ребер, ограничивающих
$i$-ю грань. Каждое ребро принадлежит двум граням, следовательно
$\sum\limits_{i=1}^m P(\Gamma_i)=2P$. С другой стороны
$P(\Gamma_i)\ge 3 \Rightarrow 2k \ge 3m$. Подставляя это
неравенство в формулу Эйлера, получим $k \le 3n-6$. Нетрудно
заметить, что отсюда следует непланарность $K_5$. А вспоминая, что
каждому ребру принадлежат две вершины, получаем
\eqn{2k=\sum\limits_{i=1}^n P(B_i) \le 6n-12,}
откуда и следует, что найдется хотя бы одна вершина (обозначим ее $B_n$), из которой
выходит не более 5 ребер. Если их меньше пяти, то все доказано:
убирая эту вершину, раскрасим (это можно сделать по предположению
индукции) оставшийся граф 5ю красками, а саму $B_n$\т раскрасим в
тот цвет, который не встречается среди 4х смежных с ним вершин.
Пусть теперь таких вершин ровно пять. Среди них найдутся две,
которые не соединены друг с другом (это следует из непланарности
$K_5$). Возьмем эти две вершины и склеим их с $B_n$, получившийся
граф раскрасим. Т. о. мы получили раскраску графа без $B_n$, причем
для раскраски вершин, смежных с $B_n$ было использовано только 4
цвета. Раскрасим $B_n$ в оставшийся цвет\т все доказано.
\end{solution}

\begin{problem}
Пусть $A\subseteq \B^n, \al \in \B^n, (\al\oplus A):=\{a+\al | a \in A \}$.
Найти такое $n$, при котором для любого $A$ с условием $|A|<n$ найдется такое $\al$, что $(\al \oplus A)\bigcap A=\es$.
\end{problem}
\begin{solution}
$\exists \al: (\al \oplus A) \bigcap A = \es$ тогда и только тогда, когда
$\exists \al: \forall a_i,a_j \in A: \al+a_i \neq a_j$. В свою очередь, это возможно в том и только в том случае,
если
\eqn{|\{a_i+a_j|a_i,a_j \in A\}| \le |\B^n \wo \hc{0}|=2^n-1.}
Отсюда получаем следующее условие на $A$:
$$
\frac{|A|(|A|-1)}{2} \le 2^n - 1,
$$
откуда
\eqn{|A| \le \frac{1+\sqrt{2^{n+3}-7}}{2}.}
\end{solution}

\section{Коды Хемминга}

\begin{df}
Линейным $[n, k, d]_q$-кодом будем называть линейное
подпространство размерности $k$ $n$-мерного пространства над полем
$\mathbb{F}_q$, расстояние (т. е. число различных координат) между
векторами которого не меньше $d$. Проверочной матрицей $H$ этого
кода будем называть такую $(n-k)\times n$ матрицу, после умножения
на которую все вектора данного подпространства (кодовые слова)
обращаются в нуль. Порождающей матрицей $G$\т такую $k\times n$
матрицу, что линейная оболочка ее столбцов совпадает с пространством
кодовых слов.
\end{df}

\begin{df}
Будем говорить, что проверочная матрица приведена к
систематическому виду, если $H=(EH')$, где $E$\т единичная
$n-k\times n-k$ матрица, а $H'$\т некоторая матрица размера $(n-k)
\times k$. Нетрудно заметить, что в этом случае порождающая матрица
будет иметь вид
\eqn{G^T=\hr{\begin{array}{c}
H' \\
E \\
\end{array}}},
где $E$\т уже $k \times k$ единичная матрица.
\end{df}

\begin{df}
Пусть $r$\т целое положительное и $H$\т матрица размера
$r\times(2^r-1)$, столбцы которой\т все различные ненулевые векторы
пространства $\Z_2^r$. Код с проверочной матрицей $H$ будем
называть (двоичным) кодом Хемминга.

Такой код является линейным $[2^r-1, 2^r-r-1, 3]_2$-кодом, т. е.
он исправляет 1 ошибку.
\end{df}

\begin{ex}
Пусть $r=3$, тогда
\begin{equation}
H=\left(
  \begin{array}{ccccccc}
    0 & 0 & 0 & 1 & 1 & 1 & 1 \\
    0 & 1 & 1 & 0 & 0 & 1 & 1 \\
    1 & 0 & 1 & 0 & 1 & 0 & 1 \\
  \end{array}
\right),
\end{equation}
или, в систематическом виде:
\begin{equation}
H=\left(
  \begin{array}{ccccccc}
    1 & 0 & 0 & 0 & 1 & 1 & 1 \\
    0 & 1 & 0 & 1 & 0 & 1 & 1 \\
    0 & 0 & 1 & 1 & 1 & 0 & 1 \\
  \end{array}
\right),
\end{equation}
и, соответственно
\begin{equation}
G=\left(
  \begin{array}{ccccccc}
    1 & 0 & 0 & 0 & 0 & 1 & 1 \\
    0 & 1 & 0 & 0 & 1 & 0 & 1 \\
    0 & 0 & 1 & 0 & 1 & 1 & 0 \\
    0 & 0 & 0 & 1 & 1 & 1 & 1 \\
  \end{array}
\right).
\end{equation}
\end{ex}

\begin{df}
Кодом Хемминга над  $\mathbb{F}_q$ называют линейный
$\hs{\frac{q^r-1}{q-1}, \frac{q^r-1}{q-1}-r, 3}_q$-код.
\end{df}

\begin{problem}
Построить код Хемминга над $\Z_3$.
\end{problem}
\begin{solution}
Любые два столбца проверочной матрицы кода с минимальным
расстоянием~3 должны быть линейно независимы. В частном случае кода
над полем $\Z_2$ для этого было достаточно, чтобы все они
были различны. В общем случае никакие два столбца не должны быть
кратны друг другу. Т. е. матрица $H$ должна состоять из
максимального числа столбцов, не кратных друг другу над
$\Z_3$\т это число равно как раз $\frac{q^r-1}{q-1}-r$ (высоту
столбцов предполагаем равной $r$). В частности, для $r=3$ эта
матрица будет выглядеть так:
\begin{equation}\label{matrica}
\left(
  \begin{array}{ccccccccccccc}
    0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
    0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 2 & 2 & 2 \\
    1 & 0 & 1 & 2 & 0 & 1 & 2 & 0 & 1 & 2 & 0 & 1 & 2 \\
  \end{array}
\right).
\end{equation}
\end{solution}

\begin{problem}
Доказать, что выполняется условие границы
Варшамова-Гилберта: если
\begin{equation}\label{varshamov}
\Cb^1_n+\ldots+\Cb^{d-2}_n<2^r-1,
\end{equation}
то существует $n\times r$ матрица $H$, в которой любые $d-1$
столбцов линейно независимы.
\end{problem}
\begin{solution}
Докажем это утверждение по индукции. Для $n=1$ оно очевидно.
Пусть оно выполнено для $n=i$. Заметим, что сумма в левой части
неравенства \eqref{varshamov} есть число всех нетривиальных линейных комбинаций из
$d-2$-х столбцов. Если неравенство выполнено, то такие линейные
комбинации не исчерпывают всех столбцов высоты $r$, т. е. найдется
еще один, не являющийся линейной комбинацией никаких $(d-2)$-х из уже
имеющихся. Значит, можно его добавить, не испортив линейной
независимости системы.
\end{solution}

\begin{problem}
Имеются 2000 символов русского алфавита (страница текста) и
битовый канал связи с вероятностью ошибки при передаче 1го символа
$p_{err}=10^{-3}$. Требуется закодировать текст с помощью кода
Хемминга и передать, так что бы вероятность неправильного
раскодирования не превышала 1) $10^{-2}$, 2) $10^{-3}$, 3)
$10^{-4}$.
\end{problem}
\begin{solution}
Сначала поставим в соответствие каждой букве некоторую
последовательность из 0 и 1 (это разумно делать, учитывая частоту
появления различных букв\т данная процедура предоставляется
читателю). В результате получим некоторую битовую последовательность
длины $N\sim 10^{4}$. Разделим нашу последовательность на $k$ слов
длины $n$, каждое из которых закодируем с помощью кода Хемминга.
размерность $r$ кода подбирается так, чтобы $n\le 2^r-r-1$, а длина
закодированных слов будет равна $m=2^r-1$. Вероятность того, что
отдельное слово будет передано правильно (т. е. вероятность того,
что при передаче $n$ символов будет допущено не более 1 ошибки)
такова:
\begin{equation}
p=(1-p_e)^m+mp_e(1-p_e)^{m-1},
\end{equation}
\begin{equation}
p=1-\frac{m(m-1)}{2}p_e^2+O(m^3p_e^3).
\end{equation}
Следовательно, вероятность того, что все сообщение будет передано
правильно равна
\begin{equation}
p^k=1-\frac{km(m-1)}{2}p_e^2+O(k^2m^3p_e^3).
\end{equation}
Отсюда для случая 1) получаем
\begin{equation}
\frac{km(m-1)}{2}p_e^2+O(k^2m^3p_e^3)<10^{-2}.
\end{equation}
Вспоминаем, что $p_e=10^{-3}$, $km\sim N$:
\begin{equation}
\frac{10^4*(m-1)}{2}10^{-6}+O(10^{-1}m)<10^{-2},
\end{equation}
\begin{equation}
\frac{m-1}{2}+O(10m)<1.
\end{equation}
Т. е. такого $m$ не существует даже для случая 1).
\end{solution}

\section{Коды БЧХ}

\begin{df}
Пусть $\al_1,\ldots,\al_{2^m-1}$\т все элементы поля $GF^*(2^m)$. Построим матрицу:
\begin{equation}
A=\left(
  \begin{array}{cccc}
    \al_1 & \al_2 & \ldots & \al_n \\
    \al_1^3 & \al_2^3 & \ldots & \al_n^3 \\
    \vdots & \vdots & \vdots & \vdots \\
    \al_1^{2t-1} & \al_2^{2t-1} & \ldots & \al_n^{2t-1} \\
  \end{array}
\right).
\end{equation}
Теперь заметим, что каждый элемент $\al_i$ можно рассматривать как
столбец $\gamma_i$ высоты $m$ из элементов $\Z_2$.
Подставляя эти столбцы в $A$ на место $\al_i$, получим $n\times mt$
матрицу $H$ с элементами из поля $\Z_2$. Код с такой
проверочной матрицей будем называть кодом БЧХ.
\end{df}

\begin{theorem}
Такой код является кодом, исправляющим $t$ ошибок.
\end{theorem}
\begin{proof}
Нам нужно доказать, что в построенной матрице любые $t$ столбцов
линейно независимы. Предположим обратное, т. е. что нашлось $t$
линейно зависимых столбцов. Без ограничения общности можно считать,
что это первые $t$ столбцов. Тогда будет равен нулю определитель
такой матрицы:
\begin{equation}
\left(
  \begin{array}{cccc}
    \al_1 & \al_2 & \ldots & \al_t \\
    \al_1^3 & \al_2^3 & \ldots & \al_t^3 \\
    \vdots & \vdots & \vdots & \vdots \\
    \al_1^{2t-1} & \al_2^{2t-1} & \ldots & \al_t^{2t-1} \\
  \end{array}
\right).
\end{equation}
Т. к. $\al_i$ есть столбцы элементов из $\Z_2$, квадрат их
суммы будет равен сумме квадратов, а значит замена в этой матрице
строк, соответствующих степеням вида $2k-1$ на строки со степенями
$k$ не испортит линейной зависимости. Т. о. мы получаем, что равен
нулю так называемый определитель Вандермонда:
\begin{equation}
det\left(
  \begin{array}{cccc}
    \al_1 & \al_2 & \ldots & \al_t \\
    \al_1^2 & \al_2^3 & \ldots & \al_t^2 \\
    \vdots & \vdots & \vdots & \vdots \\
    \al_1^{t} & \al_2^{t} & \ldots & \al_t^{t} \\
  \end{array}
\right),
\end{equation}
что неверно. Следовательно, исходное предположение было ошибочным и
любые $t$ столбцов матрицы $H$ линейно независимы.
\end{proof}

\begin{ex}
Построим проверочную матрицу кода БЧХ, исправляющего 2 ошибки для $GF^*(16)$.
Заметим, что $GF^*(16)=\Z/[x^4+x+1]$, причем $x$ в этом поле будет примитивным элементом. Т. о. получаем
$$
A=\left(
  \begin{array}{ccccccccccccccc}
    x & x^2 & x^3 & x^4 & x^5 & x^6 & x^7 & x^8 & x^9 & x^{10} & x^{11} & x^{12} & x^{13} & x^{14} & x^{15} \\
    x^3 & x^6 & x^9 & x^{12} & x^{15} & x^3 & x^6 & x^9 & x^{12} & x^{15} & x^3 & x^6 & x^9 & x^{12} & x^{15} \\
  \end{array}
\right),
$$
$$
H=\left(
    \begin{array}{ccccccccccccccc}
      0 & 0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 1 & 1 & 1 \\
      1 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 0 \\
      0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 1 \\
      0 & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 \\
      0 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 1 & 0 \\
      1 & 1 & 1 & 1 & 0 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 1 & 1 & 0 \\
    \end{array}
  \right).
$$
Теперь выясним, как будет выглядеть процесс декодирования для кода,
задаваемого этой матрицей. Синдром
$S=Hy^T=\left(
                                           \begin{array}{c}
                                             S_1 \\
                                             S_3 \\
                                           \end{array}
                                         \right)$, где $S_1, S_3$\т
                                         столбцы высоты (в данном случае) 4.
Теперь рассмотрим следующие случаи:

\begin{enumerate}
  \item $S_1=S_3=0$: ошибок нет.
  \item $S_1=\al_i \neq 0, \quad S_3=S_1^3$: 1 ошибка в $i$-м разряде.
  \item $S_1=\al_i \neq 0, \quad S_3 \neq S_1^3$: см. ниже.
\end{enumerate}
Разберем случай 3). Пусть ошибки произошли в разрядах $i, j$, тогда
$S_1=\al_i+\al_j, S_3=\al_i^3+\al_j^3$, откуда получаем, что
$\al_i, \al_j$ являются корнями следующего квадратного уравнения
\begin{equation}
t^2+S_1t+S_1^2+\frac{S_3}{S_1}=0.
\end{equation}
Т. е. требуется решить это уравнение и таким образом найти разряды,
в которых произошли ошибки.
\end{ex}

\section{Алгоритм Питерсона}

\begin{footnotesize}
Более подробно теория написана в лекциях Лупанова/Угольникова (см. \dmvnwebsite).
\end{footnotesize}

Было передано сообщение $x$, закодированное с помощью кода БЧХ.
Получено сообщение $y=x+e$, где $e$\т вектор ошибок. Требуется
восстановить исходный вектор $x$.

\pt{1} Первый шаг очевиден\т посчитаем синдром полученного вектора.
\begin{equation}
S=Hy^{T}=He^T=\left(
                \begin{array}{c}
                  S_1 \\
                  S_3 \\
                  \vdots \\
                  S_{2t-1} \\
                \end{array}
              \right)
\end{equation}

\pt{2} Теперь вспомним, что означает синдром. Если ошибки произошли в
разрядах $i_1,\ldots,i_t$, выполняются следующие соотношения:
\begin{equation}
\left\{
  \begin{array}{ll}
    \al_{i_1}+\ldots+\al_{i_t}=S_1 \\
    \al_{i_1}^3+\ldots+\al_{i_t}^3=S_3 \\
    \vdots \\
    \al_{i_1}^{2t-1}+\ldots+\al_{i_t}^{2t-1}=S_{2t-1}.
  \end{array}
\right.
\end{equation}

\pt{3}
Отсюда хорошо бы найти $\al_{i_1},\ldots,\al_{i_t}$. Введем понятие
многочлена локаторов ошибок. Выглядит эта зверюга вот так:
\begin{equation}
\sigma(x)=(x-\al_{i_1})(x-\al_{i_2})\ldots(x-\al_{i_t})=x^t+\sigma_1x^{t-1}+\ldots+\sigma_t,
\end{equation}
где $\sigma_k$\т уже знакомый нам объект, $\sigma_k =
(-1)^k\sum\limits_{i_1,\ldots,i_k}\al_{i_1}\ldots\al_{i_k}$. Более
того, про них нам известно следующее:
\begin{equation}
\left\{
  \begin{array}{l}
    S_1+\sigma_1=0\\
    S_3+S_2\sigma_1+S_1\sigma_2+\sigma_3=0\\
    \vdots\\
    S_{2t-1}+S_{2t-2}\sigma_1+\ldots+S_{t-1}\sigma_t=0.
  \end{array}
\right.
\end{equation}
Знакомьтесь: это линейная система. Чтобы лучше понять, что она из
себя представляет, нам понадобятся две леммы.

\begin{lemma}
Пусть $S_j=\al_1^j+\ldots+\al_v^j, v \le t-2$. Тогда $\det M_t=0$, где
\begin{equation}
M_t=\left(
    \begin{array}{ccccc}
      1 & 0 & 0 & \ldots & 0 \\
      S_2 & S_1 & 1 & \ldots & 0 \\
       & \vdots &  &  \\
      S_{2t-2} & S_{2t-3} & S_{2t-4} & \ldots & S_{t-1} \\
    \end{array}
  \right).
\end{equation}
\end{lemma}
\begin{proof}
Нетрудно заметить, что умножая матрицу $M_t$ на $(0, 1, \sigma_1,\ldots,\sigma_{t-2})^T$ получим нулевой столбец. А это и
означает, что $\det M_t=0$.
\end{proof}

Перейдем теперь собственно к \textit{алгоритму Питерсона}. Он
состоит из следующих шагов.

\begin{enumerate}
  \item Находим синдром $S_1,\ldots,S_{2t}$.
  \item Считаем определитель $\det M_t$. Если он оказался равен 0,
делаем вывод: произошло меньше $t-1$ ошибок. В этом случае переходим
к меньшей матрице $M_{t-2}$ и повторяем проверку. Как только для
некоторого $v$ получили $\det M_v>0$, переходим к следующему шагу.
  \item Решаем систему $M_v(\sigma_1,\ldots,\sigma_v)^T=(S_1,\ldots,S_{2v-1})^T$
  \item Ищем корни многочлена $\sigma(x)$ и узнаем номера разрядов,
в которых произошли ошибки.
\end{enumerate}

\section{СФЭ}

\begin{problem}
Задано $k>0$ и функция $F$ из $\B^{2^k-1}$ в $\B^{k}$. Действие
функции определим с помощью матрицы $H$ кода Хемминга следующим
образом. Пусть $\bar{x}=x_1\sco x_{2^k-1}$\т входной набор, $i_1\sco
i_m$\т набор индексов, которым соответствуют номера единиц в $j$-й
строке матрицы Хемминга; тогда $j$\д я компонента вектора $F(\bar{x})$
будет выглядеть следующим образом: $x_{i_1}\sa x_{i_k}$. Далее (по
вполне понятным причинам) мы будем записывать это равенство так
\eqn{F(\bar{x})=H\bar{x}.} На месте конъюнкций, разумеется, можно
было бы поставить любую другую бинарную операцию -- суть задачи от
этого не изменится. А задача заключается в том, чтобы найти
сложность СФЭ, реализующей такую функцию, над базисом $\{\&\}$.
\end{problem}
\begin{solution}
Прежде всего, запишем матрицу Хемминга так, чтобы в столбцах стояли
по порядку двоичные записи чисел $1\sco 2^k-1$, а слева еще припишем
нулевой столбец: \eqn{H_k=\rbmat{0&0&\ldots&0&0&1&1&\ldots&1&1\\
0&0&\ldots &0&1&0&0&\ldots &0&1\\&&&&& \vdots\\ 0&1&\ldots
&1&1&0&1&\ldots&1&1}.} Несложно заметить, что имеет место
представление
\eqn{H_k=\rbmat{0&\ldots&0&1&\ldots&1\\&H_{k-1}&&&H_{k-1}}.} Итак,
пусть $h_k$\т сложность схемы, реализующей $H_k$. Тогда
\eqn{h_k=h_{k-1}+(2^{k-1}-1)+(2^{k-1}-1),} где второе слагаемое
отвечает за склейку $2^{k-1}$ пар переменных, которые потом парами
подаются на входы схемы для $H_{k-1}$, а третье\т за конъюнкцию
последних $2^{k-1}$ переменных, соответствующую первой строке
матрицы $H_k$. Итак, окончательно получаем \eqn{h_k=2^{k+1}-2k.}
\hfill\end{solution}
\begin{note}
Здесь хорошо бы еще доказать, что ее нельзя реализовать меньшим
числом элементов. Пока что это доказательство откладывается до
лучших времен\ldots
\end{note}

\end{document}
