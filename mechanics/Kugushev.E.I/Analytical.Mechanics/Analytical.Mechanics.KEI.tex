\documentclass[a4paper]{article}
\usepackage{dmvn}
\usepackage{amsxtra}

\DeclareMathOperator{\diverg}{div}

\def\RR{\mathbb{R}}
\def\vr{\boldsymbol{v}}
%\def\const{\mathrm{const}}

\def\rb{\boldsymbol{r}}
\def\ub{\boldsymbol{u}}
\def\gb{\boldsymbol{g}}
\def\eb{\boldsymbol{e}}
\def\Kin{\boldsymbol{K}}
%\def\diag{\mathrm{diag}}
\def\vb{\mathbf{\displaystyle v\!}}

\def\phi{\varphi}
\def\dots{\ldots}

\def\vA{\vr_{\text{\rm абс}}}
\def\vO{\vr_{\text{\rm отн}}}
\def\vP{\vr_{\text{\rm пер}}}

\def\aA{a_{\text{\rm абс}}}
\def\aO{a_{\text{\rm отн}}}
\def\aP{a_{\text{\rm пер}}}
\def\aK{a_{\text{\rm кор}}}

\DeclareMathOperator\mom{mom}

%\newcommand[2]{\bjacobian}{\left( \jacobian{#1}{#2}\right)}
\newcommand{\jac}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}}
\newcommand{\bjac}[2]{\ensuremath{\left(\jac{#1}{#2}\right)}}
\def\Vect{\overrightarrow}

%\newtheorem{theorem}{Теорема}
%\newtheorem{stm}{Утверждение}
%\newtheorem{lemma}{Лемма}

\begin{document}
\dmvntitle{Курс лекций по}{аналитической механике}{Лектор\т Евгений Иванович Кугушев}
{IV курс, 8 семестр, поток математиков}{Москва, 2007 г.} \pagebreak

\tableofcontents

\section*{Предисловие}
Это рабочий черновик лекций по аналитической механике для математиков IV курса,
набираемых в режиме RT Александром Харитоновым ({\tt kalkin@mexmat.net}) и
Степаном Кузнецовым ({\tt skuzn@inbox.ru}).

В главу о волчках нужна куча рисунков, без них, боюсь, разобраться будет сложно. ({\tt Саша, April 2, 2008})

Теперь здесь есть все лекции, просьба искать ошибки и присылать багрепорты.
\medskip\dmvntrail

\pagebreak
\section{Лагранжева механика}
\subsection{Уравнения Лагранжа 2-го рода}
\subsubsection{Напоминание о виртуальных перемещениях}
Рассмотрим систему из $N$ материальных точек с положениями $\Vect r = (r_{1}, \dots, r_{N})$ и массами $m_{1}, \dots, m_{n}$, снабжённую $k$ независимыми голономными связями $f_{i}(\Vect r, t) = 0, i = 1,\dots,k$. Пусть $f = (f_1,\dots,f_k)$. Независимость здесь означает, что ранг матрицы $\left( \frac{\partial f_{i}}{\partial r_{j}}\right)$ максимален, т.е. равен $k$. Из этого и теоремы о неявной функции следует, что конфигурационное пространство нашей системы $\Sigma_{t}$ в каждой точке $t$ локально взаимно однозначно и взаимно гладко описывается $n = 3N-k$ координатами $\Vect q = (q_{1},\dots,q_{n})$, и это описание к тому же гладко зависит от времени, т.е. $r_i = r_i(\Vect q, t), i = 1,\dots,N$, $f_i(\Vect r(\Vect q,t), t) = 0, i = 1,\dots,k$ для всех $(\Vect q, t) \in U \times (t_0,t_1)$, где $U$ -- открытое множество и $\Vect r(\Vect q,t)$ -- гладкая функция. 

Напомним, что такое виртуальное перемещение. 
\begin{df}
$\delta r \in \R^{3N}$ -- виртуальное перемещение, если $\left(\frac{\partial f}{\partial r}\right) \delta r = 0$. Обозначим это, как $\delta r \in L_{вирт}(\Vect r, t)$.
\end{df}

Легко видеть, что $L_{вирт}(r,t)$ есть не что иное, как касательное пространство к $\Sigma_t$ в точке $\Vect r$.

Из геометрических соображений очевидно, что вектора $\frac{\partial r}{\partial q_i}$ образуют базис этого касательного пространства, и поэтому виртуальные перемещения -- это образ $\R^n$ при отображении $x \mapsto \left(\frac{\partial r}{\partial q}\right) x$ (мы получаем всевозможные линейные комбинации строк матрицы, т.е. как раз всё касательное пространство). Докажем это чуть более нудно, но строго.

Возьмём $ t \in  \R, q, \delta q \in \R^n$ и кривую $q(\alpha)$ на $\Sigma_t$, такую что $q(0) = q, q'(0) = \delta q$. По определению обобщённых координат, $g(\alpha) = f(r(q(\alpha),t),t) \equiv 0$. Продифференцируем это по $\alpha$ при $\alpha = 0$:
$$
g'(0) = \left(\frac{\partial f}{\partial r}\right) \left(\frac{\partial r}{\partial q}\right) \delta q = 0.
$$
Следовательно, по определению виртуального перемещения, $\Im \left(\frac{\partial r}{\partial q}\right) \subseteq L_{вирт}$. Осталось заметить, что этот образ имеет ту же размерность, что и $L_{вирт}$, то есть $n$. (матрица $\left(\frac{\partial r}{\partial q}\right)$ имеет максимальный ранг)
Итак, доказана 
\begin{lemma}
$\Im \left(\frac{\partial r}{\partial q}\right)(q,t) = L_{вирт}(r(q),t)$.
\end{lemma}

\subsubsection{Вывод уравнений Лагранжа 2-го рода}
Рассмотрим систему точек с идеальными связями. В прошлом семестре мы получили для неё уравнения Лагранжа с множителями (первого рода) и доказали принцип Д`Аламбера -- Лагранжа:
\begin{theorem}
$r(t)$ -- действительное движение системы $\Leftrightarrow$ в любой точке $t$ для любого виртуального перемещения $\delta r$ $\langle M \ddot r - F, \delta r \rangle = 0$. ($M = \diag(m_1,m_1,m_1,\dots,m_N,m_N,m_N)$).
\end{theorem}

Подставим сюда наше новое выражение для виртуальных перемещений.
$$
\langle M \ddot r - F, \frac{\partial r}{\partial q} \delta q \rangle = 0 \quad \forall \delta q \in \R^n
$$
и перенесём матрицу $\frac{\partial r}{\partial q}$ налево:
$$
\left\langle \left(\frac{\partial r}{\partial q}\right)^T M \ddot r - \left(\frac{\partial r}{\partial q}\right)^T F, \delta q \right\rangle = 0 \quad \forall \delta q \in \R^n.
$$ 
Отсюда получаем уравнения Лагранжа 2-го рода, правда, пока в совершенно уродском виде:
$$
\left(\frac{\partial r}{\partial q}\right)^T  M \ddot r = \left(\frac{\partial r}{\partial q}\right)^T F.
$$

Перепишем их, как уравнения относительно $q, \dot q, \ddot q, t$: $r = r(q,t), \dot r = \frac{\partial r}{\partial q} \dot q + \frac{\partial r}{\partial t} = r(q,\dot q, t), \ddot r = \ddot r(q,\dot q, \ddot q, t), \dots$, поэтому, подставив это всё, получим уравнение
$$
\left(\frac{\partial r}{\partial q}\right)^T M \left(\frac{\partial r}{\partial q}\right) \ddot q + g(q,\dot q, t) = 0.
$$
Обозначим матрицу $\left(\frac{\partial r}{\partial q}\right)^T M \left(\frac{\partial r}{\partial q}\right)$ через $A$.
Покажем, что оно разрешимо относительно $\ddot q$, т.е. $A$ обратима. Возьмём кривую $r = r(q(\alpha))$ и посчитаем на этой кривой <<кинетическую энергию>> $T' = \frac12 \langle M r',  r' \rangle > 0$, заметим, что $r' = \frac{\partial r}{\partial q} \frac{\partial q}{\partial a}$, поэтому $T' = \langle A \frac{\partial q}{\partial a}, \frac{\partial q}{\partial a} \rangle > 0$ для любого $\frac{\partial q}{\partial a} \ne 0$, значит, $A$ положительно определена и обратима.

Итак, $\dot r(q,\dot q, t) = \frac{\partial r}{\partial q} \dot q + \frac{\partial r}{\partial t}$, поэтому $\frac{\partial \dot r}{\partial \dot q} = \frac{\partial r}{\partial q}$. Считаем все связи достаточно гладкими (чтобы можно было переставлять местами частные производные). Тогда $\frac{\partial}{\partial t}(\frac{\partial r}{\partial q}) = \frac{\partial \dot r}{\partial q}$, $\frac{\partial}{\partial q}(\dot r) = \frac{\partial}{\partial t}(\frac{\partial r}{\partial q}).$

Преобразуем правую часть нашего уравнения. $Q = \left(\frac{\partial r}{\partial q}\right)^T F$  называется вектором обобщённой силы. $Q_i = \sum_j \frac{\partial r_j}{\partial q_i} F_j$, т.е. это как бы мощность (а $\frac{\partial r_j}{\partial q_i}$ -- <<скорости>>).

Теперь разберёмся с левой частью.
$$
\left(\frac{\partial r}{\partial q}\right)^T \frac{\partial}{\partial t}\left(M \dot r\right) = \frac{\partial}{\partial t}\left( \left(\frac{\partial r}{\partial q}\right)^T M \dot r \right) - \frac{\partial}{\partial t}\left(\left(\frac{\partial r}{\partial q}\right)^T\right) M \dot r.
$$

Запишем кинетическую энергию в обобщённых координатах: $T = T(q,\dot q,t) = \frac12 \langle M \dot r, \dot r \rangle = \frac12 \langle M \dot r(q,\dot q,t), \dot r \rangle.$
\begin{lemma}
Пусть $x ,b(x) \in \R^n$, $A$ -- симметрическая $n \times n$-матрица, $a(x) = \frac12\langle A b(x), b(x)\rangle.$ Тогда $\frac{\partial a}{\partial x} = \left(\frac{\partial b}{\partial x}\right)^T A b$.
\end{lemma}
\begin{proof} Проверяется непосредственно.\end{proof}

Пользуясь этой леммой, видим, что $\frac{\partial T}{\partial \dot q} = \left(\frac{\partial \dot r}{\partial \dot q}\right)^T M \dot r, \frac{\partial T}{\partial q} = \left(\frac{\partial \dot r}{\partial q}\right)^T.$ 
Поэтому окончательно уравнение можно переписать в виде
$$
\frac{\partial}{\partial t}\left(\frac{\partial T}{\partial \dot q}\right) - \frac{\partial T}{\partial q} = Q.
$$
Эта система уравнений называется уравнениями Лагранжа $2$-го рода.

\subsubsection{Случай потенциальных сил. Лагранжиан}
Пусть теперь силы потенциальны, т.е. существует $V$: $F = -\frac{\partial V}{\partial r}$ и система стационарна, т.е. $r = r(q)$. Если расписать, можно увидеть, что $Q = \left(\frac{\partial r}{\partial q}\right)^T F = - \left(\frac{\partial r}{\partial q}\right)^T  \frac{\partial V}{\partial r} = - \frac{\partial V}{\partial q}$, где $V(q)$ понимается, как $V(r(q))$.

\begin{df}
Лагранжианом такой системы называется функция $L = T(q,\dot q,t) - V(q)$.
\end{df}

$L$ не зависит от $\dot q$, поэтому $\frac{\partial T}{\partial \dot q} = \frac{\partial L}{\partial \dot q}$, и уравнение Лагранжа можно переписать в виде
$$
\frac{\partial}{\partial t}\left(\frac{\partial L}{\partial \dot q}\right) - \frac{\partial T}{\partial q} = - \frac{\partial V}{\partial q},
$$
или, что то же самое,
$$
\frac{\partial}{\partial t}\left(\frac{\partial L}{\partial \dot q}\right) - \frac{\partial L}{\partial q} = 0. 
$$

Это уравнение называется уравнением Лагранжа  $2$-го рода для \emph{консервативных систем}. Всем, кто знает ОПУ, это уравнение хорошо знакомо в качестве уравнения Эйлера которому удовлетворяет экстремаль в простейшей задаче КВИ, и это неспроста. 

%%% Лекция 2, 2008-02-20

Кинетическая энергия --- это  квадратичная форма на векторе скоростей системы: $T = \frac12 \langle M \dot r, \dot r \rangle = T_2 + T_1 + T_0$, где $T_i$ содержит члены $i$-й степени по $\dot r$.  Ясен арафат, что в случае, когда $\dot r = (\dot r_1, \ldots, \dot r_N) = (\dot x_1, \dot y_1, \dot z_1, \ldots, \dot x_N, \dot y_N, \dot z_N)$ -- просто вектор скоростей системы точек в $R^3$, $T_0 = T_1 = 0$. Система в обобщённых координатах, для которой это все равно верно, называется \emph{натуральной}. Перепишем $T$ в произвольных обобщённых координатах:
$$
T = \frac12 \bba{ M \left( \bjac{r}{q} \dot q + \bjac{r}{t} \right),  \left( \bjac{r}{q} \dot q + \bjac{r}{t} \right) }.
$$
Как видим, здесь $T_2 = \frac12 \ha{A(q) \dot q, \dot q}$, где $A(q) = \bjac{r}{q}^T M \bjac{r}{q}$, $T_1 =   \ha{ M\bjac{r}{q} \dot q, \jac{r}{t}}$, $T_0 = \ha{M \jac{r}{t}, \jac{r}{t}}$.
Матрица $A(q)$ называется \emph{матрицей кинетической энергии} системы. Как подобная матрице масс
$M$, она положительно определена.

Если силы потенциальны, то обобщённые силы тоже потенциальны, и можно ввести лагранжиан
$L(q, \dot q, t) = T - V$. Иногда бывает, что силы можно представить в виде $F = F^{\text{п}} +
F^{\text{н}}$, где $F^{\text{п}}$ --- потенциальные силы, которым соответствует потенциал
$V$, а $F^{\text{н}}$ --- непотенциальные силы, которым соответствуют обобщённые силы
$Q^{\text{н}}$. Полагаем $L = T - V$. Уравнения движения приобретают вид
$$
\frac{d}{dt} \frac{\partial L}{\partial \dot q} - \frac{\partial L}{\partial q} = Q^{\text{н}}.
$$

Наложим на нашу систему ещё одну связь $f(q,t) = 0$. Как и раньше, можно ввести уравнения
Лагранжа 2-го рода \emph{с множителями}:
$$\left\{
\begin{aligned}
&\frac{d}{dt} \frac{\partial L}{\partial \dot q} - \frac{\partial L}{\partial q} = Q^{\text{н}} +
\frac{\partial f}{\partial q}^T \lambda \\
& f(q,t) = 0.
\end{aligned}
\right.
$$

\subsubsection{Первые интегралы уравнений Лагранжа}
Фазовое пространство у нас есть пространство переменных $q, \dot q$. Напомним, что 
первым интегралом системы называется функция $\Phi$ такая, что $\Phi(q, \dot q)$ постоянна
на траекториях системы.

\textbf{I. Обобщённый интеграл энергии (интеграл Якоби)}

\begin{stm}
Если $\frac{\partial L}{\partial t} = 0$, то $h = \frac{\partial L}{\partial \dot q} \dot q - L$
--- первый интеграл уравнений Лагранжа 2-го рода.
\end{stm}
\begin{proof}
Дифференцируем по времени:
$$
\frac{d}{dt} \left( \frac{\partial L}{\partial \dot q} \dot q - L \right) = 
\frac{d}{dt} \frac{\partial L}{\partial \dot q} \dot q + \frac{\partial L}{\partial
\dot q} \ddot q - \frac{\partial L}{\partial \dot q} \ddot q - \frac{\partial L}{\partial q}
\dot q = \dot q \left( \frac{d}{dt} \frac{\partial L}{\partial \dot q} -
\frac{\partial L}{\partial q} \right).
$$
Последняя скобка равна нулю в силу системы.
\end{proof}

\begin{lemma}[Эйлера об однородных функциях]
Пусть $f(x_1, \dots, x_k)$ --- однородная функция степени $k$, т.е. $f(\lambda 
x) = \lambda^k f(x)$ при $\lambda > 0$ ($x = (x_1, \dots, x_k)$). Тогда
$$
\left\langle \frac{\partial f}{\partial x}, x \right\rangle = k f(x).
$$
\end{lemma}
\begin{proof} См. прошлый семестр. \end{proof}


$T = T_2 + T_1 + T_0$, $L = T_2 + T_1 + T_0 - V$.
 $T_2$ --- однородная функция степени 2, а $T_1$ --- степени 1 по $\dot q$
(а $T_0$ от $\dot q$ не зависит). По лемме Эйлера об однородных функциях получаем
$\frac{\partial L}{\partial \dot q} \dot q = 2T_2 + T_1$.
Поэтому интеграл Якоби записывается в виде:
$$
\frac{\partial L}{\partial \dot q} \dot q - L = 2T_2 + T_1 - T_2 - T_1 - T_0 + V =
T_2 - T_0 + V
$$
и для натуральных систем равен полной энергии системы $h = T+V$.

\textbf{II. Циклические интегралы}

\begin{df} Обобщённая координата $q_i$ называется \emph{циклической}, если 
$\frac{\partial L}{\partial q_i} = 0$.
\end{df}

В этом случае $i$-е уравнение Лагранжа приобретает вид $\frac{d}{dt} \frac{\partial L}{\partial
\dot q_i} = 0$, то есть $\beta_i = \frac{\partial L}{\partial \dot q_i}$ есть первый интеграл
системы (он называется циклическим интегралом). Заметим, что существование циклических 
интегралов зависит от выбора системы обобщённых координат: в некоторых системах они
как бы скрыты.

\subsubsection{Калибровка лагранжиана}
При следующих преобразованиях: $\tilde L = L + f(t)$, $\tilde L = cL$, $\tilde L = L
+ a(q) \dot q$ (где $a_i = \frac{\partial \phi(q)}{\partial q_i}$, т.е. $a$ --- полный
дифференциал) форма уравнений Лагранжа 2-го рода не меняется.

\begin{ex}
Рассмотрим задачу с одной степенью свободы: $L = a(q) \dot q^2 + b(q) \dot q - V$ 
($q$ --- скаляр). Второе слагаемое можно выкинуть как полный дифференциал; $a(q) 
> 0$ (матрица квадратичной формы положительно определена). Выберем новую обобщённую
координату $\xi$ так, чтобы $\dot \xi^2 = a(q) \dot q^2$ ($\dot \xi = \sqrt{a(q)} \dot q$).
Получаем $L = \dot\xi^2 - V(\xi)$ --- мы свели нашу задачу к задаче движения точки
по прямой.
\end{ex}

\subsubsection{Понижение порядка по Раусу}
Пусть $L(q, \dot q, t)$ --- лагранжиан, $q \in \RR^n$, $q = (q_1, \dots, q_k, q_{k+1},
\dots, q_n)$, где $q_c = (q_1, \dots, q_k)$ --- циклические координаты. Остальные
координаты $q_{\text{п}} = (q_{k+1}, \dots, q_n)$ назовём \emph{позиционными}.
$L = L(q_{\text{п}}, \dot q_c, \dot q_{\text{п}}, t)$. Рассмотрим стационарный случай:
$L$ не зависит от $t$.

Если заданы значения циклических интегралов $\beta_c$, получаем $k$ уравнений на
$\dot q_c$:
$\frac{\partial L}{\partial \dot q_c} = \beta_c$. Предположим, что выполнены
условия теоремы о неявной функции: $\left| \frac{\partial^2 L}{\partial \dot q_c^2} 
\right| \ne 0$. Тогда эти уравнения можно разрешить: $\dot q_c
= \dot q_c(q_{\text{п}}, \dot q_{\text{п}}, \beta_c)$.

\emph{Функция Рауса:} $R(q_{\text{п}}, \dot q_{\text{п}}, \beta_c) = 
L(q_{\text{п}}, \dot q_c(q_{\text{п}}, \dot q_{\text{п}}, \beta_c), 
\dot q_{\text{п}}) - \langle \beta_c, \dot q_c(q_{\text{п}}, \dot q_{\text{п}}, \beta_c) \rangle$.
Легко проверить, что выполняется соотношение
$$
\frac{d}{dt} \frac{\partial R}{\partial \dot q_{\text{п}}} - 
\frac{\partial R}{\partial q_{\text{п}}}=0,
$$
называемое \emph{уравнениями Рауса}.
\begin{proof}
$\jac{R}{\dot q_{\text{п}}} = \jac{L}{\dot q_{\text{п}}} + \jac{L}{\dot q_c} \jac{q_c}{q_{\text{п}}} - \ha{ \beta_c, \jac{q_c}{q_{\text{п}}}} = \jac{L}{\dot q_{\text{п}}}$, т.к. $\jac{L}{\dot q_c} = \beta_c$. Та же ботва происходит в слагаемом $\jac{R}{ q_{\text{п}}}$.
\end{proof}
Таким образом, при фиксированных значениях $k$ циклических интегралов система ведёт себя как система с $(n-k)$ степенями свободы.

\subsection{Вариационные принципы и симметрии}
\subsubsection{Поле симметрий. Теорема Нётер}
Векторному полю $v(q)$ сопоставим однопараметрическую группу диффеоморфизмов
$q \mapsto g^s(q)$, где $g^s(q)$ --- точка, в которую придёт решение дифферециального
уравнения $q' = v(q)$ из точки $q$ за время $s$. Пусть теперь дана кривая $q(t)$.
Положим $q(t, s) = g^s(q(t))$ --- сдвиг кривой вдоль векторного поля $v$.

\begin{df} $v(q)$ --- \emph{поле симметрий}, если для всех кривых $q(t)$ и для любого
$s$ выполняется
$$
L(q(t,s), \dot q(t,s), t) = L(q(t), \dot q(t), t),
$$
т.е. лагранжиан инвариантен относительно сдвигов вдоль $v$.
\end{df}

Эквивалентно: $L(q, \dot q, t) = L(g^s q, (dg^s) \dot q, t)$.

\begin{ex}\label{Ex:cycle}
Если $q_1$ --- циклическая координата, то $v = (1, 0, \dots, 0)^T$ --- поле симметрий.
\end{ex}

\begin{theorem}[Нётер]
Если $v(q)$ --- поле симметрий, то $\frac{\partial L}{\partial \dot q} v(q)$ --- первый
интеграл уравнений Лагранжа.
\end{theorem}

\begin{proof}
$q = q(t,s)$; $q(t) = q(t,0)$ --- траектория системы.

В силу дифференциального уравнения $q' = v(q)$ получаем
$$
\frac{\partial q}{\partial s} = v(q(t,s)).
$$
Дифференцируем по $t$:
$$
\frac{\partial^2 q}{\partial s\, \partial t} = \frac{\partial v}{\partial t}.
$$
Подставляем в лагранжиан и вспоминаем, что $v$ --- поле симметрий:
$$
L(q(t,s), \frac{\partial q}{\partial t}(t,s), t) = \const(s)
$$
--- зависит только от $t$. Дифференцируем по $s$:
$$
\frac{\partial L}{\partial q}\frac{\partial q}{\partial s} +
\frac{\partial L}{\partial \dot q}{\frac{\partial \dot q}{\partial s}} = 0
$$
Вспоминая, что $\frac{\partial q}{\partial s} = v$, а $\frac{\partial \dot q}{\partial s}
= \frac{\partial^2 q}{\partial t \partial s} = \dot v$, получаем
$$
\frac{\partial L}{\partial q} v + \frac{\partial L}{\partial \dot q} \dot v = 0.
$$
Отсюда (в подстановке $s=0$)
$$
\frac{d}{dt} \left( \frac{\partial L}{\partial \dot q} v \right) =
\frac{d}{dt} \left( \frac{\partial L}{\partial \dot q} \right) v +
\frac{\partial L}{\partial \dot q} \dot v =
\left( \frac{d}{dt} \frac{\partial L}{\partial \dot q} -
\frac{\partial L}{\partial q} \right) v = 0
$$
в силу уравнения Лагранжа.
\end{proof}

%
% 27.02.2008
% лекция 3
%

Продолжая пример~\ref{Ex:cycle}, видим, что нётеров интеграл,
соответствующий полю $v = (1, 0, \dots, 0)^T$, --- это просто
циклический интеграл $\frac{\partial V}{\partial \dot q_1}$. Обратно,
если для некоторой точки $q_0$ имеем $v(q_0) \ne 0$ (заметим, что
в теореме Нётер этого не требовалось), то по теореме о выпрямлении
векторного поля в некоторых координатах $\xi$ получаем $v(\xi) =
(1, 0, \dots, 0)^T$. Поскольку при замене координат вид лагранжиана
не меняется (если это не очевидно сразу, посмотрите на вариационные
принципы), в системе $\xi$ интеграл Нётер есть циклический интеграл.

\subsubsection{Принцип Гамильтона}
Общая идея вариационных принципов состоит в следующем: траектория
движения есть экстремаль некоторого функционала.

Зафиксируем моменты времени $t_1$, $t_2$ и точки (в пространстве
обобщённых координат) $q_1$ и $q_2$. Рассмотрим семейство кривых
$q(t)$, $t \in [t_1, t_2]$ с закреплёнными концами: $q(t_1) = q_1$,
$q(t_2) = q_2$. Определим на этих кривых функционал, называемый
\emph{действием}: вот так он действует на кривую $q_0(t)$:
$$
I[q_0] = \int\limits_{t_1}^{t_2} L(q_0, \dot q_0, t) \, dt.
$$

\emph{Вариацией по Гамильтону} кривой $q_0$ называется семейство
кривых $q_*(t,\alpha)$, $t \in [t_1, t_2]$, $\alpha \in (-\ep,\ep)$.
такое, что $q_*(t,0) = q_0(t)$, $q_*(t_1, \alpha) = q_1$, $q_*(t_2,\alpha)
= q_2$. Заметим, $I[q_*]$ есть функция параметра $\alpha$. 
\emph{Вариацией $I$ на вариации $q_*$} называется производная этой функции
по параметру $\alpha$ в нуле:
$$
\delta I[q_*] = \left. \frac{dI[q_*]}{d\alpha} \right|_{\alpha=0}.
$$

\begin{stm}[вариационный принцип Гамильтона] Кривая $q_0(t)$ удовлетворяет
уравнениям Лагранжа 2-го рода (является траекторией движения) тогда
и только тогда, когда $\delta I[q_*] = 0$ для любой вариации $q_*$
кривой $q_0$.
\end{stm}

Кривые, на которых все вариации функционала $I$ равны нулю, называются его
\emph{экстремалями}. Если на кривой $q_0(t)$ достигается
слабый минимум в задаче классического вариационного исчисления:
$I[q] \to \min$, $q(t_1) = q_1$, $q(t_2) = q_2$, то это экстремаль
(обратное неверно). Используя
понятие экстремали, можно переписать принцип Гамильтона так:
\textit{кривая $q_0(t)$ является траекторией движения тогда и только
тогда, когда она является экстремалью функционала $I$}.

\begin{proof}
Внесём дифференцирование по $\alpha$ под знак интеграла и в предположении
того, что всё гладко, проинтегрируем по частям. Внеинтегральный
член равен нулю (поскольку на концах $q_*$ не зависит от $\alpha$). 
Окончательно получим
$$
\delta I[q_*] = \int\limits_{t_1}^{t_2} \left.\left(
 \frac{\partial L}{\partial q}
- \frac{d}{dt} \frac{\partial L}{\partial \dot q} \right)
\frac{\partial q_*}{\partial \alpha} \right|_{\alpha=0} \, dt,
$$
что равно нулю для всех $q_*$ в том и только в том случае, когда
выполняется уравнение Лагранжа (скобка под интегралом равна нулю).

Более подробно и аккуратно это рассуждение излагается в любом
приличном курсе вариационного исчисления.
%пока что смотри курс ВИиОУ
\end{proof}

В случае натуральной системы можно показать (мы этого делать не будем),
что для достаточно близких $q_1$ и $q_2$ траектория движения даёт
минимум действия (а не просто экстремаль). В этом случае принцип
Гамильтона называется ещё \emph{принципом наименьшего действия}.
На длинных траекториях могут появляться сопряжённые точки.

\subsubsection{Принцип Мопертюи -- Якоби}
Будем предполагать, что наша система натуральна. Тогда $L = \frac 12
\langle A(q) \dot q, \dot q \rangle - V(q)$. Матрица $A(q)$ положительно
определена, а значит, задаёт риманову метрику $ds^2 = \langle A(q) \, dq,
dq \rangle$. Эта метрика называется \emph{кинетической}. 
$T = \frac{\| \dot q \|^2}{2}$ ($\| \cdot \|$ --- норма, задаваемая
кинетической метрикой).

Зафиксируем константу $h$. Введём \emph{метрику Якоби} в области $\{
q : h - V(q) > 0 \}$: $d\rho^2 = 2(h-V(q)) \, ds^2$. В случае, когда
$h$ --- значение интеграла энергии, эта область есть внутренность ОВД.

Пусть $\gamma_0$ --- кривая, соединяющая $q_1$ и $q_2$ (в любой
параметризации. \emph{Действием по Якоби} называется длина этой кривой
в метрике Якоби:
$$
J[\gamma_0] = \int\limits_{\gamma_0} d\rho = \sqrt 2 \int\limits_{\gamma_0}
\sqrt{h - V} \, ds = 2 \int\limits_{\gamma_0} \sqrt{(h - V) T} \, dt.
$$
Последнее равенство следует из вот таких соотношений: $\| \dot q \| =
\sqrt{2T}$; $ds^2 = \langle A(q) \, dq, dq \rangle = 
\langle A(q) \dot q \, dt, \dot q \, dt \rangle = 
\langle A(q) \dot q , \dot q \rangle \, dt^2 = \| \dot q \|^2 \, dt^2$;
$ds = \| \dot q \| \, dt = \sqrt{2T} \, dt$.

\emph{Вариация по Якоби} кривой $\gamma_0$ --- это семейство кривых 
$\gamma_*(\alpha)$, $\alpha \in (-\ep, \ep)$, $\gamma_*(0) = \gamma_0$,
левый и правый концы $\gamma_*(\alpha)$ --- это $q_1$ и $q_2$ соответственно.
Вариация функционала:
$$
\delta J[\gamma_*] = \left. \frac{d J[\gamma_*(\alpha)]}{d \alpha} \right|_{\alpha=0}.
$$

Зададим кривую $\gamma_0$ и постоянную $h$, для которой $h > V(q)$ для всех
$q \in \gamma_0$. Тогда на $\gamma_0$ можно ввести такую параметризацию
$q(t)$, что энергия движения вдоль пути $q(t)$ из $q_1$ в $q_2$ будет в
точности равна $h$. Действительно, пусть $\tau$ --- некоторый параметр на
$\gamma_0$. Для искомого параметра $t$ должно выполняться соотношение
$$
\frac 12 \langle A(q) q', q' \rangle \dot\tau + V(q) = \frac 12
\langle A(q) \dot q, \dot q \rangle + V(q) = h
$$
(здесь $' = \frac{d}{d\tau}$, $\dot{} = \frac{d}{dt}$). Отсюда получаем
$$
\dot\tau = \sqrt{\frac{2 (h - V)}{\langle Aq', q' \rangle}};
\qquad
t = \int\limits_0^\tau \sqrt{\frac{\langle Aq', q' \rangle}{2 (h-V)}} \, 
d\tau
$$
--- получили требуемый параметр $t$ (знаменатель положителен в
силу выбора $h$, а числитель --- в силу положительной определённости
матрицы $A$).

Итак, каждой кривой $\gamma$ сопоставляется движение по ней $q(t)$ с
энергией $h$.

\begin{stm}[вариационный принцип Мопертюи -- Якоби]
$\gamma_0$ --- траектория ($q_0(t)$ --- движение по ней с
энергией $h$) тогда и только тогда, когда $\delta J[q_*] = 0$ для
любой вариации по Якоби $\gamma_*$ траектории $\gamma_0$.
\end{stm}

Здесь $q_*$ --- движение по $\gamma_*$ с энергией $h$.

\begin{proof}
Докажем эквивалентность экстремальности по Якоби и экстремальности по
Гамильтону. Положим $I_1[q_0] = I[q_0] + h(t_2 - t_1)$. Этот функционал
отличается от действия на константу, поэтому $\delta I_1 = \delta I$.
Поскольку $h(t_2 - t_1) = \int\limits_{t_1}^{t_2} h \, dt$,
$$
I_1[q_0] = \int\limits_{t_1}^{t_2} (T - V + h) \, dt = 
\int\limits_{t_1}^{t_2} \left( \sqrt{h - V} - \sqrt T \right)^2 \, dt
+ 2 \int\limits_{t_1}^{t_2} \sqrt{(h - V) T} \, dt.
$$
Второе слагаемое есть $J[\gamma_0]$, а первое есть тождественный ноль в силу того, что 
$h = T + V$ как полная энергия.
%Первое слагаемое обозначим через
%$I_2[q_0]$ и покажем, что $\delta I_2[q_*] = 0$ для любой вариации $q_*$:
%$$
%\left. \frac{dI_2}{d\alpha} \right|_{\alpha = 0} =
%\int\limits_{t_1}^{t_2} \left( \sqrt{h-V} - \sqrt T \right)
%\left. \frac{\partial \left( \sqrt{h-V} - \sqrt T \right)}{\partial \alpha}
%\right|_{\alpha = 0} \, dt = 0
%$$
%(последнее равенство следует из того, что $h = T+V$ (как полная энергия),
%а значит $\sqrt{h-V} - \sqrt{T} = 0$).
Отсюда получаем, что $\delta I[q_*] = 0$ тогда и только тогда, когда
$\delta J[q_*] = 0$, что и требовалось.
\end{proof}
%%%
% Lecture 4, 2008-03-05
%%%
\subsection{Устойчивость положения равновесия}
Рассмотрим натуральную механическую систему, т.е. систему с лагранжианом $L = L_2 + L_0 = T - V = \frac12 \sum_{i,j} a_{ij}(q) \dot q_i \dot q_j - V(q)$.
\begin{df}
$q_0$ называется положением равновесия, если $q(t) = q_0$ -- решение уравнения движения системы. Элемент фазового пространства $(q_0,t_0)$ называется состоянием равновесия, если $q_0$ -- положение равновесия.
\end{df}
\begin{lemma}
$q_0$ --- положение равновесия $\Leftrightarrow \jac{V(q_0)}{q} = 0$.
\end{lemma}
\begin{proof}
Запишем уравнение Лагранжа на траектории, соответствующей положению равновесия (на ней $\dot q \equiv 0$): 
$$
\jac{}{t}\left(\sum_j a_{ij} \dot q_j\right) - \sum_{j,k} \jac{a_{ij}}{q_i}  \dot q_k \dot q_j + \jac{V}{q_i} = 0.
$$
\end{proof}
Вспомним, что такое устойчивость положения равновесия по Ляпунову (в нашем случае).
\begin{df}
Положение равновесия системы ОДУ второго порядка $q_0$ называется устойчивым по Ляпунову, если $\forall \ep > 0\, \exists \delta > 0\colon \forall (q^\star, \dot q^\star)\colon \hn{q^\star - q_0} + \hn{\dot q^\star} < \delta$ для решения $\tilde q(t)$ с начальными условиями $\tilde q(t_0) = q^\star, \dot {\tilde q}(t_0) = \dot q^\star$ выполнено $\hn{\tilde q(t) - q_0} + \hn{\dot {\tilde q}(t)} < \ep$ для любого $t \geqslant t_0$.
\end{df}
\begin{theorem}[Лагранжа-Дирихле об устойчивом положении равновесия натуральных механических систем]
Пусть система натуральна и  $q_0$ -- точка строгого локального минимума потенциальной энергии $V(q)$. Тогда $q_0$ -- устойчивое (по Ляпунову) положение равновесия.
\end{theorem}
\begin{proof}
Из того, что $q_0$ -- локальный минимум $V$, следует, что $\jac{V(q_0)}{q} = 0$.
%Сделаем замену координат, положив для удобства $q = q - q_0, V =  V - V(q_0)$. Теперь 
Без ограничения общности считаем, что $q_0 = 0, V(q_0) = V(0) = 0$ (если это не так, сделаем
замену координат и сдвинем $V$). $\exists \beta > 0\colon 0 < \hn{q} < \beta \Rightarrow V(q) > 0$.

Заметим, что полная энергия системы $E = T + V$ также имеет в точке $(0,0)$ строгий локальный минимум: $E(0,0) = 0, E(q,\dot q) > 0$ при $0 < ||q||_{C^1} < \mu$ для некоторого $\mu > 0$. Пусть $\ep < \mu$, $c = \min_{||q|| + ||\dot q|| = \ep} E(q,\dot q) > 0$. Из непрерывности E имеем, что 
$$\exists \delta > 0\colon ||q|| + ||\dot q|| < \delta \Rightarrow E(q,\dot q) < c.$$
Теперь рассмотрим траекторию с начальными условиями в $\delta$-окрестности $(0,0)$. Тогда $E(t) \equiv E = E(q_0,\dot q_0) < c$, что означает, что $(q,\dot q)$ никогда не выйдет на уровень $||q|| + ||\dot q|| = \ep$, а, следовательно, не покинет $\ep$-окрестность $(0,0)$, что и требовалось.
\end{proof}
Рассмотрим систему с $L = L_2 + L_1 + L_0, \jac{L}{t} = 0$ -- н.м.с. с гироскопическими силами. Для таких систем теорему можно обобщить:
\begin{theorem} 
$q_0$ -- строгий локальный {\bf максимум} $L_0(q)$ $\Rightarrow$ $q_0$ -- устойчивое положение равновесия.
\end{theorem}
\begin{proof}
Доказывается аналогично, используя интеграл энергии: $\jac{L}{\dot q} \dot q - L = L_2 - L_0 = h = \const$.
\end{proof}
\subsubsection{Диссипативные силы и их влияние на устойчивость}
\begin{df}
Обобщённая сила $Q(q,\dot q)$ называется диссипативной, если $\forall (q,\dot q) \ha{Q,\dot q} \leqslant 0$ (мощность неположительна).
\end{df}
Рассмотрим систему с непотенциальными силами: $\frac{d}{dt}\bjac{L}{\dot q} - \jac{L}{q} = Q(q,\dot q)$.
\begin{lemma}
$\frac{d}{dt}\left(\jac{L}{\dot q} \dot q - L\right) = \ha{Q,\dot q}$.
\end{lemma}
\begin{proof}
$\frac{d}{dt}\left(\jac{L}{\dot q} \dot q - L\right) = \frac{d}{dt}\bjac{L}{\dot q} \dot q + \jac{L}{\dot q} \ddot q - \jac{L}{q}\dot q - \jac{L}{\dot q} \ddot q = \ha{\frac{d}{dt}\bjac{L}{\dot q} - \jac{L}{q},\dot q} = \ha{Q, \dot q}$ в силу уравнения Эйлера.
\end{proof}
Таким образом, при наличии в системе только диссипативных непотенциальных сил, обобщённая энергия системы (значение интеграла Якоби) не возрастает вдоль траектории движения. Для того, чтобы доказать для этих систем теорему Лагранжа--Дирихле, осталось только показать, что при добавлении диссипативных сил положение равновесия останется положением равновесия, для чего достаточна следующая
\begin{lemma}
$Q(q,0) = 0.$
\end{lemma}
\begin{proof}
Мы считаем, что $Q$ у нас непрерывна, поэтому $Q(q,\ep) = Q(q, 0) + o(1), \ep \to 0$. Пусть $Q(q,0) = a \ne 0$. Рассмотрим $\ep = \lambda a, \lambda \to 0+$. Запишем условие диссипативности:
$$
\ha{Q(q, \lambda a), \lambda a} = \ha{a + o(1), \lambda a} = \lambda (\hn{a}^2 + \ha{o(1), a}) \leqslant 0.
$$
При малых $\lambda$ последнее неравенство противоречиво.
\end{proof}
\begin{ex}(Силы Релея)
Пусть $\Phi(q,\dot q) = \frac12 \ha{R(q)\dot q, \dot q} > 0 (\dot q \ne 0)$, где положительно определённая $R$ называется матрицей Релея. Сила $Q(q,\dot q) = -\jac{\Phi}{\dot q} = - R(q) \dot q$  будет диссипативной: $\ha{Q,\dot q} = -2\Phi \leqslant 0$.

Примером такой силы является сопротивления вязкой среды при движении с небольшой скоростью, в таком случае $Q = O(\hn{\dot q})$.
\end{ex}
\subsubsection{Малые колебания}
Рассматриваем систему с лагранжианом $L = L_2 + L_1 + L_0 = \frac12 \sum_{i,j} a_{i,j}(q) \dot q_i \dot q_j + \ha{d(q),\dot q} - V(q), \jac{L}{t} = 0$.

Пусть $q_0$ -- положение равновесия. Линеаризуем уравнение движения в окрестности $q_0$, т.е. разложим его в ряд по $q$ и $\dot q$ и отбросим нелинейные члены. Для удобства заметим, что замена лагранжиана $L \mapsto L + \ha{\alpha, \dot q}, \alpha \in \R^n$ допустима (не меняет уравнений движения), поэтому заменим $q \mapsto q - q_0, V \mapsto V - V(q_0), d(q) \mapsto d(q) - d(q_0)$.

Теперь можно считать $q_0 = 0, V(0) = 0, d(0) = 0$. Разложим $L$ в ряд по $q$ и $\dot q$ до членов второй степени (потому что при подставлении в уравнение Лагранжа дифференцирование $L$ по $q$ и $\dot q$ одну степень <<убьёт>>). Получим 
$$
\tilde L =  \tilde L_2 + \tilde L_1 + \tilde L_0 = \frac12 \ha{A \dot q, \dot q} + \ha{C q, \dot q} - \frac12 \ha{B q,q},
$$
где $A = \left( a_{ij}(0) \right)$, $B = \left(\frac{\partial^2 V(0)}{\partial q_i \partial q_j}\right)$, $C = \bjac{d_j(0)}{q_i}$. Заметим, что $\jac{\tilde L_1}{\dot q} = C q, \jac{\tilde L_1}{q} = C^T \dot q$. Обозначим кососимметрическую матрицу $C - C^T$ через $\Omega$. Уравнение Лагранжа для <<линеаризованного>> лагранжиана $\tilde L$ будет иметь вид 
$$
A \ddot q + \Omega \dot q + B q = 0.
$$

Рассмотрим натуральную систему ($L_1 \equiv 0$): если $0$ является точкой строгого локального минимума $V(q)$ и $V$ не вырождена в нуле ($\hm{\frac{\partial^2 V}{\partial q_i \partial q_j}} \ne 0$), то это положение равновесия устойчиво (как мы знаем) и линеаризованное уравнение Лагранжа принимает вид $A \ddot q + B q = 0$. Это уравнение называется \emph{уравнением малых колебаний}. По малым колебаниям можно судить о характере движения системы в окрестности положения равновесия.

%%% 
% Lecture 5, 2008-03-12
%%%
\subsubsection{Нормальные координаты}
Совершим линейную замену координат $q = D\xi, \det D \ne 0$. Тогда $\tilde L = \frac12 \ha{A\dot q,\dot q} - \frac12 \ha{Bq,q} = \frac12 \ha{AD\dot \xi,D\dot \xi} - \frac12 \ha{BD\xi,\xi} = \frac12 \ha{D^T A D \dot \xi,\dot \xi} - \frac12\ha{D^T B D \xi, \xi}$, то есть $A$ и $B$ преобразуются, как симметричные билинейные нормы.

 Забудем пока, что $(0,0)$ -- \emph{устойчивое} положение равновесия (т.е., что $B$ положительно определена), будем считать лишь, что $\jac{V(0)}{q} = 0$. $A$ положительно определена, как матрица кинетической энергии, а про $B$ мы знаем, что она (как гессиан) симметрична. 
 
 $A$ задаёт некоторое скалярное произведение (структуру евклидового пространства), и по известной теореме линейной алгебры существует невырожденная замена координат $q = D\xi$, такая, что базис $\{\bar e_{\xi_i}\}$ ортонормирован относительно скалярного произведения, задаваемого $A$ и ортогонален относительно симметричной билинейной формы, задаваемой $B$, т.е. $D^T A D = E$, $D^T B D = E_\lambda \in \diag(\R)$. 
 
 После этой замены уравнение малых колебаний, а точнее, линеаризованное уравнение Лагранжа (потому что у нас не обязательно устойчивое положение равновесия и никаких колебаний может не быть) примет вид 
 $$
 \ddot \xi + E_\lambda \xi = 0, \, E_\lambda = \diag(\lambda_1,\ldots,\lambda_n), \,\lambda_i \in \R,
 $$
 или, что то же самое,
 $$
 \ddot \xi_i + \lambda_i \xi = 0, \quad i = 1,\ldots,n.
 $$
 \begin{df}
 Координаты, в которых уравнение малых колебаний принимает такой вид, называются \emph{нормальными}.
 \end{df}
 Если $B > 0$, то, как мы знаем, положение равновесия устойчиво и $\lambda_i > 0$ по теореме о сохранении сигнатуры симметричной билинейной формы.
 Обозначим $\lambda_i = \omega_i^2$, где $\omega_i > 0$ называются частотами малых колебаний. Общее решение системы уравнений $\ddot \xi_i + \omega_i^2 \xi = 0,\, i = 1,\ldots,n$ имеет вид $\xi_i(t) = с_{i_1} \cos \omega_i t + c_{i_2} \sin \omega_i t$, то есть траектории системы -- гармонические колебания по всем нормальным координатам.
 % TODO поиск нормальных координат det{...) = 0
 
 Нормальные координаты можно искать с помощью стандартной процедуры приведения пары форм к диагональному виду: найти все решения $\det(B - \omega^2 A) = 0$, нормальной координатой, соответствующей частоте $\omega_i$, будет собственный вектор $B - \omega_i^2 A$ с собственным значением $\omega_i$. (если собственных векторов с одним собственным значением подпространство, в нём нужно выбрать ортонормированный по $A$ базис)
 % needs cleanup, сейчас туплю. alex
% Как искать нормальные координаты? Для системы $A \ddot q + B q = 0$ базисные решения имеют вид $e^{\lambda t} \eta, \eta \in \R^n, \eta \ne 0$ (или вид $(a \cos \omega t + b \sin \omega t) \eta)$). Подставив такое решение в систему, получим $(A \lambda^2 + B) \eta = 0$, т.е. $\det(A \lambda^2 + B) = 0$. Отсюда немедленно следует, что $\lambda^2 < 0$ (сумма двух положительно определённых матриц положительно определена и не вырождена. Обозначим $\lambda^2$ через $-\omega^2$ и найдём все положительные корни $\det(B - \omega^2 A) = \det(\omega^2 A - B) = 0$.
% Для $\omega_i$ (пусть для простоты они все различны, если нет -- нужно выбрать в соответствующем собственном подпространстве ортонормированный относительно $A$ базис) обозначим через $\eta_i$ соответствующий собственный вектор. Легко проверить, что для $
 
 \subsubsection{Фазовый портрет малых колебаний}
 В случае малых колебаний фазовая траектория линеаризованной системы по каждой из координат вблизи положения равновесия представляет собой эллипс $\frac{\dot \xi_i^2}{2} + \frac{\lambda_i}{2} \xi_i^2 = c$ (это линия уровня интеграла энергии), а топологически -- тор $\mathbb{T}^1$. Так как все координаты $\xi_i$ изменяются независимо, то фазовая кривая всей системы -- это \emph{условно-периодическое} движение по тору $\mathbb{T}^n$, который есть прямое произведение $n$ одномерных торов, по каждому из которых мы движемся с одинаковой <<угловой скоростью>> ($\dot \phi_i = c_i$). Про обмотки тора есть много интересных фактов, например, фазовая кривая на нём будет замкнута тогда и только тогда, когда $c_i$ рационально зависимы, а если они рационально независимы, то она будет незамкнута и всюду плотна на $\mathbb{T}^n$. Но это всё -- в нормальных координатах. Про то, как себя система будет вести в исходных координатах, есть целая теория (КАМ-теория), но это очень сложно и у нас в курсе этого не будет.
 \subsubsection{Степень неустойчивости и гироскопическая стабилизация}
 Вернёмся к изучению устойчивости положения равновесия уравнения $A \ddot q + \Omega \dot q + B q = 0$. Это линейная система ОДУ, её базисные решения имеют вид $q = e^{\lambda t} \eta, \eta \in \R^n, \eta \ne 0$. Подставив такую функцию в уравнение, получим $(A \lambda^2 + \Omega \lambda + B) \eta = 0$, т.е. матрица $A \lambda^2 + \Omega \lambda + C$ должна быть вырождена и $\eta$ -- вектор из её ядра.
 \begin{df}
 $f(\lambda) = \det(A \lambda^2 + \Omega \lambda + B)$ называется характеристическим многочленом нашей системы, а корни $f(\lambda) = 0$ -- её характеристическими числами.
 \end{df}
 Мы будем рассматривать только случай, когда среди характеристических чисел нет $0$, т.к. теоремы об (не)устойчивости по линейному приближению работают только в этом случае. Про вырожденные положения равновесия есть отдельная сложная наука.
 \begin{lemma}
 $f(\lambda)$ чётен: $f(-\lambda) = f(\lambda)$.
 \end{lemma}
 \begin{proof}
 $f(-\lambda) = \det(A \lambda^2 - \Omega \lambda + B) = \det(A \lambda^2 - \Omega \lambda + B)^T = \det(A \lambda^2 + \Omega \lambda + B) = f(\lambda)$, т.к. $\Omega$ кососимметрична, а $A$ и $B$ симметричны.
 \end{proof}
 Таким образом, вместе с каждым корнем $\lambda$ у нас есть корень $-\lambda$, а если вспомнить, что $f(\lambda) \in \R[\lambda]$, то с каждым комплексным корнем $\lambda$ обязательно есть ещё и корень $\bar \lambda$. Мы получили следующее 
 \begin{stm}[Парность корней характеристического многочлена]
Чисто мнимые и действительные ненулевые корни у характеристического многочлена встречаются парами: $x \in \R$ -- корень $\Leftrightarrow$ $-x$ -- корень, $z \in i\R$ -- корень $\Leftrightarrow$ $-z$ -- корень. Остальные ненулевые корни встречаются четвёрками: $a+bi$ -- корень, $(a,b \ne 0)$ $\Rightarrow$ $\pm a \pm bi$ -- тоже корни.
\end{stm}
Важным следствием отсюда является 
\begin{imp}
Если у характеристического многочлена есть корень с ненулевой действительной частью, то у него есть и корень с положительной действительной частью.
\end{imp}
Решением, соответствующим $\lambda$ с $\Re \lambda > 0$ будет $\xi = e^{\Re \lambda t} \Omega(poly(t))$: оно убегает на бесконечность при $t \to \infty$. Интуитивно понятно, что в этом случае положение равновесия исходной системы должно быть неустойчивым. Подкрепляет интуицию следующая теорема, которую мы доказывать не будем.
\begin{theorem}[Ляпунова о неустойчивости по первому приближению]
Если среди корней характеристического многочлена линеаризованной системы есть $\lambda$ с $\Re \lambda > 0$, то положение равновесия исходной системы неустойчиво.
\end{theorem}
Из парности корней следует, что если есть корень вне $i\R$, то положение равновесия автоматически неустойчиво.
\begin{df}
Степенью неустойчивости положения равновесия называется число характеристических чисел с положительной действительной частью (с учётом кратности)
\end{df}
Пусть есть неустойчивая система. Поставим вопрос -- можно ли добавлением каких-то сил в систему сделать данное положение равновесия устойчивым?
\begin{df}
Силы, вносящие в лагранжиан вклад вида $\Omega \dot q$, называются гироскопическими.
\end{df}
На практике интересен вопрос именно о гироскопической стабилизации, поскольку силы, которыми обычно стабилизируют механическую систему, являются гироскопическими.
Итак, пусть $(0,0)$ -- неустойчивое положение равновесия. Существует ли такая кососимметрическая $\Omega$, что при добавлении в линеаризованный лагранжиан $\Omega \dot q$ это положение станет устойчивым? Оказывается, далеко не всегда.
\begin{theorem}[О гироскопической стабилизации]
Если степень неустойчивости положения равновесия $(0,0)$ системы $A \ddot q + \Omega \dot q + B = 0$ нечетна, то гироскопическая стабилизация невозможна.
\end{theorem}
\begin{proof}
Заметим, что $\#\{\lambda \mid f(\lambda) = 0, \lambda \in \R_+\}$ тоже нечетно, поскольку комплексные корни входят парами. Покажем, что в этом случае $\det B < 0$. Рассмотрим $\det(A \lambda^2 + \Omega \lambda + B)$. Если расписать этот определитель, то станет ясно, что это многочлен степени $2n$ со старшим членом, равным $|A| > 0$. По теореме Виета $f(0) = \det B = |A| \prod_{i=1}^{2n} \lambda_i$. Заметим, что произведение пар сопряжённых корней положительно, поэтому $\sgn \det B = \sgn \prod_{\lambda_{i_k} \in \R} \lambda_{i_k} = -1$, т.к. отрицательных корней столько же, сколько и положительных -- нечётное число. Теперь посмотрим на $f(\lambda)$ на бесконечности. $\det(A \lambda^2 + \Omega \lambda + B) = \lambda^{2n} \left( \det A + o(1) \right), \, \lambda \to +\infty$. Поэтому $\exists\,X > 0\colon f(X) > 0$. Определитель непрерывен, поэтому на интервале $(0,X)$ обязательно найдётся корень характеристического уравнения с положительной (какой же ещё) действительной частью. Осталось только применить теорему Ляпунова.
\end{proof}

\subsubsection{<<Три источника гироскопических сил>>}
В механике есть три основных источника, из которых берутся гироскопические силы:
\begin{enumerate}
\item Кориолисовы силы в неинерциальных системах отсчёта.
\item Силы, действующие на движущуюся заряженную частицу в магнитном поле
\item Нестационарные связи, понижение порядка по Раусу и прочая чертовщина.
\end{enumerate}

\subsection{Инвариантная мера}
Как мы далее увидим, было бы здорово, если бы в фазовом пространстве была бы задана мера с гладкой плотностью, инвариантная относительно фазового потока. У нас мера будет пониматься немного не в том смысле, что в курсе теории меры (хотя то, что мы будем рассматривать -- это частный случай обычной меры).

Итак, пусть $M^n$ -- гладкое $n$-мерное многообразие, и $\omega_n$ -- дифференциальная форма степени $n$, т.е. (гладкое) поле полилинейных кососимметричных функционалов на касательном расслоении $TM^n$. $\left(\omega_n(P)\right)\left(\xi_1, \ldots, \xi_n\right) = \rho(P) d\bar x(\xi_1,\ldots,\xi_n)$, где $P \in M^n$, $\xi_i \in T_P M^n$, $\rho$ -- гладкая функция на $M^n$, а $d\bar x$ -- стандартная евклидова форма объёма (определитель матрицы, составленной из векторов координат $\xi_i$). $\rho$ называется \emph{плотностью} меры. Сама мера определяется на некотором семействе множеств: 
$$
\omega_n(A) \rightleftharpoons \int\limits_A \omega_n = \int\limits_A \rho(\bar x) d\bar x.
$$

\begin{theorem}[Напоминание о изменении плотности при замене координат]
Пусть $A$ лежит в пересечении двух карт, и координаты в этих картах -- $x$ и $y$. Тогда для $P \in A$ $\rho_y(P) = \rho_x(P) \hm{\jac{x}{y}}$.
\end{theorem}
\begin{proof}
Обычная замена переменных в кратном интеграле.
\end{proof}

Пусть теперь на многообразии задано векторное поле $\mathbf{v}$. Рассмотрим в локальных координатах дифференциальное уравнение $\dot x = \mathbf{v}(x)$. Это уравнение порождает однопараметрическую группу преобразований $\{g^t \mid t \in \R_+ \}$, где $g^t$ -- сдвиг сдоль решения $\dot x = \mathbf{v}(x)$ за время $t$. Эта группа называется \emph{фазовым потоком}.

\begin{df}
Гладкая мера называется инвариантной мерой по отношению к фазовому потоку $g^t$, Если $\forall\, V \forall\, t\colon$
$$
\int\limits_V \rho d\bar x = \int\limits_{g^t V} \rho d \bar x.
$$
\end{df}

%
% 19.03.2008
%
\subsubsection{Теорема Лиувилля об инвариантной мере}
Сформулируем критерий инвариантности меры.

\begin{theorem}[Лиувилль]
Мера с гладкой плотностью $\rho$ инвариантна по отношению к фазовому потоку,
порождаемому полем $\mathbf{v}$ тогда и только тогда, когда 
$\diverg (\rho \mathbf{v}) = 0$.
\end{theorem}

Здесь $\diverg (\rho \mathbf{v}) = \sum\limits_{i=1}^{n}
\frac{\partial (\rho v_i)}{\partial x_i}$ --- дивергенция. Заметим,
что мы не требуем декартовости системы координат.

\begin{proof}
Из разложения Тейлора имеем (при $t \to 0$):
$$
g^t x = x + \mathbf{v} t + O(t^2);
\qquad
\frac{\partial g^t x}{\partial x} = E + \frac{\partial \mathbf{v}}{\partial x}
t + O(t^2).
$$

Обозначим $|A| = \det A$ для произвольной матрицы $A$. 
Легко проверить, что при $\ep \to 0$ имеет место соотношение
$$
|E + \ep A + O(\ep^2)| = 1 + \ep \tr A + O(\ep^2).
$$

Инвариантность меры равносильна соотношению (для любого $D$)
$$
\int\limits_D \rho(x) \, dx = \int\limits_{g^t D} \rho(x) \, dx.
$$
Совершим во втором интеграле замену $y = g^t x$. Получим
$$
\int\limits_{g^t D} \rho(x) \, dx = \int\limits_D \rho(g^t x)
\, d(g^t x) = \int\limits_D \rho(g^t x) \left| \frac{\partial g^t x}
{\partial x} \right| \, dx.
$$
Инвариантность меры равносильна тому, что интеграл $\int\limits_{g^t D}
\rho(x) \, dx$ не зависит от $t$, т.е.
$$
0 = \left. \frac{d}{dt} \left( \int\limits_{g^t D} \rho(x) \, dx \right)
\right|_{t=0} = 
\int\limits_D \left.\frac{d}{dt} \left( \rho(g^t x) \left|
\frac{\partial g^t x}{\partial x} \right| \right) \right|_{t=0} \, dx.
$$
В силу автономности системы достаточно требовать равенство нулю производной
при $t=0$. Истинность этого равенства для всех $D$ равносильно равенству
нулю подынтегрального выражения. Вспоминая, что 
$\left. \frac{d g^t x}{dt} \right|_{t=0} = \mathbf{v}$,
$\left. \left|
\frac{\partial g^t x}{\partial x} \right| \right|_{t=0} = |E| = 1$
и $\frac{\partial g^t x}{\partial x} = E + \frac{\partial \mathbf{v}}
{\partial x} t + O(t^2)$, получаем
\begin{multline*}
0 = \left. \frac{d}{dt} \left( \rho(g^t x) \left| \frac{\partial g^t x}
{\partial x} \right| \right) \right|_{t=0} =
\left. \left( \frac{d \rho(g^t x)}{dt} \cdot \left| \frac{\partial g^t x}
{\partial x} \right| + \rho(g^t x) \cdot \frac{d}{dt} \left| 
\frac{\partial g^t x} {\partial x} \right| \right) \right|_{t=0} =\\=
\frac{\partial \rho}{\partial x} \left. \frac{d g^t x}{dt} \right|_{t=0} +
\rho(x) \left. \frac{d}{dt} \left( \left| E + \frac{\partial \mathbf{v}}
{\partial x} t + O(t^2) \right| \right) \right|_{t=0} = 
\left\langle \frac{\partial \rho}{\partial x}, \mathbf{v} \right\rangle +
\rho(x) \frac{d}{dt} \left( 1 + \tr \frac{\partial \mathbf{v}}
{\partial x} t + O(t^2) \right) =\\=
\left\langle \frac{\partial \rho}{\partial x}, \mathbf{v} \right\rangle +
\rho(x) \tr \frac{\partial \mathbf{v}}{\partial x}.
\end{multline*}
Остаётся заметить, что справа как раз стоит $\diverg (\rho \mathbf{v})=
\left\langle \frac{\partial \rho}{\partial x}, \mathbf{v} \right\rangle +
\rho \diverg \mathbf{v}$ ($\diverg \mathbf{v} = \sum\limits_i
\frac{\partial v_i}{\partial x_i} = \tr \frac{\partial \mathbf{v}}
{\partial x}$).
\end{proof}

\subsubsection{Построение инвариантной меры на многообразиях уровня первых интегралов}

Пусть  $F(x)$ -- первый интеграл системы $\dot x = \mathbf{v}(x)$, т.е. для любого решения системы $x(t)$ выполняется $\jac{}{t}F(x(t)) = \ha{\jac{F}{x},\mathbf{v}} = 0$. Рассмотрим множество уровня $F$ $M_c = \{ x \mid F(x) = c \}$. Если на $M_c$ $\grad F \ne 0$, то по теореме о неявной функции $M_c$ есть $(n-1)$-мерное подмногообразие $M^n$, причём $\mathbf{v}$ его всюду касается. Если на $M^n$ определена инвариантная для $\mathbf{v}$ мера с гладкой плотностью, то оказывается, что на $M_c$ можно определить $(n-1)$ форму, которая будет задавать инвариантную меру для ограничения нашего векторного поля на $M_c$ 
\begin{stm}
Пусть для системы  $\dot x = \mathbf{v}(x)$ есть инвариантная мера, $F(x)$ -- первый интеграл системы и $dF \ne 0$ на $M_c$. Тогда на $M_c$ (локально) есть инвариантная мера для ограничения исходной системы на $M_c$.
\end{stm}
\begin{proof}
Пусть $P \in M_c$. Выберем в окрестности $P$ локальные координаты $x_1,\ldots,x_n = F(x)$. Так можно сделать по теореме о неявной функции ($\jac{f}{x_i}(P) \ne 0 \Rightarrow $ в окрестности $P$ отображение $(x_1, \ldots, x_n) \mapsto  \\(x_1,\ldots,x_{i-1}, F(x), x_{i+1}, \ldots, x_n)$ есть диффеоморфизм)

В этих координатах исходная система примет вид
$$
\left\{
\begin{aligned}
& \dot x_1 = v_1 \\
& \dots\\
& \dot x_{n-1} = v_{n-1} \\
& \dot x_n = 0
\end{aligned}
\right.
$$
$\diverg \rho \mathbf{v} = \sum\limits_1^{n-1} \jac{\rho_i}{x_i} = 0$. Пусть инвариантная мера задаётся $n$-формой $\omega_n = \rho(x) dx^1 \wedge \ldots \wedge dx^n = \rho(x) dx^1 \wedge \ldots \wedge dF = (\rho dx^1 \wedge \ldots \wedge dx^{n-1}) \wedge dF = \omega_{n-1} \wedge dF$. Ограничение $\omega_n$ на $M_c$ есть $\omega_{n-1}$. Локальные координаты на $M_c$ есть $x_1,\ldots,x_{n-1}$, и уже на $M_c$ для $\rho$ и $\mathbf{v}$ выполнены условия теоремы Лиувилля, поэтому $\omega_{n-1}$ задаёт инвариантную меру на $M_c$.
\end{proof}

Эта теорема локальна, и определяет $\omega_{n-1}$ в каждой точке $M_c$. Покажем, что на самом деле все эти формы согласованы. Пусть $\omega_{n-1}, \tilde \omega_{n-1}$ -- инвариантные меры на двух пересекающихся координатных окрестностях $M_c$. По построению в окрестности (в $M^n$) пересечения этих окрестностей $\omega = \omega_{n-1} \wedge dF = \tilde \omega_{n-1} \wedge dF$. 
\begin{lemma}
Пусть $\gamma$ -- $k$-форма, $\nu$ -- ненулевая $1$-форма. Если $\gamma \wedge \nu = 0$, то $\gamma = \delta \wedge \nu$ для некоторой $(k-1)$-формы $\delta$.
\end{lemma}
\begin{proof}
Дополним $\nu$ до базиса в пространстве ковекторов и запишем в этом базисе $\gamma$. Если в $\gamma$ есть слагаемые без $\nu$, то $0$ мы не получим.
\end{proof}

Таким образом, на $M_c$ $\omega_{n-1} - \tilde \omega_{n-1} = \gamma_{n-2} \wedge dF$. Осталось заметить, что на $M_c$ $dF = 0$. (Но не в $M^n$, поэтому и можно применить лемму). Поэтому $\omega_{n-1}$ корректно задана на всём $M_c$. 

\subsubsection{Интегрируемость в квадратурах}
Пусть дана система дифференциальных уравнение $\dot x =
\mathbf{v}(x)$ ($x \in \RR^n$) и набор функций $\phi_1(x,t),
\dots, \phi_k(x,t)$. Тогда говорят, что (локально) система
\emph{интегрируется в квадратурах}, если её общее решение можно
найти при помощи конечного набора операций из $\phi_1, \dots,
\phi_k$. Допустимые операции суть арифметические действия,
взятие частных производных по координатам и времени, взятие
определённого интеграла и применение теоремы о неявной
функции (обращение).

\begin{stm}
Если $\phi_1 = F_1, \dots, \phi_{n-1} = F_{n-1}$ --- функционально
независимые ($\rk \frac{\partial F}{\partial x}$ максимален) первые
интегралы системы, то система интегрируема в квадратурах.
\end{stm}

\begin{proof}
Действительно, применим к системе уравнений
$$
\left\{
\begin{aligned}
& F_1(x) = c_1 \\
& \dots\\
& F_{n-1}(x) = c_{n-1}
\end{aligned}
\right.
$$
теорему о неявной функции: все $x_i$ выражаются через $c_1, \dots, c_{n-1}$
и одну из координат (считаем, что $x_n$):
$$
\left\{
\begin{aligned}
& x_1 =  x_1(x_n, c_1, \dots, c_{n-1})\\
& \dots\\
& x_{n-1} = x_{n-1}(x_n, c_1, \dots, c_{n-1}).
\end{aligned}
\right.
$$

Мы перешли к новым координатам: $y_1 = c_1$, $\dots$, $y_{n-1} = c_{n-1}$,
$y_n = x_n$. В них система уравнений выглядит гораздо лучше:
$$
\left\{
\begin{aligned}
&\dot y_1 = 0 \\
&\dots\\
&\dot y_{n-1} = 0\\
&\dot y_n = v_n(x_1(y), \dots, x_{n-1}(y), y_n) = 
\tilde v(c_1, \dots, c_{n-1}, y_n).
\end{aligned}
\right.
$$

В последнем уравнении переменные разделяются:
$$
\int\limits_{y_{n0}}^{y_{n1}} \frac{d y_n}{\tilde v} =
\int\limits_{t_0}^{t_1} dt.
$$
Обращением (ещё раз теорема о неявной функции) получаем
$x_n = y_n = y_n(t, c_1, \dots, c_{n-1}, C)$ ($C$ --- константа
интегрирования). $x_1$, $\dots$, $x_{n-1}$ получаются как функции
(известные) от $x_n$, $c_1$, $\dots$, $c_{n-1}$.
\end{proof}

\subsubsection{Теорема Якоби о последнем множителе}
Оказывается, если есть инвариантная мера, то для интегрируемости в квадратурах достаточно иметь не $n-1$, а $n-2$ независимых первых интеграла.
\begin{theorem}[Якоби о последнем множителе]
Пусть у $\dot x = \mathbf{v}(x)$ есть $n-2$ независимых первых интеграла $F_1(x),\ldots,F_{n-2}(x)$ и инвариантная мера с гладкой плотностью $\rho(x)$. Тогда система интегрируется в квадратурах.
\end{theorem}
\begin{proof}
Как и раньше, по теореме о неявной функции выберем за первые $n-2$ координаты наши первые интегралы, а оставшиеся выберем произвольным образом. Система примет вид 
$$
\left\{
\begin{aligned}
& \dot y_i = 0, \quad i = 1,\ldots,n-2 \\
& \dot y_{n-1} = v_{n-1}(y_{n-1}, y_n, \overline c), \quad \overline c = (y_1,\ldots,y_{n-2}) \\
& \dot y_n = v_n(y_{n-1}, y_n, \overline c)
\end{aligned}
\right.
$$
Зафиксируем $\overline c$ и рассмотрим ограничение системы на соответствующее многообразие уровня. Оно двумерно, обозначим для простоты записи $u = y_{n-1}, w = y_n$. Система примет вид
$$
\left\{
\begin{aligned}
& \dot u = v_u(u,w) \\
& \dot w = v_w(u,w)
\end{aligned}
\right.
$$
По доказанному ранее у этой системы есть некоторая инвариантная мера с плотностью $\rho(u,w)$. Для доказательства интегрируемости в квадратурах достаточно предъявить ещё один первый интеграл, независимый с $F_i$.

Положим $\omega_1 \rightleftharpoons -\rho v_w du + \rho v_u dw$. $d\omega_1 = \left(\jac{\rho v_w}{w} + \jac{\rho v_u}{u}\right) du \wedge dw = \diverg \rho \mathbf{v}_{(u,w)} = 0$ по теореме Лиувилля. Из замкнутости $\omega_1$ следует, что она локально точна и существует $\phi\colon d\phi = \omega_1$, т.е. $\jac{\phi}{u} = -\rho v_w, \jac{\phi}{w} = \rho v_u$. Покажем, что $\phi(u,w)$ -- первый интеграл. 
$$
\jac{}{t}\left(\phi( u(t), v(t) )\right) = -\rho v_w \dot u + \rho v_u \dot w,
$$ что в силу уравнения равно $-\rho v_w v_u + \rho v_w v_u = 0$, что и требовалось доказать.
\end{proof}

\subsubsection{Теорема Пуанкаре о возвращении}
Пусть, как и раньше, задано дифференциальное уравнение $\dot x = \mathbf{v}(x)$.
Зафиксируем $\Delta t$ и положим $T = g^{\Delta t}$. Ясно, что 
$T^k = g^{k\Delta t}$. Мы перешли к дискретному случаю (сдвиги вдоль
решения на величины, кратные $\Delta t$).

Теперь рассмотрим более общую ситуацию. $M$ --- пространство с мерой
$\mu$. $T \colon M \to M$ --- взаимно-однозначное $\mu$-измеримое 
преобразование. Мера $\mu$ называется \emph{инвариантной}
(относительно $T$), если
$\mu(D) = \mu(TD)$ для любого $\mu$-измеримого $D$.
(По сути здесь мы определили \emph{динамическую систему}. Подробнее
об этом см. книгу П.\,Халмоша <<Эргодическая теория>>.)

\begin{theorem}[Пуанкаре]
Если $\mu(M) < \infty$ и $\mu$ инвариантна относительно $T$, 
то для любого измеримого $D$ если $\mu(D) > 0$, то существуют
такие $x \in D$ и $N > 0$, что $T^N x \in D$ ($x$ возвращается
в $D$).
\end{theorem}

\begin{proof}
Рассмотрим семейство множеств $D, TD, T^2D, \dots, T^nD, \dots$.
Если они попарно не пересекаются, то
(в силу инвариантности) 
$$\mu(D \cup TD \cup \dots \cup T^nD) = 
\sum_{k=0}^n \mu(T^kD) = n \mu(D).
$$
Но тогда $\mu(M) \geqslant n \mu(D) \to \infty$ ($n \to \infty$), что
противоречит конечности меры $M$.

Значит, существуют такие $k$ и $l$, что $k>l$ и $T^kD \cap T^lD \ne 
\varnothing$. Но тогда $T^{k-l}D \cap D \ne \varnothing$, т.\,е.
существует $y \in D$ такой, что $y \in T^{k-l}D$. Положим
$x = T^{-(k-l)} y$, $N = k-l$. Имеем: $T^N x = y \in D$ и 
$x \in D$ (поскольку $y \in T^N D$), что и требовалось.
\end{proof}

Заметим, что на самом деле верно более сильное утверждение:	
если $\mu(D) > 0$, то $\mu$-почти все $x \in D$ возвращаются в $D$.
Действительно, обозначим множество тех $x$, которые не возвращаются,
через $D'$. Если $\mu(D') > 0$, то к нему применима теорема Пуанкаре,
т.е. существует $x \in D'$, для которого $T^N x \in D'$. Но тогда
$T^N x \in D$, что противоречит нашему предположению. Значит,
$\mu(D') = 0$, что и требовалось\footnote{По-хорошему ещё надо доказать
измеримость $D'$. Это делается, например, так:
$D' = \bigcap_{N > 0} \{ x \in D : T^N x \notin D \} =
\bigcap_{N > 0} D \setminus T^{-N} D$ измеримо как счётное пересечение
измеримых множеств.}.

Следующий факт мы докажем позже средствами гамильтоновой механики.

\begin{stm}
Если $L(q,\dot q)$ -- лагранжиан системы, то форма $\hm{\jac{^2 L(q,\dot q)}{\dot q^2}} dq_1 \wedge \ldots \wedge dq_n \wedge d\dot q_1 \wedge \ldots \wedge d\dot q_n$ задаёт инвариантную для уравнения Лагранжа меру.
\end{stm}

Можно было бы попытаться применить здесь теорему о возвращении, но, увы, эта мера на всём конфигурационном пространстве редко бывает конечной. Однако для натуральных систем мера множества $M_h = \hc{ \jac{L}{\dot q}\dot q - L = h}$ конечна (почему?). следовательно, имеет место свойство возвращения.

\subsection{Динамика тяжёлого твёрдого тела с неподвижной точкой}
Дано твёрдое тело, на которая наложена единственная связь:
точка $O$ (\emph{точка подвеса}) неподвижна. Ясно, что эта система
имеет 3 степени свободы (например, углы Эйлера). Связь считаем
идеальной (трения в точке подвеса нет). Мы будем рассматривать
\emph{тяжёлое} твёрдое тело с неподвижной точкой: тело находится
в однородном поле тяжести. 

Выведем уравнения движения нашей системы. Переместим начало координат
в точку $O$.
Поскольку связи допускают поворот системы вокруг любой оси, для кинетического
момента $K = \sum [ \rb_i, m_i \dot\rb_i ]$ выполнено соотношение (закон
изменения кинетического момента):
$$
\frac{dK}{dt} = \sum \mom_O F_i^{\text{внеш.}} =: M_O.
$$
Здесь $F_i^{\text{внеш.}}$ --- это сила тяжести, она равна\footnote
{Будем использовать обозначение $\gb$ для вектора ускорения свободного
падения и $g$ для $|\gb|$.}
 $m_i \gb$.

Пусть $C$ --- центр масс нашего тела: $\rb_C = \frac{\sum m_i \rb_i}{m}$,
где $m = \sum m_i$ --- масса тела. Имеем:
$$
M_O = \sum [ \rb_i, m_i \gb ] = \left[ \sum m_i \rb_i, \gb \right] =
[m\rb_C, \gb] = [\rb_C, m\gb].
$$
($m\gb$ --- вес тела). Отсюда
$$
\frac{dK}{dt} = [\rb_C, m\gb].
$$

Пусть $\xi$, $\eta$, $\zeta$ --- главные оси инерции (в них тензор
инерции $J$ имеет диагональный вид: $J = \diag(A,B,C)$). Главные
оси движутся вместе в телом. Их орты мы обозначим через $e_1$,
$e_2$, $e_3$. $\rb_C = \ell_1 e_1 + \ell_2 e_2 + \ell_3 e_3$,
$\ell_i = \const$ (главные оси неподвижны относительно твёрдого тела).

Положим $\omega = pe_1 + qe_2 + re_3$. Тогда $K = J\omega = Ape_1 +
Bqe_2 + Cqe_3$. Далее (по теореме сложения скоростей для вектора $K$),
$$
\frac{dK}{dt} = \vr_{\text{абс}} = \vr_{\text{отн}}(K) + 
\vr_{\text{пер}}(K) = \frac{\tilde d K}{dt} + [ \omega, K ].
$$
Здесь $\frac{\tilde d K}{dt} := \vr_{\text{отн}}(K) = (A\dot p,
B \dot q, C \dot r)$ в системе координат $\xi$, $\eta$, $\zeta$,
а $\vr_{\text{пер}}(K) = [\omega,K]$ по формуле Эйлера.
Полученное соотношение
$$
\frac{dK}{dt} = \frac{\tilde d K}{dt} + [\omega, K]
$$
называется \emph{формулой относительного дифференцирования}.

Подставляя это выражение для $\frac{dK}{dt}$ в уравнение движения,
получаем новое уравнение:
$$
\frac{\tilde d K}{dt} + [ \omega, K ] = [ \rb_C, m\gb ].
$$

В проекциях на подвижные оси:
$$
\left\{
\begin{aligned}
& A \dot p + (C-B) qr = M_\xi = -mg(\ell_2 \gamma_3 - \ell_3 \gamma_2)\\
& B \dot q + (A-C) rp = M_\eta = -mg(\ell_3 \gamma_1 - \ell_1 \gamma_3)\\
& C \dot r + (B-A) pq = M_\zeta = -mg(\ell_1 \gamma_2 - \ell_2 \gamma_1)
\end{aligned}
\right.
$$
Здесь $\gamma$ --- единичная вертикаль ($\gb = -g\gamma$,
$M_O = -mg[\rb_C, \gamma]$). В неподвижной
системе координат $\gamma = (0,0,1)$, $\gb = (0,0,-g)$, в подвижной
$\gamma = (\gamma_1, \gamma_2, \gamma_3)$.

Эта система уравнений (с произвольными $M_\xi$, $M_\eta$, $M_\zeta$ ---
не обязательно для сил тяжести) называется \emph{динамическими
уравнениями Эйлера}. Эта система из 3 уравнений на 6 неизвестных ---
она не замкнута.

Чтобы замкнуть систему уравнений Эйлера, заметим, что $\gamma$ в
абсолютной системе координат постоянен, откуда
$$
0 = \frac{d\gamma}{dt} = \frac{\tilde d \gamma}{dt} + [\omega,\gamma].
$$
В подвижных координатах получаем \emph{уравнения Пуассона}:
$$
\left\{
\begin{aligned}
& \dot\gamma_1 + q \gamma_3 - r \gamma_2 = 0\\
& \dot\gamma_2 + r \gamma_1 - p \gamma_3 = 0\\
& \dot\gamma_3 + p \gamma_2 - q \gamma_1 = 0.
\end{aligned}
\right.
$$

Вместе уравнения Эйлера и Пуассона дают замкнутую систему ОДУ из 6 уравнений
относительно 6 неизвестных --- \emph{уравнения Эйлера -- Пуассона}.

\subsubsection{Первые интегралы уравнений Эйлера -- Пуассона}
{\bf I.} Связи не зависят от времени, силы потенциальны --- значит, есть 
интеграл энергии $T+V = h = \const$. $T = \frac 12 \langle J\omega,
\omega \rangle = \frac 12 (Ap^2 + Bq^2 + Cr^2)$. $V = \sum m_i g z_i =
mgz_C$. Вычислим $z_C$ в подвижной системе координат:
$z_C = \langle \gamma, \rb_C \rangle = \ell_1 \gamma_1 + \ell_2 \gamma_2 +
\ell_3 \gamma_3$. \emph{Интеграл энергии}:
$$
\frac 12 ( Ap^2 + Bq^2 + Cr^2 ) + mg(\ell_1 \gamma_1 + \ell_2 \gamma_2 +
\ell_3 \gamma_3 ) = h.
$$

{\bf II.} Момент сил тяжести относительно $\gamma$ равен нулю. Значит,
есть \emph{интеграл кинетического момента} относительно $z$:
$\frac{dK_z}{dt} = M_z = 0$, $K_z = \sigma = \const$.
$\sigma = K_z = \langle K, \gamma \rangle = Ap\gamma_1 + Bq\gamma_2 +
Cr\gamma_3$.

{\bf III.} $\gamma_1^2 + \gamma_2^2 + \gamma_3^2 = |\gamma|^2 = 1 = \const$.
Это --- \emph{тривиальный интеграл}.

\subsubsection{Инвариантная мера уравнений Эйлера -- Пуассона}
\begin{stm}
Мера, задаваемая в координатах $p$,$q$,$r$,$\gamma_1$,$\gamma_2$,$\gamma_3$
функцией плотности, тождественно равной единице, является инвариантной
мерой для системы уравнений Эйлера -- Пуассона.
\end{stm}

\begin{proof}
Достаточно проверить, что в этих координатах $\diverg \rho 
\mathbf{v} = \diverg \mathbf{v} = 0$, а это ясно из вида уравнений.
\end{proof}

Заметим, что здесь положение тела выражено не через углы Эйлера, а
через координаты $p$, $q$ и $r$. Преобразование задаётся кинематическими
формулами Эйлера (см. прошлый семестр):
$$
\begin{pmatrix} p\\q\\r \end{pmatrix} = 
D(\phi, \theta, \psi) 
\begin{pmatrix} \dot\phi \\ \dot\psi \\ \dot\theta \end{pmatrix},
$$
причём $\det D = \sin^2 \theta \ne 0$, когда $\theta \notin \{0, \pi\}$
(т.е. углы Эйлера не вырождаются). Поэтому, если мы знаем $p$, $q$ и $r$,
то получаем систему ОДУ
$$
\begin{pmatrix} \dot\phi \\ \dot\psi \\ \dot\theta \end{pmatrix}
= D^{-1} \begin{pmatrix} \dot\phi \\ \dot\psi \\ \dot\theta \end{pmatrix},
$$
которая интегрируема в квадратурах (это мы доказывать не будем).

По теореме Якоби о последнем множителе если известны 4 первых интеграла и
инвариантная мера, система интегрируется в квадратурах. У нас есть 3 первых
интеграла. Четвёртый удаётся найти только в некоторых частных случаях.

\subsubsection{Понятие о трёх классических случаях интегрируемости уравнения Эйлера -- Пуассона}
Укажем три случая, в которых удаётся найти недостающий первый интеграл.
Первый и второй случай потом будут рассмотрены подробнее.

{\bf 1. Волчок Эйлера.} $\ell_1 = \ell_2 = \ell_3 = 0$ (центр масс находится
в точке подвеса) или $g = 0$. В этом случае правые части уравнений (моменты
сил тяжести) равны нулю.

{\bf 2. Волчок Лагранжа.} $A=B$ (\emph{динамически симметричное} твёрдое тело),
$\ell_1 = \ell_2 = 0$ (центр тяжести лежит на \emph{оси динамической симметрии}
$O\zeta$).

{\bf 3. Волчок Ковалевской.} $A=B=2C$, $\ell_3 = 0$.

В.\,В.\,Козлов доказал, что при малых отклонениях от этих случаев
 дополнительного аналитического интеграла не существует.

\subsubsection{Волчок Эйлера}
В этом случае уравнения Эйлера имеют вид (система уравнений
Пуассона отделяется и нас не интересует):
$$
\left\{
\begin{aligned}
& A \dot p + (C-B) qr = 0\\
& B \dot q + (A-C) rp = 0\\
& C \dot r + (B-A) pq = 0.
\end{aligned}
\right.
$$

Моменты сил равны нулю, значит, $\dot K = 0$, то есть $K = \const$.
Отсюда $k^2 = A^2 p^2 + B^2 q^2 + C^2 r^2 = K^2 = \const$ --- получили
добавочный первый интеграл. Теперь систему можно проинтегрировать.
Действительно, из соотношений
$$
\left\{
\begin{aligned}
& Ap^2 + Bq^2 + Cr^2 = 2h\\
& A^2p^2 + B^2q^2 + C^2 r^2 = k^2
\end{aligned}
\right.
$$
можно выразить $q$ и $r$ через $p$, после чего получается одно 
уравнение вида $A\dot p = f(p)$, которое решается методом
разделения переменных.

{\bf Фазовый портрет уравнений Эйлера.} Фазовое пространство у нас
трёхмерно ($p$, $q$, $r$). Зафиксируем $h$ (выделим в пространстве
эллипсоид), $k$ меняем. Перейдём к координатам $k_1 = Ap$, $k_2 = Bq$,
$k_3 = Cr$. В этих координатах наши первые интегралы имеют вид:
$$
\left\{
\begin{aligned}
& \frac{k_1^2}{A} + \frac{k_2^2}{B} + \frac{k_3^2}{C} = 2h\\
& k_1^2 + k_2^2 + k_3^2 = k^2,
\end{aligned}
\right.
$$
то есть фазовой кривой будет пересечение сферы с эллипсоидом.

Считаем $A>B>C$ (рассматриваем только невырожденный случай со
строгими неравенствами) и $h>0$. Обозначая $a^2 = 2Ah$, $b^2 = 2Bh$,
$c^2 = 2Ch$, перепишем первое уравнение в виде
$$
\frac{k_1^2}{a^2} + \frac{k_2^2}{b^2} + \frac{k_3^2}{c^2} = 1.
$$
Это эллипсоид с полуосями $a>b>c$. 

Второе уравнение задаёт пересекающую этот эллипсоид сферу радиуса $k$.
Рассмотрим несколько случаев:

1. $k^2<c^2$. Пересечение пусто (движения не существует).

2. $k^2 = c^2$. Касание в двух диаметрально противоположных точках.
Этот случай соответствует \emph{стационарным вращениям} --- очевидным
решениям уравнений Эйлера $r(t) = r_0 = \const$, $p(t) = q(t) = 0$
(в этом случае $\omega = (0,0,r_0)$ --- вращение вокруг третьей
главной оси); в случае $k^2 = a^2$ получится вращение
вокруг первой оси.

3. $c^2 < k^2 < b^2$ или $b^2 < k^2 < a^2$. Топологически --- две окружности.

4. Остался последний и самый интересный случай: $b^2 = k^2$. Тогда
$$
\left\{
\begin{aligned}
& \frac{k_1^2}{a^2} + \frac{k_2^2}{b^2} + \frac{k_3^2}{c^2} = 1\\
& k_1^2 + k_2^2 + k_3^2 = b^2 ( = k^2).
\end{aligned}
\right.
$$

Обозначим $\alpha^2 = \frac{1}{b^2} - \frac{1}{a^2}$ и
$-\beta^2 = \frac{1}{b^2} - \frac{1}{c^2}$ (это корректно, т.к. $a>b>c$).
Получаем 
$$
\alpha^2 k_1^2 - \beta^2 k_3^2 = 0,
$$
то есть
$$
\left[
\begin{aligned}
&\alpha k_1 - \beta k_3 = 0\\
&\alpha k_1 + \beta k_3 = 0
\end{aligned}
\right.
$$
--- две плоскости в пространстве $k_1$, $k_2$, $k_3$. В сечении
сферы получаются две окружности --- \emph{сепаратрисы}.

Стационарное вращение вокруг средней оси неустойчиво, вокруг наибольшей
и наименьшей --- устойчиво (имеется в виду устойчивость в пространстве
угловых скоростей).

\subsubsection{Геометрическая интерпретация Пуансо движения волчка Эйлера}
Вспомним, что в любое твёрдое тело <<вморожен>> \emph{эллипсоид инерции}, задающийся в главных осях инерции $\xi$, $\eta$, $\zeta$ уравнением $A\xi^2 + B\eta^2 + C\zeta^2 = 1$. Если мы сможем описать движение этого эллипсоида, то, очевидно, мы опишем и движение нашего твёрдого тела.
\begin{theorem}[Пуансо]
Эллипсоид инерции волчка Эйлера катится без проскальзывания по неподвижной (в абсолютных координатах) плоскости, ортогональной $\Kin$.
\end{theorem}
\begin{proof}
Зафиксируем неподвижную СК, у которой начало в центре масс волчка, $\eb_z$ направлен противоположно $K$, $\eb_{x,y}$ -- произвольные дополнение $\eb_z$ до ортонормированного базиса. Обозначим через $\pi$ горизонтальную плоскость, на которой в данный момент времени <<стоит>> эллипсоид, касаясь её в точке $P$. Для доказательства теоремы нужно, чтобы $\pi$ была неподвижной и чтобы $\vA(P) = 0$ (качение без проскальзывания).

Начнём с неподвижности $\pi$. Запишем координаты $P$ в главных осях инерции: $P = (\xi_P, \eta_P, \zeta_P)$, причём $A \xi_P^2 + B\eta_P^2 + C \zeta_P^2 = 1$. Т.к. эллипсоид касается $\pi$, то нормаль к эллипсоиду в $P$ параллельна $\eb_z$, т.е. $\overline K$. Вспоминая, что нормаль к поверхности, заданной уравнением $f(x,y,z) = 0$ параллельна $\nabla f$, получим
$$
2(A\xi_P,B\eta_P,C\zeta_P) = \alpha \Kin = \alpha J\omega = \alpha (Ap,Bq,Cr),
$$
то есть $\Vect{OP} = \lambda \omega$. Заметим, что $\lambda \geqslant 0$, т.к. $\ha{\Kin, \omega} = \ha{J\omega,\omega} = 2T \geqslant 0$, поэтому $\omega$ смотрит <<вниз>> (угол между $\omega$ и $\Kin$ не больше $\pi/2$), но $\Vect{OP}$ тоже смотрит <<вниз>>.

Теперь докажем, что $\lambda = \const$. Действительно, имеем $(\xi_P,\eta_P,\zeta_P) = \lambda(p,q,r), (A\xi_P, B\eta_P,C\zeta_P) = \lambda(Ap,Bq,Cr)$, поэтому $\lambda^2 \cdot 2h = \lambda^2 (Ap^2 + Bq^2 + Cr^2) = A \xi_P^2 + B\eta_P^2 + C \zeta_P^2 = 1$, откуда $\lambda = \frac{1}{\sqrt{h}}$. Далее, 
$$
d(O,\pi) = \ha{\Vect{OP}, \frac{\Kin}{|\Kin|}} = \frac{\lambda \ha{\omega,\Kin}}{|\Kin|} = \frac{\lambda}{|\Kin|}\ha{\omega,J\omega} = \frac{\lambda \cdot 2h}{|\Kin|} = \const.
$$
Найдём скорость точки касания в абсолютной СК. По формуле Эйлера
$$
v_P = v_O + \hs{\omega,\Vect{OP}} = 0 + 0,
$$
т.к. $\Vect{OP}$ параллелен $\omega$.
\end{proof}

\subsubsection{Регулярная прецессия волчка Эйлера}
Рассмотрим волчок Эйлера с $A=B$. Справедливо тривиальное 
\begin{stm}
У такого волчка вектора $\eb_\zeta, \Kin, \omega$ лежат в одной плоскости.
\end{stm}
\begin{proof}
Запишем определитель, натянутый на наши вектора в главных осях инерции.
$$
\mbmat{0 & 0 & 1 \\ Ap & Aq & Cr \\ p & q & r} = 0.
$$
\end{proof}
Поэтому $\omega = \alpha \eb_\zeta + \beta \eb_z$ (т.к. $\Kin \parallel \eb_z$). 

Теперь рассмотрим три системы координат:
\begin{enumerate}
\item Систему, в которой неподвижны $\eb_z$ и $\eb_\zeta$,
\item Систему главных осей инерции (в которой неподвижны оси $\eb_\xi, \eb_\eta,\eb_\zeta$),
\item Неподвижную систему $Oxyz$.
\end{enumerate}
\begin{stm}
Система $1$ вращается в системе $3$ с угловой скоростью $\omega_{1/3} = \beta \eb_z$, а система $2$ вращается в системе $1$ с угловой скоростью $\omega_{2/1} = \alpha \eb_\zeta$.
\end{stm}
\begin{proof}
Это просто теорема о сложении угловых скоростей.
\end{proof}
\begin{df}
Такое движение твёрдого тела называется регулярной прецессией.
\end{df}

Одно из динамических уравнений Эйлера в случае симметричного волчка упростится: $C\dot r + (B-A)pq = C\dot r = 0$, откуда $r = r_0 = \const$. Подставим эту константу в закон сохранения энергии: $Ap^2 + Aq^2 + Cr^2 = \const \Rightarrow A(p^2 + q^2) = \const$.
Легко видеть,  что $\theta = \angle(\eb_z,\eb_\zeta) = \const$ (все точки оси $O\zeta$ описывают окружности, ортогональные $Oz$), поэтому кинематические формулы Эйлера принимают вид
$$
\case{
p = \dot \psi \sin\theta\cos\phi, \\
q = \dot\psi \sin\theta\sin\phi, \\
r = \dot \psi \cos \theta + \dot \phi.
}
$$
Поэтому $\const = p^2 + q^2 = \dot \psi^2 \sin^2 \theta$, следовательно, $\dot \psi = \const$. Из третьей формулы Эйлера получим $\dot \phi = r_0 - \dot \psi \cos \theta = \const$.
Мы получили альтернативное определение регулярной прецессии (легко проверить, что оно эквивалентно предыдущему):
\begin{df}
Движение твёрдого тела называется регулярной прецессией, если углы Эйлера можно выбрать таким образом, что 
$$
\case{ 
\dot \theta = 0, \\
\dot \phi = \const, \\
\dot \psi = \const.
}
$$
\end{df}

\subsubsection{Волчок Лагранжа}
У волчка Лагранжа $A=B$, а центр масс лежит на оси симметрии (она же третья главная ось инерции), $\ell_1 = \ell_2 = 0$.
Интеграл $C\dot r + (B-A)pq = -mg(\ell_1 \gamma_2 - \ell_2 \gamma_1)$ вырождается в $C\dot r = 0$, поэтому $r = \const$.
Запишем лагранжиан волчка: $V = mgz_{\text{\rm цм}} = mgl\cos\theta$, где $l$ -- расстояние от центра масс до подвеса (считаем, что подвес ниже). $T = \frac{A}{2}(p^2 + q^2) + \frac{C}{2} r^2 = \frac{A}{2}(\dot \psi^2 \sin^2 \theta + \dot \theta^2) + \frac{C}{2}(\dot \psi \cos \theta + \dot \phi)^2,$
$$
L = T-V =  \frac{A}{2}(\dot \psi^2 \sin^2 \theta + \dot \theta^2) + \frac{C}{2}(\dot \psi \cos \theta + \dot \phi)^2 - mgl\cos\theta.
$$
Видно, что $\phi,\psi$ -- циклические, интегралы импульса:
$$
\case{
\jac{L}{\dot\phi} = & c \dot \phi + c \dot \psi \cos \theta = \beta_\phi, \\
\jac{L}{\dot \psi} = & A \dot\psi \sin^2 \theta + C\dot\psi\cos^2\theta + c\dot\phi \cos\theta = A\dot\psi \sin^2\theta + \cos\theta\beta_\phi = \beta_\psi.
}
$$
Рассмотрим невырожденный случай $C \ne A, \theta \ne 0,\pi$. Выразим циклические импульсы и понизим порядок уравнения по Раусу:
$$
%\bcase{
\dot \psi = \frac{\beta_\psi - \beta_\phi\cos\theta}{A \sin^2 \theta}, \quad
\dot \phi = \frac{\beta_\phi - C \dot\psi(\beta_\phi,\beta_\phi, \theta)\cos\theta}{C} = \frac{\beta_\phi}{C} - \dot\psi \cos\theta
%}
$$

\begin{multline*}
R(\theta,\dot\theta,\beta_\phi,\beta_\psi) = L - \beta_\phi \dot\phi - \beta_\psi\dot\psi = 
% КУРОГ
\frac{A}{2} \left( \frac{(\beta_\psi - \beta_\phi \cos\theta)^2}{A^2 \sin^4
\theta} \sin^2 \theta + \dot\theta^2 \right) +
\frac{C}{2} \left( \dot\psi \cos\theta + \frac{\beta_\phi}{C} - \dot\psi
\cos\theta \right) - \beta_\phi \dot \phi - \beta_\psi \dot \psi =\\= % end курог 
\frac{A\dot\theta^2}{2} - \frac{(\beta_\psi - \beta_\phi \cos \theta)^2}{2A\sin^2\theta} + \frac{\beta_\phi^2}{2C} - mgl\cos\theta = \frac{A\dot\theta^2}{2} - V^*(\theta).
\end{multline*}
$V^*(\theta) =  \frac{(\beta_\psi - \beta_\phi \cos \theta)^2}{2A\sin^2\theta} +  mgl\cos\theta - \frac{\beta_\phi^2}{2C}$ --- \emph{приведённый потенциал}.
Константа $\frac{\beta_\phi^2}{2C}$ не влияет на вид уравнений Рауса, поэтому
мы её отбросим.

Изучим фазовый портрет решений уравнения Рауса (у нас осталась система с одной степенью свободы). Для этого сделаем в $V^*$ замену $u = \cos\theta, u \in (-1,1)$ и разложим потенциал на простые дроби.
$$
V^*(u) = A_1 + A_2 u + \frac{A_3}{1-u} + \frac{A_4}{1+u}.
$$
Имеем $V^*(u) \to +\infty$ при $u \to \pm 1$, поэтому $A_3,A_4 > 0$. $\jac{V^*}{u} = A_2 + \frac{A_3}{(1-u)^2} - \frac{A_4}{(1+u)^2}$ -- монотонная функция, $\jac{V^*}{u} \to -\infty, u \to -1, \jac{V^*}{u} \to +\infty, u\to 1$. Поэтому существует единственный минимум $V^*$ в точке $u_0$. $V^*(u)$ также выпукла в силу монотонности производной. 

Совершив обратную замену, получим, что $V^*(\theta)$ имеет единственный строгий минимум в $\theta_0 \in (0,\pi)$ и является выпуклой вниз функцией(рисунок бы). При переходе к фазовому портрету это будет означать, что имеется центр и все фазовые траектории замкнуты, т.е. движение по координате $\theta$ периодично.

Обозначим через $\theta^*$ такое значение $\theta$, при котором $\dot \psi = \frac{\beta_\psi - \beta_\phi \cos \theta^*}{A \sin^2 \theta^*} = 0$.
\begin{stm}
$\theta^* < \theta_0.$
\end{stm}
\begin{proof}
Достаточно доказать, что $(V^{*})'(\theta^*) < 0$ (см. график). Но $(V^{*})'(\theta^*) = (\beta_\psi - \beta_\phi \cos \theta^*)\cdot ... - mgl\sin\theta^*  = - mgl\sin\theta^* < 0.$
\end{proof}
\subsubsection{След оси динамической симметрии на сфере}
Рассмотрим различные варианты энергии волчка (энергия здесь обобщённая: $h = \frac{A\dot\theta^2}{2} + V^*(\theta)$) и посмотрим, какие кривые ось динамической симметрии $Oe_\zeta$ описывает на сфере с центром в точке подвеса:
\begin{enumerate}
\item $h = h_0$ (минимальная энергия, при которой есть движение). 

В этом случае $\case{\theta = \const, \\ \dot\psi = \const, \\ \dot\phi = \const}$ ---  это регулярная прецессия. 

Ось описывает на сфере параллель с широтой $\theta$.

\item Обозначим через $h^*$ уровень энергии, при котором при $\theta = \theta^*$ $\dot\theta = 0$ (да, без рисунка это понять сложно, но что поделаешь). При $h_0 < h < h^*$ имеем знакопостоянство $\dot\psi (\dot\psi \ne 0)$, поэтому по координате $\psi$ волчок движется все время в одном направлении. След оси находится между двумя параллелями, соответствующими двум широтам $\theta\colon V^*(\theta) = h$ и описывает кривую, напоминающей синусоиду (колеблется между двумя параллелями, по очереди касаясь их).

\item $h = h^*.$ 

Опять, имеем неотрицательность (или неположительность) $\dot\psi$ (едем по $\psi$ в одном направлении) и колебания между двумя параллелями $\theta\colon V^*(\theta) = h$. Однако теперь, как мы знаем, меньшая из этих широт равна $\theta^*$ и там $\dot\psi = 0$. Если нарисовать график $\theta(\psi)$, то касательная в тех точках, где $\dot\psi = 0$, будет вертикальна. Найдём, как ведут себя $\psi$ и $\theta$ в окрестности этой особой точки.

Имеем $A\ddot \theta = -\jac{V^*}{\theta}$. В точке $\theta^*$, как мы знаем, $-\jac{V^*}{\theta} > 0$, поэтому при $\theta = \theta^*$ $\ddot \theta > 0$. Положим $t = 0$ при $\theta = \theta^*$. Тогда локально $\theta(t) = \theta^* + \frac{at^2}{2} + \ldots$, $a \ne 0$. Поэтому $t = \alpha(\theta-\theta^*)^{1/2} + \ldots$(члены более высокого порядка малости). Теперь рассмотрим $\psi$: $\dot\psi(0) = 0, \ddot\psi(0) = \jac{\dot\psi}{\theta}\dot\theta(0) = 0$, откуда $\psi = \psi^* + \frac{bt^3}{6} + ...$. Подставив сюда $t = \alpha(\theta-\theta^*)^{1/2} + \ldots$ и забив на члены более высокого порядка, получим $(\psi - \psi^*)^2 = \beta(\theta - \theta^*)^3 + ...$, то есть в окрестности нашей особой точки график $\theta(\psi)$ приблизительно является полукубической параболой.

\item $h > h^*.$

Опять имеем колебания между двумя параллелями, однако теперь при прохождении широты $\theta^*$ меняется знак $\psi$ (мы начинаем идти назад), соответственно, касательные в этих точках вертикальны. Однако можно показать, что это всё локально и до того, как мы вернёмся на нижнюю параллель, знак $\psi$ поменяется опять на нужный, то есть в итоге по $\psi$ мы движемся глобально в одном направлении, периодически описывая <<завитушки>>, касающиеся верхней параллели, но не доходящие до нижней, с переменой знака $\psi$. Мы этого доказывать не будем. Также можно показать, что траектория в этом случае не может быть периодической (т.е. представлять из себя замкнутую <<завитушку>>), но мы этого тоже делать не будем, ибо это 5 страниц выкладок.
\end{enumerate}

\section{Гамильтонова механика}
\subsection{Уравнения Гамильтона}
\subsubsection{Вывод уравнений Гамильтона из уравнений Лагранжа 2-го рода}
\emph{Обобщённый импульс:} $p = \frac{\partial L}{\partial \dot q}$.
$p = p(q, \dot q, t)$. В предположении $\det \frac{\partial^2 L}{\partial
\dot q^2} = \det \frac{\partial p}{\partial \dot q} \ne 0$ разрешим 
относительно $\dot q$: $\dot q = \dot q(q, p, t)$. Новые переменные
$q$, $p$, $t$ называются \emph{каноническими переменными}.

\emph{Функция Гамильтона (гамильтониан)}:
$$
H(q, p, t) = \left.\left( \langle p, \dot q \rangle - L \right)
\right|_{\dot q = \dot q(q,p,t)}.
$$

Запишем $dH$ двумя различными способами:
\begin{align*}
dH &= \langle dp, \dot q \rangle + \langle p, d\dot q \rangle -
\frac{\partial L}{\partial q} dq - \frac{\partial L}{\partial \dot q} 
d\dot q - \frac{\partial L}{\partial t} dt =
\dot q \, dp  - \frac{\partial L}{\partial q} dq - 
\frac{\partial L}{\partial t} dt;\\
dH &= \frac{\partial H}{\partial p} dp + \frac{\partial H}{\partial q} dq +
\frac{\partial H}{\partial t} dt.
\end{align*}
Отсюда 
$$
\frac{\partial H}{\partial q} = - \frac{\partial L}{\partial q}; \qquad
\frac{\partial H}{\partial p} = \dot q; \qquad
\frac{\partial H}{\partial t} = - \frac{\partial L}{\partial t}.
$$
В силу уравнений Лагранжа
$$
\frac{\partial H}{\partial q} = - \frac{\partial L}{\partial q} = 
- \frac{d}{dt} \frac{\partial L}{\partial \dot q} = - \dot p,
$$
что даёт нам систему $2n$ ОДУ первого порядка --- \emph{уравнения Гамильтона}:
$$
\left\{
\begin{aligned}
\dot q &= \frac{\partial H}{\partial p}\\
\dot p &= - \frac{\partial H}{\partial q}.
\end{aligned}
\right.
$$

\subsubsection{Преобразование Лежандра}
Теперь посмотрим на всё это с более высокой точки зрения. Пусть переменная
$x$ пробегает $\RR^n$ и функция $f(x) \in \Cb^\infty (\RR^n)$. Положим
$y = \frac{\partial f}{\partial x} \in \RR^n$. Потребуем (локально), чтобы
$\det \frac{\partial^2 f}{\partial x^2} \ne 0$. Тогда по теореме о
неявной функции $x$ можно выразить через $y$: $x = x(y)$. Положим
$$
g(y) = \left.(xy - f(x))\right|_{x = x(y)}
$$
(под $xy$ понимается их скалярное произведение). Функция $g$ называется
\emph{преобразованием Лежандра} функции $f$. Пишем $g = G(f)$,
$G \colon f \mapsto g$.

Обычно от $f$ требуется не только гладкость и невырожденность гессиана, но
ещё и выпуклость. В нашем случае это так: лагранжиан натуральной системы
есть выпуклая функция скоростей. 

{\bf Свойства преобразования Лежандра.}\par % FIXME: написать доказательства -- да ну нафиг, тривиальщина.
{\bf 1$^\circ\!$.} $G^2$ есть тождественное преобразование.

{\bf 2$^\circ\!$.} Функции $f$ и $g=Gf$ могут зависеть ещё и от параметра $z$. Тогда
$\frac{\partial g}{\partial z} = - \frac{\partial f}{\partial z}$.

{\bf 3$^\circ\!$.} Если $f$ выпукла, то $g = Gf$ тоже выпукла.
(Легко проверяется, что $\frac{\partial^2 g}{\partial y^2} = \left( \frac{\partial^2 f}
{\partial x^2} \right)^{-1}$, а $f$ выпукла тогда и только тогда, когда матрица Гессе положительно
определена.)

{\bf 4$^\circ\!$.} Для выпуклых функций $g(y) = \max\limits_{x \in \RR^n} ( xy - f(x))$.
\begin{proof}
Действительно, пусть $y$ лежит в образе $\jac{f}{x}$. Тогда функция $h(x) = xy - f(x)$ вогнута ($xy$ линейна и не влияет на выпуклость), и поэтому может иметь не более одного строгого максимума, который может достигаться только в точке, в которой $\jac{h}{x} = 0$, что эквивалентно $y - \jac{f}{x} = 0$, то есть именно там, где нужно. (попутно мы доказали, что для выпуклой $f$ отображение $x \mapsto \jac{f(x)}{x}$ инъективно)
\end{proof}

{\bf 5$^\circ\!$.} Из предыдущего свойства получаем \emph{неравенство Юнга}
$f(x) + g(y) \ge xy$.

Из этих свойств можно получить уравнения Гамильтона: $z = (q, t)$; $L = L(\dot q, q, t)=
f(\dot q, z)$; $H = G_{\dot q} f$. Дифференцируя по параметру, получаем
$\frac{\partial H}{\partial q} = - \frac{\partial L}{\partial q}$. Далее
$$\dot p = \frac{d}{dt} \frac{\partial L}{\partial \dot q} =
\frac{\partial L}{\partial q} = - \frac{\partial H}{\partial q},$$
а поскольку $L$ есть применение преобразования Лежандра к $H$ (свойство 1$^\circ\!$),
то $\dot q = \frac{\partial H}{\partial p}$. Получили все уравнения Гамильтона.

\subsubsection{Свойства уравнений Гамильтона}
{\bf 1$^\circ\!$.} В силу уравнений Гамильтона
$$
\frac{dH}{dt} = \frac{\partial H}{\partial q} \dot q + \frac{\partial H}{\partial p} \dot p +
\frac{\partial H}{\partial t} = \frac{\partial H}{\partial t},
$$
то есть $\frac{dH}{dt} = \frac{\partial H}{\partial t}$. В частности, если гамильтониан
не зависит явно от времени, то он является первыми интегралом системы.

{\bf 2$^\circ\!$.} $H$ --- значение обобщённой энергии системы.

{\bf Первые интегралы.} Кроме интеграла энергии у гамильтоновых систем бывают
ещё и циклические интегралы: если $\frac{\partial H}{\partial q_i} = 0$, то 
$\dot p_i = 0$, т.е. $p_i$ --- первый интеграл. Понижение порядка системы здесь тривиально: если найдём общее решение уравнений Гамильтона по нециклическим координатам (с подставленной произвольной константой вместо $p_i$) и подставим его в уравнение на $q_i$, то   в нём разделятся переменные и его можно будет легко проинтегрировать, т.к. $H$ не зависит от $q_i$.

\subsubsection{Теорема Лиувилля о сохранении фазового объёма}
Мера, заданная в координатах $q$, $p$, $t$ единичной плотностью, является
инвариантной для системы уравнений Гамильтона.

Проверим условие $\diverg f = 0$ ($f = \left( \frac{\partial H}{\partial p},
- \frac{\partial H}{\partial q} \right)$ --- векторное поле, соответствующее
гамильтоновой системе). Действительно,
$$
\diverg f = \sum\limits_{i=1}^N \frac{\partial^2 H}{\partial p_i \partial
q_i} + \sum\limits_{i=1}^N - \frac{\partial^2 H}{\partial q_i \partial p_i}
= 0.
$$

Мера с единичной плотностью есть объём в фазовом пространстве, поэтому
это утверждение можно записать и так: $V(D) = V(g^t D)$ для любой
области $D$.

Отсюда следует (по теореме о замене переменных в кратном интеграле), что
мера с плотностью $\det \frac{\partial^2 L}{\partial \dot q_i \partial 
\dot q_j}$ будет инвариантной для лагранжевой системы. Для натуральной
системы ($L = \frac 12 \langle A(q) \dot q, \dot q \rangle - V(q)$)
инвариантной будет мера с плотностью $\rho = \det A$.

\subsubsection{Вариационный принцип Гамильтона в фазовом пространстве}
Введём функционал действия на кривой $\gamma = (q(t),p(t))$ в фазовом пространстве следующим образом:
$$
I(\gamma) = \int\limits_{t_0}^{t_1} (p\dot q - H) dt.
$$
Такое действие называется \emph{действием по Гамильтону}

Зафиксируем интервал $[t_0,t_1]$ и кривую $\gamma_0 = (q_0(t),p_0(t)), t \in [t_0,t_1]$.
\begin{df}
Вариацией по Гамильтону кривой $\gamma_0$ в фазовом пространстве называется семейство кривых $\gamma_\alpha, \alpha \in (-\ep,\ep)$, для которых
\begin{enumerate}
\item $q(t_i,\alpha) = q_0(t_i), p(t_i,\alpha) = p_0(t_i), i = 0,1$, то есть концы закреплены,
\item $q(t,0) \equiv q_0(t), p(t,0) \equiv p_0(t)$ и
\item $q(t,\alpha), p(t,\alpha)$ являются гладкими функциями.
\end{enumerate}
\end{df}
\begin{df} Вариацией функционала $I$ на $\gamma_\alpha$ называется $\delta I(\gamma_\alpha) = \left.\jac{}{\alpha}I(\gamma_\alpha)\right|_{\alpha = 0}$.
\end{df}
\begin{df}
$\gamma_0$ -- экстремаль $I$, если $\delta I(\gamma_\alpha) = 0$ для любой вариации $\gamma_\alpha$ кривой $\gamma_0$.
\end{df}

\begin{stm}[Вариационный принцип Гамильтона]
$\gamma_0$ --- движение системы (решение уравнений Гамильтона) тогда и только тогда, когда $\gamma_0$ --- экстремаль $I$.
\end{stm}
\begin{proof}
Рассмотрим систему с $2n$ степенями свободы, обобщёнными координатами $p,q$ и <<суперлагранжианом>> $\Lambda(p,q,\dot p, \dot q, t) = p \dot q - H(q,p,t)$. Запишем для этого лагранжиана уравнения Лагранжа:
$$
\jac{\Lambda}{\dot q} = p, \jac{\Lambda}{q} = - \jac{H}{q}, \jac{\Lambda}{\dot p} = 0, \jac{\Lambda}{p} = \dot q - \jac{H}{p},
$$
и уравнения имеют вид
$$
\left\{
\begin{aligned}
\jac{}{t}\jac{\Lambda}{\dot q} - \jac{\Lambda}{q}  & = p + \jac{H}{q} = 0, \\
\jac{}{t}\jac{\Lambda}{\dot p} - \jac{\Lambda}{p} & = - \dot q + \jac{H}{p} = 0,
\end{aligned}
\right.
$$
что в точности совпадает с уравнениями Гамильтона исходной системы. Осталось только заметить, что действие для этой лагранжевой системы в точности совпадает с гамильтоновым действием для исходной системы, и сослаться на уже доказанный вариационный принцип для лагранжевых систем.
\end{proof}

\subsection{Каноническая форма. Инвариант Пуанкаре -- Картана}
%%% FIXME: напоминание о диф. формах --- надо было ботать диффгем :)
\subsubsection{Лемма об аннуляторе канонической 2-формы}
\begin{df}
Дифференциальная 1-форма в расширенном фазовом пространстве ($p$, $q$,
$t$; размерность $2N+1$)
$\omega_1 = p\, dq - H\, dt$ называется \emph{интегральным инвариантом
Пуанкаре -- Картана}.
\end{df}
Здесь $p\, dq = \sum p_i \, dq_i$.
\begin{df}
Дифференциальная 2-форма $\omega_2 = d \omega_1 = dp \wedge dq -
dH \wedge dt$ называется \emph{канонической 2-формой}.
\end{df}
\begin{df}
Вектор (касательный) $\xi$ называется \emph{аннулятором} формы $\omega_2$,
если для любого (касательного) вектора $\eta$ $\omega_2(\xi, \eta) = 0$.
\end{df}

Система ОДУ первого порядка задаётся векторным полем $\mathbf{v}$ в
фазовом пространстве. В расширенном фазовом пространстве ему
соответствует \emph{поле направлений}, задаваемых векторами
$(\mathbf{v}, 1)$. Кривая в расширенном фазовом пространстве,
в каждой своей точке касающаяся прямой поля направлений, ---
и есть решение.

Для уравнений Гамильтона $\mathbf{v} = \mathbf{v}_H = 
\left( \frac{\partial H}{\partial p}, - \frac{\partial H}{\partial q} 
\right)$ --- векторное поле; поле направлений:
$\tilde{\mathbf{v}}_H = \left( \frac{\partial H}{\partial p}, - \frac{\partial H}{\partial q}, 1 \right)$.

\begin{lemma}[об аннуляторе канонической 2-формы]
$\tilde{\mathbf{v}}_H$ является аннулятором $\omega_2$. Если 
$\tilde{\mathbf{u}}$ является аннулятором $\omega_2$, то
$\tilde{\mathbf{u}} = c \tilde{\mathbf{v}}_H$ для некоторой
константы $c$.
\end{lemma}
\begin{proof}
Пусть $\xi = (a,b,c), \eta = (x,y,z)$, где $a,b,x,y \in \RR^n, c,z \in \RR$. Распишем форму $dH = \jac{H}{q} dq + \jac{H}{p} dp + \jac{H}{t} dt$, $dH(\xi) = \jac{H}{q} a + \jac{H}{p} b + \jac{H}{t} c$, и при внешнем умножении на $dt$ последнее слагаемое убьётся.
Запишем значение $\omega_2$ на $\xi$ и $\eta$:
\begin{gather*}
\omega_2(\xi,\eta) = \left(\sum_i dp_i \wedge dq_i - dH \wedge dt\right)(\xi,\eta) = \left(\sum_i dp_i \wedge dq_i - \jac{H}{q} dq \wedge dt - \jac{H}{p} dp \wedge dt\right)(\xi,\eta) = \\ = 
\sum_i \mbmat{dp_i(\xi) & dq_i(\xi) \\ dp_i(\eta) & dq_i(\eta)} - \mbmat{dH(\xi) & dt(\xi) \\ dH(\eta) & dt(\eta)} = \\ = \sum_i \mbmat{b_i & a_i \\ y_i & x_i} - \mbmat{\jac{H}{q} a + \jac{H}{p} b & c \\ \jac{H}{q} x + \jac{H}{p} y & z} = bx - ay - \jac{H}{q} az - \jac{H}{p} bz + \jac{H}{q} xc + \jac{H}{p}yc.
\end{gather*}
Подставим в полученное выражение $\xi = \left(\jac{H}{p}, -\jac{H}{q}, 1\right) = \tilde v_H$:
$$
\omega_2(\xi,\eta) = -\jac{H}{q}x - \jac{H}{p} y - \jac{H}{q}\jac{H}{p} z + \jac{H}{p}\jac{H}{q} z + \jac{H}{q}x + \jac{H}{p} y = 0.
$$

Теперь пусть $\xi = (a,b,c) \ne 0 $ аннулирует $\omega_2$. Подставим в форму $\xi$ и $\eta = (e_i, 0,0)$: $0 = \omega_i(\xi,\eta) = b_i + \jac{H}{q_i} c$, подставив $\eta = (0,e_j,0)$, получим $0 = \omega_2(\xi,\eta) = -a_i + \jac{H}{p_i}c$, откуда видно, что $\xi$ параллелен $\tilde v_H$.
\end{proof}

\subsubsection{Интегральные инварианты Пуанкаре и Пуанкаре--Картана}
\begin{df}
Пусть  $\gamma$ -- замкнутая кривая в расширенном фазовом пространстве. Тогда $\int\limits_\gamma \omega_1$ называется относительным интегральным инвариантом Пуанкаре--Картана. (относительным, потому что только для замкнутых кривых)
\end{df}

Пусть $s$ -- какой-нибудь параметр на $\gamma$ и $t(s)$ непрерывна(а ещё лучше -- гладкая) определим $\tilde\gamma(s) = g^{t(s)} \gamma(s)$ --- сдвиг вдоль фазового потока системы на $t(s)$. Поверхность, которую описывает $\gamma$ при сдвиге вдоль фазового потока, называется \emph{трубкой тока}.

\begin{theorem}
Пусть $\gamma(s)$ и сдвиг $t(s)$ таковы, что трубка тока является многообразием с краем $\gamma \sqcup \tilde \gamma$ (не будем уточнять, когда именно это выполнено). Тогда 
$$
\int\limits_\gamma \omega_1 = \int\limits_{\tilde\gamma}  \omega_1.
$$
\end{theorem}
\begin{proof}
Обозначим поверхность трубки тока через $\Sigma$. Так как $\tilde v_H$ касается $\Sigma$, то $\left.\omega_2\right|_\Sigma = 0$. Действительно $\Sigma$ двумерно, поэтому в любой точке $x \in \Sigma$ в $T_x \Sigma$ можно выбрать базис из $\tilde v_H(x)$ и ещё какого-нибудь вектора $y$. Тогда для любых $\xi = a \tilde v_H + b y, \eta = x\tilde v_H + z y$ $\omega_2(\xi,\eta) = \omega_2(a \tilde v_H, z y) + \omega_2(b y, x\tilde v_H) = 0$, т.к. $\tilde v_H$ аннулирует $\omega_2$. Осталось вспомнить, что $\omega_2 = d\omega_1$, поэтому по формуле Стокса 
$$
0 = \int_\Sigma \omega_2 = \int\limits_{\tilde\gamma} \omega_1 - \int\limits_\gamma \omega_1,
$$
т.к. индуцированные ориентации на $\gamma$ и $\tilde \gamma$ противоположны.
\end{proof}
\begin{imp}
Пусть $g^{\tau}$ --- сдвиг вдоль линий тока на $\tau$. Тогда $\int\limits_\gamma \omega_1 = \int\limits_{g^{\tau}}\omega_1$.
\end{imp}
\begin{imp}
Пусть $\gamma^*$ --- контур в фазовом пространстве ($\gamma = (q(s),p(s))$) в момент $\tau_0$. Тогда 
$$
\int\limits_{\gamma^*} p dq = \int\limits_{g_{\tau_0}^\tau \gamma^*} p dq.
$$
Это называется интегральным инвариантом Пуанкаре.
\end{imp}
\begin{proof}
Заметим, что на кривых в фазовом пространстве $dt = 0$.
\end{proof}

\subsubsection{Инвариантность канонической формы при сдвиге вдоль фазовых кривых}
Вспомним, что диффеоморфизм $f\colon M \to N$ порождает линейное отображение касательных пространств $f^*\colon T_x M \to T_{f(x)} N$, называющееся дифференциалом отображения. Как хорошо известно, при этом возникает линейное отображение внешних алгебр в обратную сторону: если у нас была дифференциальная форма $\omega_2$ на $TN$, то на $TM$ можно определить $(f_* \omega_2)(\eta_1,\eta_2) = \omega_2(f^* \eta_1, f^* \eta_2)$. Замечательное свойство канонической формы состоит в том, что фазовый поток её не меняет.

\begin{theorem}
$g^t_* \omega_2 = \omega_2$.
\end{theorem}
\begin{proof}
Вспомним, что 2-формы $\alpha$ и $\beta$ совпадают тогда и только тогда, для любого гладкого вложения двумерного диска $\Sigma$ $\int_\Sigma \alpha = \int_\Sigma \beta$.

$$
\int_\Sigma \omega_2 = \int_{\partial \Sigma} \omega_1 = \int_{g^t \partial \Sigma} \omega_1 = \int_{\partial g^t \Sigma} \omega_1 = \int_{g^t \Sigma} \omega_2 = \int_\Sigma g^t_* \omega_2.
$$
\end{proof}
\subsubsection{Ещё раз теорема Лиувилля о сохранении фазового объёма}
Используя предыдущую теорему, можно показать, что сдвиг фазового пространства (\emph{не} расширенного) посредством $g^t$ сохраняет $2$-форму $dp \wedge dq$ (доказательство производится подъёмом в расширенное пространство с последующим наблюдением, что на кривых с постоянной координатой $t$ $dt = 0$), поэтому он будет сохранять и внешние степени $dp \wedge dq$. 

Из сохранения формы $(dp \wedge dq)^n = C dp_1 \wedge \ldots \wedge dp_n \wedge dq_1 \wedge \ldots \wedge dq_n$ мы получаем ещё одно доказательство теоремы Лиувилля: фазовый объём при сдвиге вдоль траекторий системы инвариантен.

\subsection{Канонические преобразования}
Для автономного случая всё просто: $H = H(q,p)$; $Q$, $P$ --- новые переменные.
Преобразование (замена координат) каноническое, если форма уравнений остаётся
гамильтоновой с гамильтонианом $\tilde H(Q,P) = H(q(Q,P), p(Q,P))$.

Дадим общее определение.
\begin{df}
Преобразование $q,p,t \to Q,P,T$ (замена координат в расширенном фазовом
пространстве) \emph{каноническое}, если существуют функции $\tilde H$ и
$S$ на расширенном фазовом пространстве такие, что
\begin{equation}\label{Eq:can}
p \, dq - H \, dt = P \, dQ - \tilde H \, dT + dS.
\end{equation}
\end{df}

{\small Это определение \emph{унивалентного} канонического преобразования. Иногда
рассматривают преобразования с условием $p\,dq - H\,dt = c(P\,dQ - \tilde H \, dT) + dS$,
где $c$ --- произвольная константа, называемая \emph{валентностью} преобразования.
}

\begin{stm} 
Если замена каноническая, то в координатах $Q$, $P$, $T$ уравнения движения
$\dot q = H_p$, $\dot p = -H_q$ имеют вид
\begin{equation}
\left\{
\begin{aligned}
\frac{dQ}{dT} &= \frac{\partial \tilde H}{\partial P}\\
\frac{dP}{dT} &= -\frac{\partial \tilde H}{\partial Q},
\end{aligned}
\right.
\end{equation}\label{Eq:Hamilton2}
то есть являются гамильтоновыми с гамильтонианом $\tilde H$.
\end{stm}

\begin{proof}
Возьмём внешнюю производную от~(\ref{Eq:can}) и вспомним, что $d^2 S = 0$:
$$
dp \wedge dq - dH \wedge dt = dP \wedge dQ - d \tilde H \wedge dT.
$$
Множества аннуляторов правой и левой частей совпадают, значит вектор
$\vb_H = (H_p, -H_q, 1)$ есть аннулятор формы $dP \wedge dQ - d \tilde H \wedge dT$.
Значит, $\vb_H = c \vb_{\tilde H}$, где $\vb_{\tilde H} = ({\tilde H}_P,
-{\tilde H}_Q, 1)$, то есть поле направлений для~(\ref{Eq:Hamilton2}) совпадает с
полем направлений для исходной системы уравнений.
\end{proof}

Заметим, что не всегда будет $\tilde H = H$.

Далее считаем, что $T = t$ (время не меняется). Тогда (\ref{Eq:can}) перепишется в
виде
\begin{equation}
p\, dq - H\,dt = P\,dQ - \tilde H\,dt + dS.
\end{equation}\label{Eq:can2}

В фиксированный момент времени $t_0$ рассмотрим фазовое пространство. Каждая точка в
нём задаётся, с одной стороны, координатами $q,p$, а с другой стороны --- $Q,P$.
Возьмём смешанный набор: рассмотрим случай, когда в качестве (локальных) координат
в фазовом пространстве можно взять $q$, $Q$. Тогда можно записать $S = S(q,Q,t)$.
$S(q,Q,t)$ называется \emph{производящей функцией} канонического преобразования.
Дальше мы увидим, что само преобразование записывается через производные $S$.
Заметим, что в~(\ref{Eq:can2}) входят только дифференциалы независимых переменных
($dq$, $dQ$ и $dt$) и $dS$. Запишем $dS$ как полный дифференциал и подставим в~(\ref{Eq:can2}):
$$
p\,dq - H\,dt = P\,dQ - \tilde H\,dt + \frac{\partial S}{\partial q}\,dq +
\frac{\partial S}{\partial Q}\,dQ + \frac{\partial S}{\partial t}\, dt.
$$
Отсюда получаем
$$
p = \frac{\partial S}{\partial q}, \qquad
\tilde H = \frac{\partial S}{\partial t} + H, \qquad
P = - \frac{\partial S}{\partial Q}.
$$

Пусть $\det \frac{\partial^2 S}{\partial Q \partial q} \ne 0$ (в таком случае
преобразование называется \emph{свободным} по переменным $q$, $Q$). Тогда
последнее соотношение ($P = - \frac{\partial S}{\partial Q}(q,Q,t)$) можно
разрешить относительно $q$: $q = q(Q,P,t)$, откуда $p = \frac{\partial S}{\partial q} =
p(Q,P,t)$, $\tilde H = \tilde H(Q,P,t)$. Если $S$ не зависит от времени, то
$\tilde H$ есть старый гамильтониан $H$, записанный в новых переменных.

% лекция 30.04.2008

\subsubsection{Производящая функция тождественного преобразования}
Рассмотрим тождественное преобразование: $q = Q$, $p = P$. Здесь в качестве
координат в фазовом пространстве брать $q$ и $Q$ уже нельзя.

%При фиксированном $t$ имеем $p\, dq = P\,dQ + dS$, откуда $dS = 0$. Значит,
%$S$ зависит только от времени.

В качестве новых координат возьмём $q$ и $P$. $S = S(q,P)$. По формуле
Лейбница $P\,dQ = -Q\,dP + d(PQ)$. Второе слагаемое (полный дифференциал)
отнесём к $S$, положив $\tilde S = S + PQ$. Условия каноничности и
свободности (по переменным $q$ и $P$) запишутся так:
$$
p\,dq - H \, dt = - Q\,dP - \tilde H \, dt + d \tilde S;
\qquad
\det \frac{\partial^2 \tilde S}{\partial q \partial P} \ne 0.
$$
Этим условиям удовлетворяет $\tilde S = qP$ --- это и будет производящая
функция тождественного преобразования.

\subsubsection{Сдвиг по траекториям как каноническое преобразование}
Сдвиг по траекториям гамильтоновой системы тоже есть замена координат
(в качестве координат $Q$ и $P$ точки в фазовом пространстве можно 
взять координаты $q_0$ и $p_0$ точки, которая переходит в данную за время
$\Delta t$). Мы знаем, что при сдвиге сохраняется каноническая 2-форма:
$$
dP \wedge dQ - d \tilde H \wedge dt = dp \wedge dq - dH \wedge dt,
$$
откуда в силу леммы Пуанкаре для некоторой функции $S$
$$
p \, dq - H \, dt = P \, dQ - \tilde H \, dt + dS,
$$
т.е. преобразование является каноническим.
\subsection{Понижение порядка по Уиттекеру}
Пусть система автономна: $H = H(q,p)$, $q, p \in \RR^n$. Значит, есть
первый интеграл $H(q,p) = h$. Пусть $\Sigma = \{ (q,p) \mid H(q,p) = h \}$
--- его многообразие уровня. $\dim \Sigma = 2n-1$. На $\Sigma$ выберем
новые координаты $P$, $Q$ и $\tau$ и рассмотрим $\Sigma$ как
\emph{расширенное} фазовое пространство новой гамильтоновой системы
(уже неавтономной).

$\vb_H = (H_p, -H_q)$ касается $\Sigma$ ($dH({\vb}_H) = 0$
в силу уравнений Гамильтона). Фазовые кривые лежат в $\Sigma$ и касаются
поля направлений, заданного векторным полем ${\vb}_H$.

Допустим, что локально $\frac{\partial H}{\partial p_n} \ne 0$. Тогда
разрешим уравнение $H(q,p) = h$ относительно $p_n$:
$$
p_n = -K(q_1, \dots, q_n, p_1, \dots, p_{n-1}, h).
$$

Введём новые переменные: $Q = (q_1, \dots, q_{n-1}) \in \RR^{n-1}$,
$P = (p_1, \dots, p_{n-1}) \in \RR^{n-1}$, $\tau = q_n$. Тогда
$p_n = -K(Q,P,\tau)$. Заметим, что при этом выборе координат $\dot \tau = \dot q_n = \jac{H}{p_n} \ne 0$, то есть векторное поле $v_H$ действительно является полем направлений вдоль <<времени>> $\tau$.

\begin{theorem}
В координатах $Q$, $P$, $\tau$ дифференциальные уравнения, соответствующие
полю направлений $\left. \vb_H \right|_\Sigma$, таковы:
$$
\left\{
\begin{aligned}
Q' &= \frac{\partial K}{\partial P}\\
P' &= - \frac{\partial K}{\partial Q},
\end{aligned}
\right.
$$
где $' = \frac{d}{d\tau}$.
\end{theorem}

\begin{proof}
Рассмотрим фазовое пространство $X$ в любой фиксированный момент времени $t_0$ (всё равно, в какой, ибо поле направлений у нас инвариантно относительно сдвигов по $t$). На нём задано векторное поле $\vb_H = (H_p, -H_q)$, а в расширенном фазовом пространстве $Y$ задано поле направлений $\tilde{\vb}_H = (H_p, -H_q, 1)$. 

Мы хотим доказать, что ограничение поля $\vb_H$ на $\Sigma$ аннулирует форму $\tilde{\omega}_2 = dP \wedge dQ - dK \wedge d\tau$; тогда по лемме о аннуляторе наше поле на $\Sigma$ будет  гамильтоновым с нужным гамильтонианом. Очевидно, для $\xi, \eta \in T\Sigma \subset TX$ выполнено $(dP \wedge dQ - dK\wedge d\tau)(\xi,\eta) = (dp \wedge dq)(\xi,\eta)$.  

Осталось заметить две вещи: во-первых, ограничение $\left.\omega_2\right|_\Sigma$ совпадает с $dp \wedge dq$, т.к. $dH,dt$ на $\Sigma$ равны нулю, во-вторых, $\forall \eta \in T\Sigma\quad \omega_2(\vb_H, \eta) = \omega_2(\tilde{\vb}_H, \eta)$, т.к. $\omega_2(\vb_H - \tilde{\vb}_H,\eta) = \omega_2((0,0,1),\eta) = -(dH\wedge dt)((0,0,1),\eta)$ в координатах $(q,p,t)$, но на $\Sigma$ $dH(\eta) = dt(\eta) = 0$. Так как $\vb_H \in T\Sigma$, то получаем $\tilde{\omega}_2(\vb_H, \eta) = (dp \wedge dq)(\vb_H,\eta) = \omega_2(\vb_H,\eta) = \omega_2(\tilde{\vb}_H,\eta) = 0$ для всех $\eta \in T\Sigma$.
\end{proof}

\subsection{Автономизация гамильтоновой системы}
Пусть система неавтономна: $H = H(q, p, t)$. Введём новые
координаты: $Q = (q, t)$, $P = (p, P_{n+1})$ ($t = Q_{n+1}$) и
новый (автономный) гамильтониан $W(Q, P) = H + P_{n+1}$. 
Для новой системы уравнения движения имеют вид
$$
\left\{
\begin{aligned}
&\dot q_i = \dot Q_i = \frac{\partial W}{\partial P_i} = 
\frac{\partial H}{\partial p_i} && (i = 1, \dots, n)\\
&\dot Q_{n+1} = \frac{\partial W}{\partial P_{n+1}} = 1\\
&\dot p_i = \dot P_i = -\frac{\partial W}{\partial Q_i} =
-\frac{\partial H}{\partial q_i} && (i = 1, \dots, n)\\
&\dot P_{n+1} = - \frac{\partial W}{\partial Q_{n+1}} = 
- \frac{\partial H}{\partial t}
\end{aligned}
\right.
$$

При начальных условиях $Q_{n+1}(0) = 0$ получаем решение исходной
системы.

\subsection{Уравнение Гамильтона -- Якоби}
Пусть задана система с гамильтонианом $H(q,p,t)$. Мы ищем каноническое
преобразование $q,p,t \to Q,P,t$, для которого $\tilde H = 0$
(при этом уравнения движения приобретут простейшую форму), т.е. соответствующую
производящую функцию $S(q,Q,t)$:
$$
\tilde H = \frac{\partial S}{\partial t} + H(q,p,t)\biggr|_{q=q(Q,P,t),\: p=p(Q,P,t)} = 0.
$$
Подставим сюда $p = \frac{\partial S}{\partial q}$ и получим соотношение на $S$
(как функцию от $q, Q, t$):
$$
\frac{\partial S}{\partial t} + H\left(q, \frac{\partial S}{\partial q}, t \right) = 0.
$$
Считая $Q$ параметром (зафиксировав его), получим уравнения в частных производных
на $S$ по переменным $q$ и $t$ --- \emph{уравнение Гамильтона -- Якоби}.

Условие свободности преобразования записывается так:
$$
\det \frac{\partial^2 S}{\partial q \partial Q} \ne 0.
$$

\subsubsection{Полный интеграл уравнения Гамильтона -- Якоби}
\begin{df} Функция $W(q, \alpha, t)$, зависящая от $t$, $q \in \RR^n$ и параметров
$\alpha \in \RR^n$, называется \emph{полным интегралом} уравнения Гамильтона -- Якоби,
если:
\begin{nums}{-2}
\item для всех $\alpha$ $W$ есть решение уравнения Гамильтона -- Якоби:
$$
\frac{\partial W}{\partial t} + H \left( q, \frac{\partial W}{\partial q}, t \right) = 0;
$$
\item
$$
\det\frac{\partial^2 W}{\partial q \partial \alpha} \ne 0.
$$
\end{nums}
\end{df}

\begin{stm}
Если известен полный интеграл уравнения Гамильтона -- Якоби, то система уравнений Гамильтона
интегрируется в квадратурах.
\end{stm}

\begin{proof}
Рассмотрим каноническое преобразование $q,p,t \to Q=\alpha, P=\beta, t$, задаваемое
производящей функцией $S = W(q, \alpha, t)$. Из пункта 2 определения полного интеграла
следует, что это преобразование свободно. В новых переменных уравнения движения
тривиальны: $\tilde H = 0$ в силу уравнения Гамильтона -- Якоби, а значит
$\dot\alpha = 0$, $\dot\beta = 0$, т.е. $\alpha = \const$, $\beta = \const$.

Далее, в силу свободности уравнение $\beta = \frac{\partial W}{\partial \alpha}(q,\alpha,t)$
можно разрешить относительно $q$: $q = q(\alpha, \beta, t)$. Отсюда 
$p = \frac{\partial W}{\partial q} = p(\alpha, \beta, t)$. Получили параметрическое
семейство решений уравнений Гамильтона.
\end{proof}

\subsection{Симплектическое многообразие}
\subsubsection{Симплектическая структура}
Пусть $M^k$ --- гладкое многообразие.

\begin{df} \emph{Симплектической структурой} на $M^k$ называется 2-форма
$\omega_2$ со следующими свойствами:
\begin{nums}{-2}
\item замкнутость ($d \omega_2 = 0$);
\item невырожденность: $\forall \xi \in T_x M, \xi \ne 0 \:
\exists \eta \in T_x M, \eta \ne 0 \: \omega_2(\xi, \eta) \ne 0$
(т.е. аннулятор $\omega$ тривиален --- состоит только из нулевого
вектора).
\end{nums}
Многообразие с симплектической структурой называется \emph{симплектическим
многообразием}.
\end{df}

\begin{stm}
Размерность любого симплектического многообразия чётна ($k = 2n$).
\end{stm}

\begin{proof}
Действительно, пусть $\left. \omega_2(\xi, \eta)\right|_{x} = 
\langle A(x) \xi, \eta \rangle$. Тогда в силу косой симметрии
$$\langle A\xi, \eta \rangle = \omega_2(\xi, \eta) = 
- \omega_2(\eta, \xi) = - \langle A\eta, \xi \rangle =
- \langle A^T \xi, \eta \rangle,$$
для всех $\xi$, $\eta$, откуда $A = -A^T$ ($A$ --- кососимметрическая
матрица). Значит, $\det A = \det (-A^T) = (-1)^k \det A$.
При нечётных $k$ матрица $A$, а значит и форма $\omega_2$ вырождена.
\end{proof}

\subsubsection{Теорема Дарбу о канонических координатах}
Приведём без доказательства следующее утверждение (кому интересно,
пусть посмотрит в книгу А.\,Картана <<Дифференциальные формы>>):
\begin{theorem}[Дарбу]
Пусть $(M^{2n}, \omega_2)$ --- симплектическое многообразие,
$x_0 \in M^{2n}$. Тогда в окрестности $x_0$ существует система координат
$x = (q, p)$, $q = (x_1, \dots, x_n)$, $p = (x_{n+1}, \dots, x_{2n})$, в
которой симплектическая структура имеет вид 
$$
\omega_2 = dp \wedge dq = \sum_{i=1}^n dx_{i+n} \wedge dx_i.
$$
\end{theorem}
Такие координаты называются \emph{каноническими}.

\subsubsection{Гамильтоново векторное поле}
Пусть на симплектическом многообразии $(M^{2n}, \omega_2)$ задано векторное
поле $\mathbf{v}(x)$. Положим $\omega_1(\xi) := \omega_2(\xi, \mathbf{v})$,
$J \colon \mathbf{v} \mapsto \omega_1$ ($\text{векторные поля} \to
\text{1-формы}$). В точке $J$ есть невырожденное отображение конечномерных
пространств ($\RR^{2n}$), поэтому есть обратное: $J^{-1}\colon
\omega_1 \mapsto \mathbf{v}$.

\begin{df}
Пусть $H$ --- функция на $M^{2n}$. Векторное поле $\vb_H = J^{-1}(dH)$
называется \emph{гамильтоновым} с гамильтонианом $H$.
\end{df}

Заметим, что это определение не зависит от выбора системы координат.
$\omega_2(\xi, \vb_H) = dH(\xi)$.
Теперь перейдём (по теореме Дарбу) в канонические координаты.

\begin{stm}
В канонических координатах $\vb_H = (H_p, -H_q)$.
\end{stm}

\begin{proof}
Действительно, в канонических координатах
$$
\omega_2(\xi, \eta) = (dp \wedge dq)(\xi, \eta) = 
\sum_i \begin{vmatrix} \xi^i_p & \xi^i_q \\ \eta^i_p & \eta^i_q \end{vmatrix}
= \xi_p \eta_q - \xi_q \eta_p.
$$
Подставляя $\eta = \vb_H$ и вспоминая, что $\omega_2(\xi, \vb_H) = 
H_q \xi_q + H_p \xi_p$, получаем требуемое.
\end{proof}

% лекция 07.05.2008

\subsection{Скобки Пуассона}
Гладкие функции на $M^{2n}$ образуют векторное пространство. Есть гомоморфизм из него в
пространство гамильтоновых векторных полей. Введём в пространстве гладких функций
структуру \emph{алгебры Ли}.

\begin{df}
Пусть $H$ и $F$ --- гладкие функции на $M^{2n}$. Тогда функция
$$
G = \{ H, F \} = \partial_{\vb_H} F = dF(\vb_H) = \omega_2(\vb_H,\vb_F)
$$
называется \emph{скобкой Пуассона} функций $H$ и $F$.
\end{df}

{\bf Свойства скобок Пуассона:} (все эти свойства проверяются явно)

{\bf 0$^{\circ}\!$.} В канонических координатах
$$
\{ H, F \} = \frac{\partial F}{\partial q} \frac{\partial H}{\partial p} - 
\frac{\partial F}{\partial p} \frac{\partial H}{\partial q}.
$$

{\bf 1$^{\circ}\!$.} Кососимметричность: $\{ F, G \} = - \{ G, F \}$.

{\bf 2$^{\circ}\!$.} Билинейность.

{\bf 3$^{\circ}\!$.} Тождество Якоби:
$
\{ F, \{ G, H \} \} + \{ G, \{ H, F \} \} + \{ H, \{ F, G \} \} = 0.
$

\begin{stm}
$F$ является первым интегралом гамильтоновой системы с гамильтонианом $H$ тогда
и только тогда, когда $\{ H, F \} = 0$.
\end{stm}

\subsubsection{Алгебры Ли}
Линейное пространство, оснащённое билинейной кососимметрической формой, удовлетворяющей
тождеству Якоби, называется \emph{алгеброй Ли}. Сама форма в этом случае называется
\emph{скобкой Ли} или \emph{коммутатором}.

Мы показали, что $\Cb^\infty(M^{2n})$ со скобкой Пуассона есть алгебра Ли. Примерами
алгебр Ли являются также пространство матриц $n\times n$ с коммутатором $\{ A, B \} = 
BA - AB$ и $\RR^3$ со структурой векторного произведения.

\subsubsection{Связь коммутаторов функций и гамильтоновых векторных полей}
Напомним определение коммутатора векторных полей:
\begin{df}
Векторное поле $\mathbf{w} = [\mathbf{u}, \mathbf{v}]$ называется \emph{коммутатором}
векторных полей $\mathbf{u}$ и $\mathbf{v}$, если
$$
\partial_{\mathbf{\displaystyle w}} = \partial_{\mathbf{\displaystyle u}}
\partial_{\mathbf{\displaystyle v}} - \partial_{\mathbf{\displaystyle v}}
\partial_{\mathbf{\displaystyle u}}.
$$
\end{df}
Из курса дифференциальной геометрии известно, что $\mathbf{w}$ --- это действительно
векторное поле (старшие производные сокращаются).

\begin{stm}
$\vb_{\{\!H,F\!\}} = [ \vb_H, \vb_F ]$.
\end{stm}

\begin{proof}
$
\partial_{\vb_{\{\!H,F\!\}}} G = dG(\vb_{\{\!H,F\!\}}) = 
\{ \{ H, F \}, G \} = - \{ G, \{ H, F \} \} = \{ H, \{ F, G \} \} +
\{ F, \{ G, H \} \} = \{ H, \{ F, G \} \} - \{ F, \{ H, G \} \} =
\partial_{\vb_H} \partial_{\vb_F} G - \partial_{\vb_F} \partial_{\vb_H} G =
\partial_{[\vb_H, \vb_F]} G.
$
\end{proof}

\begin{imp}
Коммутатор гамильтоновых векторных полей есть гамильтоново векторное поле. Гамильтоновы
векторные поля с коммутатором образуют алгебру Ли.
\end{imp}

\subsubsection{Теорема Пуассона о первых интегралах гамильтоновых систем}
\begin{theorem}
Пусть $F$ и $G$ --- первые интегралы системы с гамильтонианом $H$. Тогда $\{ F, G \}$
--- тоже первый интеграл этой системы.
\end{theorem}

\begin{proof}
$\{ H, \{ F, G \} \} = - \{ F, \{ G, H \} \} - \{ G, \{ H, F \} \} = 0.$
\end{proof}

\begin{imp}
Первые интегралы образуют алгебру Ли.
\end{imp}

\subsection{Переменные действие -- угол}
\subsubsection{Теорема Лиувилля -- Арнольда о вполне интегрируемых системах}
\begin{df}
Функции $g$ и $h$ на $M^{2n}$ \emph{находятся в инволюции}, если $\{ g, h \} = 0$.
\end{df}

Приведём без доказательства следующее утверждение:

\begin{theorem}
Пусть у гамильтоновой системы на $(M^{2n}, \omega)$ с гамильтонианом $H$ есть $n$
первых интегралов $f_1 = H, f_2, \dots, f_n$, причём
\begin{nums}{-2}
\item $f_1, \dots, f_n$ попарно находятся в инволюции;
\item выполнены условия невырожденности (не будем уточнять, какие).
\item Пусть $c \in \RR^n$, $M_c = \{ x \in M^{2n} : f_i(x) = c_i \}$ --- многообразие
уровня $c$ (то, что это действительно многообразие, входит в условия невырожденности);
$df_1, \dots, df_n$ независимы на $M_c$. $M_c$ называется \emph{инвариантным 
многообразием}.
\item $\tilde{M_c}$ --- компактная связная компонента $M_c$.
\end{nums}

Тогда:
\begin{nums}{-2}
\item $\tilde{M_c} = T^n = S^1 \times \dots \times S^1$ ($n$-мерный инвариантный тор). На
$T^n$ можно ввести координаты $\phi_1, \dots, \phi_n \mod 2 \pi$; в этих координатах
уравнения движения имеют вид $\dot\phi_i = \omega_i = \const$ (движение ---
условно-периодическое).
\item Существует окрестность $T^n \times \RR^n$ компоненты $\tilde{M_c}$, где можно
ввести канонические координаты $\phi, I$ ($\omega_2 = dI \wedge d\phi$), в которых система
имеет вид: $H=H(I)$,
$$
\left\{\begin{aligned}
\dot\phi &= \omega(I) = \frac{\partial H}{\partial I}\\
\dot I &= 0.
\end{aligned}\right.
$$
\end{nums}
\end{theorem}

Такие системы называются \emph{вполне интегрируемыми по Лиувиллю}; $\phi$ и $I$ ---
\emph{переменные действие -- угол}.

\subsubsection{Переменные действие -- угол для систем с одной степенью свободы}
Мы приведём лишь схему вывода, не обращая внимания на мелкие детали.

Итак, $H = H(q,p)$ --- гамильтониан. Нам достаточно одного интеграла $f_1 = H$.
Невырожденность в данном случае означает $dH \ne 0$. Пусть $\gamma_h =
\{ (q,p) \mid H(q,p) = h \}$ --- линия уровня. Ориентируем $\gamma_h$ по часовой
стрелке. 

Мы хотим перейти в новые канонические координаты $\phi, I$. Положим
$$
I(h) = \frac{1}{2\pi} \int\limits_{\gamma_h} p \, dq = \frac{S(h)}{2 \pi}.
$$
Здесь $S(h)$ --- площадь внутри $\gamma_h$; второе равенство следует из формулы Грина.
Условие невырожденности: $\frac{\partial I}{\partial h} \ne 0$.

$I = I(H(q,p))$. В областях, где $\frac{\partial H}{\partial p} \ne 0$, это соотношение
можно разрешить относительно $p$, т.к. там $\frac{\partial I}{\partial p} = 
\frac{\partial I}{\partial h}{\partial H}{\partial p} \ne 0$. Заметим, что таких областей
внутри $\gamma_h$ две: они разделены линией $\{ \frac{\partial H}{\partial p} = 0\}$
(если не ясно, нарисуйте несколько вложенных $\gamma_h$ на плоскости).
Итак, $p = f_j(q,I)$, где $j = 1,2$ --- номер области (1 --- верхняя, 2 --- нижняя).

Переход к новым координатам $Q = \phi$, $P = I$ задаётся производящей функцией
$W = W(q, P)$:
$Q = \frac{\partial W}{\partial P}$, $p = \frac{\partial W}{\partial q}$.

$p = f_j(q, I) = \frac{\partial W}{\partial q}$, откуда
$$
W_j = \int f_j \, dq + C_j(I).
$$
$C_j$ подберём так, чтобы при склейке разных $j$ всё было гладко, т.е. определим
(многозначную) $W$ на всей окрестности.

$\phi = \frac{\partial W}{\partial I}$.
При обходе $\gamma_h$ $\phi$ меняется на $2\pi$:
$$
\left.\Delta \phi \right|_{\gamma_h} = 
\int\limits_{\gamma_h} \frac{\partial\phi}{\partial q} \, dq =
\int\limits_{\gamma_h} \frac{\partial^2 W}{\partial q \partial I} \, dq =
\frac{\partial}{\partial I} \int\limits_{\gamma_h} \frac{\partial W}{\partial q} \, dq =
\frac{\partial}{\partial I} \int\limits_{\gamma_h} p \, dq =
\frac{\partial (2 \pi I)}{\partial I} = 2\pi.
$$

\subsubsection{Пример: гармонический осциллятор}
Уравнение движения: $m \ddot x = -cx$ ($c > 0$).

Обозначим $k^2 = c/m$, уравнение: $\ddot x = - k^2 x$.
Лагранжиан: $L = \frac{\dot x^2}{2} - \frac{k^2 x^2}{2}$.
Гамильтониан: $H = \frac 12 p^2 + \frac 12 k^2 q^2$,
$q = x$, $p = \frac{\partial L}{\partial \dot q}$.

$\gamma_h$ --- эллипс с полуосями $a = \sqrt{2h}$, $b = \sqrt{2h / k^2}$ площади
$S(h) = \pi ab$.

$$I(h) = \frac{S(h)}{2\pi} = \frac{ab}{2} = \frac{h}{k}.$$

$$Ik = H = \frac 12 p^2 + \frac 12 k^2 q^2,
$$
откуда $p^2 = 2kI - k^2 q^2$, т.е. $p = f_{1,2} = \pm \sqrt{2kI - k^2 q^2} =
\frac{\partial W_{1,2}}{\partial q}$. Окончательно
$$
W_{1,2} = \pm \int\limits_0^q \sqrt{2kI - k^2 q^2} dq
$$
(считаем $C_j = 0$).

Далее,
$$
\phi = \frac{\partial W}{\partial I} = \int\limits_0^q \frac{k \, dq}{\sqrt{2kI - k^2 q^2}} =
\arcsin \left( \sqrt{\frac{k}{2I}} q \right),
$$
а потому
$$
\sin \phi = \sqrt{\frac{k}{2I}} q.
$$

Получаем замену
$$
\left\{
\begin{aligned}
q &= \sqrt{\frac{2I}{k}} \sin\phi\\
p &= \pm \sqrt{2kI} \cos\phi.
\end{aligned}
\right.
$$

В новых координатах система имеет вид
$$
\left\{
\begin{aligned}
\dot\phi &= k\\
\dot I &= 0.
\end{aligned}
\right.
$$

$k = \omega_1$ --- частота колебаний.


\end{document}
