\documentclass[a4paper,12pt]{article}
\usepackage[utf]{dmvn}
\newcommand{\xtrmail}{\texttt{sxtr@yandex.ru}}
\newcommand{\vb}[1]{\mathbf{\overline{#1}}}
\newcommand{\vd}[1]{\dot{\mathbf{\overline{#1}}}}
\newcommand{\vdd}[1]{\ddot{\mathbf{\overline{#1}}}}
\newcommand{\tdf}[1]{\textsl{#1}}
\newcommand{\tstm}[1]{\emph{#1}}
\newcommand{\tpic}[1]{\emph{#1}}
\newcommand{\spr}[2]{\hr{#1 \cdot #2}}
\newcommand{\myspr}[3]{\expandafter\csname#3\endcsname{#1 \cdot #2}}
\newcommand{\vpr}[2]{\hs{#1 \times #2}}
\newenvironment{nbb}{\par\vskip3pt\hrule\vskip3pt\textbf{\footnotesize Замечание наборщика.}\footnotesize }
{\vskip3pt\hrule\par\vskip3pt}
\newcommand{\eql}[2]{\begin{equation}\label{#2}#1\end{equation}}
\newcommand{\ointl}[1]{\oint\limits_{{#1}}}
\newcommand{\adot}[1]{{\widehat{{#1}}}}
\newcommand{\ti}[1]{\widetilde{{#1}}}

\renewcommand\o{\ol{\ol{o}}}

\newcommand{\bdot}{\epsfbox{pictures.13}}

\newdimen\pictureskip\pictureskip=.5pc
\newdimen\inpictureskip\inpictureskip=2pt

\def\xtrpicture#1#2{\vbox{%
\vskip\pictureskip
\centerline{\epsfbox{pictures.#1}}
\vskip\inpictureskip
\centerline{\footnotesize\normalfont\textbf{Рис.~#2}}
\vskip\pictureskip}}

\def\xtrpicturep#1#2{\vadjust{\vbox{%
\vskip.5pc
\centerline{\epsfbox{pictures.#1}}
\vskip2pt
\centerline{\footnotesize\normalfont\textbf{Рис.~#2}}
\vskip.5pc}}}


\begin{document}

\dmvntitle{Курс лекций по}{аналитической механике}{Лектор
Александр Владиленович Карапетян}{IV курс, 8 семестр, поток математиков}{Москва, 2006 г.}

\pagebreak
\tableofcontents

\pagebreak

\section*{Предисловие}

Это конспект курса лекций по аналитической механике, читаемых в~8
семестре 2005--2006 учебного года на механико-математическом
факультете МГУ. Данная редакция отличается от предыдущей большим
количеством существенных (можно сказать кардинальных)
исправлений. Большое спасибо всем тем, кто способствовал исправлению
ошибок в этом тексте (в основном Паше Наливайко).

Убирать кредиты -- это неблагодарно. Текущая версия -- адоптированная
под программу 2011--2012 годов. Часть материалов, которых нет в программе,
вынесены в \texttt{obsolete.tex} в репозитарии. Быть может, стоит как-то стандартизировать
предисловие?

\medskip

\dmvntrail

\rightline{\footnotesize Также об опечатках можно сообщать по адресу \xtrmail.}

\medskip
\section*{Программа экзамена 2011--2012 г.г}
\begin{enumerate}
\item Обобщенные координаты, обобщенные силы, кинетическая энергия и
  её свойства.
\item Уравнения Лагранжа 2-го рода и их первые интегралы.
\item Явный вид уравнений Лагранжа, движение по инерции.
\item Уравнения Рауса, игнорирование циклических переменных
\item {Неголономные системы: уравнения с неопределенными множителями}
\item {Неголономные системы Чаплыгина: уравнения Чаплыгина}
\item \textit{Конек Чаплыгина на наклонной плоскости}
\item Основные понятия теории устойчивости(устойчивость, неустойчивость,
  ассимптотическая устойчивость, уравнения возмущенного движения, функции Ляпунова и Хана)
\item Теоремы Ляпунова об устойчивости и асимптотической устойчивости.
\item Теорема Четаева о неустойчивости
\item Теорема Ляпунова об устойчивости и \textit{теорема Барбашина-Красовского об
асимптотической устойчивости для стационарных систем.}
\item \textit{Теорема Красовского о неустойчивости для стационарных систем.}
\item Линеаризация. Теорема Ляпунова об асимптотической устойчивости и неустойчивости
  по первому приближению. Критерий Рауса-Гурвица.
\item Теорема Лагранжа об устойчивости положения равновесия
  консервативной системы и понятие об её обращении
\item Влияние гироскопических и диссипативных сил на устойчивость равновесия.
\item \textit{Теорема Рауса об устойчивости стационарый движений консервативной системы с циклическими координатам и понятие о её обращении.}
\item Устойчивость треугольных точек либрации в плоской ограниченной круговой задаче трех тел.
\item \textit{Стационарные движения гантели Белецкого и их устойчивость.}
\item Принцип Гамильтона-Остроградского.
\item Принцип Мопертюи-Лагранжа-Якоби.
\item Преобразования Лежандра. Канонические переменные. Функция Гамльтона.
\item Уравнения Гамильтона и их свойства.
\item Принцип Гамильтона в форме Пуанкаре.
\item Универсальный интегральный инвариант Пуанкаре.
\item Интегральный инвариант Пуанкаре-Картана.
\item Уравнение Уиттекера.
\item Уравнения Якоби.
\item Канонические преобразования и их групповые свойства.
\item Критерий каноничности преобразования.
\item Сохранение гамильтоновой структуры при канонический преобразованиях.
\item Канонические преобразования и процесс движения. Теорема Лиувилля
  о сохранении фазового объема.
\item Свободное каноническое преобразование и его производящая
  функция. Уравнение и теорема Гамильтона-Якоби.
\item Теорема Лиувилля об интегрируемости гамильтоновых систем в квадратурах.
\item Переменные <<действие-угол>>: идея и её реализация на примере линейного осциллятора.
\item Теория возмущений: идея и реализация на примере математического
  маятника в окрестности устойчивого равновесия.
\item Переменные <<действие-угол>> для математического маятиника(колебания).
\item Переменные <<действие-угол>> для математического маятиника(вращения).
\item \textit{Математический маятник с вибрирующей точкой подвеса.}
\end{enumerate}
\section*{Обозначения}

Сразу введем несколько обозначений, которые понадобятся нам в дальнейшем:
\begin{itemize}
  \item если имеется $k$ различных величин, обозначаемых, скажем, $p_1\sco
  p_k$, мы будем иногда использовать сокращенную запись $p$,
  подразумевая их полное перечисление например, мы можем написать
  $f(\vb{r})$ вместо $f(\vb{r}_1\sco\vb{r}_n)$, не оговаривая ничего
  отдельно но только в том случае, если раньше были введены
  величины $\vb{r}_1\sco\vb{r}_n$ и не вводилась величина $\vb{r}$;
  \item в произведениях вида $a_ib^i$ то есть включающих в себя
  величины с верхним и нижним индексом одновременно, всегда
  подразумевается суммирование по этому индексу; при этом верхний
  индекс, стоящий в знаменателе, приравнивается к нижнему;
  \item скалярное произведение векторов $\vb{a}$ и $\vb{b}$ мы будем обозначать
  так:
  $\spr{\vb{a}}{\vb{b}}$;
  \item а векторное так: $\vpr{\vb{a}}{\vb{b}}$.
\end{itemize}

\pagebreak

\section{Лагранжев формализм}

\subsection{Введение}

\subsubsection{Учение о связях или принцип д'Аламбера Лагранжа}

Принцип д'Аламбера Лагранжа один из многих подходов, позволяющих
записывать уравнения движения системы точек под действием сил и
связей. Его можно считать <<первой ступенькой>> на пути к лагранжевому
формализму вот почему он открывает этот раздел. Но прежде, чем
описывать этот принцип, дадим несколько общих определений, которые
понадобятся нам в дальнейшем.

Будем рассматривать систему из $n$ материальных точек, которые мы
будем обозначать $m_i,\ i=1\sco n$. Массы этих этих точек будут
обозначаться так же, как и сами точки ($m_i$), а их радиус векторы
$\vb{r}_i$.
\begin{df}
\tdf{Удерживающей (двусторонней) связью} мы будем называть условие
на координаты и скорости точек системы вида
\eqn{\Phi(\vb{r}_1\sco\vb{r}_n,\ \vd{r}_1\sco\vd{r}_n,\ t)=0.}
\end{df}
\begin{df}
\tdf{Неудерживающей (односторонней) связью} мы будем называть
условие на координаты и скорости точек системы вида
\eqn{\Phi(\vb{r}_1\sco\vb{r}_n,\ \vd{r}_1\sco\vd{r}_n,\ t)\ge0.}
\end{df}
\begin{note}
В дальнейшем мы будем рассматривать только удерживающие связи.
\end{note}
\begin{df}
\tdf{Геометрическими} мы будем называть связи, удовлетворяющие
условию \eqn{\pf{\Phi}{\vd{r}_i}=0,\ i=1\sco n;} связи, не
удовлетворяющие этому условию, мы будем называть
\tdf{дифференциальными}.
\end{df}
\begin{df}
Связь называется \tdf{интегрируемой}, если ее можно привести к виду
\equ{\psi({\vb{r}_1\sco\vb{r}_n,\ t})=0,}
т.~е. к виду геометрической связи.
\end{df}

Таким образом, даже дифференциальная связь может являться
интегрируемой. В дальнейшем это различие будет играть принципиальную
роль.
\begin{note}
Если на систему наложено две или более дифференциальных связи, то
возможны случаи, когда каждая связь по отдельности не является
интегрируемой, но тем не менее они интегрируемы в совокупности.
\end{note}
\begin{ex}
Примером такой ситуации могут служить связи
\equ{\begin{cases}
  \dot{z}=x\dot{y},\\
  \dot{z}=\dot{x}y.
\end{cases}
}
Каждая из них в отдельности, очевидно, неинтегрируема, в то время
как вместе их можно проинтегрировать при этом получим геометрические связи
\equ{
  \begin{cases}
    2z=xy+\const,\\
    \frac{x}{y}=\const.
  \end{cases}
}
\end{ex}
\begin{df}
Геометрические и дифференциальные связи, интегрируемые в
совокупности, называют \tdf{голономными}.
\end{df}
\begin{ex}
Примером системы с неголономными связями может служить шар на
абсолютно шероховатой плоскости.
\end{ex}
\begin{note}
В дальнейшем нас будут интересовать только голономные связи.
\end{note}
\begin{nbb}
Вообще говоря, здесь следовало бы отметить, что все связи будут также предполагаться независимыми;
однако лектор об этом ничего не говорил.
\end{nbb}


Рассмотрим систему точек в пространстве с ограничениями вида
\eql{
\begin{cases}
  f_{\al}(\vb{r}_1\sco\vb{r}_n,\ t)=0, & \al=1\sco a, \\
  f_{\be}(\vb{r}_1\sco\vb{r}_n,\ \vd{r}_1\sco\vd{r}_n,\ t)=0, & \be=1\sco b,
\end{cases}
}{rel1}
то есть, фактически, отделим геометрические связи от
дифференциальных. Но на этом мы не остановимся. Уравнения первого
типа мы продифференцируем по $t$; что касается второго далее
всюду мы будем полагать, что их компоненты линейны по $\vd{r}$ и
перепишем их в соответствие с этим предположением. После этого,
домножая все на $dt$, получим систему ограничений вида
\eql{\bcase{
&\suml{i=1}{n}\spr{\pf{f_{\al}(\vb{r},t)}{\vb{r}_i}}{d\vb{r}_i}+\pf{f_{\al}(\vb{r},t)}{t}dt=0, &\al=1\sco a,\\
&\suml{i=1}{n}\spr{\vb{b}_{\be i}(\vb{r},t)}{d\vb{r}_i}+b_{\be}(\vb{r},t)dt=0,&\be=1\sco b.}
}{rel2}

\begin{df}
\tdf{Действительными перемещениями} мы будем называть траектории, удовлетворяющие соотношениям~\eqref{rel2}.
\end{df}
Полагая в \eqref{rel2} $dt=0$, получим соотношения
\eql{\bcase{
  &\suml{i=1}{n}\spr{\pf{f_{\al}(\vb{r},t)}{\vb{r}_i}}{\de\vb{r}_i}=0, &\al=1\sco a,\\
  &\suml{i=1}{n}\spr{\vb{b}_{\be i}(\vb{r},t)}{\de\vb{r}_i}=0, &\be=1\sco b.}
}{rel3}
\begin{df}
\tdf{Виртуальными перемещениями} мы будем называть траектории, удовлетворяющие соотношениям~\eqref{rel3}.
\end{df}
\begin{note}
Мы будем использовать обозначение $\de\vb{r}$ вместо $d\vb{r}$,
чтобы подчеркнуть разницу между виртуальными и действительными
перемещениями.
\end{note}
\begin{ex}
Муха ползет по надуваемому шарику. Уравнение связи:
\equ{x^2+y^2+z^2=a+bt} (считаем, что шарик надувается линейно). В
этом случае уравнения \eqref{rel2} и \eqref{rel3} будут выглядеть
так:
\equ{2x\,dx+2y\,dy+2z\,dz=b\,dt,}
\equ{2x\,\de x+2y\,\de y +2\,z\de z=0.}
Таким образом, вектор действительных перемещений имеет две составляющих: радиальную и касательную,
а вектор виртуальных перемещений имеет только касательную составляющую.
\end{ex}
\begin{note}
Нетрудно заметить, что действительные перемещения являются также и
виртуальными в том и только в том случае, когда связь стационарна:
\equ{d\vb{r}_i\in\{\de\vb{r}_i\}\Lra\pf{f_{\al}}{t}=0,\ b_{\beta}=0.}
\end{note}
Запишем аксиому освобождения от связей:
\eql{m_i\vdd{r}_i=\vb{F}_i+\vb{R}_i,\ i=1\sco n.}{rel_free}
Здесь $\vb{R}_i$ \tdf{силы реакции связей}.
\begin{df}
Связи \tdf{идеальны}, если работа сил реакции на виртуальном перемещении
равна нулю:
\eql{\suml{i=1}{n}\spr{\vb{R}_i}{\de\vb{r}_i}=0}{virt_work} для всех
$\de\vb{r}_i$, удовлетворяющего условиям \eqref{rel3}.
\end{df}
\begin{note}
В дальнейшем мы будем рассматривать только идеальные связи.
\end{note}
Подставляя \eqref{rel_free} в \eqref{virt_work}, получим, наконец,
уравнение, которое и составляет суть \tdf{принципа
д'Аламбера Лагранжа}:
\eql{\suml{i=1}{n}\spr{(-m_i\vdd{r}_i+\vb{F}_i)}{\de\vb{r}_i}=0.}{DL}

%\begin{nbb}
%Лектор, по-видимому,
%предполагает, что $3n-a-b>0$, нигде этого не оговаривая; это
%эквивалентно независимости связей, о которой также явно не упоминалось.
%\end{nbb}

Просуммируем уравнения \eqref{virt_work} и уравнения системы
\eqref{rel3}, взятые с произвольными коэффициентами $\la_{\al}$ и
$\mu_{\be}$ и с обратным знаком:
\mln{
\label{eq::rel4_base}
\suml{i=1}{n}\hr{\spr{\vb{R}_i}{\de\vb{r}_i}-
\suml{\al=1}{a}\la_{\al}\spr{\pf{f_{\al}}{\vb{r}_i}}{\de\vb{r}_i}-
\suml{\be=1}{b}\mu_{\be}\spr{\vb{b}_{\be i}}{\de\vb{r}_i}}=\\
=\suml{i=1}{n}\spr{\hr{\vb{R}_i-\suml{\al=1}{a}\la_{\al}\pf{f_{\al}}{\vb{r}_i}-
\suml{\be=1}{b}\mu_{\be}\vb{b}_{\be i}}}{\de\vb{r}_i}=0.}

Всего у нас имеется $3n$ компонент приращений $\de \vb r_i$, на
которые накладывается $a+b$ ограничений вида \eqref{rel3}. При этом мы предполагаем, что
связи у нас независимы и $a+b<3n$. Кроме того, в уравнении \eqref{eq::rel4_base}
фигурируют как раз $a+b$ свободных параметров: выбирая их подходящим образом,
мы можем обнулить коэффициенты при <<зависимых>> приращениях. Это оставляет
нам ещё $3n-(a+b)$ независимых компонент приращений, некоторая линейная
комбинация которых должна давать~$0$. Отсюда и следует равенство нулю всех её коэффициентов.

Таким образом, получаем представление для сил реакции связей:
\eql{\vb{R}_i=\suml{\al=1}{a}\la_{\al}\pf{f_{\al}}{\vb{r}_i}+\suml{\be=1}{b}\mu_{\be}\vb{b}_{\be i}.}{rel4}

Собирая воедино \eqref{rel1}, \eqref{rel2}, \eqref{rel_free} и
\eqref{rel4} получим \tdf{уравнения Лагранжа первого рода}:
\eqn{
    \bcase{
        &m_i\vdd{r}_i=\vb{F}_i+\suml{\al=1}{a}\la_{\al}\pf{f_{\al}}{\vb{r}_i}+\suml{\be=1}{b}\mu_{\be}\vb{b}_{\be i},
        &i=1\sco n,\\
        &f_{\al}(\vb{r},t)=0, &\al=1\sco a, \\
        &\ph_{\be}:=\suml{i=1}{n}\spr{\vb{b}_{\be i}(\vb{r},t)}{\vd{r}_i}+\vb{b}_{\be}(\vb{r},t)=0, &\be=1\sco b.
    }
}

\subsubsection{Вывод общих теорем динамики\\ из принципа д'Аламбера Лагранжа}

\begin{theorem}
Если связи, наложенные на систему, допускают перемещение системы как
единого целого вдоль некоторой неподвижной оси, то скорость
изменения проекции импульса системы на эту ось равна проекции
равнодействующей всех внешних сил:
\eql{\frac{d}{dt}\spr{m\vb{v}_S}{\vb{e}}=\spr{\vb{F}^{(e)}}{\vb{e}},}{th1.1}
где $\vb{v}_S$ скорость центра масс системы, $\vb{e}$ орт той
оси, вдоль которой допустимо перемещение системы, а
$\vb{F}^{(e)}=\suml{i=1}{n}\vb{F}_i^{(e)}$ равнодействующая
внешних сил.
\end{theorem}
\begin{nbb}
Напомню, что силы, действующие на точки некоторой системы принято разделять на внутренние и внешние:
\equ{\vb F_k=\vb F^{(i)}_k+\vb F^{(e)}_k.}
При этом, пользуясь вторым законом Ньютона, несложно показать, что равнодействующая внутренних сил равна нулю:
\equ{\vb F^{(i)}=\sum\vb F^{(i)}_k=0,}
более того, нулю равен главный момент внутренних сил:
\equ{\sum\vpr{\vb r_k}{\vb F^{(i)}_k}=0.}
\end{nbb}
\begin{proof}
Заметим, что $\de\vb{r}_i$ коллинеарно $\vb{e}$, то есть можно
записать \equ{\de\vb{r}_i=\vb{e}\de s,} где $s$ некоторая
скалярная переменная. Подставим это представление в принцип
д'Аламбера Лагранжа \eqref{DL}:
\eqn{
\label{eq::pf_lagr1}
\suml{i=1}{n}\spr{\hr{-m_i\vdd{r}_i+\vb{F}_i^{(e)}+\vb{F}_i^{(i)}}}{\vb{e}}\de
s=0\quad\Lra\quad \suml{i=1}{n}\spr{m_i\vdd{r}_i}{\vb{e}}=\suml{i=1}{n}\spr{\vb{F}_i^{(e)}}{\vb{e}},}
так как
\equ{\suml{i=1}{n}\spr{\vb{F}_i^{(i)}}{\vb{e}}=\spr{\hr{\suml{i=1}{n}\vb{F}_i^{(i)}}}{\vb{e}}=0.}
Вначале разберемся с правой частью равенства \eqref{eq::pf_lagr1}:
\equ{\suml{i=1}{n}\spr{\vb{F}_i^{(e)}}{\vb{e}}=\hr{\hr{\suml{i=1}{n}\vb{F}_i^{(e)}}\cdot\vb{e}}=\spr{\vb{F}^{(e)}}{\vb{e}}.}
А теперь с левой:
\equ{\suml{i=1}{n}\spr{m_i\vdd{r}_i}{\vb{e}}=\hr{\frac{d}{dt}\hr{\suml{i=1}{n}m_i\vd{r}_i}\cdot\vb{e}}=\spr{m\vd{v}_S}{\vb{e}}=\frac{d}{dt}\spr{m\vb{v}_S}{\vb{e}}.}
Остается заметить, что мы получили соответственно правую и левую
части доказываемого равенства \eqref{th1.1}.
\end{proof}
\begin{note}
Из только что доказанной теоремы очевидным образом следует такой
факт: если связи допускают перемещение системы как единого целого
вдоль \tdf{трех} неподвижных некомпланарных осей, то
\equ{m\vd{v}_S=\vb{F}^{(e)}.}
\end{note}

\begin{nbb}
Напомним, что кинетическим моментом системы относительно точки $O$ называется величина
\eqn{\vb K_O := \suml{i=1}{n} \vpr{\vb r_i}{m_i\vd r_i},}
при этом в качестве начала координат выбирается точка $O$.
\end{nbb}


\begin{theorem}
Если связи, наложенные на систему, допускают поворот системы как
единого целого вокруг неподвижной оси, то скорость изменения
проекции кинетического момента системы на эту ось равна проекции
главного момента внешних сил:
\eql{\frac{d}{dt}\spr{\vb{K}_O}{\vb{e}}=\spr{\vb{M}_O^{(e)}}{\vb{e}},}{th1.2}
где
\equ{\vb{M}_O^{(e)}=\suml{i=1}{n}\vpr{\vb{r}_i}{\vb{F}_i^{(e)}},} а
$\vb{e}$ орт оси вращения.
\end{theorem}
\begin{proof}
В этом случае $\de\vb{r}_i$ коллинеарно $\vpr{\vb{e}}{\vb{r}_i}$,
то есть \equ{\de\vb{r}_i=\vpr{\vb{e}}{\vb{r}_i}\de\ph.} Вновь
подставляем в \eqref{DL}:
\equ{\suml{i=1}{n}\spr{m_i\vdd{r}_i}{\vpr{\vb{e}}{\vb{r}_i}}=\suml{i=1}{n}\spr{\vb{F}_i}{\vpr{\vb{e}}{\vb{r}_i}}.}
Циклически переставим аргументы в обеих частях равенства:
\equ{\suml{i=1}{n}\spr{\vb{e}}{\vpr{\vb{r}_i}{m_i\vdd{r}_i}}=\suml{i=1}{n}\spr{\vb{e}}{\vpr{\vb{r}_i}{\vb{F}_i}}.}
Осталось лишь вынести $\vb{e}$ за знак суммы, воспользоваться тем, что главный момент внутренних сил равен нулю, и получить доказываемое
равенство \eqref{th1.2}.
\end{proof}

\begin{theorem}
Если связи, наложенные на систему, являются стационарными, то
дифференциал кинетической энергии системы равен работе всех заданных
сил на действительном перемещении. То есть, если
\equ{d\vb{r}_i\in\{\de\vb{r}_i\},} то
\eql{dT:=\suml{i=1}{n}\spr{m_i\vdd r_i}{d\vb r_i}=\suml{i=1}{n}\spr{\hr{\vb{F}_i^{(e)}+\vb{F}_i^{(i)}}}{d\vb{r}_i}.}{th1.3}
\end{theorem}
\begin{proof}
Нужно просто подставить $\de\vb{r}_i=d\vb{r}_i$ в \eqref{DL}:
\equ{\suml{i=1}{n}\spr{(-m_i\vdd r_i+\vb F_i)}{d\vb r_i}=0,}
перенести слагаемые $m_i\vdd r_i$ в другую часть равенства и вспомнить, что $\vb F_i = \vb{F}_i^{(e)}+\vb{F}_i^{(i)}$.
\end{proof}

\subsection{Уравнения Лагранжа второго рода}

\subsubsection{Обобщенные координаты}

Мы рассмотрим случай, когда на систему наложены только
геометрические связи:
\eql{f_{\al}(\vb{r}_1\sco\vb{r}_n,t)=0,\quad\al=1\sco a.}{rel_geom}
При этом мы будем полагать, что связи эти
удовлетворяют следующим условиям:
\begin{nums}{-2}
\item гладкость то есть функции $f_{\al}$ предполагаются гладкими (дифференцируемыми столько раз, сколько потребуется);
\item независимость то есть предполагается, что ранг матрицы, составленной из частных производных
$\pf{f_{\al}}{\vb{r}_i}$, равен
$a$: \equ{\rk{\hr{\pf{f_{\al}}{\vb{r}_i}}_{\al i}}=a;}
\item идеальность то есть работа связей на виртуальном перемещении равна нулю.
\end{nums}
\begin{nbb}
Следует понимать, что, когда речь идёт о матрице частных производных $\pf{f_{\al}}{\vb r_i}$,
её размер равен $a\times 3n$, если расписать векторные компоненты покоординатно.
Каждая её компонента с номером~$\al i$ имеет вид:
\equ{\pf{f_{\al}}{\vb r_i}=\hr{\pf{f_{\al}}{\vb r_i^1},\pf{f_{\al}}{\vb r_i^2},\pf{f_{\al}}{\vb r_i^3}}.}
\end{nbb}
\begin{df}
\tdf{Конфигурационным пространством} системы, на которую наложены
геометрические связи, удовлетворяющие свойствам 1 и 2, называют
подмногообразие в пространстве $\R^{3n}$, задаваемое уравнениями
\eqref{rel_geom}.
\end{df}

Заметим, что свойства 1 и 2 дают нам возможность утверждать, что
конфигурационное пространство будет гладким многообразием
размерности $m=3n-a$.\vadjust{\vbox{\vskip\pictureskip%
\hbox to \textwidth{\hfil\epsfbox{pictures.2}\hfil\hfil\epsfbox{pictures.3}\hfil\hfil\epsfbox{pictures.4}\hfil}
\vskip\inpictureskip
\hbox to \textwidth{\footnotesize\textbf{\hfil Рис. 1\hfil\hfil Рис. 2\hfil\hfil Рис. 3\hfil}}
\vskip\pictureskip}}
Вот примеры конфигурационных пространств некоторых широко известных
механических систем:
\begin{nums}{-2}
\item математический маятник:
конфигурационное пространство -- просто
окружность $M^1=S^1$ (\tpic{рис.~1});
\item в случае двойного маятника
конфигурационное пространство есть тор:
$M^2=\T^2$ (\emph{рис. 2});
\item у сферического маятника $M^2=S^2$ (\emph{рис. 3});
\item в случае твердого тела с одной
неподвижной точкой конфигурационное
пространство $M^3=\SO(3)$.
\end{nums}

\begin{df}
\tdf{Обобщенными координатами} $q=(q^1\sco q^m)$ будем называть
локальные координаты на конфигурационном пространстве.
\end{df}

Очевидно, мы можем записать $\vb{r}_i=\vb{r}_i(q^1\sco q^m,\ t)$.
\begin{note}
Индексы были поставлены вверху не случайно. Позже мы этим
воспользуемся, дабы лишний раз не писать знак суммирования.
\end{note}
\begin{note}
От абсолютных координат к обобщенным можно перейти всегда, а вот
обратное, вообще говоря, неверно. Примером могут служить обобщенные
координаты $\ph,\ \psi$ на $S^2$ (сфере): нам никак не справиться с
особенностью в полюсах.
\end{note}

\begin{nbb}
Кроме того, лектор высказал утверждение, что на $S^1$ такой
проблемы не возникает, что не вполне понятно: ни на $S^1$, ни на $S^2$
не существует глобального атласа из одной карты. Другое дело, что в случае окружности
можно хотя бы использовать координату $\ph$ (длину дуги), опущенную с накрывающей~$\R$.
\end{nbb}

\begin{note}
Следует отметить, что обобщенные координаты могут иметь весьма
неожиданную размерность. К примеру, в случае маятника
(конфигурационное пространство окружность) в качестве обобщенной
координаты можно ввести не угол отклонения радиус вектора от
вертикали, как это делается обычно, а площадь сектора между этой
вертикалью и радиус вектором, взятую с соответствующим углу знаком.
Размерность будет $\text{м}^2$.
\end{note}

Дифференцируя $\vb{r}_i(q,t)$ по $t$ как сложную функцию, получим
формулу для скоростей в обобщенных координатах:
\eql{\vd{r}_i=\pf{\vb{r}_i}{q^j}\dot{q}^j+\pf{\vb{r}_i}{t}.}{speed_gen}
Для виртуальных перемещений получим (умножая предыдущую формулу на
$dt$, а потом полагая $dt=0$):
\eql{\de\vb{r}_i=\pf{\vb{r}_i}{q^j}\de q^j.}{virt_gen}

\begin{note}
Если на систему наложены только геометрические связи, то $\de
q^1\sco\de q^m$ независимы.
\end{note}

\begin{note}
Кратко поясним, что делать в случае, если имеются также
дифференциальные связи: $\ph_{\be}(\vb{r},\vd{r},t)=0,\ \be=1\sco
b$. На время <<забываем>> о них и вводим обобщенные координаты $q$,
а затем переписываем уравнения дифференциальных связей в виде
$\Ph_{\be}(q,\dot{q},t)=0$. В этом случае число степеней свободы
системы равно $m-b$, а $\de q$, конечно, уже не являются
независимыми: они удовлетворяют соотношениям
\equ{\pf{\Ph_{\be}}{\dot{q}^j}\de q^j=0.}
\end{note}

До сих пор мы не пользовались предположением об идеальности
накладываемых на систему связей. Из него, конечно, следует
выполнение принципа д'Аламбера Лагранжа \eqref{DL}.

\begin{df}
\tdf{Кинетическая энергия} системы
\equ{T=\frac{1}{2}\suml{i=1}{n}m_i\vd{r}_i^2=T(q,\dot{q},t).} Такое
представление возможно в силу \eqref{speed_gen}.
\end{df}
\begin{df}
\tdf{Обобщенные силы}
\equ{Q_j=\suml{i=1}{n}\spr{\vb{F}_i}{\pf{\vb{r}_i}{q^j}}=Q_j(q,\dot{q},t).}
\end{df}

\subsubsection{Вывод уравнений Лагранжа}

При доказательстве следующей теоремы нам понадобится одна полезная
лемма.
\begin{lemma} Имеют место соотношения
\equ{\pf{\vd{r}_i}{\dot{q}^j}=\pf{\vb{r}_i}{q^j}, \quad
\frac{d}{dt}\pf{\vb{r}_i}{q^j}=\pf{\vd{r}_i}{q^j}.}
\end{lemma}
\begin{proof}
Первое соотношение следует непосредственно из \eqref{speed_gen}. Чтобы убедиться в справедливости второго соотношения,
придётся долго дифференцировать:
\equ{\frac{d}{dt}\pf{\vb{r}_i}{q^j}=
\frac{\pd^2\vb{r}_i}{\pd q^k \pd q^j}\dot{q}^k+\frac{\pd^2\vb{r}_i}{\pd t \pd q^j}\stackrel!=
\frac{\pd^2\vb{r}_i}{\pd q^j \pd q^k}\dot{q}^k+\frac{\pd^2\vb{r}_i}{\pd q^j \pd t}=
\pf{}{q^j}\hr{\pf{\vb{r}_i}{q^k}\dot{q}^k+\pf{\vb{r}_i}{t}}\stackrel{!!}=
\pf{\vd{r}_i}{q^j}.} Меняя в <<!>> порядок
дифференцирования, мы воспользовались гладкостью, а при переходе <<!!>> равенством
\eqref{speed_gen}.
\end{proof}

\begin{theorem}[уравнения Лагранжа второго рода]
Действительные перемещения системы удовлетворяют следующим
соотношениям:
\eql{\frac{d}{dt}\pf{T}{\dot{q}^j}-\pf{T}{q^j}=Q_j, j=1\sco m.}{L2}
\end{theorem}
\begin{proof}
Подставим соотношение \eqref{virt_gen} в принцип д'Аламбера-Лагранжа \eqref{DL} и раскроем все по линейности:
\equ{\hr{\suml{i=1}{n}\spr{-m_i\vdd{r}_i}{\pf{\vb{r}_i}{q^j}}+\suml{i=1}{n}\spr{\vb{F}_i}{\pf{\vb{r}_i}{q^j}}}\de
q^j=0.} Пользуясь тем, что $\de q^j$ независимы, можем записать
\equ{\suml{i=1}{n}\spr{-m_i\vdd{r}_i}{\pf{\vb{r}_i}{q^j}}+\suml{i=1}{n}\spr{\vb{F}_i}{\pf{\vb{r}_i}{q^j}}=0,\
j=1\sco m.} Вспоминая определение обобщенных сил, запишем
\equ{\suml{i=1}{n}\spr{\vb F_i}{\pf{\vb{r}_i}{q^j}}=Q_j.} Таким образом, осталось показать,
что первое слагаемое полученного равенства (взятое с обратным знаком) совпадает с левой частью \eqref{L2}. Тут-то мы и
воспользуемся только что доказанной леммой. Итак,
\ml{\suml{i=1}{n}\spr{m_i\vdd{r}_i}{\pf{\vb{r}_i}{q^j}}=
\frac{d}{dt}\suml{i=1}{n}\myspr{m_i\vd{r}_i}{\ub{\pf{\vb{r}_i}{q^j}}}{bbr}-
\suml{i=1}{n}\myspr{m_i\vd{r}_i}{\ub{\frac{d}{dt}\pf{\vb{r}_i}{q^j}}}{bbr}
\stackrel!=\\
\stackrel!=\frac{d}{dt}\suml{i=1}{n}\spr{m_i\vd{r}_i}{\pf{\vd{r}_i}{\dot{q}^j}}-\suml{i=1}{n}\spr{m_i\vd{r}_i}{\pf{\vd{r}_i}{q^j}}
=\frac{d}{dt}\pf{}{\dot{q}^j}\hr{\frac{1}{2}\suml{i=1}{n}m_i\vd{r}_i^2}-\pf{}{q^j}\hr{\frac{1}{2}\suml{i=1}{n}m_i\vb{r}_i^2}.}
В переходе <<!>> мы воспользовались леммой.
Остается вспомнить определение кинетической энергии и понять, что все доказано.
\end{proof}
\begin{note}
Если заданные силы не зависят от скоростей, то есть
\equ{\vb{F}_i=\vb{F}_i(\vb{r}_1\sco\vb{r}_n,t)}
и потенциальны, то есть
\equ{\vb{F}_i=-\pf{W(\vb{r}_1\sco\vb{r}_n,t)}{\vb{r}_i},}
то обобщенные силы также потенциальны: \equ{Q_j=-\pf{V(q,t)}{q^j},} где
\equ{V=W(\vb{r}(q,t),t).} Уравнения Лагранжа в этом случае принимают
вид \eql{\frac{d}{dt}\hr{\pf{L}{\dot{q}^j}}-\pf{L}{q^j}=0,}{L2'} где
$L=T-V$ \tdf{функция Лагранжа}.
\end{note}

\subsubsection{Структура кинетической энергии}

\begin{stm}
\label{kin_en_rep}
Кинетическую энергию можно представить в виде
\equ{T(\dot{q},q,t)=T_2+T_1+T_0,} где
\equ{\begin{aligned}
  T_2&=\frac{1}{2}a_{jk}(q,t)\dot{q}^j\dot{q}^k\text{ --- квадратичная форма},
  &&a_{jk}=\suml{i=1}{n}m_i\spr{\pf{\vb{r}_i}{q^j}}{\pf{\vb{r}_i}{q^k}};\\
  T_1&=a_j(q,t)\dot{q}^j\text{ --- линейная форма}, &&a_j=\suml{i=1}{n}m_i\spr{\pf{\vb{r}_i}{q^j}}{\pf{\vb{r}_i}{t}};\\
  T_0&=a_0(q,t), &&a_0=\frac{1}{2}\suml{i=1}{n}m_i\hr{\pf{\vb{r}_i}{t}}^2.
\end{aligned}}
Кроме того, $T_2>0$ при всех $q$, таких что $\dot{q}\neq0.$
\end{stm}
\begin{proof}
Чтобы убедиться в корректности такого представления, достаточно
подставить \eqref{speed_gen} в определение кинетической энергии. А
вот положительность $T_2$ следует, с одной стороны, из того, что
\equ{T_2=\frac{1}{2}\suml{i=1}{n}m_i\spr{\pf{\vb{r}_i}{q^j}}{\dot q^j}^2\ge0,} а с другой стороны, в
силу независимости $q^j$, векторы $\pf{\vb{r}_i}{q}$ линейно независимы, поэтому
\equ{T_2=0\quad\Lra\quad\pf{\vb{r}_i}{q^j}\dot{q}^j=0\quad\Lra\quad\dot{q}^j=0.}
Утверждение доказано.
\end{proof}
\begin{imp}
Если обобщенные силы потенциальны, то есть
\equ{Q_j=-\pf{V}{q^j},} то
функция Лагранжа может быть представлена в виде \equ{L=L_2+L_1+L_0,}
где $L_2=T_2,\ L_1=T_1,\ L_0=T_0-V.$
\end{imp}
\begin{imp} Если заданные силы потенциальны и не зависят от
скоростей (то есть уравнения Лагранжа имеют вид \eqref{L2'}), то
\equ{\frac{d}{dt}\hr{L_2-L_0}=-\pf{L}{t}.}
\end{imp}
\begin{proof}
Умножая $j$ е уравнение системы \eqref{L2'} на $\dot{q}^j$ и
суммируя по $j$, получим
\ml{0=\dot{q}^j\frac{d}{dt}\pf{L}{\dot{q}^j}-\dot{q}^j\pf{L}{q^j}=
\frac{d}{dt}\hr{\dot{q}^j\pf{L}{\dot{q}^j}}-\pf{L}{\dot{q}^j}\ddot{q}^j-\pf{L}{q^j}\dot{q}^j-\pf{L}{t}+\pf{L}{t}=\\
=\frac{d}{dt}\hr{\dot{q}^j(a_{jk}\dot{q}^k + a_j)} - \frac{d}{dt}L + \pf{L}{t}
=\frac{d}{dt}\hr{2L_2+L_1}-\frac{d}{dt}\hr{L_2+L_1+L_0}+\pf{L}{t}.}
\hfill\end{proof}
\begin{imp}
Если функция Лагранжа не зависит от времени, то уравнения
\eqref{L2'} допускают первый интеграл: \equ{\pf{L}{t}=0\quad\Ra\quad
L_2-L_0=\const,} называемый \tdf{обобщенным интегралом энергии} или
\tdf{интегралом Пенлеве.}
\end{imp}
\begin{note}
Если связи не зависят от времени, а силы консервативны (то есть
потенциальны и не зависят от времени), то $T=T_2,\ L_0=-V,\ L_2=T$,
и обобщенный интеграл энергии превращается в обычный: $T+V=\const.$
\end{note}

\subsubsection{Разрешимость уравнений Лагранжа\\ относительно старших производных}

\begin{theorem}
Уравнения Лагранжа разрешимы относительно старших (то есть вторых)
производных.
\end{theorem}
\begin{proof}
Перепишем уравнения Лагранжа:
\equ{\frac{d}{dt}\pf{T}{\dot{q}^s}-\pf{T}{q^s}=Q_s(\dot{q},q,t).} А
теперь будем преобразовывать их левую часть, пользуясь утверждением
\ref{kin_en_rep}. Во-первых, \equ{\pf{T}{\dot{q}^s}=a_{sj}\dot{q}^{j}+a_s.}
Дифференцируем это равенство по $t$:
\equ{\frac{d}{dt}\pf{T}{\dot{q}^s}=a_{sj}\ddot{q}^{j}+\pf{a_{sj}}{q^k}\dot{q}^k\dot{q}^j+\pf{a_{sj}}{t}\dot{q}^j+\pf{a_s}{q^k}\dot{q}^k+\pf{a_s}{t}.}
\begin{nbb}
На самом деле уже всё доказано: мы выделили старшую производную, и остаётся только перенести её
в левую часть, а всё остальное в правую. Далее мы просто приводим это дифференциальное уравнение
к системе уравнений первого порядка.
\end{nbb}
Теперь перейдем ко второму слагаемому:
\equ{\pf{T}{q^s}=\frac{1}{2}\pf{a_{kj}}{q^s}\dot{q}^k\dot{q}^j+\pf{a_k}{q^s}\dot{q}^k+\pf{a_0}{q^s}.}
Наконец, выпишем еще одно очевидное тождество
\equ{\pf{a_{sj}}{q^k}\dot{q}^k\dot{q}^j=\frac{1}{2}\hr{\pf{a_{sj}}{q^k}+\pf{a_{sk}}{q^j}}\dot{q}^k\dot{q}^j.}
Собирая все это воедино, мы можем переписать уравнения
Лагранжа в следующей форме: \equ{a_{sj}\ddot{q}^j=F_s(\dot{q},q,t),}
где
\equ{F_s=\frac{1}{2}\hr{\pf{a_{kj}}{q^s}-\pf{a_{sj}}{q^k}-\pf{a_{sk}}{q^j}}\dot{q}^k\dot{q}^j+\hr{\pf{a_k}{q^s}-\pf{a_s}{q^k}}\dot{q}^k+
Q_s-\pf{a_s}{t}-\pf{a_{sj}}{t}\dot{q}^j+\pf{a_0}{t}.} Теперь
остались детали. Введем матрицу $(a^{rs})$, обратную матрице
$(a_{sj})$, то есть такую, что $a^{rs}a_{sj}=\delta^r_j$ и величины
$F^r=a^{rs}F_s$. Тогда наше уравнение можно переписать в виде
системы ОДУ
\equ{\begin{cases}
\dot{q}^r=v^r, \\
\dot{v}^r=F^r(q,v,t).
\end{cases}}
Видно, что эти уравнения разрешены относительно вторых производных.
\end{proof}

\subsubsection{Уравнения Лагранжа для подвижной системы координат}
\label{ref:moving-system}
Пусть $Oxyz$ неподвижная система координат, $S\xi\eta\zeta$
подвижная. Введем следующие обозначения: $\vb{r}_i$, как обычно, радиус векторы
точек $m_i$  в неподвижной системе,
$\vb{\rho}_i$ их радиус векторы в подвижной системе координат,
$\vb{r}_S$ радиус вектор начала подвижной системы координат
(относительно неподвижной), наконец, $\vb{v}_i$ это их скорости
в неподвижной системе координат. Теперь можно записать формулы перехода
\equ{\vb{r}_i=\vb{r}_S+\vb{\rho}_i(q,t),\
\vb{v}_i=\vb{v}_S+\frac{d\vb{\rho}_i}{dt}=
\vb{v}_S+\vpr{\vb{\om}}{\vb{\rho}_i}+\vd{\rho}_i,}
причём точка в последнем равенстве означает дифференцирование по
времени относительно подвижной системы координат.

Отсюда следует, что при
переходе к подвижной системе координат представление для
кинетической энергии в виде $T=T_2+T_1+T_0$ остается в силе.
Это позволяет записать уравнения Лагранжа для подвижной системы координат\footnote{Нужно проделать ещё некоторое количество выкладок,
чтобы в этом убедиться. Возможно, они будут приведены позже. \emph{Прим. наб.}}.


\subsection{Уравнения Рауса}

До сих пор мы рассматривали фазовые переменные вида $q^1\sco
q^m,\dot{q}^1\sco \dot{q}^m$. Посмотрим, что можно получить,
перейдя\footnote{Впервые это предложил сделать Раус (E.\,Routh).} от них к
переменным $q^1\sco q^m,\dot{q}^1\sco\dot{q}^{\ka},p_{\ka+1}\sco
p_m,$ где переменные $p_\al$ определяются так:
\eql{p_{\al}=\pf{T}{\dot{q}^{\al}}=a_{\al
r}\dot{q}^r+a_{\al\be}\dot{q}^{\be}.}{rauss_var}
\begin{note}
Индексация переменных здесь такова: $j,k=1\sco m,\ r,s=1\sco \ka$ и (в отличие от предыдущих разделов!)
$\al,\be=\ka+1\sco m$.
\end{note}
<<Недостающие>> старые координаты находятся из системы
\eql{\dot{q}^{\al}=a^{\al\be}\hr{p_{\be}-a_{\be
s}\dot{q}^s},}{var_trans_rauss} где величины $a^{\al\be}$ есть
элементы матрицы, обратной к $(a_{\al\be})$, то есть
$a^{\al\be}a_{\be\ga}=\de_{\ga}^{\al}.$ Ясно, что такая система
всегда разрешима (её матрица является угловым минором положительно определённой квадратичной формы).

\begin{df}
\tdf{Функцией Рауса} называется функция вида
\eql{R=L-p_{\al}\dot{q}^{\al}=R(q^1\sco
q^m,\dot{q}^1\sco\dot{q}^{\ka},p_{\ka+1}\sco p_{m}),}{rauss} где
$L=T-V$ --- функция Лагранжа.
\end{df}
\begin{stm}
Функция Рауса представима в виде \equ{R=R_2+R_1+R_0,} где
\begin{itemize}
    \item $R_2=\frac{1}{2}b_{rs}(q)\dot{q}^r\dot{q}^s,\
    b_{rs}=a_{rs}-a^{\al\be}a_{\al r}a_{\be s}$;
    \item $R_1=b_r(q,p)\dot{q}^r,\ b_r=-a_{r\al}a^{\al\be}p_{\be};$
    \item $R_0=-W,\ W=V+\frac{1}{2}a^{\al\be}p_{\al}p_{\be}.$
\end{itemize}
Величина $W$ называется \tdf{приведенной потенциальной энергией}.
\end{stm}
\begin{proof}
На всякий случай не поленюсь и приведу опущенные лектором выкладки:
\ml{R=T-V-p_{\al}\dot{q}^{\al}=\frac{1}{2}a_{jk}\dot{q}^j\dot{q}^k-p_{\al}a^{\al\be}\hr{p_{\be}-a_{\be
s}\dot{q}^s}-V=\\
=\frac{1}{2}a_{rs}\dot{q}^r\dot{q}^s+\frac{1}{2}a_{\al\be}\dot{q}^{\al}\dot{q}^{\be}-p_{\al}a^{\al\be}\hr{p_{\be}-a_{\be
s}\dot{q}^s}-V=\\
=\frac{1}{2}a_{rs}\dot{q}^r\dot{q}^s+\frac{1}{2}a_{\al\be}a^{\al\be}a^{\be\al}(p_{\be}-a_{\be
s}\dot{q}^s)(p_{\al}-a_{\al
r}\dot{q}^r)-p_{\al}a^{\al\be}\hr{p_{\be}-a_{\be
s}\dot{q}^s}-V=\\=\frac{1}{2}a_{rs}\dot{q}^r\dot{q}^s-\frac{1}{2}a^{\al\be}p_{\al}(p_{\be}-a_{\be
s}\dot{q}^s)-\frac{1}{2}a_{\al r}a^{\al\be}\dot{q}^r(p_{\be}-a_{\be
s}\dot{q}^s)-V=\\ =\frac{1}{2}\underbrace{\br{a_{rs}-a^{\al\be}a_{\al
r}a_{\be
s}}}_{b_{rs}}\dot{q}^r\dot{q}^s\underbrace{-\br{\frac{1}{2}a_{\al
s}a^{\al\be}p_{\be}\dot{q}^s+\frac{1}{2}a_{\al
r}a^{\al\be}p_{\be}\dot{q}^r}}_{b_r\dot{q}^r}-\underbrace{\br{V+\frac{1}{2}a^{\al\be}p_{\al}p_{\be}}}_{W}.}
\hfill\end{proof}
\begin{theorem}[Уравнения Рауса]
\eql{
  \bcase{
         &\frac{d}{dt}\pf{R}{\dot{q}^r}-\pf{R}{q^r}=0, & r=1\sco\ka; \\
         &\dot{q}^{\al}=-\pf{R}{p_{\al}},\ \dot{p}_{\al}=\pf{R}{q^{\al}}, & \al=\ka+1\sco m.
       }
}{eq_rauss}
\end{theorem}
\begin{proof}
Следует из уравнений Лагранжа \eqref{L2'} и определения функции
Рауса \eqref{rauss}.
\end{proof}

\subsubsection{Циклические координаты}

\begin{df}
Координата $q^{\al}$ называется циклической, если от неё не зависит
функция Лагранжа, то есть
\equ{\pf{L}{q^{\al}}=0.}
Координаты, не являющиеся циклическими, называются \tdf{позиционными}.
\end{df}
\begin{stm}
\label{cycle_coord}
Если $q^{\al}$ циклическая координата, то
$p_{\al}=c_{\al}=\const$ (так называемый \tdf{циклический интеграл}).
\end{stm}
\begin{proof}
Подставим определение $p_{\al}$ \eqref{rauss_var} в уравнения Лагранжа:
\equ{\frac{d}{dt}p_{\al}=\frac{d}{dt}\pf{T}{\dot{q}^{\al}}=\pf{L}{q^{\al}}=0,}
то есть $p_\al$ постоянна на траекториях системы.
\end{proof}
\begin{df}
Система называется \tdf{приведенной по Раусу}, если для всех $\al$,
таких, что координата $q^{\al}$ циклическая, и только для них,
вместо фазовых координат $\dot{q}^{\al}$ взяты координаты~$p_{\al}$.
\end{df}
Уравнения \eqref{eq_rauss} для такой системы имеют вид
\eql{\bcase{
&\frac{d}{dt}\pf{R}{\dot{q}^r}-\pf{R}{q^r}=0 \\
&\dot{q}^{\al}=-\pf{R}{p_{\al}},\\
&\dot{p}_{\al}=0.
}
}{eq_rauss'} Первая часть этих уравнений замкнута относительно
$q^r$. Можно переписать ее в следующем виде (пользуясь
представлением $R=R_2+R_1+R_0$):
\equ{\frac{d}{dt}\pf{R_2}{\dot{q}^r}-\pf{R_2}{q^r}+
\ub{\hr{\frac{d}{dt}\pf{R_1}{\dot{q}^r}-\pf{R_1}{q^r}}}_{g_{rs}\dot{q}^s}+\pf{W}{q^r}=0.}
При этом элементы кососимметрической матрицы $(g_{rs})$ задаются
следующим образом: \equ{g_{rs}=\pf{b_r}{q^s}-\pf{b_s}{q^r},} а $W$
приведенная потенциальная энергия.
В самом деле, $R_1 = b_r \dot q^r$,
поэтому
\equ{\frac{d}{dt}\pf{R_1}{\dot q^r} = \frac{d}{dt} b_r = \pf{b_r}{q^s}\dot q^s \quad\text{и}\quad
\pf{R_1}{q^r} = \pf{b_s}{q^r}{\dot q^s.}}

\begin{df}
Состояние $q_0^r$ называется \tdf{положением равновесия} приведённой системы~\eqref{eq_rauss'}, если
\equ{q^r=q^r_0,\ \dot{q}^r=0,\ \pf{W}{q^r}\evu{q=q_0}{12pt}{1.4pc}=0.}
\end{df}

\begin{df}
Положениям равновесия приведенной системы соответствуют
\tdf{стационарные движения} исходной системы:  подставляя
$q^r=q^r_0$ в \eqref{eq_rauss'}, получаем уравнения этих
движений\equ{q^r=q^r_0,\ \dot{q}^r=0,\
\dot{q}^{\al}=\dot{q}^{\al}_0,\ q^{\al}=q_0^{\al}+\dot{q}_0^{\al}(t-t_0).}
\end{df}

\begin{note}
Непосредственно из \eqref{var_trans_rauss} получаем
\equ{\dot{q}^{\be}=a^{\be\ga}c_{\ga},} где константы $c_{\ga}$ те
самые, которые определяются в \tstm{утверждении~\ref{cycle_coord}}. Таким
образом, стационарные движения образуют семейства, параметризованные
константами циклических интегралов.
\end{note}

Теперь, как и в случае обыкновенных положений равновесия, сделаем
замену $x^r=q^r-q^r_0$ и выпишем уравнения малых колебаний в
окрестности положения равновесия приведенной системы. Все вычисления
будем сразу проводить с точностью до $\o(x^2+\dot{x}^2).$ Итак,
\equ{R_1=b_r(q_0+x)\dot
x^r=b_r(q_0)\dot{x}^r+\hr{\pf{b_r}{q_0^s}}x^s\dot x^r.} Так будет
выглядеть $R_1$, а сами уравнения движения будут такими:
\equ{b_{rs}^0\ddot{x}^s+g^0_{rs}\dot{x}^s+c^0_{rs}x^s=0, \quad r=1\sco k,}
где
\equ{b^0_{rs}=b_{rs}(q^0),\quad g_{rs}^0=g_{rs}(q_0),\quad
c_{rs}^0=\frac{\pd^2W}{\pd q^r \pd q^s}\evu{q=q_0}{12pt}{1.4pc}.}
Можно переписать их в матричном виде:
\equ{B\ddot{x}+G\dot{x}+Cx=0.}
По сравнению со случаем обычного положения равновесия здесь
добавилась кососимметрическая матрица $G$ матрица так называемых
\tdf{гироскопических сил}. <<Нормальным>> в этом случае называют
следующий вид этих уравнений: \equ{\ddot{\xi}+\Ga\dot{\xi}+K\xi=0,}
где $K$ определяется так же, как и в случае обыкновенного положения
равновесия, а вот матрица~$\Ga$, конечно, уже не будет диагональной.
\subsection{Неголономные системы}
\subsubsection{Уравнения с неопределенными множителями}
\begin{petit}
  Параграф одолжен из книжки лектора. Книжка вообще неплохая\dots
\end{petit}
Пусть на систему наложены, помимо геометрических связей, линейные
дифференциальные связи. Временно забывая про дифференциальные связи, вводим
обобщенные координаты $\bar q = (q_1\sco q_n)$:
\begin{displaymath}
  \bar r = \bar r(\bar q, t)
\end{displaymath}
Виртуальные перемещения $\de q_j$  удовлетворяют равенствам
\begin{displaymath}
  \sumiun a_{li}\de q_i = 0, \quad l = 1\sco m
\end{displaymath}
Согласно принципу Даламбера-Лагранжа в обобщенных координатах для
любых виртуальных перемещений должно выполнятся
\begin{displaymath}
  \sumiun \hr{-\pf{}{dt}\pf{T}{\dot q_i} + \pf{T}{q_i} + Q_i}\de q_i = 0
\end{displaymath}
где $T$ -- кинетическая энергия системы в обобщенных координатах; $Q_i$ -- обобщенные силы:
\begin{displaymath}
  T = T(\bar q, \dot{\bar q}, t), \quad Q_i = Q_i(\bar q, \dot{\bar q}, t)
\end{displaymath}
\begin{petit}
  Что это за принцип, неплохо было бы написать
\end{petit}
По правилу множителей Лагранжа,  найдутся
числовые функции $\la_\mu(t)$, $\mu = 1\sco m$ (Множители Лагранжа), для которых
\begin{equation}
\label{diff:lagr}
\frac{d}{dt}\pf{T}{\dot q_j} = \pf{T}{q_j} + Q_j + \sum_{\mu=1}^m \la_\mu a_{\mu j}, \quad j = 1\sco n
\end{equation}
Полученное уравнение совместно с условиями дифференциальных связей
замкнуты относительно $n+m$ переменных $q_1\sco q_n$, $\la_1\sco \la_m$.

Если силы потенциальны, т.е $\displaystyle Q_i = -\pf{V(\bar q)}{q_i}$, то уравнение переписывается
в более компактной форме
\begin{equation}
  \frac{d}{dt}\pf{L}{\dot q_j} - \pf{L}{q_j} = \sum_{\mu=1}^m \la_\mu a_{\mu j}, \quad j=1\sco n
\end{equation}
где $L=T-V$ -- лагранжиан системы.
\subsubsection{Неголономные системы Чаплыгина}
Из общего класса линейных дифференциальных связей вида
\begin{equation}
  \label{general-diff-restrictions}
  A(\bar q, t)\dot{\bar q} + b(\bar q, t) = 0
\end{equation}
выделим те, что для которых связи не зависят от времени и $ b \equiv 0$.
Разрешим соотношение (\ref{general-diff-restrictions}) относительно последних $m$ обобщенных скоростей:
\begin{equation}
  \label{diff-resolved}
  \dot q_{k+\mu} = \sum_{i=1}^k c_{\mu i}(\bar q)\dot q_i, \quad \mu=1\sco m,\quad k = n-m
\end{equation}
При этом уравнение (\ref{diff:lagr}) переписывается следующим образом:
\begin{petit}
  А куда делись коэффиценты $a_{ij}$?
\end{petit}
\begin{equation}
  \label{diff-first}
  \frac{d}{dt}\pf{T}{\dot q_i} = \pf{T}{q_i} + Q_i + \sum_{\mu=1}^m \la_\mu c_{\mu i}, \quad i = 1\sco k
\end{equation}
\begin{equation}
  \label{diff-last}
  \frac{d}{dt}\pf{T}{\dot q_{k+\mu}} = \pf{T}{q_{k+\mu}} + Q_{k+\mu} -\la_\mu,\quad \mu = 1\sco m
\end{equation}
Выразим из (\ref{diff-last}) неизвестные коэффиценты
\begin{equation}
  \la_\mu = Q_{k+\mu}+\pf{T}{q_{k+\mu}} - \frac{d}{dt}\pf{T}{\dot q_{k+\mu}}
\end{equation}
и подставим в (\ref{diff-first})
\begin{equation}
  \label{diff-subst}
  \frac{d}{dt}\pf{T}{\dot q_i} - \pf{T}{q_i} +
  \sum_{\mu=1}^m\hr{\frac{d}{dt}\pf{T}{\dot q_{k+\mu}}}
    -\pf{T}{q_{k+\mu}}c_{\mu i} = Q_i + \sum_{\mu = 1}^m Q_{k+\mu}c_{\mu i}, \quad  i = 1\sco k
\end{equation}
Система $n$ уравнений (\ref{diff-subst}), (\ref{diff-resolved}) замкнута относительно $n$ переменных
$q_1\sco q_n$ и не содержит неизвестных множителей.

Предположим, что кинетическая энергия $T$, обобщенные силы $Q_i$ и
коэффиценты $c_{\mu i}$ неголономных связей не зависят от $m = n - k$
обобщенных координат $q_{k+\mu}$, $\mu = 1\sco m$. Такие неголономные
системы называются системами Чаплыгина.

Введем функции
\newcommand{\qlast}{q_1\sco q_k, \dot q_1\sco \dot q_k}
\begin{displaymath}
\label{chapl:asterix}
\begin{array}{c}
  T^* = T^*(\qlast) = (T)\evn{(\ref{diff-resolved})} \\
  \displaystyle
  Q_i^* = Q_i^*(\qlast) =\hr{Q_i + \sum_{\mu =1 }^mQ_{k+\mu}c_{\mu i}}\evn{(\ref{diff-resolved})} \\
  \tau_\mu = \tau_\mu(\qlast) = \hr{\pf{T}{\dot q_{k+\mu}}}\evn{(\ref{diff-resolved})}\\
    \nu_{\mu ij} = \nu_{\mu ij}(\qlast) = \pf{c_{\mu i}}{q_j} - \pf{c_{\mu j}}{q_i} = -\nu_{\mu ji} \\
    \ga_{ij} = \sum_{\mu=1}^m \tau_\mu\nu_{\mu ij}
\end{array}
\end{displaymath}
\begin{petit}
  Здесь должно быть много матана из книжки, но мне лень.
\end{petit}
Систему уравнений (\ref{diff-resolved}) и (\ref{diff-subst}) можно
записать в виде
\begin{equation}
  \label{chapl}
  \frac{d}{dt}\pf{T^*}{\dot q_i} -\pf{T^*}{q_i} = Q^*_i +
  \sum_{j=1}^k\ga_{ij}\dot q_j, \quad i =1\sco k
\end{equation}
Полученные уравнения (\ref{chapl}) называются уравнениями
Чаплыгина. Если $q_i = \ph(t)$, $i = 1\sco k$, --- решения уравнений
Чаплыгина, то переменные $q_{k+\mu}$ определяются простым
интегрированием соотношений (\ref{diff-resolved}). Если связи
интегриуемы, то $\ga_{ij} \equiv 0$, и получаются обычные уравнения Лагранжа.
\begin{note}
  Если обобщенные силы консервативны, то уравнение (\ref{chapl})
  принимает вид
  \begin{equation}
    \frac{d}{dt}\pf{T^*}{\dot q_i} - \pf{T^*}{q_i} = -\pf{V}{q_i} +\sum_{j=1}^k\ga_{ij}\dot q_j, \quad i = 1\sco k
  \end{equation}
  где $V = V(q_1,\sco q_k)$ -- потенциальная энергия. Поскольку
  $\ga_{ij} = -\ga_{ji}$, имеет место интеграл энергии
  \begin{equation*}
    T^*+V = h =\const
  \end{equation*}

\end{note}
\subsubsection{Конек Чаплыгина}
\newcommand{\half}{\frac{1}{2}}
\begin{df}
  Конек Чаплыгина -- это диск, опирающийся на плоскость полукруглым
  лезвием, прикрепленным к диску в его центре $C$. Связь заключается в
  том, что скорость центра диска паралельна диску,
  т.е $(\sin\psi,\cos\psi)$ и $(\dot x, \dot y)$ паралельны, т.е
  \begin{displaymath}
    \dot x\sin\psi - \dot y\cos\psi = 0
  \end{displaymath}
\end{df}
\begin{petit}
 Дальнейшая часть параграфа -- чистейшей воды импровизация, ибо
 никаких достоверных источников у меня нет, однако содержит некую
 работу по подгонке Конька Чаплыгина под теорию предыдущих двух
 параграфов. Вас предупреждали. Картинки будут\dots{} когда-нибудь.
\end{petit}
Итак, рассмотрим конек на наклонной плоскости. Пусть в объемлющем
пространстве имеется система координат $O'$,$x'$,$y'$,$z'$.  На
наклонной плоскости $\pi$, образующей угол $\ph$ с осью $z'$ и
паралельной оси $x'$, введем координаты $O$,$x$,$y$, причем $Ox =
O'x'$, $O = O'$.  Т.к вся конструкция движется паралельно плоскости,
то для вычисление энергии вращения необходим только один момент
инерции -- вдоль нормали к поверхности. Пусть он равен $J$. Угол
поворота конька обозначим $\psi$.

Если на плоскости конек имеет координаты $(x,y)$, то в объемлющем пространстве
$\bar r = (x,y\cos\ph, -y\sin\ph)$. Запишем лагранжиан:
\begin{displaymath}
  L =\half J{\dot \psi}^2 + \frac{m}{2}\hr{{\dot x}^2 + {\dot y}^2} +mgy\sin\ph
\end{displaymath}

 А теперь начнем подгонять под букву теории предыдущих параграфов.
Обозначим $q_1=\psi$, $q_2 = x$, $q_3 = y$.

Обобщенные силы:
\begin{displaymath}
  \begin{array}{l}
    Q_1  = Q_\psi =0\\
    Q_2 = Q_x =0 \\
    Q_3 = Q_y = (-mg\bar e_{z'}, \pf{\bar r(x,y,\psi)}{y}) =  (-mg\bar e_{z'}, \cos\ph \bar e_{y'} - \sin\ph\bar e_{z'}) = mg\sin\ph
  \end{array}
\end{displaymath}

Разрешим дифференциальную связь относительно последней переменной:
\begin{displaymath}
  \dot q_3 = 0\dot q_1+\tg\psi\dot q_2
\end{displaymath}
Т.е $m=1$, $n=3$, $k = n-m = 2$, $c_{11} =0$, $c_{12} = \tg\psi$.

Начинаем подставлять в (\ref{chapl:asterix}):
\begin{displaymath}
  \begin{array}{c}
    \displaystyle
    T^* = \half J{\dot \psi}^2 + \frac{m{\dot x}^2}{2}\hr{1+\tg^2\psi} \\
    Q_1^* = 0 +c_{11}\cdot Q_3 = 0 \\
    Q_2^* = 0 + c_{12}Q_3 = mg\sin\ph\tg\psi \\
    \tau_1 = m\dot x\tg\psi \\
    \nu_{1\,12} = -\frac{1}{{\cos^2\psi}} \\
    \ga_{12} = - m\dot x\tg\psi \frac{1}{{\cos^2\psi}}
  \end{array}
\end{displaymath}
А теперь получим систему уравнений на $x$,$\psi$.
\begin{displaymath}
  \begin{array}{c}
    \displaystyle
    J\ddot\psi - m{\dot x}^2\frac{1}{{\cos^2\psi}} = -m\dot x\tg\psi \frac{1}{{\cos\psi}^2}\dot x \\
    m\ddot x\hr{1+\tg^2\psi} +  m\dot x\tg\psi\cdot\frac{1}{\cos^2\psi}\dot\psi = mg\sin\ph\tg\psi +m\dot x\tg\psi \frac{1}{{\cos^2\psi}}\dot\psi
  \end{array}
\end{displaymath}
Упростим
\begin{displaymath}
    \begin{array}{c}
    \displaystyle
    J\ddot\psi =  m{\dot x}^2\frac{1}{{\cos^2\psi}}(1 - \tg\psi) \\
    \ddot x\hr{1+\tg^2\psi} = g\sin\ph\tg\psi
    \end{array}
\end{displaymath}
\begin{petit}
  А решать это как?
\end{petit}

\tbk

\section{Гамильтонов формализм}

\subsection{Уравнения Гамильтона}

Рассмотрим голономную механическую систему под действием потенциальных
сил; $q^j$ обобщенные координаты, $\dot{q}^j$ обобщённые скорости. Как
мы уже знаем, функция Лагранжа в этих координатах имеет вид:
\equ{L=L(q,\dot{q},t)=\frac{1}{2}a_{jk}(t,q)\dot{q}^j\dot{q}^k+a_j(t,q)\dot{q}^j+a_0(t,q)}
и удовлетворяет уравнению Лагранжа
\eqn{\label{eq::L}\frac{d}{dt}\hr{\pf{L}{\dot{q}^j}}-\pf{L}{q^j}=0.}
Рассматривая функцию Рауса, мы, фактически, заменяли часть скоростей
на импульсы; теперь заменим все:
\eql{p_j=\pf{L}{\dot{q}^j}=a_{jk}\dot{q}^k+a_j.}{imp}

\begin{nbb}
На всякий случай поясняю: первое равенство можно считать определением импульса, а второе
следует из \tdf{утверждения \ref{kin_en_rep}}.
\end{nbb}
Равенство \eqref{imp} можно обратить, получив выражение для скоростей через импульсы:
\eql{\dot{q}^j=a^{jk}p_k-a^{jk}a_k,}{sp_by_imp} где $a^{jk}$, как обычно, элементы матрицы,
обратной к $(a_{jk})$, то есть $a^{jk}a_{kl}=\de^j_l.$
\begin{df}
\tdf{Функцией Гамильтона}, или \tdf{гамильтонианом} описываемой системы будем называть функцию
\eql{H=H(t,q,p)=p_j\dot{q}^j-L.}{H}
\end{df}
\begin{stm}
$H=H_2+H_1+H_0,$ где \equ{H_2=\frac{1}{2}a^{jk}p_jp_k,\ H_1=-a^{jk}a_kp_j,\
H_0=\frac{1}{2}a^{jk}a_ja_k-a_0.}
Формы $H_2$ и $H_1$ называются, соответственно, квадратичной и линейной формами импульсов.
\end{stm}
\begin{proof}
Опять-таки, следует из \tstm{утверждения~\ref{kin_en_rep}}, а также, разумеется, из \eqref{sp_by_imp} и
\eqref{H}.
\end{proof}
\begin{theorem}[Уравнения Гамильтона]
\eql{\dot{q}^j=\pf{H}{p_j},\ \dot{p}_j=-\pf{H}{q^j},\ j=1\sco
m.}{H_eq}
\end{theorem}
\begin{proof}
Первое уравнение следует непосредственно из \eqref{H}, а второе из \eqref{eq::L} и \eqref{imp}.
\end{proof}
\begin{imp}
\equ{\pf{H}{t}=\frac{dH}{dt}.}
\end{imp}
\begin{proof} Имеем
\equ{\frac{dH}{dt}=
\pf{H}{t}+\pf{H}{q^j}\dot{q}^j+\pf{H}{p_j}\dot{p}_j=
\pf{H}{t}+\pf{H}{q^j}\pf{H}{p_j}-\pf{H}{p_j}\pf{H}{q^j}=\pf{H}{t},}
что и требовалось доказать.
\end{proof}
\begin{imp}
Если $\pf{H}{t}=0$ (то есть время не входит в гамильтониан явно),
имеет место первый интеграл $H=h=\const$.
\end{imp}

\begin{note}
  Пространство переменных $z=(q,p)$ называется фазовым пространством,
  а переменные $(q,p)$ -- каноническими переменными.
\end{note}

\subsection{Функционал действия и его вариации}

\subsubsection{Принцип наименьшего действия Гамильтона--Остроградского}

В этом разделе мы будем рассматривать голономную механическую систему под действием потенциальных
сил. Пусть, как обычно, $q=(q^1\sco q^m)$ обобщенные координаты и $L\bw=L(t,q,\dot{q})$ функция
Лагранжа.
\begin{df}
\tdf{Действием по Гамильтону} называется функционал вида
\eqn{\label{eq::Ham_act}W=W(q)=\intl{t_0}{t_1}L(t,q,\dot{q})dt.} При этом предполагается, что
моменты времени $t_0$ и $t_1$ фиксированы, а функция $q=q(t)$ удовлетворяет условиям
\equ{q(t_0)=q_0,\ q(t_1)=q_1.}
\end{df}
Ясно, что функцию $q(t)$ можно рассматривать как <<траекторию>> системы в пространстве обобщенных
координат (см.~\tpic{рис.~10}). \xtrpicturep{10}{10} Среди всех допустимых (то есть проходящих через точки
$A_0$ и $A_1$) траекторий нам интересны прежде всего те, которые соответствуют реальным положениям
системы. Сформулируем это более строго.
\begin{df}
Траекторию $q_r$, удовлетворяющую уравнению Лагранжа \eqref{eq::L}, мы будем называть <<прямой>> или
<<действительной>>, все остальные тракетории <<окольными>>.
\end{df}
Параметризуем все допустимые траектории с помощью некоторого вещественного параметра $\al$: положим
$q=q(t,\al),\ \al\in[-\ga,\ga]$; параметризацию выбираем так, чтобы $q(t,0)=q_r$. Параметр $\al$ выбираем
не зависящим от времени.
\begin{df}
\tdf{Вариацией траектории} будем называть следующую величину:
\equ{\de q=\pf{q}{\al}\de\al.}
\end{df}
\begin{nbb}
Вариацию можно понимать как дифференциал при замороженном времени.
Пусть дана некоторая величина, скажем, $y$,
которая зависит от независимых переменных $x$ и $t$ ($t$ время).
В таком случае полный дифференциал этой величины, как известно, имеет вид:
\equ{dy=\pf yx dx+\pf yt dt.}
А вариация будет равна
\equ{\de y=\pf yxdx=\pf yx\de x,}
так как для величин, не зависящих от времени, очевидно, $d=\de$.


Теперь становится понятно, что в определении вариации можно было бы написать:
\equ{\de q=\pf{q}{\al}d\al.}
При этом под функцией $q(t,\al)$ подразумевается функция вида
\equ{q(t,\al):= q(t) + \al h(t),}
где $h$ произвольная гладкая функция, равная нулю на концах отрезка $[t_0,t_1]$.

\end{nbb}
Такая параметризация позволяет рассматривать функционал действия как функцию параметра $\al$:
\equ{W(q)=W(\al).}

\begin{note}
Ясно, что вариация производной есть производная вариации:
\equ{\de\dot{q}=\pf{\dot{q}}{\al}\de\al=\pf{^2q}{t\pd\al}\de\al=(\de
  q)^{\bdot}.} Этим фактом мы будем неоднократно пользоваться в
дальнейшем. Все дело здесь в том, что, как уже упоминалось, параметр
$\al$ не зависит от $t$ (мы параметризуем траектории целиком, а не
отдельные точки на них), поэтому операция варьирования является
изохронной и перестановочна с дифференцированием по времени.
\end{note}

Теперь мы можем сформулировать и доказать теорему, составляющую суть \tdf{принципа наименьшего действия
Гамильтона Остроградского.}

\begin{theorem}
\label{thm::var_act_zero}
Вариация функционала действия равна нулю на решениях уравнений Лагранжа \eqref{eq::L} и только на
них: \eqn{\label{eq::var_atc_zero}\de W=\de\intl{t_0}{t_1}L(t,q,\dot{q})dt=0\Lra\eqref{eq::L}.}
\end{theorem}
\begin{proof}
Ключевым соображением при доказательстве этого факта является использование изохронности вариации
по $\al$, в силу которой варьирование перестановочно с дифференцированием, а значит и с
интегрированием по $t$. Поэтому можем записать:
\ml{\de W=\de\intl{t_0}{t_1}L(t,q,\dot{q})dt=\intl{t_0}{t_1}\de L(t,q,\dot{q})dt=\\
=\intl{t_0}{t_1}\hs{\spr{\pf{L}{q}}{\de q}+\spr{\pf{L}{\dot{q}}}{\de\dot{q}}}dt
\stackrel{!}{=}\intl{t_0}{t_1}\hs{\spr{\pf{L}{q}}{\de q}+\spr{\pf{L}{\dot{q}}}{(\de q)^{\bdot}}}dt\stackrel{!!}{=}\\
\stackrel{!!}{=}\left.\spr{\pf{L}{\dot{q}}}{\de q}\right|_{t_0}^{t_1}+\intl{t_0}{t_1}\hs{\spr{\pf{L}{q}}{\de q}-\spr{\frac{d}{dt}\pf{L}{\dot{q}}}{\de q}}dt
\stackrel{!!!}{=}\intl{t_0}{t_1}\spr{\hs{\pf{L}{q}-\frac{d}{dt}\pf{L}{\dot q}}}{\de q}dt.}
При переходе <<!>> мы воспользовались перестановочностью операций варьирования и дифференцирования, <<!!>>
это просто интегрирование по частям, и, наконец, <<!!!>> следует из того, что вариация равна нулю в точках~$t_0$ и~$t_1$.

Теперь уже ясно, что на решениях уравнений Лагранжа $\de W=0$. Убедимся, что обратное утверждение также выполнено.
Действительно, пусть это не так. Это означает, что найдутся такая точка $t_*$ и такой номер $i$ в пределах от единицы
до $k$, что \equ{\frac{d}{dt}\pf{L}{\dot{q}^i}\neq\pf{L}{q^i}\evu{t=t_*}{12pt}{1.4pc}.} В силу непрерывности всех
всех входящих в него функций, это неравенство будет выполнено в некоторой $\ep$ окрестности точки $t_*$, откуда
немедленно\footnote{Стандартный приём: нужно выбрать подходящую вариацию, не равную нулю там
где надо. \emph{Прим. вред.}}
получаем, что вариация интеграла действия не будет равна нулю. Полученное противоречие доказывает теорему.
\end{proof}
\begin{note}
Вообще говоря, из доказанной теоремы следует только стационарность, но не минимальность функционала действия на
траекториях, удовлетворяющих уравнениям Лагранжа. Однако, если краевые условия $(t_0,q_0)$ и $(t_1,q_1)$
достаточно близки друг к другу, то на таких траекториях действительно будет достигаться минимум.
\end{note}

Тот же принцип наименьшего действия можно сформулировать в несколько другой форме.
Для этого перейдем к обобщенным координатам $(q,p)$, где
\equ{p=\pf{L}{\dot{q}},}
а вместо функции Лагранжа будем рассматривать функцию Гамильтона
\equ{H=H(t,q,p),}
которая, как уже было доказано, удовлетворяет уравнениям Гамильтона~\eqref{H_eq}.
Введем также функцию $\La$, которую определим следующим образом:
\equ{\La:=\spr{p}{\dot{q}}-H(t,p,q)=\La(t,q,\dot{q},p,\dot{p}),}
при этом в силу уравнений Гамильтона получаем
\equ{\pf{\La}{p}=0.}
В силу уравнений Гамильтона~\eqref{H_eq}
эта функция удовлетворяет следующим соотношениям:
\equ{\frac{d}{dt}\pf{\La}{\dot{q}}=\pf{\La}{q},\quad \frac{d}{dt}\pf{\La}{\dot{p}}=\pf{\La}{p}.}
Поэтому, действуя аналогично
доказательству теоремы \ref{thm::var_act_zero}, можно убедиться в справедливости другой формулировки принципа
Гамильтона Остроградского:
\equ{\de\intl{t_0}{t_1}\hs{\spr{p}{\dot{q}}-H(t,q,p)}dt=0.}
\begin{note}
Ясно, что в этой формулировке принцип наименьшего действия будет выполнен лишь в том случае, если мы зафиксируем не только
начальный и конечный моменты времени $t_0$ и $t_1$, но и соответствующие им положения системы $(q_0,p_0)$ и
$(q_1,p_1)$, причем эти положения должны лежать на действительной траектории.
\end{note}
\begin{note}
На действительных траекториях имеем:
\equ{\La=\spr{p}{\dot q}-H=\spr{p}{\dot q}-\hr{\spr{p}{\dot q}-L}=L.}
\end{note}

\subsubsection{Интегральные инварианты}

Рассмотрим задачу Коши на функции $p=p(s,t)$ и $q=q(s,t)$ (где $s$ некоторый параметр из отрезка $[0,l]$),
определяемую уравнениями Гамильтона~\eqref{H_eq} и краевыми условиями вида
\equ{q(0,s)=q_0(s),\,p(0,s)=p_0(s);\,q_0(l)=q_0(0),\,p_0(l)=p_0(0).}
\xtrpicture{11}{11}
\begin{theorem}[Универсальный интегральный инвариант Пуанкаре]
Пусть $C$ некоторое сечение трубки решений плоскостью $t=\const$ (см. рис. 11). Тогда
\eqn{\label{eq::uiip}I_p=\oints{C}\spr{p}{\de q}=\const=
\oints{C_0}\spr{p}{\de q},\quad\text{где}\quad\de q=\pf{q}{s}\de s.}
\end{theorem}
\begin{proof}
Доказательство получаем прямой выкладкой, интегрируя по частям:
\ml{\frac{dI_p}{dt}=\frac{d}{dt}\oints{C}\spr{p}{\de q}=\oints{C}\hs{\spr{\dot{p}}{\de q}+\spr{p}{(\de q)^{\bdot}}}=
\oints{C}\hs{\spr{\dot{p}}{\de q}}+\spr{p}{\de\dot{q}}=\\
=\oints{C}\de\spr{p}{\dot{q}}+\oints{C}\hs{\spr{\dot{p}}{\de q}-\spr{\dot{q}}{\de p}}\stackrel{!}{=}
\oints{C}\hs{-\spr{\pf{H}{q}}{\de q}-\spr{\pf{H}{p}}{\de p}}=-\oints{C}\de H=0.}
При переходе <<!>> мы воспользовались уравнениями Гамильтона, а так же тем, что первое слагаемое в левой части,
очевидно, равно нулю.
\end{proof}
Обратное утверждение также будет верным.
\begin{theorem}
Если трубка решений системы дифференциальных уравнений
\eqn{\label{eq::uiip_reverse}\dot{q}=Q(t,q,p),\,\dot{p}=P(t,q,p)}
удовлетворяет условию инвариантности \equ{I_p=\oint\limits_C\spr{p}{\de q}=\const,}
то существует такая функция $H$, относительно которой уравнения \eqref{eq::uiip_reverse}
имеют форму уравнений Гамильтона \eqref{H_eq}.
\end{theorem}
\begin{proof}
Вновь все сводится к аналогичной выкладке:
\equ{\frac{dI_p}{dt}=\oint\limits_C\hs{\spr{\dot{p}}{\de q}+\spr{p}{\de\dot{q}}}=
\oint\limits_C\de\spr{p}{\dot{q}}+\oint\limits_C\hs{\spr{\dot{p}}{\de q}-\spr{\de p}{\dot{q}}}=
\oint\limits_C\hs{\spr{P}{\de q}-\spr{Q}{\de p}}=0.}
Так как последнее равенство выполнено для произвольного контура $C$, подынтегральное выражение должно
иметь вид полного дифференциала. То есть для некоторой функции $H$ получим
\equ{\spr{P}{\de q}-\spr{Q}{\de p}=-\de H(t,q,p),} откуда немедленно следует, что
\equ{P=-\pf{H}{q},\,Q=\pf{H}{p},} что и требовалось доказать.
\end{proof}
\begin{theorem}[Интегральный инвариант Картана]
Если $C$ произвольный замкнутый контур на трубке решений, то
\eqn{\label{eq::iic}I_c=\oint\limits_C\hs{\spr{p}{dq}-Hdt}=\const=\ointl{C_0}\hs{\spr{p}{dq}-Hdt}.}
Обратное утверждение также верно, а именно: если на трубке решений выполнено \eqref{eq::iic}, то функция $H$
удовлетворяет уравнениям Гамильтона \eqref{H_eq}.
\end{theorem}
\begin{proof}
Без доказательства.
\end{proof}

\begin{nbb}
Интересующиеся могут прочесть доказательство, а также правильную интерпретацию всей этой науки,
в книге В.\,И.\,Арнольда <<Математические методы классической механики>>.
\end{nbb}

\begin{nbb}
В такой формулировке этот инвариант приводился на лекциях:
\eqn{
I_c=\oint\limits_C\hs{\spr{p}{\de q}-H\de t}=\const=\ointl{C_0}\hs{\spr{p}{\de q}-H\de t}.}
Имеются, однако, все основания полагать, что данная формулировка не является верной. При написании текущей версии лекций
были использованы дополнительные источники, в частности, лекции по теоретической механике Г.\,Н.\,Яковенко и
книжка <<Общая теория вихрей>> В.\,В.\,Козлова.
\end{nbb}


\subsubsection{Уравнения Уиттекера и Якоби}

В силу интеграла энергии \equ{H(q,p)=h=\const,} мы можем выразить $p_1$ через
остальные координаты: \eqn{\label{eq::p_by_h}p_1=-K(q^1\sco q^n,p^2\sco p^n,h).}
\begin{note}
В связи с такими обозначениями, нам будет удобно везде в этом разделе полагать, что
индекс $k$ изменяется в пределах от двойки до $n$.
\end{note}
Пользуясь таким представлением, можно записать
\equ{\ointl{C}\spr{p}{\de q}=\ointl{C}\hs{\spr{p_k}{\de q^k}-K\de q^1}=\const.}
Введем также величины
\equ{\adot{q}{}^k=\frac{dq^k}{dq^1},\quad \adot{p}_k=\frac{dp_k}{dq^1}.}

Имеем
\equ{0 = \frac{dH}{dq^k} \stackrel!= \pf{H}{q^k} - \pf{H}{p_1}\pf{K}{q^k} \quad\stackrel{!!}\Lra\quad
\pf{H}{q^k} = -\dot p_k = \dot q^1\pf{K}{q^k} \quad\Lra\quad
-\pf{\dot p_k}{\dot q^1} = \pf{K}{q^k}.}
Здесь <<!>> следует из правил дифференцирования сложной функции, а <<!!>> из уравнений Гамильтона.
Теперь, пользуясь тем, что
\eqn{\adot{q}^k = \frac{dq^k}{dq^1} = \frac{dq^k/dt}{dq^1/dt} = \frac{\dot q^k}{\dot q^1}, }
получаем так называемые \tdf{уравнения Уиттекера (E.\,T.\,Whittacker)}:
\eqn{\label{eq::uitteker}\adot{q}{}^k=\pf{K}{p_k},\quad\adot{p}_k=-\pf{K}{q^k}.}
Таким образом, с помощью интеграла энергии мы понизили порядок наших уравнений на два, пожертвовав при этом, однако,
автономностью: в исходных уравнениях дифференцирование было по $t$, а само $t$ в них не
фигурировало, а в полученных переменная дифференцирования $q_1$, вообще говоря, присутствует как параметр
функции $K$. Что касается $t$, его из этих уравнений можно выразить следующим образом. Пусть
\equ{q^k=\ph^k(q^1,h,c),\quad p_k=\psi_k(q^1,h,c),}
где $c$ некоторый набор констант: $c\in\R^{2n-2}$ некоторые решения уравнений \eqref{eq::uitteker}.
Кроме того, введем функцию \equ{p_1=\psi_1(q^1,h,c).} Наконец, можем записать:
\equ{\dot{q}_1=\pf{H(q,p)}{p_1}\evu{q^k=\ph^k,p_i=\psi_i}{12pt}{1.4pc}=\ph^1(q^1,h,c),}
откуда получаем
\equ{t=\int\frac{dq^1}{\ph^1}+c_{2n-1}.}

Видно, что уравнения Уиттекера получены на основе уравнений Гамильтона; ничего не мешает, однако, построить
аналогичную конструкцию для уравнений Лагранжа. Впервые это проделал Якоби, и получаемые таким образом
уравнения носят его имя:
\equ{\frac{d}{dq^1}\pf{P}{\adot{q}{}^k}=\pf{P}{q^k},\quad k=2\sco n,}
где функция $P$ определяется следующим образом:
\equ{P=P(q^1,q^2\sco q^n,\adot{q}{}^2\sco \adot{q}{}^n,h):=(p_k\adot{q}{}^k-K)\stackrel{!}{=}p_i\adot{q}{}^i\stackrel{!!}{=}
\frac{p_i\adot{q}{}^i}{\adot{q}{}^1}=\frac{\spr{p}{\dot{q}}}{\dot{q}^1}
\stackrel{!!!}{=}\frac{2T}{\dot{q}^1}=\frac{a_{ij}(q)\dot{q}^i\dot{q}^j}{\dot{q}^1}.}
Переход <<!>> следует из \eqref{eq::p_by_h}, кроме того, в <<!>> и <<!!>> используется тот очевидный факт, что
$\adot{q}^1=1$. В <<!!!>> мы пользуемся тем, что в данном случае мы предполагаем $T=T_2 = \frac12 \spr{p}{\dot q}$.
Введём еще одно обозначение: \equ{2G:=a_{ij}(q)\adot{q}^i\adot{q}^j,} тогда
\equ{2T=a_{ij}(q)\dot{q}^i\dot{q}^j=(\dot{q}^1)^2a_{ij}(q)\adot{q}^i\adot{q}^j=(\dot{q}^1)^2\cdot2G\Ra\dot{q}^1=\sqrt{T/G}.}
Таким образом, окончательно функцию $P$ можно записать в виде
\equ{P=\frac{2T}{\sqrt{T/G}}=2\sqrt{TG}=2\sqrt{(h-V(q))G(q,\adot{q})}=P(q,\adot{q},h).}

\subsubsection{Принцип наименьшего действия\ форме Мопертюи Лагранжа и Якоби}

Здесь мы также будем полагать, что $T=T_2$. Кроме того, мы зафиксируем начальное и конечное положения системы
$q_0$ и $q_1$, но не моменты времени, им соответствующие (то есть допустимыми будут любые траектории с началом
на прямой $q=q_0$ и окончанием на прямой $q=q_1$ см.~\tpic{рис.~12}). Рассмотрим функционал действия в виде:
\equ{W^*=\intl{q_0^1}{q_1^1}Pdq^1.}
\xtrpicture{12}{12}
Заметим, что $Pdq^1=2Tdt$, поэтому можем записать \equ{\de\intl{t_0}{t_1}2Tdt=0.}
Это и есть \tdf{принцип наименьшего действия в форме Мопертюи Лагранжа}. Однако, такая форма для практических вычислений
очень неудобна. Гораздо удобнее \tdf{форма Якоби}: \equ{\de\intl{q_0}{q_1}\sqrt{2(h-V(q))}ds=0,} где
метрика определяется так: $ds^2=a_{ij}(q)dq^idq^j.$


\subsection{Канонические преобразования}

\subsubsection{Групповые свойства канонических преобразований}

Итак, мы будем рассматривать механические системы, удовлетворяющие уравнениям Гамильтона
\eqn{\label{eq::Ham}\dot{q}=\pf{H}{p},\quad\dot{p}=-\pf{H}{q},}
где $H=H(q,p,t)$ гамильтониан, а $q\in \Ms^n\subset\R^n.$
Можно переписать их в векторной форме:
\eqn{\label{eq::Ham_vect}\dot{z}=J\pf{H}{z},}
где $E_n$ единичная матрица, а
\equ{z=\rbmat{q\\p},\quad J=\rbmat{0&E_n\\-E_n&0}.}
Ясно, что матрица $J$ удовлетворяет следующим свойствам:
\equ{J^T=J^{-1}=-J,\quad J^2=-E_{2n},\quad \det J=1.}
От координат $q,p$ ничего не мешает перейти к новым координатам $\ti{q},\ti{p}:$
\eqn{\label{eq::transform}q,p\rightsquigarrow\ti{q},\ti{p}\cln\quad \ti{q}=\ti{q}(p,q,t),\quad \ti{p}=\ti{p}(q,p,t).}
Функции перехода также можно переписать в векторной форме:
\eqn{\label{eq::transform_vect}z\rightsquigarrow\ti{z},\quad \ti{z}=\ti{z}(z,t).}
Мы будем рассматривать только те преобразования, для которых $\ti{z}(z,t)\in \Cb^2$
и матрица \eqn{\label{eq::transform_matrix}M=\hr{\pf{\ti{z}}{z}}=\rbmat{\hr{\pf{\ti{q}}{q}}&\hr{\pf{\ti{q}}{p}}\\\hr{\pf{\ti{p}}{q}}&\hr{\pf{\ti{p}}{p}}}}
невырождена. Из этого следует существование обратного преобразования $z=z(\ti{z},t)$, удовлетворяющего тем же свойствам.
\begin{df}
Преобразование \eqref{eq::transform} (оно же \eqref{eq::transform_vect}) называется \tdf{каноническим}, если для некоторой
положительной константы $c$ (называемой валентностью преобразования) оно удовлетворяет условию
\eqn{\label{eq::canon_transform}M^TJM=cJ.}
Преобразование называется \tdf{унивалентным}, если $c=1$ (то есть $M$ в точности сохраняет форму~$J$).
\end{df}
Непосредственно из определения можно получить следующее свойство канонических преобразований:
\equ{(\det M)^2=c^{2n}\quad\Ra\quad\det M=\pm c^n.}

В дальнейшем мы ограничимся рассмотрением только унивалентных преобразований. Однако результаты,
которые будем для них получать, без труда обобщаются на случай произвольных канонических
преобразований путём добавления в некоторых равенствах множителя $c$.

\begin{theorem}
Канонические преобразования образуют группу.
\end{theorem}
\begin{note}
На самом деле, мы докажем, что унивалентные преобразования образуют группу. Впрочем, для канонических преобразований доказательство
выглядело бы абсолютно аналогично.
\end{note}
\begin{note}
Для немного искушенных в алгебре доказательство данной теоремы для унивалентных преобразований состоит
из одной фразы: <<дифференциалы наших преобразований лежат в группе $\Sb\Pb_{2n}$>>.
\end{note}
\begin{proof}
Нам нужно проверить выполнение групповых аксиом для унивалентных преобразований относительно операции композиции.
Единичным элементом, таким образом, будет тождественное преобразование, которое,
очевидно, является каноническим. Убедимся, что обратное к унивалентному преобразованию также является унивалентным.
Нужно проверить, что
\equ{(M^{-1})^TJM^{-1}=J.}
В самом деле, согласно~\eqref{eq::canon_transform}, имеем
\equ{(M^{-1})^TJM^{-1}=(M^{-1})^TM^TJMM^{-1}=J.}
Остаётся убедиться, что композиция двух унивалентных преобразований есть преобразование унивалентное. Итак, пусть
\equ{z_1=z_1(z,t),\quad z_2=z_2(z,t)} унивалентные преобразования с матрицами $M_1$ и $M_2$ соответственно. Положим
\equ{\ti{z}=\ti{z}(z,t):=z_2(z_1(z,t),t).} Этому преобразованию будет соответствовать матрица
\equ{M=\pf{\ti{z}}{z}=\pf{z_2}{z_1}\pf{z_1}{z}=M_2M_1.}
Ясно, что для неё также будет выполнено условие унивалентности:
\equ{M^TJM=M_1^TM_2^TJM_2M_1=M_1^TJM_1=J,}
что и требовалось доказать.
\end{proof}

\subsubsection{Критерии каноничности}

\begin{df}
\tdf{Скобкой Пуассона} функций $\ph=\ph(q,p,t)$ и $\psi=\psi(q,p,t)$ будем называть выражение вида
\equ{(\ph,\psi)=\pf{\ph}{q^s}\pf{\psi}{p_s}-\pf{\ph}{p_s}\pf{\psi}{q^s}.}
Если же $\ti{q},\ti{p}$ получены из $q,p$ с помощью преобразования \eqref{eq::transform},
а функции $\xi,\eta$ есть некоторые из функций $q^i,p_j$, введём \tdf{скобку Лагранжа}:
\equ{[\xi,\eta]=\pf{\ti{q}^s}{\xi}\pf{\ti{p}_s}{\eta}-\pf{\ti{q}^s}{\eta}\pf{\ti{p}_s}{\xi}.}
\end{df}
\begin{lemma}
\label{lem::canon_criterion1}
Преобразование \eqref{eq::transform} является каноническим тогда и только тогда, когда для любых индексов $i,j$ выполняются следующие три условия
\eqb{
\label{eq::canon_criterion1}
[q^i,q^j]&=0,\\
[p_i,p_j]&=0,\\
[q^i,p_j]&=\de^i_j.
}
\end{lemma}
\begin{proof}
Доказательство сводится к тому, чтобы прямой выкладкой убедиться в справедливости следующего равенства:
\equ{M^TJM=\rbmat{[q,q]&[q,p]\\ [p,q]&[p,p]}.}
\hfill\end{proof}
\begin{note}
Совершенно аналогично доказывается, что каноничность также эквивалентна следующим условиям:
\eqb{
(\ti{q}^i,\ti{q}^j)&=0,\\
(\ti{p}_i,\ti{p}_j)&=0,\\
(\ti{q}^i,\ti{p}_j)&=\de^i_j.
}
Но такой критерий нам не понадобится.
\end{note}
\begin{theorem}
\label{thm::canon_criterion2}
Преобразование \eqref{eq::transform} является каноническим тогда и только тогда, когда существует такая функция $F$, что
\eqn{\label{eq::canon_criterion2}p_id q^i-\ti{p}_id\ti{q}^i+\ti p_i\pf{\ti q_i}{t}dt+\pf{F}{t}dt=dF(q,p,t).}
\end{theorem}
\begin{proof}
Равенство \eqref{eq::canon_criterion2} может быть представлено в виде
\ml{p_i d q^i-\ti{p}_i d\ti{q}^i+\ti p_i\pf{\ti q^i}{t}dt+\pf{F}{t}dt=\\=
p_i d q^i-\ti{p}_i\pf{\ti{q}^i}{q^j} d q^j -\ti{p}_i\pf{\ti{q}^i}{p_j} d p_j
-\ti p_i\pf{\ti q^i}{t}dt + \ti p_i\pf{\ti q^i}{t}dt
+\pf{F}{t}dt=\\
=X_j d q^j+Y_j d p_j+\pf{F}{t}dt=\pf{F}{q^j}dq^j+\pf{F}{p_j}dp_j+\pf{F}{t}dt,} где
\equ{X_j=p_j-\ti{p}_s\pf{\ti{q}^s}{q^j},\quad Y_j=-\ti{p}_s\pf{\ti{q}^s}{p_j},}
откуда получаем
\equ{
X_j=\pf{F}{q^j},\quad Y_j=\pf{F}{p_j}.
}
\begin{nbb}
Следует отметить, что индекс $j$ у величины $Y$ не является нижним в обычном смысле слова.
Достаточно понимать, что в произведении $Y_j dp_j$ по нему ведётся суммирование.
В дальнейшем мы будем писать этот индекс вверху.
\end{nbb}
Функция $F$ у нас достаточно гладкая (у нас обычно всё достаточно гладкое), так что
вторые частные производные, взятые в разном порядке, у неё должны совпадать. Итак, имеем:
\eqb{
\pf{X_j}{q^i}-\pf{X_i}{q^j}=0,\\
\pf{Y^j}{p_i}-\pf{Y^i}{p_j}=0,\\
\pf{X_j}{p_i}-\pf{Y^j}{q^i}=0.
}
Преобразуем левую часть первого из этих условий:
\equ{\pf{X_j}{q^i}-\pf{X_i}{q^j}=-\pf{\ti{p}_s}{q^i}\pf{\ti{q}^s}{q^j}-\ti{p}_s\pf{^2\ti{q}^s}{q^i\pd q^j}+
                                    \pf{\ti{p}_s}{q^j}\pf{\ti{q}^s}{q^i}+\ti{p}_s\pf{^2\ti{q}^s}{q^j\pd q^i}=[q^i,q^j].}
Совершенно аналогично можно убедиться, что левая часть второго условия равна $[p_i,p_j]$, а третьего $\de^j_i-[q^j,p_i].$
Остаётся заметить, что мы получили ни что иное, как уже доказанное условие каноничности \eqref{eq::canon_criterion1}.
\end{proof}

\begin{nbb}
Эта теорема также формулировалась (и доказывалась) на лекциях несколько иначе, и, по-видимому, неверно.
\end{nbb}

\subsubsection{Сохранение гамильтоновой структуры канонических преобразованиях}

\begin{theorem}
\label{thm::ham_inv}
При  канонических преобразованиях сохраняется гамильтонова структура уравнений движения.
То есть, если некоторая система удовлетворяет уравнениям Гамильтона \eqref{eq::Ham}, то при
каноническом преобразовании вида \eqref{eq::transform} найдется такая функция $\ti{H}$, что
\equ{\dot{\ti{q}}=\pf{\ti{H}}{\ti{p}},\quad \dot{\ti{p}}=-\pf{\ti{H}}{\ti{q}}.}
\end{theorem}
\begin{proof}
В силу \tstm{теоремы \ref{thm::canon_criterion2}}, преобразования \eqref{eq::transform} тогда и только тогда каноничны,
когда существует функция $F$, такая что выполнено условие \eqref{eq::canon_criterion2}. Положим
\equ{\ti{H}(\ti{q},\ti{p},t)=H(q,p,t)+\ti p_i\pf{\ti q_i}{t}+\pf{F}{t},} причём в правую часть этого равенства вместо переменных
$q$ и $p$ нужно подставить их выражения через $\ti{q}$ и $\ti{p}$ (как уже отмечалось в самом начале, мы
рассматриваем лишь обратимые преобразования).

В пространстве $\ti{q},\ti{p},t$ возьмём произвольный замкнутый контур $\ti{C}$. Проинтегрируем,
пользуясь соотношениями \eqref{eq::transform}, \eqref{eq::canon_criterion2}:
\equ{\ointl{\ti{C}}\hr{\ti{p}_i d\ti{q}^i-\ti{H} d t}=
\ointl{C}\hr{p_i d q^i+\pf F t dt -dF -H d t-\pf{F}{t} d t}=\ointl{C}\hr{p_i d q^i-H d t}-\ointl{C}d F=\const.}
Второй интеграл в последнем равенстве равен нулю по теореме Стокса, а первый равен константе в силу теоремы об интегральном инварианте Картана. Эта же теорема гарантирует нам,
что, что функция $\ti{H}$ удовлетворяет уравнениям Гамильтона.
\end{proof}
\begin{nbb}
И вновь вынужденное расхождение с лекциями... Что неудивительно: эта теорема опирается на две другие, которые уже были исправлены.
\end{nbb}
\begin{note}
Доказанную только что теорему иногда принимают за определение каноничности.
\end{note}

\subsubsection{Теорема Лиувилля о сохранении фазового объёма}

Сейчас мы покажем, что процесс движения есть унивалентное каноническое преобразования.
Ясно, что уравнения Гамильтона с заданными начальными условиями $t_0,p_0,q_0$ можно рассматривать как задачу Коши.
Её решения представляются в виде некоторых непрерывных функций от начальных условий:
\eqn{\label{eq::motion_transform}q=q(q_0,p_0,t),\quad p=p(q_0,p_0,t).}
\begin{theorem}
Преобразование~\eqref{eq::motion_transform} является унивалентным каноническим.
\end{theorem}
\begin{proof}
Пусть \equ{M=\pf{z}{z_0}} матрица этого преобразования, записанного в векторной форме \eqref{eq::transform_vect}.
Продифференцируем эту матрицу по времени:
\equ{\dot{M}=\hr{\pf{z}{z_0}}^{\bdot}\stackrel!=\pf{\dot{z}}{z_0}=\pf{}{z_0}\hr{J\pf{H}{z}}=J\pf{^2H}{z_0\pd z}=
J\pf{^2H}{z^2}\pf{z}{z_0}=J\pf{^2H}{z^2}M.}
Здесь <<!>> следует из того, что $z_0$ не зависит от времени.
Следовательно, учитывая, что $J=-J^T$, имеем
\equ{\dot{M}^T=-M^T\pf{^2H}{z^2}J.}
Воспользовавшись этими двумя равенствами, получаем:
\equ{\frac{d}{dt}(M^TJM)=-M^T\pf{^2H}{z^2}M+M^TJ^2\pf{^2H}{z^2}M=0.}
Таким образом, матрица $M^TJM$ в каждый момент времени остаётся неизменной и совпадает с исходной, соответствующей
моменту $t=t_0$ и тождественному преобразованию $M=E$:
\equ{M^TJM=\const=EJE=J.}
\hfill\end{proof}
\begin{note}
Из доказательства этой теоремы ясно, что $(\det M)^2=1$, то есть $\det M=\pm1$. Однако, нам известно, что в начальный
момент времени $\det M=1$, а значит, в силу непрерывности, это равенство выполнено при любом $t$.
\end{note}

\begin{theorem}[Лиувилль]
Фазовый объём гамильтоновой системы сохраняется вдоль её решений.
\end{theorem}
Эта теорема является простым следствием предыдущей. Однако, прежде
чем её доказывать, следует прояснить формулировку. Пусть $G_0$
некоторая область в пространстве фазовых переменных $p,q$ в
начальный момент времени $t_0$. Рассмотрим сечение $G$ множества фазовых
кривых, проходящих через эту область, плоскостью $t=\const$ и его
объём обозначим $V_t$. Теорема Лиувилля утверждает, что объём области~$G$
совпадает с объёмом $G_0$.
\begin{proof}
Применяя теорему о замене переменных, получаем
\equ{V_t=\ints{G}dq^1\ldots dq^ndp_1\ldots dp_n=\ints{G_0}\det Mdq_0^1\ldots q_0^ndp_1^0\ldots dp_n^0=V_0,}
ибо, как только что было отмечено, $\det M=1$.
\end{proof}

\subsection{Уравнения Гамильтона Якоби и теорема Лиувилля}

\subsubsection{Свободные канонические преобразования}

\begin{df}
Каноническое преобразование вида \eqref{eq::transform} называется \tdf{свободным}, если
\equ{\det\hr{\pf{\ti{q}}{p}}\neq0.}
\end{df}
\begin{note}
Не нужно путать это условие с условием невырожденности преобразования. Здесь мы отдельно требуем,
чтобы невырожденным был правый верхний угол матрицы преобразования \eqref{eq::transform_matrix}. Из невырожденности всей матрицы
это никак не следует.
\end{note}
Итак, в силу того, что для свободного канонического преобразования функция~$\ti q$ зависит от~$p$ невырождено, мы можем записать:
\eqn{
\label{eq::free_transform}
\begin{cases}
p=p(q,\ti{q},t)\\
\ti{p}=\ti{p}(q,\ti{q},t)
\end{cases}
}
В этом разделе нам понадобится именно такая запись свободного канонического преобразования.
Учитывая \eqref{eq::free_transform}, перепишем соотношение \eqref{eq::canon_criterion2}:
\eqn{\label{eq::free_criterion2}
p_id q^i-\ti{p}_id\ti{q}^i+\ti p_i\pf{\ti q_i}{t}dt+\pf{F}{t}dt=
d F(q,p(q,\ti{q},t),t)=: d S(q,\ti{q},t).}
\begin{nbb}
Следует отметить, что
\equ{\pf{S}{t}  = \pf{F}{t} + \ti p_i\pf{\ti q_i}{t}dt,}
поэтому
\equ{d S = p_i dq^i - \ti p_i d\ti q^i + \ti p_i \pf{\ti q^i}{t}dt + \pf{S}{t}dt.}
\end{nbb}
\begin{df}
Функция $S=S(q,\ti{q},t)$, определённая выше, называется \tdf{производящей функцией} свободного канонического
преобразования \eqref{eq::free_transform}.
\end{df}
\begin{petit}
  Не ясно. Надо ссылку проставить.
\end{petit}
Ясно, что для производящей функции выполняются соотношения
\eqn{\label{eq::free_p}p=\pf{S}{q},\quad \ti{p}=-\pf{S}{\ti{q}}.}
\begin{stm}
Если существует функция $S=S(q,\ti{q},t)\in C^2$ с невырожденной матрицей вторых производных:
\equ{\det\hr{\pf{^2S}{q\pd\ti{q}}}\neq0,} то уравнения \eqref{eq::free_p} задают свободное каноническое преобразование.
\end{stm}
\begin{proof}
Легко понять, что для функции $S$ будут выполнены соотношения \eqref{eq::free_criterion2}, откуда немедленно следует
каноничность заданных с её помощью преобразований. Кроме того
\equ{p=\pf{S}{q}\Ra\pf{p}{\ti{q}}=\pf{^2S}{q\de\ti{q}},} а про эту матрицу нам известно, что она невырождена, и, значит,
обратная матрица также существует и невырождена.
\end{proof}
Согласно \tstm{теореме~\ref{thm::ham_inv}} о сохранении гамильтоновой структуры при канонических преобразованиях,
для преобразованной по формулам \eqref{eq::free_p} системы также будет существовать функция Гамильтона
\equ{\ti{H}(\ti{q},\ti{p},t)=H(q,p,t)+\pf{S}{t},}
причём в правую часть этого равенства вместо $q$ и $p$ следует подставлять их представление через преобразованные координаты и импульсы:
\equ{q=q(\ti{p},\ti{q},t),\quad p=p(\ti{p},\ti{q},t).}
Предположим теперь, что с помощью некоторого свободного канонического преобразования нам удалось получить систему,
для которой $\ti{H}=0$. В силу уравнений Гамильтона в ней также будут выполнены соотношения
\equ{\dot{\ti{q}}=0,\quad \dot{\ti{p}}=0\Ra \ti{p}=\al,\quad \ti{q}=\be,}
где $\al$ и $\be$ некоторые $n$ мерные константы. В этом случае функции
\equ{p=p(\al,\be,t),\quad q=q(\al,\be,t)}
будут решением исходного уравнения Гамильтона. Таким образом, мы можем переписать уравнения Гамильтона
в форме
\eqn{\label{eq::ham_jac}\pf{S}{t}+H\hr{q,\pf{S}{q},t}=0,}
называемой \tdf{уравнением Гамильтона Якоби}.
\begin{df}
Функция $S=S(q,\al,t)$ называется \tdf{полным интегралом} уравнения Гамильтона Якоби \eqref{eq::ham_jac}, если
\begin{enumerate}
  \item $S$ удовлетворяет уравнению Гамильтона Якоби~\eqref{eq::ham_jac};
  \item $S$ зависит от~$n$~произвольных констант~$\al$;
  \item $\det\hr{\pf{^2S}{q\pd\al}}\neq0$.
\end{enumerate}
\end{df}
\begin{theorem}[Якоби]
Если функция $S(q,\al,t)$ является полным интегралом уравнения~\eqref{eq::ham_jac}, то общее решение
уравнений Гамильтона~\eqref{eq::Ham} определяется формулами
\eqn{\label{eq::p_in_S}p=\pf{S}{q},\quad \be=-\pf{S}{\al},}
где $\be$ некоторая $n$ мерная константа.
\end{theorem}
\begin{proof}
Всё необходимое для доказательства этой теоремы у нас уже есть. В силу невырожденности матрицы вторых производных
функции $S$ мы можем однозначно восстановить функцию $q=q(\al,\be,t)$, после чего из соотношений \eqref{eq::p_in_S}
получаем функцию $p=p(\al,\be,t)$. Уравнениям Гамильтона Якоби они будут удовлетворять по построению.
\end{proof}
\begin{note}
Пока не совсем ясно, какая от всего этого польза: мы просто заменили $2n$ обыкновенных дифференциальных
уравнений одним уравнением в частных производных; никакого понижения порядка при этом не происходит.
Уравнения Гамильтона Якоби становятся полезней, если часть координт циклические. Действительно,
пусть $q=(r,s)$ и координаты $s$ циклические, то есть
\equ{\pf{H}{s}=0.}
В этом случае производящая функция представляется в виде
\equ{S=:(b,s)+S^*(r,a,t),}
где $a$ и $b$ некоторые константы соответствующих размерностей. Определённая таким образом функция
$S^*$ будет удовлетворять уравнению Гамильтона Якоби:
\equ{\pf{S^*}{t}+H\hr{r,\pf{S^*}{r},b,t}=0.}
При этом $S^*$ зависит от меньшего числа переменных.
\end{note}

\subsubsection{Характеристическая функция Гамильтона}

В этом разделе мы будем рассматривать консервативные гамильтоновы системы, то есть системы, для которых
\equ{\pf{H}{t}=0.} Для таких систем полный интеграл уравнения Гамильтона Якоби \eqref{eq::ham_jac} будет
иметь вид
\eqn{\label{eq::S_conserv}S=:-ht+V(q,\al),}
где $h$ некоторая величина, не зависящая от времени.
\begin{df}
Определённая выше функция~$V$ называется \tdf{характеристической функцией Гамильтона}.
\end{df}
Непосредственно из уравнения \eqref{eq::ham_jac} и определения полного интеграла получаем следующие свойства
характеристической функции:
\begin{enumerate}
  \item $V\in \Cb^2$;
  \item $\det\hr{\pf{^2V}{q\pd\al}}\neq0$;
  \item $h=H\br{q,\pf{V}{q}}$.%=f(\al,)$ где $\al$ некоторая $n$ мерная константа.
\end{enumerate}

\subsubsection{Случай разделяющихся переменных}

Предположим теперь, что переменные в функции Гамильтона разделяются, точнее, пусть
\equ{H=H\hr{f^1\Br{q^1,\pf{V}{q^1}}\sco f^n\Br{q^n,\pf{V}{q^n}}}=h,}
иначе говоря,
\equ{H=H(\al^1\sco\al^n),}
где
\equ{f^i(q^i,\pf{V}{q^i})=\al^i.}
Характеристическая функция Гамильтона в этом случае будет иметь вид
\equ{V=V_1(q^1,\al^1)+\ldots+V_n(q^n,\al^n).}
Введём обозначение
\equ{\frac{dV_i}{dq^i}=g_i(q^i,\al^i),\quad V_i=\int g_i(q^i,\al^i)dq^i.}
Теперь несложно заметить следующий факт:
\equ{\pf{f^i}{p_j}\pf{g_j}{\al^k}=\frac{df^i}{d\al^k}=\de^i_k,}
то есть матрицы частных производных $\pf{f^i}{p_j}$ и $\pf{g_j}{\al^k}$ являются взаимнообратными.

\subsubsection{Пример: математический маятник}

Попробуем применить вышеописанную технику к исследованию этого классического примера (см.~\tpic{рис.~1}).
Для простоты полагаем, что единицы измерения выбраны так, чтобы выполнялись равенства
\equ{m=1,\quad l=1,\quad g=1.}
Тогда функции Лагранжа и Гамильтона этой системы будут выглядеть так:
\equ{L=\frac12\dot{\ph}^2+\cos\ph,\quad H=\frac12p^2-\cos\ph=h.}
Отсюда находим выражение для характеристической функции Гамильтона:
\equ{V=\int\sqrt{2(h+\cos\ph)}d\ph.}
Можно показать, что этот интеграл не берётся в элементарных функциях.

\subsubsection{Обобщённый случай разделяющихся переменных}

Мы находимся в рамках этого случая, если имеет место представление
\equ{H(q,p)=f^n(f^{n-1},q^n,p_n);\quad f^k=f^k(f^{k-1},q^k,p_k),\quad k=2\sco n-1;\quad f^1=f^1(q^1,p_1).}
Кроме того, накладывается существенное условие невырожденности: $\pf{f^i}{p_i}\neq0.$
В этом случае характеристическая функция Лагранжа будет выглядеть так:
\equ{V=V_1(q^1,\al^1)+\suml{i=2}{n}V_i(q^i,\al^{i-1},\al^i).}
Для самих функций $f^i$ будут выполнены тождества:
\equ{f^1\hr{q^1,\frac{dV_1}{dq^1}}=\al_1,\quad f^i\hr{\al^{i-1},q^i,\frac{dV_i}{dq^i}}=\al^i,\quad i=2\sco n.}
Аналогично случаю полностью разделяющихся переменных, введём функции $g_i$:
\equ{\frac{dV_1}{dq^1}=g_1(q^1,\al^1),\quad\frac{dV_i}{dq^i}=g_i(q^i,\al^{i-1},\al^i),\quad i=2\sco n.}
Ясно, что при этом $\al^n=h,$ а матрица вторых производных $\pf{^2V}{q\pd\al}$ будет двухдиагональной.

\subsubsection{Теорема Лиувилля об интегрируемости в квадратурах}

Пусть $H=H(q,p,t)$ функция Гамильтона некоторой механической системы, удовлетворяющей уравнениям Гамильтона \eqref{eq::Ham},
а функции $u=u(q,p,t)=u_0,\,v=v(q,p,t)=v_0$ её первые интегралы. Прежде всего, отметим,
что для этих функций выполнено очевидное соотношение
\equ{\pf{u}{t}+(u,H)=0,}
где $(\cdot,\cdot)$ скобка Пуассона. Действительно,
\equ{0=\frac{du}{dt}=\pf{u}{t}+\pf{u}{q}\pf{q}{t}+\pf{u}{p}\pf{p}{t}=\pf{u}{t}+\pf{u}{q}\pf{H}{p}-\pf{u}{p}\pf{H}{q}.}
\begin{df}
Первые интегралы $u$ и $v$ находятся \tdf{в инволюции}, если $(u,v)=0$.
\end{df}
\begin{theorem}[Лиувилль]
\label{thm::int_liuv}
Если система имеет $n$ первых интегралов
\equ{f_i(q,p,t)=c_i,\quad i=1\sco n,}
все они попарно находятся в инволюции друг к другу:
\equ{(f_i,f_j)=0,\quad 1\le i<j \le n}
и матрица частных производных $\pf{f}{p}$ невырождена,
то система интегрируема по Лиувиллю (в квадратурах).
\end{theorem}
\begin{proof}
Прежде всего отметим, что, в силу условия $\det\pf{f}{p}\neq0$ найдутся функции $\ph_i$ такие, что
\equ{p_i=\ph_i(q,t,c),}
где $c=(c_1\sco c_n)$ константы первых интегралов.
Введём обозначение \equ{H^*(q,c,t)=H\br{q,\ph(q,t,c),t}.}
Прежде чем продолжать доказательство этой теоремы, сформулируем и докажем две вспомогательные леммы.
\begin{lemma}
\label{lem::liuv1}
В условиях теоремы имеем:
\equ{\pf{\ph_i}{q^j}=\pf{\ph_j}{q^i},\quad i,j=1\sco n.}
\end{lemma}
\begin{proof}
Имеем
\equ{f_r\br{q,\ph(q,t,c),c}=c_r\quad\Ra\quad\frac{df_r}{dq^i}=0.}
Раскрывая последнее равенство, получаем, с одной стороны
\equ{0=\pf{f_r}{q^i}+\pf{f_r}{p_j}\pf{\ph_j}{q^i},}
а с другой стороны
\equ{0=\pf{f_s}{q^j}+\pf{f_s}{p_i}\pf{\ph_i}{q^j}.}
Теперь первое из них домножим на $\pf{f_s}{p_i}$ и просуммируем по $i$, второе домножим на $\pf{f_r}{p_j}$
и просуммируем по $j$, после чего из первой суммы вычтем вторую. Вот что получится:
\equ{0=(f_r,f_s)+\pf{f_r}{p_j}\pf{f_s}{p_i}\hr{\pf{\ph_j}{q^i}-\pf{\ph_i}{q^j}}.}
Остаётся заметить, что первое слагаемое равно нулю (интегралы находятся в инволюции). Значит, нулю должно быть
равно и второе слагаемое, то есть матрицы $\pf{\ph_i}{q^j}$ и $\pf{\ph_j}{q^i}$ должны совпадать. Лемма доказана.
\end{proof}
\begin{lemma}
\label{lem::liuv2}
В условиях теоремы имеем:
\equ{\pf{\ph_i}{t}=-\pf{H^*}{q^i},\quad i=1\sco n.}
\end{lemma}
\begin{proof}
Воспользуемся \tstm{леммой~\ref{lem::liuv1}}:
\equ{-\pf{H}{q^i}=\frac{dp_i}{dt}=\pf{\ph_i}{t}+\pf{\ph_i}{q^j}\pf{q^j}{t}=\pf{\ph_i}{t}+\pf{\ph_i}{q^j}\pf{H}{p_j},}
откуда
\equ{\pf{\ph_i}{t}=\pf{H}{q^i}-\pf{H}{p_j}\pf{\ph_j}{q^i}=-\pf{H^*}{q^i}.}
\hfill\end{proof}
Теперь перейдём к доказательству самой теоремы. Две только что доказанные леммы дают нам право утверждать:
может существовать такая $\Cb^2$ гладкая функция $S(q,c,t)$, что
\equ{\pf{S}{q^i}=\ph_i,\quad \pf{S}{t}=-H^*.}
\begin{nbb}
Собственно, этот факт нам никак в дальнейшем не поможет разве только морально.
А вот леммами мы ещё воспользуемся в более разумных целях.
\end{nbb}
Будем искать функцию $S$ в следующем виде:
\equ{S=-\int H^*(q,c,t)dt+V(q,c),}
где
\equ{V(q,c)=V_1(q^1\sco q^n,c)+V_2(q^2\sco q^n,c)+\ldots+V_n(q^n,c).}
Теперь вопрос об интегрировании системы сводится к нахождению функций $V_i$.
Покажем, как определяются функции $V_1$ и $V_2$ дальнейшие выкладки полностью аналогичны.
Итак, имеем:
\equ{p_1=\pf{S}{q^1}=\ph_1(q^1\sco q^n,c,t)=-\int\pf{H^*}{q^1}dt+\pf{V^1}{q^1},}
откуда
\equ{\pf{V^1}{q^1}=\ph_1(q^1\sco q^n,c,t)+\int\pf{H^*}{q^1}dt=:\psi_1(q^1\sco q^n,c).}
Тот факт, что $\psi_1$ действительно не зависит от $t$, проверяется легко, нужно
только вспомнить \tstm{лемму~\ref{lem::liuv2}}:
\equ{\pf{\psi_1}{t}=\pf{\ph_1}{t}+\pf{H^*}{q^1}=0.}
Таким образом
\equ{V_1=\int\psi_1(q^1\sco q^n,c)dq^1.}
Найдём $V_2$. Теперь выкладки будут несколько сложнее:
\equ{p_2=\pf{S}{q^2}=\ph_2(q^1\sco q^n,c,t)=-\int\pf{H^*}{q^2}+\pf{V_1}{q^2}+\pf{V_2}{q^2},}
\equ{\pf{V_2}{q^2}=\ph_2+\int\pf{H^*}{q^2}dt-\pf{V_1}{q^2}=\ph_2+\int\pf{H^*}{q^2}dt-\int\pf{\psi_1}{q^2}dq^1=:\psi_2(q^2\sco q^n,c).}
Независимость от времени проверяется так же, а чтобы убедиться в независимости от $q^1$, нам потребуется лемма \ref{lem::liuv1}:
\equ{\pf{\psi_2}{q^1}=\pf{\ph_2}{q^1}-\pf{\ph_1}{q^2}+\int\pf{^2H^*}{q^1\pd q^2}dt-\int\pf{^2H^*}{q^2\pd q^1}dt=0.}
Итак,
\equ{V_2=\int\psi_2(q^2\sco q^n,c)dq^2,}
и теорему можно считать доказанной.
\end{proof}
\begin{note}
Если $\pf{H}{t}=0$, система имеет интеграл энергии $H=h$ и нам достаточно найти ещё $n-1$ первых интегралов.
Так, для тяжелого твёрдого тела с неподвижной точкой ($n=3$) есть имеют место интегралы $H=h$ и $K_z=k$.
Однако третьего интеграла в общем случае не существует.
\end{note}

\subsection{Переменные <<действие угол>>}

Будем рассматривать консервативную гамильтонову систему и каноническое преобразование с характеристической  функцией Гамильтона $V(q,\ti{p}).$
Пусть новые координаты удовлетворяют условиям
\equ{\dot{\ti{q}}=\pf{\ti{H}}{\ti p}=\om(\ti p),\quad \dot{\ti p}=0,}
то есть
\equ{\ti p=\ti p_0,\quad \ti q=\om(\ti p_0)t+\ti q_0.}
Такие переменные принято называть переменными <<действие угол>> и обозначать $I,\,\om.$
\begin{nbb}
То есть $\om$ будет в дальнейшем обозначать $\ti q$, если $\ti q$ переменная угол. Не путать с тем $\om$,
которое фигурирует в приведенных выше выкладках!
\end{nbb}

\subsubsection{Пример: простейший гармонический осциллятор}

Уравнения движения гармонического осциллятора имеют вид
\equ{m\ddot x+kx=0,}
функция Лагранжа
\equ{L=\frac12m\dot x^2-\frac12kx^2.}
Для простоты полагаем $m=1,\,k=1$ (этого всегда можно добиться выбором подходящих единиц измерения).
Гамильтониан запишется так:
\equ{H=\frac12p^2+\frac12x^2=h.}
Ясно, что фазовый портрет такой системы состоит из концентрических окружностей вида \equ{p^2+x^2=2h.}
Определим переменную действие так:
\ml{I=\frac1{2\pi}\oint pdx=\frac1{2\pi}\oint\sqrt{2h-x^2}dx=\{x=\sqrt{2h}\sin y\}=\frac1{2\pi}2h\intl{0}{2\pi}\cos^2ydy=\\
=\frac1{2\pi}2h\intl{0}{2\pi}\frac{1+\cos2y}2dy=2h.}
Таким образом, переменной действия в данном случае будет просто интеграл энергии и, следовательно, $\ti H=I$.
Характеристическая функция Гамильтона будет равна
\equ{V(x, I)=\int pdq=\int\sqrt{2h-x^2}dx=\int\sqrt{2I-x^2}dx,}
откуда находим переменную угол:
\equ{\om(I)=\pf{V}{I}=\int\frac{dx}{\sqrt{2I-x^2}}=\arcsin\frac{x}{\sqrt{2I}}.}
Выражая через <<старые>> переменные, окончательно имеем:
\equ{I=\frac{p^2+x^2}2,\quad \om=\arcsin\frac x{\sqrt{p^2+x^2}}.}
Осталось убедиться, что это действительно переменные действие угол:
\equ{\dot{\om}=\pf{\ti H}{I}=1,\quad \dot I=-\pf{\ti H}{\om}=0.}

\subsubsection{Пример: математический маятник}

Напомним, что гамильтониан для математического маятника имеет вид
\equ{H=\frac12\frac{p^2}{ml^2}-mgl\cos\ph.}
Как обычно, будем предполагать, что $m=1,\, l=1,\, g=1.$
Тогда гамильтониан станет проще:
\equ{H=\frac12p^2-\cos\ph=h.}
Теперь нам придётся рассмотреть два случая. Первый случай соответствует условию $|h|<1$.
В силу этого условия фазовые траектории замкнуты и система совершает малые колебания вблизи положения
равновесия (маятник <<качается>>).
Введём величину $\be$ такую, что $-\cos\be=h.$ Выражая через неё импульс (точнее, его квадрат), получим
\equ{p^2=2(\cos\ph-\cos\be)=4\hr{\sin^2\frac{\be}2-\sin^2\frac{\ph}2}=4\hr{k_1^2-\sin^2\frac{\ph}2},}
где, как несложно догадаться, $k_1^2=\sin^2\frac{\be}2.$
Теперь запишем выражение для переменной действие
\ml{
2\pi I=\oint pd\ph=2\oint\sqrt{k_1^2-\sin^2\frac{\ph}2}d\ph=8\intl{0}{\be}\sqrt{k_1^2-\sin^2\frac{\ph}2}d\ph=\\
=\{\sin\frac{\ph}2=k_1\sin\psi\}=16\intl{0}{\pi/2}\frac{k_1^2(1-\sin^2\psi)d\psi}{\sqrt{1-k_1^2\sin^2\psi}}=
16\intl{0}{\pi/2}\frac{k_1^2-1+1-k_1^2\sin\psi}{\sqrt{1-k_1^2\sin^2\psi}}=\\
=16\hs{\intl{0}{\pi/2}\sqrt{1+k_1^2\sin^2\psi}d\psi-(1-k_1^2)\intl{0}{\pi/2}\frac{d\psi}{\sqrt{1-k_1^2\sin^2\psi}}}.
}
Итак, окончательно запишем:
\equ{I=I(k_1)=\frac8{\pi}\hs{E(k_1)-(1-k_1^2)K(k_1)},}
где $E(k_1)$ и $K(k_1)$ эллиптические интегралы первого и второго рода соответственно.
Теперь найдём переменную угол:
\equ{\dot{\om}=\frac{d\ti H}{dI}=\frac{d\ti H/dk_1}{dI/dk_1}=\frac{4k_1}{dI/dk_1}=
4k_1\frac{\pi}8\hs{\frac{E-K}{k_1}-\frac E{k_1}+\frac{1-k_1^2}{k_1}K+2k_1K}^{-1}=\frac{2\pi}{K(k_1)}.}

Для полноты картины, выпишем характеристическую функцию:
\ml{V(\ph,h)=\int pd\ph=2\int\sqrt{k_1^2-\sin^2\frac{\ph}2}d\ph=4\int\frac{k_1^2-1+1-k_1^2\sin^2\psi}{\sqrt{1-k_1^2\sin^2\psi}}d\psi=\\
=4\hs{\Es(\psi,k_1)-(1-k_1^2)\Ks(\psi,k_1)},}
где $\Es$ и $\Ks$ эллиптические интегралы первого и второго рода.

Теперь перейдём ко второму случаю: $h>1$. При $\ph=0$ и $p=p_0$ имеем:
\equ{h=\frac12p_0^2-1=\frac2{k_2^2}-1,}
где величину $k_2$ по определению полагаем такой, чтобы выполнялось равенство
\equ{p_0^2=\frac4{k_2^2}.}
Найдём переменную действие:
\ml{I=\frac1{2\pi}\oint pd\ph=\frac1{2\pi}\oint\sqrt{2(h+\cos\ph)}d\ph=\frac1{\pi k_2}\intl{-\pi}{\pi}\sqrt{1-k_2^2\sin^2\frac{\ph}2}d\ph
=\{\ph=2\theta\}=\\=\frac1{\pi k_2}\intl{-\pi/2}{\pi/2}\sqrt{1-k_2^2\sin^2\theta}d\theta=\frac4{\pi k_2}E(k_2).}
Теперь угол:
\equ{\dot{\om}=\frac{\pd \wt H/\pd k_2}{\pd I/\pd k_2}=-\frac1{k_2^3}\frac{k_2}{E-K}=\frac{K(k_2)-E(k_2)}{K-2^2}.}
И, наконец, характеристическая функция (выкладки пропущены, так не содержат в себе ничего нового):
\equ{V(\ph,h)=\frac4{k_2}\Es\hr{\frac{\ph}2,k_2}.}


\section{Теория устойчивости}

\subsection{Основные понятия теории устойчивости}

Приводимые здесь определения относятся скорее к теории ОДУ, чем к аналитической механике, но тем не
менее не лишним будет их напомнить.

Итак, мы будем рассматривать уравнения вида \eql{\dot{z}=Z(t,z),}{odu} где под $z$ подразумеваются
все фазовые переменные системы, а под $t$ время. А если говорить формально, $t\in I=[0,+\infty)$,
а $z$ принадлежит некоторой области $D^n$ в $n$-мерном (действительном) пространстве. Также будем
предполагать, что
\eqn{Z(t,z)\cln I\times D^n\ra\R^n, \quad Z\in \Cb^{1,1}.}

Мы будем использовать следующие стандартные обозначения: \equ{z_0(t)=z(t,t_0,z_0)} решение
уравнения \eqref{odu}, проходящее через точку $z_0$ в момент времени $t_0$;
\equ{z_*(t)=z(t,t_0,z_*)} решение уравнения \eqref{odu}, проходящее через точку
$z_*$ в момент времени $t_0$.

Зафиксируем функцию
\equ{y(t,z)\cln I\times D^n\ra\R^n, \quad y \in\Cb^{1,1}}
\begin{df}
Движение (то есть решение уравнения~\eqref{odu}) $z_0(t)$ называется \tdf{устойчивым по Ляпунову} относительно
функции $y(t,z)$, если для любого $t_0\in I$ и любого достаточно малого~$\ep$
существует $\de=\de(t_0,\ep)$ такое, что \equ{\De(t)=\hn{y(t,z_0(t))-y(t,z_*(t))}\le\ep} для
любых значений $t\in J=[t_0,+\infty)$ и любых решений $z_*$, если только $\hn{z_0-z_*}<\de.$
В противном случае движение называется \tdf{неустойчивым}.
\end{df}
\begin{df}
Движение называется \tdf{асимптотически устойчивым}, если оно устойчиво и
\equ{\liml{t\ra+\infty}{}\De(t)=0.}
\end{df}
\begin{note}
В дальнейшем мы будем считать, что размерность вектор функции $y(t,z)$ совпадает с
размерностью $z$ (так делал и сам Ляпунов). Более того, мы положим $y\equiv z$.
\end{note}
\begin{df}
Пусть $z=z_0(t)+x$, тогда уравнения \eql{\dot{x}=Z(t,z_0(t)+x)-Z(t,z_0(t))=X(t,x)}{odu_spoiled}
будем называть \tdf{уравнениями возмущенного движения}. При этом полагаем, что
\equ{t\in I,\ x\in B_\rho=\hc{x\in\R^n\cln\hn{x}<\rho},}
а функция $X$ удовлетворяет условиям
\equ{X(t,x)\cln I\times B_{\rho}\ra\R^n,\quad X \in \Cb^{1,1}, \quad X(t,0)=0.}
\end{df}
\begin{df}
Говорят, что $V(t,x)$ \tdf{функция Ляпунова} (обозначение: ${V(t,x)\in\Ls}$), если
\equ{V(t,x)\cln I\times B_{\rho}\ra\R,\quad V \in \Cb^{1,1},\quad V(t,0)=0.}
\end{df}
\begin{note}
В силу \eqref{odu_spoiled}, очевидно, имеем
\equ{\dot{V}(t,x)=\frac{dV}{dt}=\pf{V}{t}+\spr{\pf{V}{x}}{X}.}
\end{note}
\begin{df}
Будем говорить, что $a(r)$ \tdf{функция Хана} (обозначение: $a(r)\in\Ks$), если
\equ{a(r)\cln[0,r_0]\ra\R,\quad a \in \Cb,\quad a(0)=0} и строго возрастает на $[0,r_0]$.
\end{df}

\subsection{Теоремы Ляпунова и Четаева}

В этих теоремах часто мы будем писать просто <<$V(t,x)$>>. Естественно, нужно понимать, что вместо буковки $x$ мы будем
подставлять туда решение $x(t)$ (в противном случае неясно, какое отношение функция имеет к решению уравнения).
Значок нормы будет обозначать обычную норму в $\R^n$.

\begin{theorem}[А.\,М.\,Ляпунов]
\label{th_lyap_2}
Если найдутся функции $V\in\Ls$ и $a\in\Ks$ такие, что
\begin{nums}{-2}
  \item $V(t,x)\ge a(\hn{x})$,
  \item $\dot{V}(t,x)\le0$,
\end{nums}
то невозмущенное решение $x=0$ системы \eqref{odu_spoiled} устойчиво.
\end{theorem}
\begin{proof}
Выберем $t_0\in I$ и $\ep>0$, с тем условием, однако, чтобы $\ep<\ep_0=\min\{r_0,\rho
\}$. Тогда, согласно определению функции Хана, $a(\ep)>0$, а значит найдется такое
$\de=\de(\ep,t_0)>0$, что $V(t_0,x_*)<a(\ep)$ для любого $x_*\in B_{\de}$. Для такого
$x_*$, в силу первого условия теоремы, можно записать \equ{a(\hn{x_*(t)})\le
V(t,x_*(t)).} С другой стороны, в силу второго условия, выполняется неравенство
$V(t,x_*(t))\le V(t_0,x_*(t_0))$. Собирая полученные неравенства воедино, запишем
\equ{a(\hn{x_*(t)})\le V(t,x_*(t))\le V(t_0,x_*(t_0))<a(\ep)\quad\Ra\quad\hn{x_*(t)}<\ep,}
что и требуется.
\end{proof}
\begin{note}
Здесь нам не понадобилась непрерывность функции Хана, мы использовали только ее неубывание.
\end{note}
\begin{theorem}
Если найдутся функции $V(t,x)\in\Ls$ и $a,b,c\in\Ks$ такие, что
\begin{nums}{-2}
  \item $a(\hn{x})\le V(t,x)\le b(\hn{x})$,
  \item $\dot{V}(t,x)\le -c(\hn{x})$,
\end{nums}
то невозмущенное решение $x=0$ системы \eqref{odu_spoiled} асимптотически устойчиво.
\end{theorem}
\begin{proof}
Согласно предыдущей теореме, такое решение будет устойчиво, то есть в любой момент времени $t_0$ и
для любого положительного $\ep$ найдется такое $\de=\de(t_0,\ep)>0$, что
для всех $x_*\in B_\de$ и всех $t\in J=[t_0,+\infty)$ выполнено $\hn{x_*(t)}<\ep$.
Таким образом, пользуясь условиями
теоремы, получаем, что функция $V(t,x_*)$ строго убывает по $t$ и при этом \equ{0\le
V(t,x_*(t))\le b(\ep).} Следовательно, у функции $V(t,x_*(t))$ существует предел
$\liml{t\ra\infty}{}V(t,x_*(t))=v\ge0.$

Покажем, что на самом деле $v=0$. Допустим, что $v>0$. Тогда:
\equ{V(t,x_*(t))\ge v>0\quad\Ra\quad
b(\hn{x_*(t)})\ge v>0\quad\Ra\quad
\hn{x_*(t)}\ge\ga>0\quad\Ra\quad
c(\hn{x_*(t)})\ge c>0.}
С другой стороны, согласно второму
условию теоремы, можем записать:
\equ{V(t,x_*(t))=V(t_0,x_*)+\intl{t_0}{t}\dot{V}(t, x_*(t))\,dt\le V(t_0,x_*(t_0))-c(t-t_0).}
Отсюда следует, что, при достаточно больших значениях $t$ функция $V$
становится отрицательной, что противоречит условиям теоремы.

Итак, мы доказали, что $\liml{t\ra\infty}{}V(t,x_*(t))=v=0$. C другой стороны, по условию,
\equ{0\le a(\hn{x_*(t)})\le V(t,x_*(t)),}
откуда
\equ{\liml{t\ra+\infty}{}a(\hn{x_*(t)})=0,} а значит и
\equ{\liml{t\ra+\infty}{}\hn{x_*(t)}=0,}
что и требовалось доказать.
\end{proof}

\begin{theorem}[Н.\,Г.\,Четаев]
Если найдется такое $t_0\in I$ и такое достаточно малое $\ep$,
а также открытая область $\Om\subset B_\ep$, такая, что
$0\in\pd\Om$ и функции $V\in\Ls$, $a\in\Ks$,
удовлетворяющие условиям
\xtrpicturep{7}{7}
\begin{nums}{-2}
  \item $0<V(t,x)\le M$ для всех $x\in\Om$ и $t\in J$, где $M = \const$,
  \item $\dot{V}(t,x)\ge a(V)$ для всех $x\in\Om$ и $t\in J$,
  \item $V(t,x)=0$ при любых $x\in\pd\Om\cap B_{\ep}$ и $t\in J$,
\end{nums}
то невозмущенное движение $x=0$ системы \eqref{odu_spoiled} неустойчиво.
\end{theorem}
\begin{petit}
  Зачем нужно было $t_0$ в условии?
\end{petit}
\begin{proof}
Для любого положительного $\de<\ep$ найдется такое $x_*\in B_{\de}\cap\Om$, что
$V(t_0,x_*)>0$. Если допустить, что $x_*(t)\in\Om$ при любом $t\in J$, получим
\equ{V(t,x_*(t))=V(t_0,x_*)+\intl{t_0}{t}\dot{V}(t,x_*(t))\,dt\ge
V(t_0,x_*)+a\hr{V\br{t_0,x_*(t_0)}}(t-t_0),} что противоречит условию ограниченности $V$. Следовательно,
найдется такое $t_1\in J$, что $x_*(t_1)\in\pd\Om$ и при этом $V(t_1,x_*(t_1))>0$, а
значит, по третьему условию теоремы, $x_*(t_1)\notin\pd\Om\cap B_{\ep}$. Таким образом,
неизбежно получаем $\hn{x_*(t_1)}=\ep$, что и завершает доказательство.
\end{proof}

\subsection{Теоремы об устойчивости для стационарных систем}

Рассмотрим систему вида
\eql{\dot{x}=X(x),\quad X\cln B_{\rho}\ra\R^n,\quad X \in \Cb^1,\quad X(0)=0.}{odu_2} Выделим
в ней линейную часть:
\equ{\dot{x}=Ax+o(\hn{x}),\ A=\hr{\pf{X}{x}}\evu{x=0}{12pt}{1.4pc}} и запишем
характеристическое уравнение \eql{f(\la)=|A-E\la|=0.}{eq_char}
\begin{theorem}[А.\,М.\,Ляпунов]
\label{th_lyap_1}
Если все корни характеристического уравнения \eqref{eq_char} имеют отрицательную вещественную
часть, то невозмущенное решение $x=0$ системы \eqref{odu_2} асимптотически устойчиво; если
найдется хотя бы один корень с положительной вещественной частью, то неустойчиво.
\end{theorem}
\begin{proof}
Без доказательства.
\end{proof}
\begin{theorem}[Барбашина-Красовского]
 Пусть найдется функция $V\in\Ls$, удовлетворяющая следующим условиям:
 \begin{enumerate}
 \item $\dot V(\bar x) \le 0$
 \item Множество $\dot V(\bar x) = 0$ не содержит решений исходого уравнения, отличных от нулевого.
 \end{enumerate}
 В таком случае решение $\bar x = 0$ является ассимптотически устойчивым.
\end{theorem}

\begin{theorem}[Критерия Рауса-Гурвица]
  Запишем уравнение (\ref{eq_char}) в виде
\begin{displaymath}
 f(\la) = a_0\la^n+a_1\la^{n-}+\dots+a_1\la+a_0 =0
\end{displaymath}
Тогда условие отрицательности вещественных частей всех корней
эквивалентно условию положительности всех главных миноров матрицы,
построенной по следующим правилам:
  \begin{petit}
        В книжке матрица была нарисована, и рисунок совпадает с
        описанием, приведенным далее, одолженным с википедии, с точностью до транспонирования.
  \end{petit}
  \begin{enumerate}
  \item по главной диагонали слева направо выставляются все
    коэффициенты характеристического уравнения от $a_1$ до $a_n$
  \item от каждого элемента диагонали вверх и вниз достраиваются
    столбцы определителя так, чтобы индексы убывали сверху вниз
  \item на место коэффициентов с индексами меньше нуля или больше $n$ ставятся нули.
  \end{enumerate}
\end{theorem}

\begin{theorem}[Красовского об асимптотической неустойчивости]
  Пусть найдутся $V\in\Ls$, $\Om\subset B_\rho$, удовлетворяющие условиям
  \begin{enumerate}
  \item $\bar 0 \in \Om$
  \item $V(\bar x) > 0, \quad \bar x\in\Om$
  \item множество $\hc{\bar x\colon \dot V(\bar x ) = 0} $ не содержит ненулевых решений исходной системы.
  \end{enumerate}
  Тогда решение $\bar x = \bar 0$ является неустойчивым.
\end{theorem}

{}

Рассмотрим консервативную голономную систему, описываемую уравнением Лагранжа
\equ{\frac{d}{dt}\pf{T}{\dot{q}}-\pf{T}{q}=-\pf{V}{q},} где
\equ{T=\frac12\spr{A(q)\dot{q}}{\dot{q}},} имеющую положение равновесия при $q=q_0,\ \dot{q}=0$,
причем \equ{\pf{V}{q}\evu{q=q_0}{12pt}{1.4pc}=0.}
\begin{theorem}[Лагранжа Дирихле об устойчивости положения равновесия консервативной голономной системы]
Если $V(q)$ имеет в положении равновесия $q_0$ строгий локальный минимум, то это положение
равновесия устойчиво.
\end{theorem}
\begin{proof}
Нужно применить \tdf{теорему Ляпунова~\ref{th_lyap_2}}, взяв $W(q,\dot{q})=T+V-V(q_0)$ в качестве функции Ляпунова.
\end{proof}
\begin{note}
Обратное утверждение неверно, и примером тому может служить функция Уитнера:
\equ{
  V(q)= \bcase{
    &e^{-1/\hn{q}}\cos\frac{1}{\hn{q}}, & q\ne0; \\
    &0, & q=0.}}
\end{note}
Пусть $q=q_0$ критическая точка потенциала $V(q)$,
то есть ${V'(q_0)=0}$. Сделаем замену $q=q_0+x$ и разложим
функцию $V(x)$ в ряд Тейлора в точке $x=0$:
\equ{V(x)=V(0)+\frac{x^m}{m!}V^{(m)}(0)+\ldots,} где $V^{m}(0)$
первая ненулевая производная. Тогда, как видно из следующей теоремы,
устойчивость точки равновесия $x=0$ определяется знаком этой
производной.
\begin{theorem}
\label{th_lyap_3}
Если во всякой окрестности нуля найдётся точка~$x$, в которой $V^{(m)}(x)<0$,
то состояние равновесия $x=0$ неустойчиво.
\end{theorem}
\begin{note}
Эта теорема была доказана
\begin{enumerate}
  \item для $m=2$ самим Ляпуновым;
  \item для $m=2k+1$ В.\,В.\,Козловым;
  \item для $m=2k$ В.\,В.\,Козловым и В.\,П.\,Паламодовым.
\end{enumerate}
\end{note}
Мы её докажем только для случая $m=2$.
\begin{proof}
В этом случае разложение имеет вид:
\equ{V(q_0+x)=V(q_0)+\frac12\hr{C x,x}+\ldots,} где
\equ{C=\pf{^2V}{q^2}\evu{q=q_0}{12pt}{1.4pc}.} Как было установлено
ранее, линеаризация уравнений движения вблизи точки равновесия будет
в этом случае иметь вид \equ{A\ddot{x}+Cx=0.} С помощью
ортогонального преобразования координат это уравнение можно
преобразовать к виду \equ{\ddot{\xi}+K\xi=0,} где
$K=\diag(\ka_1\sco\ka_k).$ Его характеристическое уравнение будет
таким: \equ{(\la^2+\ka_1)\cdot\ldots\cdot(\la^2+\ka_k)=0.} В силу
условия теоремы, среди $\ka_j$ будут отрицательные, а значит
некоторые корни будут иметь положительную вещественную часть,
откуда, по \tstm{теореме~\ref{th_lyap_1}}, такое решение будет неустойчивым.
\end{proof}
\begin{df}
Число отрицательных капп~$\ka_j$ называется \tdf{степенью неустойчивости}
системы.
\end{df}
\begin{stm}
\label{stm::signature}
Для определения степени устойчивости системы вместо того, чтобы считать количество
отрицательных корней уравнения
\equ{\det(A\ka-C)=0}
достаточно считать количество отрицательных корней уравнения
\equ{\det(E\theta-C)=0.}
\end{stm}
\begin{proof}
Рассмотрим ортогональную замену координат $B$, при которой матрица $A$ диагонализуется.
При этом в новом базисе матрица $C$ будет иметь вид $B^{-1} CB$, и её сигнатура останется
прежней. После этого с помощью положительной диагональной замены (которая тоже не поменяет сигнатуры),
сделаем из неё единичную матрицу.
\end{proof}
\subsection{Теоремы Кельвина Четаева о влиянии гироскопических диссипативных сил на устойчивость}

Рассмотрим голономную стационарную механическую систему под действием потенциальных сил, в которой
выполняются уравнения Лагранжа вида \eql{\frac{d}{dt}\pf{T}{\dot{q}}=\pf{T}{q}-\pf{V}{q}}{La} и
предположим, что в точке $q_0$ эта система имеет положение равновесия. Выясним, как на устойчивости
этого положения равновесия может сказаться появление в системе гироскопических и диссипативных сил,
при наличии которых уравнения Эйлера Лагранжа принимают вид
\eql{\frac{d}{dt}\pf{T}{\dot{q}}=\pf{T}{q}-\pf{V}{q}+Q_g+Q_d.}{Lgd} Здесь $Q_g=Q_g(q,\dot{q})$
гироскопические силы, то есть
\eql{Q_g(q,0)=0,\quad\spr{Q_g}{\dot{q}}=0}{g_eq,} а
$Q_d=Q_d(q,\dot{q})$, соответственно, диссипативные:
\eql{Q_d(q,0)=0,\quad \spr{Q_d}{\dot{q}}\le0.}{d_eq}
Диссипативные силы называют \tdf{силами с полной диссипацией}, если при
всех ненулевых значениях $\dot{q}$ выполнено условие
\equ{\spr{Q_d}{\dot{q}}<0.}

\begin{theorem}
\label{gir_diss_stable}
Если потенциальная энергия имеет строгий локальный минимум в положении равновесия, то оно остается
устойчивым при добавлении гироскопических и (или) диссипативных сил.
\end{theorem}
\begin{proof}
Воспользуемся \tstm{теоремой Ляпунова~\ref{th_lyap_2}},
в качестве функции Ляпунова взяв
\equ{W=T\bw+V\bw-V(q_0).}
Действительно, в силу стационарности исходной системы,
имеем
\equ{\dot{W}= \spr{Q_d}{\dot{q}}\le0.}
\begin{nbb}
Откуда следует данное равенство, мы не совсем понимаем. Также не вполне понятно, почему найдётся
функция Хана из теоремы Ляпунова. Возможно, мы поймём это когда нибудь потом.
\end{nbb}
\end{proof}
\begin{theorem}
\label{gir_diss_stable_asymp}
Если потенциальная энергия имеет строгий локальный минимум в точке $q_0$ и это положение равновесия
является изолированным, то оно становится асимптотически устойчивым при добавлении диссипативных
сил с полной диссипацией (вне зависимости от наличия либо отсутствия гироскопических сил).
\end{theorem}
\begin{proof}
Без доказательства.
\end{proof}
\begin{theorem}
\label{gir_unstable}
Если потенциальная энергия не имеет в положении равновесия $q_0$ даже нестрогого локального
минимума и это равновесие является изолированным, то оно становится неустойчивым при добавлении
диссипативных сил с полной диссипацией (вне зависимости от наличия либо отсутствия гироскопических
сил).
\end{theorem}
\begin{proof}
Без доказательства.
\end{proof}
\begin{theorem}
\label{gir_odd}
Если степень неустойчивости положения равновесия системы при ${q=q_0}$ является нечётной, это
положение равновесия остается неустойчивым при добавлении гироскопических сил (в отсутствии
диссипативных).
\end{theorem}
\begin{proof}
Полагая $x=q-q_0$, выпишем уравнения малых колебаний в окрестности положения равновесия:
\equ{A\ddot{x}+G\dot{x}+Cx=0.} Здесь $G$ матрица гироскопических сил:
\equ{G=-\pf{Q_g}{\dot{q}}\evu{q=q_0}{12pt}{1.4pc}.} Запишем характеристическое уравнение полученной
системы: \equ{f(\la)=\det(A\la^2+G\la+C)=0.} Теперь ключевое соображение: нам известно, что число
отрицательных корней уравнения \equ{\det(A\ka-C)=0,} а значит, в силу \tstm{утверждения~\ref{stm::signature}},
также и уравнения $\det(E\theta-C)=0$, нечётно. Как несложно заметить, из этого
следует, что $\det C<0$. Таким образом, имеем: $f(0)\bw=\det C<0,$ откуда следует, что найдется такое
действительное значение $\la_0>0$, что $f(\la_0)=0$, а значит, в силу \tstm{теоремы Ляпунова~\ref{th_lyap_1}}, имеет место
неустойчивость.
\end{proof}
\begin{note}
Если степень неустойчивости положения равновесия четна (и положительна), то, в некоторых случаях,
при надлежащем выборе гироскопических сил это положение равновесия может быть сделано устойчивым.
\end{note}
\subsection{Теорема Рауса об устойчивости стационарных движений и понятие об её обращении}
\begin{theorem}
  Если приведенный потенциал имеет строгий локальный минимум в точке
  $r_0(p_0)$ при фиксированных значениях постоянныхциклических
  интегралов $p_0$, то стационарное движение устойчиво по отношению к
  позиционным переменным и импульсам циклических координат.
\end{theorem}
\begin{theorem}
  Если степень неустойчивости по Пуанкаре положения равновесия $r =
  r_0(p_0)$ приведенной системы нечетна, то стационарное движение
  неустойчиво.
\end{theorem}

\subsection{Пример: Устойчивость треугольных точек либрации~плоской~круговой~ограниченной~задаче~трех~тел}
В качестве примера рассмотрим следующую задачу.
\begin{petit}
  Вообще-то первая часть параграфа была в начале, и она там неплохо
  смотрелась. Но т.к на неё ничего не опирается, я собрал все, что
  использует эту модель про Солнце, Юпитер и астероид, вместе.
\end{petit}
\label{sssec:three-solid-problem}

Три тела назовем так: Солнце ($S$), Юпитер ($J$), и астероид ($A$).
Пусть ${m_A\ll m_J \ll m_S}$ и предположим, что влиянием астероида на
движение Солнца и Юпитера можно пренебречь (это и означает
<<ограниченность>> задачи). Кроме того, для простоты считаем, что все
они движутся в одной плоскости, а Солнце и Юпитер по окружностям
(тогда, очевидно, центр этих окружностей это их общий центр
масс). Введем подвижную систему координат $Oxyz$, где $O$ совпадает с
центром этой окружности, а ось $Ox$ с прямой $SJ$ (\emph{рис. 4}).
\xtrpicturep{1}{4} Эта система вращается со скоростью
$\vb{\om}_{Oxyz}=\om\vb{e}_z$.  Вспоминая замечание (\ref{ref:moving-system}), запишем
\equ{\vb{v}=(\dot{x}-\om y)\vb{e}_x+(\dot{y}+\om x)\vb{e}_y,} так как
в нашем случае
\equ{\vb{\rho}=x\vb{e}_x+y\vb{e}_y,\ \vd{\rho}=\dot{x}\vb{e}_x+\dot{y}\vb{e}_y,\ \vpr{\om}{\vb{\rho}}=\vpr{\om\vb{e}_z}{\hr{x\vb{e}_x+y\vb{e}_y}}=\om\hr{-y\vb{e}_x+x\vb{e}_y},}
а скорость начала подвижной системы координат равна нулю. Теперь можно
посчитать кинетическую энергию и потенциал:
\equ{T=\frac{m_A}{2}\BS{\hr{\dot{x}^2+\dot{y}^2}+2\om\hr{x\dot{y}-y\dot{x}}+\om^2\hr{x^2+y^2}}=:T_2+T_1+T_0,}
\equ{V=-\ga
  m_A\hr{\frac{m_S}{|\overline{AS}|}+\frac{m_J}{|\overline{AJ}|}}.}
Здесь $\ga$~--- это константа данной системы. Пришло, однако, время
облегчить себе жизнь, введя удобные единицы измерения. А именно, мы
положим равными единице следующие величины:
$\ga,\ m_S+m_J,\ |\overline{SJ}|,\ \om.$ Кроме того, пусть $\mu=m_J$,
тогда, очевидно, можно записать \equ{m_S=1-\mu,\ x_S=\mu,\ x_J=1-\mu.}
Теперь выражение для потенциальной энергии примет вид
\equ{V=-m_A\hr{\frac{1-\mu}{\sqrt{(x+\mu)^2+y^2}}+\frac{\mu}{\sqrt{(1-\mu-x)^2+y^2}}}=V(x,y).}
Сократим на $m_A$ и обозначим $\tilde V = \frac{1}{m_A}V$
Запишем, наконец, уравнения Лагранжа для нашей системы
\equ{\begin{cases}
    \ddot{x}-2\dot{y}+x-\pf{\tilde V}{x}=0,
    \\ \ddot{y}+2\dot{x}+y-\pf{\tilde V}{y}=0.
\end{cases}
}
Или, через приведенный потенциал $\tilde W=\tilde V- \frac{1}{m_A}T_0=\tilde V-\frac{1}{2}(x^2+y^2)$
\equ{\begin{cases}
  \ddot{x}-2\dot{y}-\pf{W}{x}=0, \\
  \ddot{y}+2\dot{x}-\pf{W}{y}=0.
\end{cases}
}
\begin{nbb}
На случай, если кому то покажется, что в этих выкладках теряется множитель~$\frac{m_A}{2}$,
поясняю: мы на него просто сокращаем, так как он фигурирует во всех слагаемых.
\end{nbb}

Пусть  $r_S=\sqrt{(x+\mu)^2+y^2},\ r_J=\sqrt{(x+\mu-1)^2+y^2}$. Тогда
\equ{W'_x=xm_A\hr{-1+\hr{\frac{1-\mu}{r_S^3}+\frac{\mu}{r_J^3}}}+\mu(1-\mu)\hr{\frac{1}{r^3_S}-\frac{1}{r^3_J}},}
\equ{W'_y=ym_A\hr{-1+\hr{\frac{1-\mu}{r_S^3}+\frac{\mu}{r_J^3}}}.} Положения, удовлетворяющие
условию $W'_x=W'_y=0,$ и есть точки либрации. Их принято разделять на линейные точки либрации
$L_{1,2,3}$, для которых $y=0$, и треугольные точки либрации $L_{4,5}$, для которых
\equ{r_S=r_J=1,\quad y=\pm\frac{\sqrt{3}}{2},\quad x=\frac12-\mu.} О линейных точках либрации скажем лишь,
что их степень неустойчивости равна единице, откуда следует, что они остаются неустойчивыми при
добавлении гироскопических сил. Треугольные точки либрации мы исследуем более подробно.

Выпишем значения вторых производных функции $W$ в этих точках:
\equ{W''_{xx}=-\frac{3}{4},\quad
W''_{xy}=\pm\frac{3\sqrt{3}}{4}(2\mu-1),\quad
W''_{yy}=-\frac{9}{4}.}
Таким образом, определитель
матрицы вторых производных равен $\frac{27}{4}\mu(\mu-1)<0$. Следовательно, приведенный потенциал
имеет в треугольных точках либрации строгий максимум и степень неустойчивости этих точек равна
двум.

Убедимся, что в наличие гироскопических сил действительно может сделать устойчивыми положения
равновесия в этих точках. Уравнения малых колебаний примут вид:
\equ{\bcase{
     \ddot{x}-2\dot{y}+\frac{3}{4}x\pm\frac{3\sqrt{3}}{4}(2\mu-1)y=0 \\
     \ddot{y}+2\dot{x}\pm\frac{3\sqrt{3}}{4}(2\mu-1)x-\frac{3}{4}y=0}}
и характеристическое уравнение будет таким:
\equ{f(\la)=\la^4+\la^2+\frac{27}{4}\mu(1-\mu)=0.}
Устойчивость будет иметь место в том случае, если корни этого уравнения окажутся чисто мнимыми, что
эквивалентно наличию только действительных отрицательных корней у уравнения
\equ{\ph(z)=z^2+z+\frac{27}{4}\mu(1-\mu)=0.} Как несложно убедиться, для этого необходимо, чтобы
\equ{27\mu(1-\mu)<1.} Для системы <<Солнце Юпитер>> это условие действительно выполняется; в
окрестности треугольных точек либрации этой системы наблюдаются большие скопления астероидов.

\begin{nbb}
В связи с этой задачей уместно привести следующий интересный факт (он имеет отношение
к гамильтоновым системам вообще и данной задаче в частности). Именно, гамильтонова система
\textbf{не~может быть асимптотически устойчивой}, потому что для асимптотически устойчивых систем
отображение фазового потока будет сжимающим, а у гамильтоновых систем фазовый объём сохраняется
(теорема Лиувилля).
\end{nbb}

\subsection{Стационарные движения гантели Белецкого.}
 Рассмотрим задачу о плоском движении двухмассовой системы
 (<<гантели>>). <<Гантель>>, представляющая собой две точки А и В
 массы $m/2$ каждая, соединенные стержнем $АВ$ нулевой массы и длины
 $2a$, движется в неподвижной плоскости $Оху$ под действием сил
 ньютоновского притяжения к точке О (рисунка нет, а должен). Положение
 <<гантели>> будем характеризовать полярными координатами $r$ и $\ph$
 ее центра масс и углом $\theta$ поворота <<гантели>> относительно
 радиуса-вектора центра масс. Выбираяединицы измерения так, что $m = 1$,
 $a = 1$ и гравитационная постоянная $\mu=1$, выпишем выражения для
 кинетической Г и потенциальной V энергии системы:
 \begin{displaymath}
   \begin{array}{c}
     T = \half({\dot r}^2+r^2{\dot\ph}^2)+\half(\dot\ph+\dot\theta)^2\\
     V = -\half\hr{\frac{1}{\hr{r^2 - 2r\cos\theta+1}^{1/2}} +\frac{1}{\hr{r^2 + 2r\cos\theta+1}^{1/2}}}
   \end{array}
 \end{displaymath}
 \begin{petit}
   Вопрос -- откуда берется второе слагаемое в первой скобке в кинетической энергии?
 \end{petit}
 \begin{petit}
   Дальше идет много матана и $\ph$ -- циклическая переменная.
 \end{petit}
\subsection{Маятник с вибрирующей точкой подвеса}
\begin{petit}
  Все это есть в книжке автора. Здесь оно тоже будет.
\end{petit}
Пусть вибрации точки подвеса описываются уравнением $y =
a\sin(\frac{\om t}{\ep})$, где $\om = \sqrt\frac{g}{l}$.
\newcommand{\hzz}{\frac{\om t}{\ep}}
\begin{displaymath}
  \begin{array}{cc}
    x = l \sin\ph,&  y = a\ep\cos\hzz -  l\cos\ph\\
    \dot x = l \dot\ph\cos\ph,& \dot y  =  -a\om\sin\hzz + l\dot\ph\sin\ph
  \end{array}
\end{displaymath}
Следовательно,
\begin{displaymath}
  L = \frac{m}{2}\hr{l^2{\dot\ph}^2 - 2al\om\dot\ph\sin\ph\sin\hzz + a^2\om^2\sin^2\hzz} - mg\hr{a\ep\cos\hzz - l\cos\ph}
\end{displaymath}

Отметим, что третье слагаемое в первой скобке и первое слагаемое во
второй скобке не зависят ни от $\ph$, ни от $\dot\ph$, поэтому они не
влияют на уравнения движения и могут быть опущены. Кроме того
лагранжиан $L$ можно поделить на постоянный коэффициент $ml^2$ . Это
также не отразится на уравнениях. С учетом этих замечаний лагранжиан
приобретает вид
\begin{displaymath}
  \frac{{\dot\ph}^2}{2} - \frac{a\om}{l}\dot\ph\sin\ph\sin\hzz + \om^2\cos\om
\end{displaymath}
Перейдем к уравнеениям Гамильтона:
\tbk
\begin{displaymath}
  \begin{array}{l}
    \displaystyle
    p = \dot\ph - \frac{a\om}{l}\sin\ph\sin\hzz\\
    H = p\ph - L =
  \end{array}
\end{displaymath}

\end{document}
