\documentclass[a4paper]{article}
\usepackage[simple]{dmvn}

\begin{document}

\section*{К вопросу о столкновении двух тел в пространстве}

\begin{problem}
В трёхмерном пространстве равномерно прямолинейно
движутся два шара $S_1$ и $S_2$ с радиусами $R_1$ и $R_2$, векторами скоростей
$$\vec{V}_1(u_1,v_1,w_1), \quad \vec{V}_2(u_2,v_2,w_2),$$
и начальными точками движения
$$P_1(x_1^0,y_1^0,z_1^0), \quad P_2(x_2^0,y_2^0,z_2^0).$$
Определить, столкнутся ли эти два тела, и если да, то в какой момент времени.
\end{problem}
\begin{solution}
Запишем координаты этих тел в зависимости от времени $t$. Пусть $(x_1,y_1,z_1)$ и
$(x_2,y_2,z_2)$ --- координаты центров первого и второго тела соответственно. Тогда
$$x_1=x_1^0+u_1t, \; y_1=y_1^0+v_1t, \; z_1=z_1^0+w_1t;$$
$$x_2=x_2^0+u_2t, \; y_2=y_2^0+v_2t, \; z_2=z_2^0+w_2t.$$
Тогда расстояние между их центрами будет выражено формулой:
$$\rho(S_1,S_2,t) = \sqrt{(x_1-x_2)^2+(y_1-y_2)^2+(z_1-z_2)^2}.$$
Положим по определению $D=R_1+R_2$.

Ясно, что столкновение произойдёт, если в какой-либо момент времени $t \ge 0$
это расстояние будет равно $D$. Разумеется, мы считаем, что радиусы положительны.
Но тогда нам надо найти минимальное $t \ge 0$, при котором расстояние будет
не больше, чем $D$. Вначале хорошо проверить, чему равно это расстояние при $t=0$.
Если оно равно $D$, то и считать ничего не надо (начальные положения и есть искомые),
а если оно меньше $D$, то задача имеет некорректные входные данные. Поэтому в дальнейшем
будем считать, что в момент времени $t=0$ расстояние было строго больше $D$.
Тогда нам остаётся попробовать решить уравнение на $t$
$$\rho(t)=D,$$
и выбрать наименьший положительный корень, если таковой вообще имеется.
Решим его:
$$D^2=(x_1^0-x_2^0 + u_1t-u_2t)^2+(y_1^0-y_2^0 + v_1t-v_2t)^2+(z_1^0-z_2^0 + w_1t-w_2t)^2.$$
Введём обозначения:
$$x=x_1^0-x_2^0, \; y=y_1^0-y_2^0, \; z=z_1^0-z_2^0;$$
$$u=u_1-u_2, \; v=v_1-v_2, \; w=w_1-w_2.$$
Тогда наше уравнение перепишется более изящно:
$$D^2=(x-ut)^2+(y-vt)^2+(z-wt)^2.$$
Раскрывая скобки, получаем:
$$t^2(u^2+v^2+w^2)-2t(xu+yv+zw)+x^2+y^2+z^2-D^2=0,$$
Это обычное квадратное уравнение, но иногда, хотя и очень редко,
оно оказывается не квадратным. Это бывает, когда вектора скоростей
совпадают, и тогда $u=v=w=0$. Но это, вообще говоря, означает, что
уравнение имеет либо бесконечное множество решений, либо не имеет
их вовсе. Действительно, при условии $u=v=w=0$ получаем
$$x^2+y^2+z^2-D^2=0.$$
Ну, этот случай, стало быть, надо рассмотреть отдельно. Заметим,
что во всех остальных случаях уравнение будет строго второй степени,
значит, решаем, как обычно. Положим
$$A=u^2+v^2+w^2, \; B = xu+yv+zw, \; C = x^2+y^2+z^2-D^2.$$
Тогда, при условии $B^2-AC \ge 0$, получаем решения:
$$t_{1,2}=\frac{B \pm \sqrt{B^2-AC}}{A}.$$
Ясно, если дискриминант отрицателен, значит, не столкнутся.
Напомним, что надо выбрать наименьший положительный корень, а если
оба они неположительны, то, стало быть, тоже не столкнутся.
Напомним, что случай $t=0$ мы уже разобрали вначале.
\end{solution}

\hfill \texttt{\copyright\,]DichlofoS[}\par
\end{document}
