\documentclass[a4paper,draft]{article}
\usepackage{dmvn}
\usepackage{time}

\input picref
%\input marginmarker

\DeclareMathOperator{\locextr}{locextr}
\DeclareMathOperator{\locmax}{locmax}
\DeclareMathOperator{\locmin}{locmin}
\DeclareMathOperator{\absmin}{absmin}

\newcommand{\KC}{\mathbf{KC}}

\newcommand{\dt}{\,dt}
\newcommand{\ds}{\,ds}
\newcommand{\dx}{\,dx}
\newcommand{\dmu}{\,d\mu}
\newcommand{\dtau}{\,d\tau}

\newcommand{\na}{\nabla}
\newcommand{\xbi}{\mbox{\normalfont\textit{\textbf{x}}}}

\def\fio.#1.#2#3.{#1\,#2.\,#3.}

\newcounter{piccounter}
\def\thepiccounter{\arabic{piccounter}}
\def\cpic#1#2#3{%
\stepcounter{piccounter}%
\piclabel{#2}{\thepiccounter}%
\par\medskip\vbox{\centerline{\epsfbox{pictures.#1}}
\centerline{\footnotesize\normalfont Рис.~\thepiccounter. #3}}\medskip\par}

\long\def\fns#1{\par\medskip{\footnotesize#1\par}\medskip}

\begin{document}
\dmvntitle{Курс лекций по}{вариационному исчислению}{Лектор\т Андрей Владимирович Фурсиков}
{IV курс, 7 семестр, поток математиков}{Москва, 2006 г.}

\pagebreak

\tableofcontents
\pagebreak

\section*{Введение}

\subsection*{Предисловие}

\subsubsection*{От наборщика}

В данных лекциях всё ещё возможны опечатки, если заметите, пишите мне на \texttt{jura05@narod.ru}
или DMVN (\texttt{dmvn@mccme.ru}). В некоторых местах я чуть\д чуть отклонялся от
лекций (например, я не требую $\pd\Om\in \Cb^\bes$ или даю другое определение
$H^{-1}$, или видоизменяю формулировку некоторых теорем), впрочем, кое-где это было
необходимо. Петитом выделены мои комментарии.

Про литературу: она вся относится к частям~1 и~2. Я лично использовал \cite{g}, иногда более
подробную \cite{atf} (которую, кстати, рекомендовал лектор). Замечу, что \cite{gt} отличается от
\cite{g} наличием одной дополнительной главы, написанной Тихомировым. Про части 3--4 лектор
сказал, что они взяты из одной главы книги~\cite{tf}, ещё не вышедшей в печать.

Я выражаю благодарность Диме и Мише (DMVN) за \TeX\д ническую и моральную поддержку, а также исправление опечаток.

\medskip
\rightline{\emph{Юра Малыхин}}

\subsubsection*{От редакции}

Это постэкзаменационная редакция данного опуса, версия~1.1.
Пока не исправлен глюк в доказательстве теоремы Тонелли.
Подробности см.~в~комментариях к тексту доказательства.

Мы благодарим Алексея Басалаева и Игоря Яковлева за обнаружение опечаток.

\medskip
\dmvntrail

\subsection*{Условные обозначения и соглашения}

\begin{items}{-2}
\item $\Cb(X)$\т пространство непрерывных функций $f\cln X\ra \R$ с чебышёвской нормой.
\item $\Cb^k(X)$\т пространство функций $f\cln X \ra \R$, у которых $k$\д я производная непрерывна.
В качестве нормы берётся сумма чебышёвских норм производных всех порядков от нуля до~$k$.
\item $\Cb^k(X;Y)$\т пространство непрерывных функций $f\cln X \ra Y$, у которых $k$\д я производная непрерывна.
В качестве нормы берётся сумма чебышёвских норм производных всех порядков от нуля до~$k$.
\item $\AC$\т пространство абсолютно непрерывных функций.
\item Значок $A\Subset B$ означает, что $\ol A$\т компакт, содержащийся в $B$.
\item Переменная в нижнем индексе у функции подразумевает частное дифференцирование по этой переменной.
      Частная производная по вектору\т это вектор из частных производных по его компонентам.
\end{items}

\begin{thebibliography}{АТФ}
\setlength{\itemsep}{-2pt}
\bibitem[АТФ]{atf} \fio.Алексеев.ВМ., \fio.Тихомиров.ВМ., \fio.Фомин.СВ. \emph{Оптимальное управление}. М.: Наука, 1979.
\bibitem[ГТ]{gt} \fio.Галеев.ЭМ., \fio.Тихомиров.ВМ. \emph{Оптимизация. Теория, примеры, задачи.} М.: УРСС, 2000.
\bibitem[Г]{g} \fio.Галеев.ЭМ. \emph{Оптимизация. Теория, примеры, задачи.} М.: УРСС, 2002.
\bibitem[ТФ]{tf} \fio.Тихомиров.ВМ., \fio.Фурсиков.АВ. \emph{Теоремы существования.} Электронная библиотека МехМата.
\end{thebibliography}

\newpage

%\makeatletter
%  \renewcommand{\headheight}{11mm}
%  \renewcommand{\headsep}{2mm}
%  \renewcommand{\sectionmark}[1]{}
%  \renewcommand{\subsectionmark}[1]{}
%  \renewcommand{\subsubsectionmark}[1]{\markright{\thesubsubsection. #1}}
%  \renewcommand{\@oddhead}{\vbox{\hbox to \textwidth{\scriptsize\hbox to .5cm{\thepage\hfil}\textsc{[\сегодня~года, \now]}\hfil\rightmark\strut}\hrule}}
%  \renewcommand{\@oddfoot}{\hfil\thepage\hfil}
%\makeatother

\section{Вариационное исчисление}

\subsection{Введение. Классические задачи вариационного исчисления}

\subsubsection{Примеры задач вариационного исчисления}

Сначала рассмотрим некоторые задачи, являющиеся задачами вариационного исчисления.

\begin{problem}[Изопериметрическая задача, задача Дидоны] Имеется веревка фиксированной длины $l$.
Требуется огородить ей максимальную площадь. Вариант: огородить максимальную площадь у берега моря (прямолинейного),
если концы веревки фиксированы. Математически последняя задача записывается в виде:
\eqn{\intl{-T_0}{T_0} x(t)\dt \ra\sup \quad \text{при  условии}\quad \intl{-T_0}{T_0}\sqrt{1+\dot x(t)^2}dt = l.}
\end{problem}

\begin{problem}
Имеется эллипс с полуосями $a$ и $b$, и фиксирована точка $(x_0,y_0)$. Требуется найти точки эллипса, наименее и наиболее
удаленные от~$(x_0,y_0)$.
\eqn{\bcase{&(x-x_0)^2+(y-y_0)^2\ra\inf\;(\sup),\\
&\frac{x^2}{a^2}+\frac{y^2}{b^2} = 1.}}
\end{problem}

\begin{problem}[Задача о брахистохроне]
Имеются две точки $A$ и $B$, соединённые жёлобом, по которому скатывается шарик. Надо найти форму
жёлоба, при которой шарик скатывается по нему за минимальное время (ответ: \emph{циклоида}, другое название:
\emph{брахистохрона\footnote{В переводе\т <<кривая наискорейшего спуска>>.}}). Введём координаты так, что
начальная точка~$A$ имеет координаты $(0,0)$, а конечная точка $B$\т координаты $(x_0,y_0)$. Пусть жёлоб имеет
форму графика функции $y=y(x)$. Тогда время скатывания будет равно $T=\intl{A}{B} \frac{ds}{\sqrt{2gy(x)}}$.
Получаем задачу
\eqn{\bcase{\intl{0}{x_0}\frac{\sqrt{1+(y'(x))^2}\dx}{\sqrt{2gy(x)}}\ra\inf,\\
y(0)=0,\quad y(x_0)=y_0.}}
\end{problem}

\begin{problem}[Транспортная задача]
Пусть имеется $n$ складов и $m$ магазинов. На $i$-м складе находится $a_i$
единиц товара, в $j$-й магазин нужно привезти $b_j$ единиц товара. Пусть $d_{ij}$\т стоимость
перевозки единицы товара из $i$-го склада в $j$-й магазин. Требуется обеспечить товаром все
магазины и минимизировать расходы на перевозку. Пусть $x_{ij}$\т количество товара,
перевозимое из $i$-го склада в $j$-й магазин. Получаем задачу
\eqn{\bcase{&\suml{i=1}n\suml{j=1}m d_{ij}x_{ij}\ra\inf,\\
&\suml{j=1}m x_{ij}\le a_i,\\
&\suml{i=1}n x_{ij} = b_j.}}
\end{problem}

Следующие две задачи относятся к оптимальному управлению.

\begin{problem}[Простейшая задача быстродействия]
По прямой движется точка единичной массы. Положение точки в момент времени~$t$ обозначим через~$x(t)$.
Начальные условия $x(0)=x_0$, $\dot x(0)=v_0$. Наложим условие $\hm{\ddot x(t)}\le1$. Требуется найти
траекторию, у которой $x(T)=\dot x(T)=0$ для некоторого $T>0$, и при этом время~$T$ минимально.
\end{problem}

\begin{problem}
Тело движется в среде с сопротивлением. Найти оптимальную форму тела, то есть такую, чтобы
сопротивление среды было минимальным.
\end{problem}

\subsubsection{Простейшая задача вариационного исчисления. Уравнение Эйлера\ч Лагранжа}

Здесь и далее в первой главе мы будем использовать обозначение $T := [t_0,t_1]$.

Рассмотрим задачу
\eqn{\label{eqn:problemClassic}
\bcase{&J(x):=\intl{t_0}{t_1}L\br{t,x(t),\dot x(t)}\dt\ra\extr,\\
&x(t_0)=x_0,\quad x(t_1)=x_1.}}

Предполагается, что $L(t,x,\dot x)\in \Cb^1(T\times\R^2)$, $x(t)\in \Cb^1(T)$.

\begin{df}
Функция $x(t)$ называется \emph{допустимой}, если $x(t)\in \Cb^1(T)$, и выполнены условия задачи:
$x(t_0)=x_0$, $x(t_1)=x_1$. Множество допустимых функций обозначим буквой $\Ac$.
\end{df}

В дальнейшем мы будем рассматривать и другие классы допустимых функций. Суть определения в том,
что нужно искать экстремум на некотором классе функций, удовлетворяющих некоторому набору условий.

\begin{df}
Функция $\wh x(t)$ называется \emph{слабым локальным минимумом}, если $\wh x\in\Ac$ и
найдётся такое $\ep$, что при всех $x\in\Ac$ таких, что $\hn{\wh x-x}_{\Cb^1}<\ep$, выполняется
неравенство $J(\wh x)\le J(x)$.
\end{df}

Аналогично определяется \emph{слабый локальный максимум}.

\begin{df}
Слабый локальный минимум и слабый локальный максимум называются \emph{слабыми локальными экстремумами}.
\end{df}

\fns{Если заменить $\hn{\wh x-x}_{\Cb^1}$ на $\hn{\wh x-x}_\Cb$, получится определение \emph{сильного}
локального экстремума. Но мы такие экстремумы пока не рассматриваем.}

\begin{theorem}
Пусть $L\in \Cb^1$  и $x$\т точка слабого локального экстремума задачи \eqref{eqn:problemClassic}. Тогда $x$ удовлетворяет
уравнению Эйлера:
\eqn{-\frac{d}{dt}L_{\dot x}(t,x,\dot x) + L_x(t, x,\dot x) \equiv 0.}
\end{theorem}
\fns{Здесь $L_{\dot x}$ обозначает частную производную $L$ по третьей переменной, то есть $\dot x$ в данном
случае\т название переменной. Имеется в  виду, что мы подставляем функцию $x$ и её производную $\dot x$ в уравнение,
и получаем тождество.}

\begin{proof}
Возьмем $h\in \Cb^1(T)$, такое что $h(t_0)=h(t_1)=0$. Рассмотрим $\Ph(\la):=J(x+\la h)$. Функция $\Ph(\la)$
дифференцируема по $\la$. Поскольку у функционала $J$ имеется экстремум в точке $x$, то $\Ph$ имеет локальный экстремум
в нуле, откуда $\Ph'(0)=0$. Распишем это условие:
\eqn{0 = \Ph'(0) = \frac{d}{d\la}\intl{t_0}{t_1}L(t,x+\la h,\dot x+\la\dot h)\dt\evn{\la=0}=
\intl{t_0}{t_1}L_x(t,x,\dot x)h + L_{\dot x}(t,x,\dot x)\dot h\dt=0.}
Далее остаётся применить лемму Дюбуа\ч Реймона (см. ниже).
\end{proof}

\begin{lemma}[Дюбуа\ч Реймон]
Пусть имеются функции $a(t),b(t)\in \Cb(T)$, такие что
\eqn{\intl{t_0}{t_1}a(t)\dot h(t)+b(t)h(t)\dt=0}
для любой функции $h\in \Cb^1$, у которой $h(t_0)=h(t_1)=0$. Тогда $a(t)\in \Cb^1(T)$ и
\eqn{\label{eqn:dr-eq}-\frac{d}{dt}a(t)+b(t)\equiv 0.}
\end{lemma}
\begin{proof}
Обозначим $B(t) := \intl{t_0}{t}b(\tau)d\tau$.
Интегрируем второе слагаемое в исходном интеграле по частям и вспоминаем, что на концах отрезка функция $h$ равна нулю:
\eqn{\intl{t_0}{t_1}b(t)h(t)\dt = \intl{t_0}{t_1}h(t)\,d B(t) =
h(t)B(t)\biggl|_{t_0}^{t_1} - \intl{t_0}{t_1}\dot h(t)B(t)\dt =  - \intl{t_0}{t_1}\dot h(t)B(t)\dt,}
поэтому, с учётом исходного равенства, получаем
\eqn{\intl{t_0}{t_1}\bs{a(t)- B(t)}\dot h(t)\dt = 0.}
Покажем, что выражение в квадратных скобках есть константа. Обозначим его через $c(t)$.
Предположим, что найдутся точки $\tau_1,\tau_2>0$, такие что $c(\tau_1)>c(\tau_2)$. Выберем $\ep>0$ так, чтобы
\eqn{m := \minl{\hm{t-\tau_1}\le\ep} c(t) > \maxl{\hm{t-\tau_2}\le\ep} c(t) =: M.}
Рассмотрим функцию $g_0(t)$, такую что $g_0(t_0)=g_0(\tau_1\pm\ep)=g_0(\tau_2\pm\ep)=g_0(t_1)=0$ и $g_0(\tau_1)=-g_0(\tau_2)=1$,
и продолженную между этими точками линейным образом (см.~рис.~\picref{DRFunction}).
\cpic{1}{DRFunction}{Функция $g_0(t)$}
Положим $h_0(t):=\intl{t_0}{t} g_0(\tau)\dtau$. Тогда
\eqn{0=\intl{t_0}{t_1}c(t)\dot h_0(t)\dt \ge
m\cdot \intl{\tau_1-\ep}{\tau_1+\ep}g_0(t)\dt + M\cdot \intl{\tau_2-\ep}{\tau_2+\ep}g_0(t)\dt = C(m - M) > 0, \text{ где } C =\const > 0.}
Противоречие. Значит, $a(t) = B(t)+\const$, а потому функция $a(t)$ дифференцируема. После дифференцирования этого выражения по $t$ получается
искомое уравнение~\eqref{eqn:dr-eq}.
\end{proof}

\begin{ex}
\eqn{\bcase{
&J(x)=\intl{0}{1} \dot x^2\dt\ra\inf,\\
&x(0)=0,\quad x(1)=1.}}
Решим эту задачу с помощью уравнения Эйлера. Имеем
$L(t,x,\dot x)=\dot x^2$, поэтому уравнение Эйлера имеет вид $-\frac{d}{dt}(2\dot x)=0$, то есть $\ddot x=0$,
откуда $x(t)=at+b$. Из краевых условий получаем $x(t)=t$. Проверим, что это действительно
локальный экстремум, точнее, локальный минимум:
\eqn{J(x+h)-J(x)=\intl{0}{1} \dot h^2dt + 2\intl{0}{1}\dot h dt = \intl{0}{1}\dot h^2dt \ge 0.}
\end{ex}

\begin{stm}
Предположим дополнительно, что найденная экстремальная функция $x$ дважды дифференцируема,
а функция $L$ в задаче не зависит явно от переменной $t$. Тогда имеет место интеграл энергии
\eqn{L_{\dot x} \dot x - L = \const.}
\end{stm}
\begin{proof}
Достаточно продифференцировать интеграл энергии по времени и убедиться, что получится нуль.
В самом деле,
\eqn{\frac{d}{dt}\hr{L_{\dot x} \dot x - L} = \hr{\frac{d}{dt}L_{\dot x}}\dot x + L_{\dot x}\ddot x - L_x\dot x - L_{\dot x} \ddot x =
\dot x\hr{\frac{d}{dt}L_{\dot x} - L_x} \equiv 0}
в силу уравнения Эйлера.
\end{proof}

\subsubsection{Решение задачи о брахистохроне}

Напомним математическую постановку задачи:
\eqn{\bcase{&J(x)=\intl{0}{t_0}\frac{\sqrt{1+\br{\dot x(t)}^2}\dt}{\sqrt{x(t)}}\ra\inf,\\
&x(0)=0,\quad x(t_0)=x_0.}}

Как мы знаем, первые интегралы (функции, постоянные на орбитах) позволяют понижать порядок дифференциальных уравнений.
Лобовое решение задачи о брахистохроне, состоящее в выписывании уравнения Эйлера, даёт уравнение второго порядка.
Однако в нашем случае можно использовать интеграл энергии.


Решим эту задачу, не следя за строгостью рассуждений. Имеем
\eqn{L(t,x,\dot x) = \frac{\sqrt{1+\dot x^2}}{\sqrt x}.}
Если $x$\т экстремальная функция, то для неё выполнено уравнение Эйлера, а поскольку $L$ не зависит от $t$, то,
в силу доказанного выше утверждения имеем
$L_{\dot x}\dot{x}-L \equiv c$, $c = \const$. Обозначим $C := \frac1{c^2}$.
\eqn{\frac{\dot x^2}{\sqrt{x(1+\dot x^2)}} - \frac{\sqrt{1+\dot x^2}}{\sqrt x} = -\frac{1}{\sqrt{x(1+\dot x^2)}} = c,\quad
x(1+\dot x^2) = C,\quad \dot x = \pm\sqrt\frac{C-x}{x}.}
По смыслу задачи мы должны выбрать знак <<+>>. Делая замену $x=C\sin^2\frac{\tau}2$, получим, что
\eqn{\frac{\sin \frac{\tau}{2}}{\cos\frac{\tau}{2}}dx = dt,}
откуда с учётом равенства $dx = C\sin\frac\tau2\cos\frac\tau2\dtau$ получаем
\eqn{dt=C\sin^2\frac{\tau}2\dtau,\quad t=\frac{C}2(\tau-\sin\tau)+D.}
Ясно, что $t(0)=0$, откуда $D=0$. Найдем $C$. Мы имеем уравнение
\eqn{\frac{x_0}{t_0}=2\frac{\sin^2\frac{\tau_0}2}{\tau_0-\sin\tau_0},}
из которого можем найти $\tau_0$. Далее $C$ находится из уравнения $t_0=\frac{C}{2}(\tau_0-\sin\tau_0)$. Итак, мы получили
решение в параметрическом виде:
\eqn{\bcase{x(\tau)&=C\sin^2\frac{\tau}2,\\
t(\tau)&=\frac{C}2(\tau-\sin\tau).}}

Проблема в том, что в нашей задаче $L\notin \Cb^1$. Попробуем все же обосновать наше
решение. Для этого нужно рассмотреть следующий класс допустимых функций:
\eqn{\Ac:=\hc{x\in \Cb^1(0,t_0] \bvl x(+0)=0,\; x(t_0)=x_0,\; \exi C=C(x)\cln \hm{x(t)}<Ct^{2/3}, \;\hm{\dot x(t)}<Ct^{-1/3}}.}
Для этого класса нужно проделать все те же выкладки, что мы делали раньше: рассмотреть функцию $J(x+\la h)$,
доказать ее дифференцируемость в нуле и применить аналог леммы Дюбуа\ч Реймона.

\fns{Приведенные аргументы \textbf{неубедительны}. Например, при $x\sim t^2$ интеграл
в $J(x)$ расходится, а при $x<0$ он вообще не определен, так что эти функции не являются
допустимыми. Попробуем провести решение аккуратно и со всеми выкладками. Положим
\eqn{\Ac:=\hc{x\in \Cb^1(0,t_0]\bvl x(+0)=0,\; x(t_0)=x_0,\; \exi C=C(x)\cln \hm{\dot x(t)}<Ct^{-1/3},\;
\exi \ep=\ep(x)>0\cln x(t)>\ep t}.}
Множество $\Ac$ будет классом допустимых функций. Условия гарантируют существование
интеграла $J(x)$. При этом класс достаточно широк для нашей задачи. Классом <<сдвигов>> будет
\eqn{\Hc:=\hc{h\in \Cb^1[0,t_0]\bvl h(t_0)=0,\;\exi\ep=\ep(h)>0\cln h \equiv 0 \text { на отрезке } [0,\ep]}.}
Такое определение гарантирует, что если
$x\in\Ac$ и $h\in\Hc$, то при малых $\la$ будет $x+\la h\in\Ac$. Итак, мы имеем задачу
\eqn{\bcase{&J(x)=\intl{0}{t_0}\frac{\sqrt{1+(\dot x(t))^2}\dt}{\sqrt{x(t)}}\ra\extr,\\
&x\in \Ac.}}
Пусть $\wh x$\т экстремальная функция в этой задаче. Покажем, что она
удовлетворяет уравнению Эйлера. Возьмем произвольное $h\in\Hc$ и рассмотрим
$\Ph(\la):=J(\wh x+\la h)$. Функция $\Ph$ определена в окрестности нуля.
Покажем, что она дифференцируема в нуле и
\eqn{\label{eqn:dPhiInZero}
\Ph'(0)=\intl{0}{t_0}\frac{d}{d\la}(L(t,\wh x+\la h,\Dot{\wh x}+\la\dot h))\evn{\la=0}dt.}
Для краткости обозначим $f(t,\la)=L(t,\wh x+\la h,\Dot{\wh x}+\la\dot h)$.
Заметим, что при всех $t\ne0$ функция $f(t,\cdot)$ дифференцируема в нуле. Значит,
$\frac{f(t,\la)-f(t,0)}{\la}\ra f'_\la(t,0)$ при $\la\ra0$. Покажем, что
эта сходимость мажорируема: $\frac{f(t,\la)-f(t,0)}{\la} = f'_\la(t,\de)$
для некоторого $\de$ между~$0$ и~$\la$. Оценим функцию $f'_\la(t,\de)$:
\eqn{f'_\la(t,\de) = L_x(t, \wh x+\de h, \Dot{\wh x}+\de\dot h)h + L_{\dot x}(t, x+\de h, \Dot{\wh x}+\de\dot h)\dot h.}
При $t<\ep=\ep(h)$ эта сумма, очевидно,
равна нулю, а на отрезке $[\ep,t_0]$ все функции непрерывны, следовательно, ограничены некоторой
константой $M$. Итак, $\hm{f'_\la(t,\de)}<M$, откуда по теореме Лебега о мажорируемой сходимости
\eqn{\frac{J(\wh x+\la h) - J(\wh x)}\la =
\intl{0}{t_0}\frac{f(t,\la)-f(t,0)}\la dt \ra \intl{0}{t_0} f'_\la(t,0),}
и мы получили~\eqref{eqn:dPhiInZero}.

Итак, функция $\Ph$ дифференцируема в нуле. Поскольку она имеет так экстремум, то из~\eqref{eqn:dPhiInZero} мы получаем
\eqn{0=\intl{0}{t_0}\frac{d}{d\la}(L(t,\wh x+\la h,\Dot{\wh x}+\la\dot h))\evn{\la=0}\dt =
\intl{0}{t_0}\wh L_xh+\wh L_{\dot x}\dot h dt.}
Осталось провести доказательство леммы Дюбуа\ч Реймона. Обозначим $a(t)=\wh L_{\dot x}$
и $b(t)=\wh L_x$. Можно считать, что интегрирование ведется по отрезку
$[\ep(h),t_0]$. На этом отрезке все функции гладкие. Интегрируя по частям и обозначая
$c(t)=a(t)+\intl{t}{t_0}b(t)\dt$, получим
\eqn{\intl{0}{t_0} c(t)\dot h\dt = 0\quad\text{при всех }h\in\Hc.}
Отсюда следует, что $c(t)\equiv\const$. Действительно, если существуют
$\tau_1,\tau_2>0$, такие что $c(\tau_1)>c(\tau_2)$, то для функции $h_0(t)\in\Hc$
(определённой как в доказательстве оригинальной леммы Дюбуа\ч Реймона) получаем
противоречие.}

\subsubsection{Задача Больца}

\begin{df}
\emph{Задачей Больца} называется следующая экстремальная задача:
\eqn{J(x)=\intl{t_0}{t_1}L\br{t,x(t),\dot x(t)}\dt + l\br{x(t_0),x(t_1)} \ra\extr,}
где $x\cln T\ra \R^n$ и $x\in\Cb^1(T)$; $L\in\Cb^1(T\times \R^{n+n})$; $l\in \Cb^1(\R^{n+n})$.
\end{df}

Введём обозначения $x^0 = (x^0_1\sco x^0_n) := x(t_0)$ и $x^1 = (x^1_1\sco x^1_n) := x(t_1)$. Тогда $l = l(x^0,x^1)$.

\begin{theorem}
Пусть $x$\т точка слабого локального экстремума для задачи Больца, и выполнены написанные
выше условия. Тогда $x$ удовлетворяет (векторному) уравнению Эйлера
\eqn{-\frac{d}{dt}L_{\dot x}+ L_x=0}
и условию трансверсальности
\eqn{\frac{\pd l}{\pd x^i} = (-1)^i L_{\dot x}(t_i), \quad i = 0,1.}
\end{theorem}
\begin{proof}
Пусть $x$\т точка экстремума. Возьмем $\vec h$ в виде $\vec h(t)=\br{0\sco h(t)\sco 0}$, где $h(t)$
стоит на $i$\д м месте.
\eqn{\label{eqn:BoltsEuler}
0=\frac{d}{d\la} J(x+\la \vec h)\evn{\la=0}=\intl{t_0}{t_1}\bs{ L_{x_i}(t)h(t)+L_{\dot x_i}(t)\dot h(t)}\dt +
\frac{\pd l}{\pd x^0_i}h(t_0) + \frac{\pd l}{\pd x^1_i}h(t_1).}
Выберем $h$ такое, что $h(t_0)=h(t_1)=0$. Применяя лемму Дюбуа\ч Реймона, получим уравнение
Эйлера (точнее, его $i$-ю компоненту).

Теперь выведем условие трансверсальности. Интегрируя по частям второе слагаемое в~\eqref{eqn:BoltsEuler}, получаем:
\eqn{\intl{t_0}{t_1}\bs{L_{x_i}(t)-\frac{d}{dt}L_{\dot x_i}(t)}h(t)\dt +
L_{\dot x_i}(t)h(t)\biggl|_{t_0}^{t_1} + \frac{\pd l}{\pd x^0_i}h(t_0) + \frac{\pd l}{\pd x^1_i}h(t_1)=
L_{\dot x_i}(t)h(t)\biggl|_{t_0}^{t_1} + \frac{\pd l}{\pd x^0_i}h(t_0) + \frac{\pd l}{\pd x^1_i}h(t_1)=0.}
Осталось подставить в последнее равенство две функции: $h_0$, такую что $h_0(t_0)=0$,
$h_0(t_1)=1$, и функцию $h_1$, такую что $h_1(t_0)=1$, $h_1(t_1)=0$.
\end{proof}

\subsection{Общая теория}

\subsubsection{Некоторые факты линейного функционального анализа}

Пусть $X$\т нормированное пространство. Через $X^*$ обозначается \emph{сопряжённое пространство},
наделённое нормой
\eqn{\hn{f}=\supl{\hn{x}=1}\hm{\ha{f,x}}, \quad f \in X^*.}
Если $Y$\т другое нормированное пространство, то прямое произведение $X\times Y$ наделяется нормой
\eqn{\hn{(x,y)}_{X\times Y}:=\hn{x}_X+\hn{y}_Y}
и называется \emph{произведением} нормированных пространств $X$ и~$Y$.

\begin{lemma}
Каждый функционал $F\in(X\times Y)^*$ однозначно представляется в виде
\eqn{\ha{F,(x,y)} = \ha{f,x} + \ha{g,y},}
где $f\in X^*$, $g\in Y^*$.
\end{lemma}
\begin{proof}
В самом деле, функционалы $f$ и $g$ однозначно определяются равенствами
\eqn{\ha{f,x}=\ha{F,(x,0)},\quad \ha{g,y}=\ha{F,(0,y)},}
что и требуется.
\end{proof}

\subsubsection{Факторпространства нормированных пространств}

\begin{note}
\emph{Линейным подмногообразием} линейного топологического пространства $X$ мы будем называть множество,
замкнутое относительно сложения и умножения на скаляры.
\emph{Подпространством} мы будем называть \textbf{замкнутое} (уже в~топологическом смысле)
линейное подмногообразие.
\end{note}

\begin{df}
Рассмотрим линейное пространство $X$ и его линейное подпространство $L\subset X$. На
множествах вида $x+L=\hc{x+l\cln l\in L}$ естественным образом вводится структура линейного
пространства. Это пространство называется \emph{факторпространством} $X$ по $L$ и обозначается
$X/L$.
\end{df}

\begin{theorem}
Пусть $X$\т нормированное пространство, $L\subset X$\т его подпространство. Тогда $X/L$ тоже является
нормированным пространством с нормой
\eqn{\hn{x+L}_{X/L}:=\inf_{l\in L}\hn{x+l}_X.}
\end{theorem}
\begin{proof}
В силу замкнутости для $x\notin L$ имеем:
$\hn{x+L}=\infl{l\in L}\hn{x-(-l)}=\rho(x,L)>0$. Проверим неравенство
треугольника:
\eqn{\hn{(x+L)+(y+L)}=\inf_{l_0,l_1\in L}\hn{x+y+l_0+l_1}\le
\inf_{l_0,l_1\in L}\br{\hn{x+l_0}+\hn{y+l_1}}=\hn{x+L}+\hn{y+L}.}
Однородность нормы очевидна. Таким образом, $X/L$\т нормированное пространство.
\end{proof}

\begin{theorem}
Если $X$\т банахово пространство, $L\subset X$\т подпространство, то $X/L$\т также
банахово пространство.
\end{theorem}

\begin{proof}
Пусть $x_n+L\in X/L$\т фундаментальная последовательность. Покажем, что она сходится.
Выберем подпоследовательность $x_{n_k}+L$, такую, что
\eqn{\hn{x_{n_{k+1}}+L - (x_{n_k}+L)}<\frac{1}{2^k}.}
Но ясно, что для любого $x$ найдется $x'\in x+L$, такой, что
$\hn{x'}\le 2\hn{x+L}$. Поэтому мы можем выбрать $x_{n_k}'\in x_{n_k}+L$, так что
$\bn{x_{n_{k+1}}'-x_{n_k}'}<\frac{2}{2^k}$. Тогда $x_{n_k}'$ сходятся к некоторому $x$. Ясно, что
$x_{n_k}+L=x_{n_k}'+L$ сходятся к $x+L$.
\end{proof}

\subsubsection{Ещё несколько теорем функционального анализа}

\begin{lemma}[О правом обратном]
Пусть $X$ и $Y$\т банаховы пространства, $A\cln X\ra Y$\т линейный непрерывный
сюръективный оператор. Тогда существуют отображение $M\cln Y\ra X$ и константа $C$, такие что
$A\circ M=\id_Y$ и при этом $\hn{M(y)}\le C\hn{y}$ при всех $y \in Y$.
\end{lemma}

\begin{note}
Заметим, что отображение $M$ не обязано быть линейным и непрерывным!
\end{note}

\begin{proof}
Обозначим $\wt X:=X/\Ker A$. Пусть $\pi\cln X\ra \wt X$\т естественная проекция,
$\pi\cln x\mapsto x+\Ker A$. По теореме о гомоморфизме однозначно определён биективный линейный
оператор $\wt A\cln\wt X\ra Y$, такой что $\wt A\circ\pi=A$ (просто полагаем
$\wt A(x+\Ker A):=Ax$).

Покажем, что оператор $\wt A$ непрерывен. Мы можем сопоставить каждому
элементу $\wt x\in\wt X$ вектор $\ph(\wt x)\in X$ так, чтобы $\wt x =
\ph(\wt x)+\Ker A$ (то есть $\pi\circ\ph=\id_{\wt X}$) и
$\hn{\ph(\wt x)}\le 2\hn{\wt x}$. Тогда
\eqn{\bn{\wt A\wt x} = \hn{A\ph(\wt x)} \le \hn{A}\cdot\hn{\ph(\wt x)} \le
2\hn{A}\cdot\hn{\wt x}.}
\cpic{3}{RightReverseLemma}{Диаграмма}
Поскольку $\Ker\wt A=0$ по построению, $\Im\wt A=Y$ и
$\wt X$ банахово по предыдущей теореме, то, по теореме Банаха, существует обратный
(линейный непрерывный) оператор $\wt A^{-1}\cln Y\ra\wt X$. Теперь положим
$M:=\ph\circ\wt A^{-1}$. Тогда
\eqn{\begin{aligned}&A\circ M = \wt A\circ\pi\circ\ph\circ\wt A^{-1} = \wt A\circ \id_{\wt X} \circ\wt A^{-1}=\id_Y,\\
&\hn{M(y)}=\bn{\ph(\wt A^{-1}y)}\le 2\bn{\wt A^{-1}y} \le 2\bn{\wt A^{-1}}\cdot\hn{y},\end{aligned}}
что и означает непрерывность.
\end{proof}

Напомним (без доказательства) теорему из функционального анализа:

\begin{theorem}[Вторая теорема отделимости]
\label{thm:secondSeparationTheorem}
Пусть $X$\т нормированное пространство, $A\subset X$\т выпуклое замкнутое множество,
$x_0\notin A$. Тогда существует гиперплоскость, разделяющая $A$ и $x_0$, то есть
найдётся такой ненулевой функционал $f \in X^*$, что
\eqn{\supl{x\in A}\ha{f,x} < \ha{f,x_0}.}
\end{theorem}

\begin{df}
Пусть $X$\т нормированное пространство, $A\subset X$. \emph{Аннулятором} множества $A$ называется множество
\eqn{\Ann A=A^\perp:=\hc{f\in X^*\cln \ha{f,x}=0 \text{ при всех } x\in A}.}
\end{df}

\begin{theorem}[О нетривиальности аннулятора]
Пусть $X$\т нормированное пространство и $L\subsetneq X$\т собственное подпространство в~$X$.
Тогда $\Ann L\ne0$.
\end{theorem}

\begin{proof}
Рассмотрим $x_0\notin L$. Применяя вторую теорему отделимости, выберем $f\in X^*$ так, что $\supl{x\in L}\ha{f,x} < \ha{f,x_0}$.
Ясно, что $f\ne0$. Покажем, что $f\in L^\perp$. Действительно, если
$\ha{f,x'}\ne0$ для некоторого $x'\in L$, то
\eqn{\supl{x\in L}\ha{f,x}\ge\supl{\la\in\R}\ha{f,\la x'}=+\bes,}
что и требуется.
\end{proof}

\fns{Чтобы не опираться на незнакомую теорему отделимости, можно доказать
нетривиальность аннулятора по-другому. Возьмем $v\notin L$ и на подпространстве $\Lin\ha{L, v}$
зададим функционал $f$ формулой $\ha{f,\la v + l}=\la$. Далее продолжим
его на всё пространство~$X$ по теореме Хана\ч Банаха.}

\begin{lemma}[О замкнутости образа]
Пусть $X$, $Y$, $Z$\т банаховы пространства, $A\cln X\ra Y$, $B\cln X\bw\ra Z$\т
линейные непрерывные операторы, $\Im A$ замкнуто в $Y$, $B\Ker A$ замкнуто в $Z$. Пусть
$Dx:=(Ax,Bx)$. Тогда множество $\Im D$ замкнуто в $Y\times Z$.
\end{lemma}

\begin{proof}
Обозначим $\wt Y := \Im A$. Подпространство $\wt Y$ банахово, как и всякое подпространство банахова пространства.
Очевидно, что $A\cln X\ra\wt Y$\т эпиморфизм. По лемме о правом
обратном существует отображение $M\cln\wt Y\ra X$, такое что $A\circ M=\id_{\wt Y}$ и
$\hn{My}\le C\hn{y}$. Пусть $(y,z)\in\ol{\Im D}$. Значит, найдётся последовательность
$x_n$, такая что $\lim Ax_n = y\in\wt Y$, $\lim Bx_n = z$. Положим $\xi_n:=M(Ax_n-y)$.
Тогда
\eqn{\hn{\xi_n}=\hn{M(Ax_n-y)}\le C\hn{Ax_n-y}\ra 0.}
Поэтому $z=\lim Bx_n=\lim B(x_n-\xi_n)$. Теперь рассмотрим множество $R=\hc{Bx\cln Ax=y}$.
Ясно, что если $Ax=Ax'=y$, то $Bx-Bx'=B(x-x')\subset B\Ker A$, откуда
$R=Bx_0+B\Ker A$ (где $x_0$\т некоторый вектор), а, значит, замкнуто. Заметим, что
\eqn{A(x_n-\xi_n) = Ax_n-AM(Ax_n-y) = Ax_n - (Ax_n-y) = y,}
откуда $B(x_n-\xi_n)\in R$, значит, $z\in\ol R=R$. Поэтому существует $x\in X$, такой что
$Ax=y$ и $Bx=z$, то есть $(y,z)\in\Im D$.
\end{proof}

\begin{theorem}
\label{thm:KerOrtEQUImAdjoint}
Пусть $X$ и $Y$\т банаховы пространства, $A\cln X\ra Y$\т линейный непрерывный сюръективный оператор.
Тогда $(\Ker A)^\perp=\Im A^*$.
\end{theorem}
\begin{proof}
Включение $\supset$ устанавливается легко: если $f\in\Im A^*$, то $f=A^*g$, и для любого $x\in\Ker A$
мы получаем
\eqn{\ha{f,x} = \ha{A^*g,x} = \ha{g,Ax} = \ha{g,0} = 0,}
откуда $f\in(\Ker A)^\perp$.

Обратно, пусть $f\in(\Ker A)^\perp$. Рассмотрим оператор $D\cln X\ra Y\times\R$, заданный по формуле
$Dx = (Ax, \ha{f,x})$. По лемме о замкнутости образа $\Im D$ замкнут, но $(0,1)\notin\Im D$. Значит,
аннулятор множества $\Im D$ содержит ненулевой функционал $F$. Так как $F\in(Y\times \R)^*$, то
найдутся $g\in Y^*$ и $\la\in\R$, такие что
\eqn{\ha{F, (Ax,\ha{f,x})} = \ha{g,Ax} + \la\ha{f,x} = 0 \quad \text{ при всех } x\in X.}
Покажем, что $\la\ne0$. Предположим противное.
Тогда при всех $x$ будет $\ha{g,Ax}=0$, а значит (в силу сюръективности $A$), при всех $y\in Y$ будет
выполнено $\ha{g,y}=0$, откуда
$g=0$, и потому $F=0$. Противоречие.

Итак, можно поделить на $\la$, поэтому получаем явное выражение для $f$:
\eqn{\ha{f,x} = -\frac{1}{\la}\ha{g, Ax} = -\frac{1}{\la}\ha{A^*g,x}, \text{ то есть } f = A^*\Br{-\frac{1}{\la}g} \in \Im A^*,}
что и требовалось доказать.
\end{proof}

\subsubsection{Производная в нормированных пространствах}

Пусть $X$ и $Y$\т нормированные пространства, $U\subset X$ открыто, $f\cln U\ra Y$,
$x\in U$.

\begin{df}
Говорят, что функция $f$ \emph{дифференцируема по Гато} в точке $x$, если существует линейный
непрерывный оператор $\La\cln X\ra Y$, такой что при всех $h \in X$
\eqn{f(x+\la h) = f(x)+\la\La h+o(\la).}
Оператор $\La$ называется \emph{производной по Гато} и обозначается $f'_{\Ga}(x)$.
\end{df}

\begin{note}
В данном выше определении допущена некоторая вольность, и формально оно неверное. Постарайтесь обнаружить её самостоятельно.
\end{note}

\begin{df}
Говорят, что $f$ \emph{дифференцируема по Фреше} в точке $x$, если существует линейный
непрерывный оператор $\La\cln X\ra Y$, такой что
\eqn{f(x+h) = f(x)+\La h+o(h).}
Оператор $\La$ называется \emph{производной по Фреше} и обозначается $f'(x)$.
\end{df}

\begin{df}
Говорят, что $f$ \emph{строго дифференцируема} в точке $x$, если существует линейный
непрерывный оператор $\La\cln X\ra Y$, такой что для любого $\ep > 0$
найдётся $\de > 0$, такое что при всех $x_1,x_2\in U$, для которых
$\hn{x_i-x}<\de$ ($i=1,2$), имеем
\eqn{\hn{f(x_1)-f(x_2)-\La(x_1-x_2)}<\ep\hn{x_1-x_2}.}
\end{df}

Нетрудно проверить, что оператор $\La$ во всех трёх определениях определён однозначно.

Ясно, что строгая дифференцируемость влечёт дифференцируемость по Фреше, а та, в свою
очередь, влечет дифференцируемость по Гато. Обратные импликации неверны, как показывают
функции
\eqn{f(x_1,x_2)=
\case{1,&x_1^2=x_2\ne0,\\
0,&\mbox{иначе},}
\qquad
g(x)=\case{
x^2,&x\in\Q,\\
0,&x\notin\Q.}}
Из первого примера также видно, что существование производной по Гато в точке
не влечёт даже непрерывности функции в этой точке.


\begin{theorem}[О производной композиции]
Пусть $X,Y,Z$\т нормированные пространства, $U\subset X$, $V\subset Y$\т открытые
множества, $x\in U$, $y\in V$, $f\cln U\ra Y$, $g\cln V\ra Z$, $f(x)=y$.

1) Пусть функция $g$ дифференцируема по Фреше в точке $y$. Если функция $f$ дифференцируема по Гато
(Фреше) в точке $x$, то функция $g\circ f$ дифференцируема по Гато (Фреше) в точке~$x$.

2) Если функции $f$ и $g$ строго дифференцируемы в соответствующих точках, то функция $g\circ f$ строго
дифференцируема в~$x$.
\end{theorem}

Доказательство остается в виде упражнения.

Пусть, как и ранее, $X$ и $Y$\т нормированные пространства, $U\subset X$ открыто,
$f\cln U\ra Y$.

\begin{theorem}[О конечном приращении]
Пусть $f$ дифференцируема по Гато во всех точках $U$, пусть
$[x_1,x_2]\subset U$. Тогда
\eqn{\hn{f(x_2)-f(x_1)}\le\supl{x\in[x_1,x_2]}\hn{f'_\Ga(x)}\cdot\hn{x_2-x_1}.}
\end{theorem}
\begin{proof}
По теореме Хана\ч Банаха существует функционал $y^*\in Y^*$, такой что
\eqn{\hn{y^*}=1 \text{ и } \ha{y^*,f(x_2)-f(x_1)}=\hn{f(x_2)-f(x_1)}.}

Введём обозначение $\De x := x_2-x_1$ и $x(t) := t(x_2-x_1) + x_1$.
Заметим, что $x(t+\la) - x(t) = \la\De x$.

Рассмотрим $\Ph(t):=\ha{y^*,f\br{x(t)}}$. Дифференцируемость~$f$
по Гато влечет дифференцируемость $\Ph$ на $[0,1]$, откуда по одномерной теореме Лагранжа получаем
\eqn{\hn{f(x_2)-f(x_1)}=\Ph(1)-\Ph(0)=\Ph'(\xi)}
для некоторого $\xi \in [0,1]$. Вычислим производную $\Ph$ в точке $\xi$:
\eqn{\frac{\Ph(\xi+\la)- \Ph(\xi)}{\la} = \Ba{y^*, \frac{f\br{x(\xi+\la)} - f\br{x(\xi)}}{\la}} =
\Ba{y^*, \frac{f'_\Ga\br{x(\xi)} \De x \la + o(\la)}{\la}}  \ra \ha{y^*, f'_\Ga\br{x(\xi)}\De x}}
при $\la \ra 0$. Отсюда
\mln{\hn{f(x_2) - f(x_1)} = \Ph'(\xi) = \ha{y^*,f'_\Ga\br{x(\xi)}\De x} \le
\hn{y^*} \cdot \hn{f'_\Ga\br{x(\xi)}\De x} \le \\ \le
\hn{f'_\Ga\br{x(\xi)}} \cdot \hn{\De x} \le \supl{t \in [0,1]} \hn{f'_\Ga\br{x(t)}} \cdot \hn{\De x},}
что и требовалось доказать.
\end{proof}

Очевидно, линейный непрерывный оператор $A\cln X\ra Y$ строго дифференцируем и $A'=A$.

\begin{imp}
В условиях предыдущей теоремы для всякого линейного непрерывного оператора $\La\cln X\ra Y$ выполнено неравенство
\eqn{\hn{f(x_2)-f(x_1)-\La(x_2-x_1)}\le \supl{x\in[x_1,x_2]} \hn{f'_\Ga(x)-\La} \cdot\hn{x_2-x_1}.}
\end{imp}

Пусть $X$, $Y$\т нормированные
пространства, $U\subset X$ открыто. Пусть $f\cln U\ra Y$ дифференцируема по Гато во всех точках $x\in U$.
Обозначим через $\mathcal L(X,Y)$ пространство
линейных непрерывных операторов $X\ra Y$, снабженное операторной нормой.

\begin{df}
Отображение $f$ называется \emph{непрерывно дифференцируемым} по Гато в $U$, если отображение
$U\ra\Lc(X,Y)$, $x\mapsto f'_\Ga(x)$, непрерывно.
\end{df}

\begin{theorem}
Пусть $f$ непрерывно дифференцируемо по Гато в $U$. Тогда $f$ строго дифференцируемо в~любой
точке $x\in U$.
\end{theorem}

\begin{proof}
Фиксируем $x_0\in U$ и докажем строгую дифференцируемость $f$ в точке $x_0$. Пусть
$\hn{f'_\Ga(x)-f'_\Ga(x_0)}<\ep$ при $\hn{x-x_0}<\de$. Тогда при
$\hn{x_1-x_0}<\de$ и $\hn{x_2-x_0}<\de$, пользуясь предыдущим следствием, получим
\eqn{\hn{f(x_2)-f(x_1)-f'_\Ga(x_0)(x_2-x_1)}
\le\supl{x\in[x_1,x_2]}\hn{f'_\Ga(x)-f'_\Ga(x_0)}\cdot\hn{x_2-x_1}\le\ep\hn{x_2-x_1},}
а это и означает строгую дифференцируемость.
\end{proof}


\subsubsection{Оператор Немыцкого}

Пусть $f\cln U\ra\R^m$ и $f\in \Cb^1(U)$, где $U$\т область в $\R_t\times\R^n_x$.

Рассмотрим множество
\eqn{W:=\hc{x(t)\in \Cb(T;\R^m)\cln \br{t,x(t)}\in U \text{ при всех } t}.}
Определим оператор Немыцкого равенством $N(x):=f\br{t,x(t)}$.

\begin{theorem}
Пусть $\wh x\in W$. Тогда оператор Немыцкого $N\cln W\ra \Cb(T;\R^m)$ строго
дифференцируем в~точке~$\wh x$, причём $N'(\wh x) = f'_x\br{t,\wh x(t)}$.
\end{theorem}
\begin{proof}
Найдём производную $N$ по Гато и докажем её непрерывность. Выберем малое $\de>0$ и
рассмотрим компакт $K:=\hc{(t,x)\in T\times\R^n\cln \hm{x-\wh x(t)}\le\de}$. Заметим, что $f'_x(t,x)$
равномерно непрерывна на $K$. Возьмём $h\in W$. При фиксированном $t$ по теореме Лагранжа
имеем (промежуточную точку обозначим $\ta_t \in (0,1)$):
\eqn{\hm{f(t,\wh x+\la h)-f(t,\wh x)-f'_x(t,\wh x)\la h} \le
\hm{f'_x(t,\wh x+\ta_t\la h)-f'_x(t,\wh x)}\cdot\hm{\la}\cdot\hm{h(t)}.}
Ясно, что при $\la\ra 0$ величина
$\hm{f'_x\br{t,\wh x+\ta_t \la h}-f'_x(t,\wh x)}$ стремится к нулю. Но поскольку
$f'_x$ равномерно непрерывна на $K$, то все рассуждения равномерны по $t$, так что
\eqn{\supl{t\in T}\hm{f\br{t,\wh x(t)+\la h(t)}-f\br{t,\wh x(t)}-f'_x\br{t,\wh x(t)}\la h(t)}=o(\la).}
Итак, мы нашли производную по Гато. Осталось показать, что она непрерывна
в $\wh x$ (отсюда последует строгая дифференцируемость в $\wh x$).
Действительно,
\eqn{\hn{N'(\wh x)-N'(x)} = \supl{\hn{h}=1} \supl{t\in T}
\hm{\bs{f'_x\br{t,\wh x(t)}-f'_x\br{t,x(t)}}h(t)} \le \supl{t\in T}\hm{f'_x\br{t,\wh x(t)}-f'_x\br{t,x(t)}}\ra0}
при $\hn{x-\wh x}\ra0$.
\end{proof}

\subsubsection{Теорема Люстерника}

\begin{theorem}[Люстерник]
Пусть $X$, $Y$\т банаховы пространства, $U\subset X$ открыто, $F\cln U\ra Y$, $\wh
x\in U$, $F$ строго дифференцируема в $\wh x$, $F'(\wh x)$\т эпиморфизм. Тогда
существует окрестность $\Oc$ точки $\wh x$, отображение $\ph\cln\Oc\ra X$ и число $K>0$, такие что
$F\br{\ph(x)} = F(\wh x)$ для всех $x \in \Oc$ и
\eqn{\hn{\ph(x)-x}\le K\hn{F(x)-F(\wh x)}.}
\end{theorem}

\begin{proof}
Не ограничивая общности, считаем $\wh x=0$ и $F(0)=0$. По лемме о правом обратном, найдётся $M\cln Y\ra X$,
такое что $F'(\wh x)M=\id_Y$, $\hn{M(y)}\le C\hn{y}$. В силу строгой дифференцируемости,
найдется $\ep>0$, такое что при $\hn{x_i}<2\ep$ $(i=1,2)$ выполнено неравенство
\eqn{\label{eqn:LusternikStrongDiff}\hn{F(x_2)-F(x_1)-F'(0)(x_2-x_1)}\le \frac{1}{2C}\hn{x_2-x_1}.}
Из этого неравенства видно, что функция $F$ непрерывна в шаре $\hc{x\cln\hn{x}<2\ep}$. Выберем
$\de$ так, что
\eqn{\hn{x}+C\hn{F(x)} < \frac{\ep}2}
при $\hn{x}<\de$. Положим
$\Oc:=\hc{x\cln\hn{x}<\de}$. Рассмотрим произвольную точку $x \in \Oc$. Будем искать $\ph(x)$ с помощью итераций (это, как несложно убедиться,
аналог метода Ньютона):
\eqn{\xi_0:=x, \quad \xi_{n+1}:=\xi_n-MF(\xi_n).}

Докажем по индукции, что $\hn{\xi_n}<\ep$. При $n=0$: $x\in\Oc$,
$\hn{x}<\frac{\ep}2$. При $n=1$ имеем
\eqn{\hn{\xi_1}\le \hn{x}+\hn{MF(x)}\le\hn{x}+C\hn{F(x)}<\frac{\ep}2}
в силу выбора~$\de$.
Пусть мы доказали это для $\xi_n$, докажем для $\xi_{n+1}$. Заметим, что
$\xi_n-\xi_{n-1}+MF(\xi_{n-1})=0$. Применим к этому равенству оператор $F'(0)$:
\eqn{0=F'(0)\br{\xi_n-\xi_{n-1}+MF(\xi_{n-1})} = F'(0)(\xi_n-\xi_{n-1}) + F(\xi_{n-1}).}
Далее,
\mln{\hn{\xi_{n+1}-\xi_n}\le C\hn{F(\xi_n)} =
C\bn{F(\xi_n)\ub{-F'(0)(\xi_n-\xi_{n-1})-F(\xi_{n-1})}_{0}}\stackrel{!}{\le}
C\cdot\frac{1}{2C}\hn{\xi_n-\xi_{n-1}}=\\=
\frac12\hn{\xi_n-\xi_{n-1}} \le \frac14\hn{\xi_{n-1}-\xi_{n-2}} \sle\frac{1}{2^n}\hn{\xi_1-x} =
\frac{1}{2^n}\hn{MF(x)} \le\frac{\ep}{2^{n+1}}.}
Здесь переход <<!>> следует из~\eqref{eqn:LusternikStrongDiff}. Отсюда
\eqn{\hn{\xi_{n+1}} \le \hn{\xi_{n+1}-\xi_n} + \hn{\xi_n-\xi_{n-1}} \spl \hn{\xi_1} \le
\hr{\frac{1}{2^{n+1}}+\frac1{2^n}\spl \frac14}\ep + \frac{\ep}2 < \ep.}

Аналогичным образом получается неравенство $\hn{\xi_{n+m}-\xi_n} < \frac{\ep}{2^n}$, из
которого следует, что последовательность $\xi_n$ фундаментальна. Положим
$\ph(x):=\lim\xi_n$. Проверим, что $\ph$ удовлетворяет требуемым условиям.
Поскольку $\hn{\ph(x)}\le\ep$ и $F$ непрерывна в шаре $\hc{x\cln\hn{x}<2\ep}$, то
$F\br{\ph(x)}=F(\lim\xi_n)=\lim F(\xi_n)$. Но
\eqn{F(\xi_{n-1})=-F'(0)(\xi_n-\xi_{n-1}) \ra 0,}
поскольку $\xi_n-\xi_{n-1}\ra 0$. Мы доказали, что $F\br{\ph(x)}=0$. Наконец,
\eqn{\hn{\xi_n-x}\le \hn{\xi_n-\xi_{n-1}}\spl \hn{\xi_1-x}\le 2\hn{\xi_1-x}\le 2C\hn{F(x)}.}
Переходя к пределу в этом неравенстве, получим $\hn{\ph(x)-x}\le 2C\hn{F(x)}$.
\end{proof}

\subsubsection{Теорема о касательном пространстве}

Пусть $X$\т нормированное пространство, $M\subset X$, $\wh x\in M$.

\begin{df}
Вектор $h\in X$ называется \emph{касательным вектором} к $M$ в точке $\wh x$, если существует
$\ep>0$ и отображение $r\cln(-\ep,\ep)\ra X$, такое что $r = o(\la)$, и при всех $\la \in (-\ep,\ep)$
выполнено $\wh x+\la h+r(\la)\in M$.
\end{df}

\begin{df}
Совокупность касательных векторов к $M$ в точке $\wh x$ обозначается $T_{\wh x}M$. Если
$T_{\wh x}M$ является линейным пространством, то $T_{\wh x}M$ называется \emph{касательным
пространством}.
\end{df}

Пусть $X$ и $Y$\т банаховы пространства, $U\subset X$\т открыто, $\wh x\in U$, $F\cln U\ra Y$.

\begin{theorem}[О касательном пространстве]
Пусть $F$ строго дифференцируема в $\wh x$ и $F'(\wh x)$ является эпиморфизмом.
Обозначим $M\bw=\hc{x\in U\cln F(x)=F(\wh x)}$. Тогда $T_{\wh x}M=\Ker F'(\wh x)$.
\end{theorem}

\begin{proof}
Докажем <<$\subset$>>. Пусть $h\in T_{\wh x}M$. Возьмём $r(\la)$ из определения
касательного вектора.
\eqn{F(\wh x) = F\br{\wh x+\la h+r(\la)} = F(\wh x)+F'(\wh x)\br{\la h+r(\la)} + o\br{\la h+r(\la)},}
откуда
\eqn{F'(\wh x)h=-\frac{o\br{\la h+r(\la)} + F'(\wh x)r(\la)}{\la}\ra 0\quad\mbox{ при }\quad\la\ra0,}
откуда $F'(\wh x)h=0$, $h\in\Ker F'(\wh x)$.

Докажем обратное включение. Пусть $h\in\Ker F'(\wh x)$. Воспользуемся теоремой Люстерника. Возьмём
\eqn{\ph\cln \Oc(\wh x)\ra X,}
такое что $F(\wh x)=F\br{\ph(x)}$ и $\hn{\ph(x)-x}\le K\hn{F(\wh x)-F(x)}$. Положим
\eqn{r(\la):=\ph(\wh x+\la h)-(\wh x+\la h).}
Тогда
\eqn{F(\wh x) = F\br{\ph(\wh x+\la h)} = F\br{\wh x+\la h + r(\la)},}
и при этом
\eqn{\hn{r(\la)} = \hn{\ph(\wh x+\la h) - (\wh x+\la h)} \le K\hn{F(\wh x+\la h) - F(\wh x)} =o(\la).}
Из вышесказанного следует, что $h$ является касательным вектором с функцией близости $r(\la)$.
\end{proof}

\subsubsection{Принцип Лагранжа для гладких задач с ограничениями типа равенства}

Пусть $X$, $Y$\т банаховы пространства, $U\subset X$ открыто, $f\cln U\ra\R$, $F\cln U\ra Y$.

\begin{df}
Гладкими задачами с ограничениями типа равенства называются задачи вида
\eqn{\label{eqn:problemLagrangeSmooth}
\bcase{
&f(x)\ra\inf\;(\sup),\\
&F(x)=0.}}
Множество $\Ac:=\hc{x\in X\cln F(x)=0}$ является множеством допустимых элементов
для нашей задачи.
\end{df}

\begin{df}
Точка $\wh x\in\Ac$ называется локальным минимумом (мы будем писать $\wh x\in \locmin$), если
найдётся $\ep>0$, такое что для всех $x\in\Ac$, для которых $\hn{\wh x-x}<\ep$, выполнено
$f(\wh x)\le f(x)$.
\end{df}

Определение локального максимума ($\wh x\in \locmax$) аналогично.

\begin{df}
Локальный экстремум ($\locextr$)\т это локальный минимум или локальный максимум.
\end{df}

\fns{На самом деле правильнее считать, что локальный экстремум\т это <<место, где изменение функции мало по
сравнению с изменением аргумента>>. Например, для гладких функций на прямой\т это те $x$, в которых $f'(x)=0$.
Так, $0$ будет локальным экстремумом для $x^3$, но не локальным минимум или максимумом. Мы всё же будем считать, что
$\locextr = \locmin \cup \locmax$.}

\begin{df}
\emph{Функцией Лагранжа} для абстрактной задачи называется функция
\eqn{\Lc(x,\la,y^*):=\la f(x)+\ha{F(x),y^*}.}
\end{df}

\begin{theorem}[Лагранж]
\label{thm:Lagrange}
Пусть $\wh x\in \locextr$ для задачи \eqref{eqn:problemLagrangeSmooth}, $f$ и $F$ строго дифференцируемы в
$\wh x$, $\Im F'(\wh x)$ замкнут в $Y$. Тогда:

\textbf{а)} Существует ненулевой функционал $(\la,y^*)\in(\R\times Y)^*$ такой, что $\Lc'_x(\wh x,\la,y^*)=0$.

\textbf{б)} Если $\Im F'(\wh x)=Y$, то $\la\ne0$.
\end{theorem}

\fns{Как понимать $\Lc'_x$? Так же, как и обычно: нужно зафиксировать
$\la$ и $y^*$, получится отображение $U\ra Y$. Остается показать, что оно строго
дифференцируемо в $\wh x$ (если таковы $f$ и $F$) и что его производная равна $\la
f'(\wh x)(\cdot)+\ha{F'(\wh x)(\cdot),y^*}$. Это делается непосредственно по
определению.}

\begin{proof}
Рассмотрим функцию $G(x)=\br{f(x),F(x)}\cln U\ra\R\times Y$. Ясно\footnote{Формула $(A,B)'=(A',B')$ легко
доказывается.}, что $G'(\wh x)=\br{f'(\wh x),F'(\wh x)}$.
По лемме о замкнутом образе, $\Im G'(\wh x)$ замкнут в $\R\times Y$. Рассмотрим два случая.

\pt{1} Пусть $\Im G'(\wh x)\ne\R\times Y$. В силу леммы о нетривиальности аннулятора
существует ненулевой функционал $\La\in(\R\times Y)^*$ такой, что $\ha{\La, G'(\wh x)h}=0$ для всех $h \in X$.
Имеем $\ha{\La,(c,y)}=\la c+\ha{y^*,y}$. Тогда для любого $h \in X$
\eqn{0 = \ha{\La, G'(\wh x)h} = \la f'(\wh x)h + \ha{y^*,F'(\wh x)h} = \Lc'_x(\wh x,\la,y^*)h.}
Мы доказали пункт \textbf{а)} теоремы.

Докажем \textbf{б)}. Предположим, $\la=0$.
Тогда $\ha{y^*,F'(\wh x)h}=0$, откуда в силу сюръективности $F'(\wh x)$ имеем $y^*=0$.
Противоречие с условием $\La\ne0$.

\pt{2} $\Im G'(\wh x)=\R\times Y$. В частности, $\Im F'(\wh x)=Y$. Обозначим $M:=\hc{x\in U\cln F(x)=0}$.
Пусть $h\in T_{\wh x}M$. Тогда для некоторой
функции $r(\la)=o(\la)$ выполнено равенство $F\br{\wh x+\la h+r(\la)}=0$, потому что $\wh x + \la h + r(\la) \in M$.
Пусть, для определенности, $\wh x\in \locmin$. Рассмотрим одномерную задачу
\eqn{\bcase{
&\ph(\la)=f\br{\wh x+\la h+r(\la)}\ra \inf,\\
&F(\wh x+\la h+r(\la))=0.}}
Ясно, что $\la=0$ является локальным минимумом новой задачи (так как $\wh x\in \locmin$), поэтому
\eqn{0=\ph'(0)=\ha{f'(\wh x),h}.}
Значит,
\eqn{f'(\wh x)\in (T_{\wh x}M)^\perp \stackrel{!}{=} \br{\Ker F'(\wh x)}^\perp \stackrel{!!}{=} \Im \br{F'(\wh x)}^*.}
Здесь переход <<!>> следует из теоремы о касательном пространстве, а <<!!>>\т из теоремы~\ref{thm:KerOrtEQUImAdjoint}.
Поэтому найдётся  $y^*\in Y^*$ такой, что
\eqn{f'(\wh x)+\br{F'(\wh x)}^*y^*=0,}
откуда следует, что и
\eqn{\ha{f'(\wh x),h}+\ha{F'(\wh x)h,y^*}=0.}
Итак, $\Lc'_x(\wh x,1,y^*)=0$ и теорема доказана.
\end{proof}

\begin{ex}
Покажем, что условие замкнутости $\Im F'(x)$ существенно. Пусть
\eqn{X=\R \times \ell_2 = \hc{(\al,y)\cln \al\in\R,y\in \ell_2},\quad Y=\ell_2,}
\eqn{\La\cln (y_1,y_2\sco y_n\etc)\mapsto \Br{\frac{y_1}{1},\frac{y_2}2\sco \frac{y_n}n\etc}.}
Легко видеть, что $\Im\La\ne \ell_2$
(например, образ не содержит $(1,\frac12,\frac13\etc)$) и $\ol{\Im\La}=\ell_2$.
В частности, образ не замкнут. Возьмем какое-нибудь $\wh y\in \ell_2\wo\Im\La$.
Определим отображения $f$ и $F$:
\eqn{f\br{(\al,y)}:=\al,\quad  F\br{(\al,y)}:=\La y+\al \wh y.}
Рассмотрим задачу
\eqn{\bcase{
&f(x)\ra\inf,\\
&F(x)=0,}}
Ясно, что из равенства $F\br{(\al,y)}=0$ следует $\al=0$, откуда $y=0$, то
есть множество допустимых элементов\т это $\hc{(0,0)}$. Покажем, что принцип Лагранжа всё~же
не~выполнен. Возьмем $0\ne(\la,z)\in(\R\times \ell_2)^* \cong \R\times \ell_2$. Имеем
\eqn{\Lc\br{(\al,y),\la,z}=\la\al+\sums{k}\hr {\frac{y_k}k+\al\wh y_k}z_k.}
Предположим, что $\Lc'_x(0,\la,z)=0$. Имеем
\eqn{\Lc'_\al= 0 = \la + \sums{k}\wh y_kz_k,\quad \Lc'_{y_k}=\frac{z_k}{k}=0,}
откуда следует $\la=0$, $z=0$. Противоречие.
\end{ex}

\begin{ex}
Конечномерные задачи вида
\eqn{\bcase{
&f_0(x)\ra\inf,\\
&f_k(x)=0,\;(k=1,2\sco n),}}
где $f_j\cln\R^n\ra\R$ являются частным случаем задачи~\eqref{eqn:problemLagrangeSmooth}.
\end{ex}

\subsection{Выпуклые задачи}


\subsubsection{Выпуклые функции}

Нам понадобится расширенная вещественная прямая
$\ol\R:=\R\cup\hc{-\bes}\cup\hc{+\bes}$. Пусть $X$\т линейное пространство, и $f\cln X\ra\ol\R$.

\begin{df}
\emph{Эффективным множеством} $f$ называется множество $\dom f:=\hc{x\in X\cln f(x)<\bes}$.
\end{df}

\begin{df}
\emph{Надграфиком} $f$ называется множество
$\epig f:=\hc{(\al,x)\in\R\times X\cln x\in\dom f,\;\al\ge f(x)}$.
\end{df}

\begin{df}
Функция $f$ называется \emph{выпуклой}, если $\epig f$\т выпуклое множество.
\end{df}

\begin{df}
Функция $f$ называется \emph{собственной}, если $\dom f\ne\es$ и $f > -\bes$.
\end{df}

В основном мы будем рассматривать собственные функции.

\begin{stm}
Пусть $f\cln X\ra\ol\R$\т собственная функция. Она является выпуклой тогда и только тогда, когда выполнено
неравенство Йенсена:
\eqn{f(\al x_1+(1-\al)x_2)\le \al f(x_1)+(1-\al)f(x_2)}
для  любых $x_1,x_2\in\dom f$ и всех $\al\in[0,1]$.
\end{stm}
\begin{proof}
Пусть выполнено неравенство Йенсена. Возьмем $(a,x_1), (b,x_2)\in\epig f$ и
$\al\in[0,1]$. Покажем, что $\al(a,x_1)\bw+(1-\al)(b,x_2)\in\epig f$. Действительно,
\eqn{f(\al x_1+(1-\al)x_2)\le \al f(x_1)+(1-\al)f(x_2)<\bes,}
откуда $\al x_1+(1-\al)x_2\in\dom f$. Далее,
\eqn{\al a+(1-\al)b\ge \al f(x_1)+(1-\al)f(x_2)\ge f(\al x_1+(1-\al)x_2),}
откуда $\br{\al a+(1-\al)b,\al x_1+(1-\al)x_2}\in\epig f$. В обратную сторону\т аналогично.
\end{proof}

\fns{Собственные выпуклые функции $f\cln X\ra\ol\R$ можно отождествить с
выпуклыми функциями $f\cln M\ra\R$, определенными на выпуклых непустых множествах
$M\subset X$, поскольку в силу неравенства Йенсена $\dom f$ является выпуклым множеством.}

\subsubsection{Постановка выпуклой задачи}

\begin{df}
Пусть $X$\т линейное пространство, $f_j\cln X\ra\ol\R$\т
собственные выпуклые функции ($j\bw=0,1\sco n$), $A\subset X$\т выпуклое множество.
Рассмотрим задачу
\eqn{\label{eqn:problemConvex}
\bcase{
&f_0(x)\ra\inf,\\
&f_j(x)\le0 \quad (j=1\sco n),\\
&x\in A.}}
Задачи такого вида называются \emph{выпуклыми}.
\end{df}

\begin{note}
Здесь важно, что стоит $\inf$, а не $\sup$, и что стоят неравенства вида $f\le0$.
\end{note}

Как и раньше, определим \emph{множество допустимых элементов}:
\eqn{\Ac := \hc{x \in A\vl f_j(x) \le 0 \text{ при } j = 1\sco n}.}
Заметим, что множество~$\Ac$ выпукло. В отличие от обычных экстремальных задач, в выпуклом случае
не бывает локальных минимумов (см.~лемму ниже). Поэтому нам достаточно рассматривать
абсолютные минимумы: мы пишем $\wh x\in \absmin$, если $\wh x\in\Ac$ и
для всех $x\in\Ac$ выполнено неравенство $f_0(\wh x)\le f_0(x)$.

Если на~$X$ введена норма, то можно говорить о локальных минимумах задачи~\eqref{eqn:problemConvex}.

\begin{lemma}
Если $\wh x\in \locmin$ задачи~\eqref{eqn:problemConvex}, то $\wh x\in \absmin$ задачи~\eqref{eqn:problemConvex}.
\end{lemma}
\begin{proof}
Пусть $\wh x\in \locmin$. Возьмем произвольный $x\in\Ac$. Рассмотрим $x_\al=\al
x+(1-\al)\wh x$ для $\al\in[0,1]$. Ясно, что $x_\al\in\Ac$. Так как при \textbf{малых} $\al$ элемент
$x_\al$ близок к $\wh x$, а $\wh x$\т локальный минимум, то при малых $\al$
\eqn{f(\wh x)\le f(x_\al) = f\br{\al x+(1-\al)\wh x} \le \al f(x)+(1-\al)f(\wh x),}
откуда $f(\wh x)\le f(x)$.
\end{proof}

Нам понадобится теорема отделимости в следующей форме:

\begin{theorem}[Теорема отделимости для выпуклых множеств]
Пусть $C\subset\R^n$\т выпуклое множество, не~содержащее нуля. Тогда найдётся
ненулевое $\la\in\R^n$, такое что для всех $c\in C$ выполнено $(\la,c)>0$.
\end{theorem}

\fns{\begin{proof}
Для выпуклого множества определено понятие размерности (например, как наименьшее $s$,
при~котором множество содержится в~некотором аффинном подпространстве размерности $s$).
Без ограничения общности можно
считать, что $\dim C=n$, тогда $C=\ol{\Int C}$. Далее, мы можем
перейти от $C$ к $\Int C$ и~считать, что наше множество не~только выпукло, но~и~открыто.
Будем строить подпространства $M_k$, не~пересекающиеся с~$C$, такие что $\dim M_k=k$ (в~конце
мы получим $M_{n-1}$, не~пересекающееся с~$C$, и~в~качестве $\la$ нужно будет взять
нормаль к~$M_{n-1}$, смотрящую в~то~полупространство, где лежит $C$). $M_0=\hc{0}$. Пусть
мы построили $M_0,M_1\sco M_k$, $k\le n-2$. Построим $M_{k+1}$. Возьмем какое-нибудь
двумерное подпространство $P$ так, чтобы $P\cap M_k=\hc{0}$. Положим $C':=P\cap (C-M_k)$,
$C'$ выпукло, открыто в~$P$ и~не~содержит нуль. Мы свели задачу к~плоскости $P$: если мы
построим прямую $l\subset P$, такую что $l\cap C'=\es$ и $0\in l$, то достаточно
будет положить $M_{k+1}:=M_k+l$ (ведь $l\cap (C-M_k)=\es\Lra (M_k+l)\cap
C=\es$). Но~на~плоскости все очевидно: конус $\hc{kc\cln c\in C',k>0}$ есть
открытый сектор, соответствующий углу, не~большему $\pi$, в~качестве $l$ можно взять
прямую, содержащую один из~граничных лучей.
\end{proof}}

\subsubsection{Теорема Куна\ч Таккера}

Пусть нам дана выпуклая задача~\eqref{eqn:problemConvex}. Пусть $\la = (\la_0,\la_1\sco \la_n)$.
Введём функцию Лагранжа:
\eqn{\Lc(x,\la):=\suml{j=0}{n} \la_jf_j(x).}

\begin{theorem}[Кун\ч Таккер]

\pt{1} Если $\wh x\in \absmin$ задачи~\eqref{eqn:problemConvex}, то найдётся $\la\ne 0$, такое что:
\begin{items}{-1}
\item[\textbf{а)}] $\la_j\ge 0$ при $j=0\sco n$\т условие неотрицательности,
\item[\textbf{б)}] $\la_j f_j(\wh x)=0$ при $j=1\sco n$\т условие дополняющей нежёсткости,
\item[\textbf{в)}] $\Lc(\wh x,\la) \le \Lc(x,\la)$ для всех $x\in\Ac$.
\end{items}

\pt{2} Если $\wh x$ и $\la$ таковы, что $\la_0>0$ и выполнены условия \textbf{а)}, \textbf{б)}, \textbf{в)},
то $\wh x\in \absmin$ задачи~\eqref{eqn:problemConvex}.

\pt{3} Если в условиях \pt{1} выполнено условие Слейтера, то есть найдётся $x\in\Ac$ такой,
что $f_j(x)<0$ при всех $j=1\sco n$, то для всех $\la$ имеем $\la_0\neq 0$.
\end{theorem}
\begin{proof}
\pt{1} Без ограничения общности считаем $f_0(\wh x)=0$. Рассмотрим множество
\eqn{C:=\hc{(\al_0,\al_1\sco \al_n)\bvl \text{найдётся } x\in\Ac, \text{ такой, что }\al_0>f_0(x),\;\al_j\ge f_j(x)\text{ при всех } j=1\sco n}.}
Проверим, что к~$C$ можно применить конечномерную теорему отделимости.

В самом деле, если $(0\sco 0)\in C$, то для некоторого $x\in\Ac$ будет $f_0(x)<0=f_0(\wh x)$\т противоречие.
Далее, покажем, что $C$ выпукло. Пусть
$(\al_0\sco \al_n),(\be_0\sco \be_n)\in C$. Им соответствуют $x_1$ и $x_2$, для
которых $\al_0>f_0(x_1)$, $\al_j\ge f_j(x_1)$, $\be_0>f_0(x_2)$, $\be_j\ge f_j(x_2)$. Тогда точка
\eqn{\ga (\al_0\sco \al_n)+(1-\ga)(\be_0\sco \be_n)}
соответствует $\ga x_1+(1-\ga)x_2$. Итак, по конечномерной теореме отделимости, найдется
ненулевое $\la$, такое что $(\la,c)> 0$ для всех $c\in C$. Взяв $c$ в виде
$c=(\de,0\sco 1\sco 0)$ (единица на $j$-м месте), получаем неравенство
$\la_0\de+\la_j>0$. Но поскольку $\de>0$ произвольно, то $\la_j\ge0$. Мы получили \textbf{а)}.

Перейдём к пункту \textbf{б)}. Фиксируем $j$. Если $f_j(\wh x)=0$, то тем более $\la_jf_j(\wh x)=0$.
Если же ${f_j(\wh x)<0}$, то возьмём $c=(\de,0\sco f_j(\wh x)\sco 0)$
($f_j$ на $j$-м месте). Так как  $(\la,c)>0$, то $\de\la_0+\la_jf_j(\wh x)\ge 0$,
откуда $\la_j f_j(\wh x)\ge 0$. Это неравенство возможно лишь при $\la_j=0$.

Теперь докажем \textbf{в)}:
\eqn{\Lc(\wh x,\la)=\la_0f_0(\wh x)+\suml{j=1}{n}\la_jf_j(\wh x)\stackrel{\mbox{\textbf{б)}}} = 0
\stackrel{!}{\le} \Lc(x,\la)+\de f_0(x),}
где <<!>> означает применение неравенства $(\la,c)\ge0$ для $c=(f_0(x)+\de,f_1(x)\sco f_n(x))$.
В силу произвольности~$\de$ заключаем, что $\Lc(\wh x, \la) \le \Lc(x,\la)$.

\pt{2} Пусть $\la_0>0$ и выполнены условия \textbf{а)}, \textbf{б)} и \textbf{в)}. Тогда
\eqn{\la_0f_0(\wh x) \stackrel{\mbox{\textbf{б)}}}{=} \Lc(\wh x,\la) \stackrel{\mbox{\textbf{в)}}}{\le}
\Lc(x,\la) = \suml{j=0}{n}\la_jf_j(x) \stackrel{\mbox{\textbf{а)}}}{\le} \la_0f_0(x),}
поэтому $\wh x\in \absmin$.

\pt{3} Пусть $\wh x\in \absmin$, и выполнено условие Слейтера, то есть $f_j(\wt x)<0$ ($j = 1\sco n$)
для некоторого $\wt x\in\Ac$. Предположим, что в найденном $\la$ оказалось $\la_0=0$.
Тогда $\Lc(\wh x,\la)=0>\suml{j=0}{n}\la_j f_j(\wt x)$\т противоречие с \textbf{в)}.
\end{proof}

\section{Задачи оптимального управления}


Наша основная цель\т доказать принцип максимума Понтрягина. Пока что рассмотрим задачу,
внешне похожую на задачу управления, но исследовать её мы будем в постановке Лагранжа.

Как обычно, $T = [t_0,t_1]$.

\subsection{Задача Лагранжа}

\eqn{\label{eqn:problemLagrange}
\bcase{&J(x,u)=\intl{t_0}{t_1} f\br{t,x(t),u(t)}\dt\ra\inf,\\
&\dot x(t)=\ph\br{t,x(t),u(t)},\\
&g(x^0,x^1)=0,}}
где $f \in \Cb^1(T\times\R^{n+m})$; $\ph \in \Cb^1(T \times \R^{n+m}; \R^n)$; $g \in \Cb^1(\R^{2n};\R^k)$.
%пусть $f\in \Cb^1(T\times\R^{n+m})$, $\ph\in \Cb^1(T\times\R^{n+m})$, $g\in \Cb^1(\R^{2n})$.
Функции $f$, $\ph$ и $g$ заданы. Неизвестными являются функции $x\cln T \ra \R^n$ и $u\cln T \ra \R^m$, которые ищутся
в классе $\Cb^1(T)$ и $\Cb(T)$ соответственно. Концы отрезка интегрирования $t_0$ и~$t_1$ фиксированы.

\begin{df}
Назовём пару $(x,u)$ \emph{допустимой}, если выполнены условия задачи
\eqref{eqn:problemLagrange}. Множество допустимых пар обозначим через $\Ac$.
\end{df}

\begin{df}
Мы пишем $(\wh x,\wh u)\in \locmin$, если $(\wh x,\wh u)\in\Ac$ и существует
$\ep>0$ такое, что для всех $(x,u)\in\Ac$, таких  что
$\hn{x-\wh x}_{\Cb^1}+\hn{u-\wh u}_\Cb<\ep$, выполнено
$J(\wh x,\wh u)\le J(x,u)$.
\end{df}

Аналогично определяется $\locmax$ и $\locextr$.

Составим функцию Лагранжа
\eqn{\Lc(x,u,\la_0,p,\nu):=\intl{t_0}{t_1}\hs{\la_0f(t,x,u)+\br{p(t),\dot x-\ph(t,x,u)}}dt + \br{\nu,g(x^0,x^1)},}
где $\la_0\in\R$, $p\in \Cb(T;\R^n)$, $\nu\in\R^k$.
\fns{Здесь самое сложное\т условие $\dot x=\ph$. Поскольку при каждом $t$
имеется равенство $\dot x(t)=\ph(t,x(t),u(t))$, то мы должны были бы <<написать
бесконечное число множителей Лагранжа и просуммировать их>>:
$\sums{t} p_{t}(\dot x(t)-\ph(t))$, вместо этого мы написали интеграл $\int p(t)\br{\dot x(t)-\ph(t)}$.}

Проведем некие неформальные рассуждения. Принцип Лагранжа утверждает, что если есть
решение задачи с условиями, то найдутся множители Лагранжа, такие что функция Лагранжа
имеет в соответствующей точке безусловный экстремум. В нашем случае это означает, что если
$(\wh x,\wh u)\in \locextr$, то найдутся $\wh\la_0$, $\wh p$ и $\wh\nu$, такие что
$(\wh x,\wh u,\wh p,\wh\nu)$ будет решением задачи
\eqn{\Lc(\wh\la_0,x,u,p,\nu)\ra\extr,}
при фиксированном $\wh\la_0$. Важно, что экстремум здесь понимается не в смысле
локального максимума или минимума, а в смысле стационарности функции, то есть равенства
нулю производной. Примем без доказательства, что принцип Лагранжа применим к нашей
задаче: найдутся $\la_0\in\R$, $p\in \Cb^1(T;\R^n)$ и $\nu\in\R^k$, такие что
при всех $h$ и $w$ выполнено
\eqn{\ba{\Lc'_{x(\cdot)}(\wh x,\wh u,\la_0,p,\nu),h}=0 , \qquad
\ba{\Lc'_{u(\cdot)}(\wh x,\wh u,\la_0,p,\nu),w}=0.}
\fns{Совершенно неясно, почему можно взять $p\in \Cb^1$.}

Из первого равенства, точно так же, как и в выводе уравнений для задачи Больца (разница
только в том, что там $\extr$ понимался как локальный максимум или минимум, но на
доказательство это не влияет), мы получаем необходимые условия на $\wh x$. Запишем
уравнение Эйлера $-\frac{d}{dt}L_{\dot x}+L_x=0$:
\eqn{-\dot p+\la_0f'_x(t,\wh x,\wh u)-\br{p(t),\ph'_x(t,\wh x,\wh u)}=0.}
Поскольку $p(t)$ и $\ph'_x$ суть векторы\д столбцы, то скалярное произведение
$(p,\ph'_x)$ можно записать как $(\ph'_x)^\top p$.
Поэтому перепишем уравнение Эйлера в следующем виде, который называется \emph{сопряженным уравнением}:
\eqn{\label{eqn:lagrangeAdjointEq}
\dot p+\br{\ph'_x(t,\wh x,\wh u)}^\top p=\la_0f'_x(t,\wh x,\wh u).}
Запишем условие трансверсальности:
\eqn{\label{eqn:lagrangeTransversal}
p(t_i)=(-1)^i(g'_{x^i})^\top \nu,\quad (i=0,1).}
Рассматривая производную $\Lc'_u$, получаем уравнение
\eqn{\label{eqn:lagrangeStat}
\la_0f'_u(t,\wh x,\wh u)-\br{\ph'_u(t,\wh x,\wh u)}^\top p=0.}

Попробуем получить те же уравнения, исходя из принципа Лагранжа для гладких задач с
ограничениями типа равенств. Напомним, что нами рассматривалась задача
\eqn{\bcase{
&f(x)\ra\inf,\\
&F(x)=0.}}
Предполагалось, что $X$ и $Y$\т банаховы пространства, $U\subset X$\т открытое
подмножество, $f\cln U\ra\R$ и $F\cln U\ra Y$\т отображения, строго дифференцируемые
в точке $\wh x$. Теорема \ref{thm:Lagrange} утверждала, что в случае замкнутости
множества $\Im F'(\wh x)$ для такой задачи справедлив принцип Лагранжа.

\begin{theorem}
Пусть $(\wh x,\wh u)\in \locextr$ для задачи \eqref{eqn:problemLagrange}, и выполнены условия
гладкости $f,\ph,g\in \Cb^1$. Тогда найдутся $\la_0\in\R$, $p\in \Cb^1(T;\R^n)$,
$\nu\in\R^k$, такие что $(\la_0,p,\nu)\ne0$ и справедливы уравнения
\eqref{eqn:lagrangeAdjointEq}, \eqref{eqn:lagrangeTransversal}, \eqref{eqn:lagrangeStat}.
\end{theorem}
\begin{proof}
Мы наметим лишь план доказательства. Будем сводить всё к общей теореме
\ref{thm:Lagrange}. В нашем случае $X\bw{:=}\Cb^1(T;\R^n)\times \Cb(T;\R^m)$,
то есть $\xbi\in X$ соответствует паре функций: $\xbi\lra (x,u)$.
Далее, возьмём $Y\bw{:=}\Cb(T;\R^n)\times\R^k$, $U:=X$,
\eqn{f(\xbi) := J(x,u),}
\eqn{F(\xbi) := \br{\dot x-\ph(t,x,u),g(x^0,x^1)}.}

Отображения $f$ и $F$ строго дифференцируемы, так как в выражениях для $F$ и $f$ участвуют
лишь оператор Немыцкого, операторы взятия производной и интегрирования, дельта\д функция и
гладкие функции $g$ и $\ph$.

Проверим замкнутость образа $\Im F'(\wh{\xbi})$:
\eqn{F'(\wh{\xbi})(h,w) = \br{\dot h-\ph'_x(t,\wh x,\wh u)h-\ph'_u(t,\wh x,\wh u)w,  g'_{x^0}h(t_0)+g'_{x^1}h(t_1)}.}
Оператор $F'$ имеет вид
$F'(\cdot)=\br{A(\cdot),B(\cdot)}$, где $A$ действует в $\Cb(T;\R^n)$, $B$ действует в~$\R^k$. Покажем, что отображение~$A$
сюръективно (отсюда автоматически последует замкнутость $\Im A$).
Действительно, для всякой функции $\psi(t)\in \Cb(T;\R^n)$ уравнение $\ha{A,(h,w)}=\psi(t)$,
или, что то же самое,
\eqn{\dot h-\ph'_x(t,\wh x,\wh u)h-\ph'_u(t,\wh x,\wh u)w = \psi(t)}
имеет решение, как следует из теоремы существования из курса ОДУ. Далее,
поскольку $\R^k$ конечномерно, то $B\Ker A$ замкнуто. По лемме о замкнутости образа, $\Im F'$ тоже будет замкнут.

Итак, все условия теоремы \ref{thm:Lagrange} выполнены, и мы можем сделать вывод:
существует ненулевая пара $(\la_0,y^*)\bw\in\R\times \br{\Cb(T;\R^n)\times\R^k}^*$, такая что
для функции Лагранжа в общей форме
\eqn{\Lc(\xbi,\la,y^*)=\la f(x)+\ha{F(\xbi),y^*}}
будет выполнено условие стационарности
\eqn{\Lc'_{\xbi}(\wh{\xbi},\la_0,y^*)=0,}
откуда
\eqn{\Lc'_x(\wh{\xbi},\la_0,y^*)=0, \quad \Lc'_u(\wh{\xbi},\la_0,y^*)=0.}
Разберемся с условием стационарности по $x$. Оно эквивалентно тому, что при всех $h$ имеем
\eqn{\label{eqn:lagrangeStatEquiv}
\la_0f'_x(\wh{\xbi})h + \ha{y^*,F'_x(\wh{\xbi})h}=0.}
Перепишем это условие по\д другому. По теореме Рисса, любой линейный непрерывный функционал~$\xi$
на $\Cb[a,b]$ имеет вид $\ha{\xi,f(t)}=\intl ab f(t)\dmu(t)$, где $\mu(t)$\т функция
ограниченной вариации, а интеграл понимается как интеграл Римана\ч Стилтьеса. Отсюда
следует, что $y^*$ можно представить в виде
\eqn{\ba{y^*,(f(t),r)} = \suml{i=1}{n} \intl{t_0}{t_1} f_i(t)\dmu_i(t) + (\nu,r),}
где $f=(f_1,f_2\sco f_n)$. Далее, из условия стационарности можно вывести, что меры
$d\mu_i(t)$ будут иметь $\Cb^1$\д гладкую плотность, то есть найдется $p(t)\in \Cb^1(T;\R^n)$,
для которого
\eqn{\intl{t_0}{t_1}f_i(t)\dmu_i(t) = \intl{t_0}{t_1}p_i(t)f_i(t)\dt.}
Это доказывается с помощью аналога леммы Дюбуа\ч Реймона,
который мы не будем здесь приводить. Подставляя полученное представление для $y^*$
в~\eqref{eqn:lagrangeStatEquiv}, получим, что при всех $h$
\eqn{\intl{t_0}{t_1}\bs{\la_0f'_x(t,\wh x,\wh u)h(t) + \br{p(t),\dot h-\ph'_x(t,\wh x,\wh u)h(t)}}\dt +
\br{\nu,g'_{x(t_i)}\br{h(t_i)}} = 0.}
Далее идут те же рассуждения, что
и в задаче Больца: применение леммы Дюбуа\ч Реймона и интегрирование по частям.

Условие стационарности по $u$ исследуется аналогично.
\end{proof}


\subsection{Задачи оптимального управления}

Рассмотрим пример задачи оптимального управления.


\eqn{\label{eqn:problemOptCommon}
\bcase{
&J(x,u)=\intl{t_0}{t_1} f\br{t,x(t),u(t)}\dt\ra\inf,\\
&\dot x(t)=\ph\br{t,x(t),u(t)},\\
&g(x^0,x^1)=0,\\
&u(t)\in U \text{ при всех } t.}}
Функции $f,\ph$ и $g$ предполагаются гладкими, $U$\т некоторое замкнутое множество.
\fns{Кстати, контрольный вопрос к читателю: а где используется замкнутость множества $U$?}
Концы отрезка интегрирования $t_0$ и $t_1$, в принципе, могут быть подвижны, но мы
остановимся на случае фиксированных $t_0$ и $t_1$.
Как и раньше, $x^i = x(t_i)$ ($i=0,1$). Важно, что теперь мы ищем $x$ и $u$ не
среди гладких функций, а среди кусочно\д гладких и кусочно\д непрерывных соответственно.
Дело в том, что гладких решений обычно не существует, а на практике $x$~получается
кусочно\д гладкой функцией, $u$\т кусочно\д непрерывной.
Итак, мы рассматриваем
\eqn{x(t)\in \KC^1(T;\R^m), \quad u(t)\in \KC(T;\R^m).}
Для полноты картины напомним, что мы называем функцию \emph{кусочно\д непрерывной} на отрезке, если
этот отрезок можно так разбить на более мелкие отрезки, что на каждом из полученных интервалов функция уже
будет непрерывной, а в точках разбиения допускаются только разрывы первого рода (то есть должны существовать конечные пределы
справа и слева).

\begin{note}
В литературе для кусочно\д непрерывных функций встречается (более правильное) обозначение $\mathbf{PC}$
(от англ. \emph{piecewise-continuous}). Однако мы будем придерживаться обозначения $\KC$.
\end{note}
\begin{df}
Пара $(x,u)\in \KC^1\times \KC$ называется \emph{допустимой} (или \emph{управляемой}), если
$(x,u)$ удовлетворяет условиям задачи \eqref{eqn:problemOptCommon}: $\dot x=\ph$,
$g(x^0,x^1)=0$ и $u(t)\in U$ для всех $t$.

\end{df}

\begin{df}
Пара $(\wh x,\wh u)$ называется \emph{решением}, или \emph{оптимальным процессом},
а~$\wh u$ называется \emph{оптимальным управлением}), если
$(\wh x,\wh u)$ допустима, и существует $\ep>0$, такое что для любой допустимой пары
$(x,u)$ неравенство $\hn{x-\wh x}_C<\ep$ влечёт $J(\wh x,\wh u)\le J(x,u)$.
\end{df}
Главное отличие этого определения от предыдущих\т то, что $u$ уже не должно быть близко
к $\wh u$, а может быть любым.
\fns{Общий смысл задач оптимального управления
примерно таков: некий (физический) процесс с траекторией $x(t)$ описывается
дифференциальными уравнениями и другими соотношениями. В эти уравнения и соотношения
входит параметр (управление)\т функция~$u$. Реализацию процесса $x$ и управление $u$ мы можем
выбирать в заданных пределах (множество $U$) как захотим. При этом нужно минимизировать
заданный функционал. Пример: как следует управлять ракетой, чтобы она в фиксированный
момент времени достигла заданной точки с заданной скоростью, израсходовав минимум
топлива. Если $x$\т положение ракеты, $u$\т вектор тяги ракеты (считаем массу ракеты
единичной), $g$\т поле тяготения, то получается задача оптимального управления
\eqn{\bcase{
&\intl{t_0}{t_1}\hm{u}dt\ra\inf,\\
&\ddot x=u+g,\\
&x(t_i)=x_i,\;\dot x(t_i)=v_i,\;i=1,2.}}}

Составим функцию Лагранжа
\eqn{\Lc(x,u,\la_0,p,\nu) = \intl{t_0}{t_1}\hs{\la_0f(t,x,u)+\br{p(t),\dot x-\ph(t,x,u)}}dt + \br{\nu,g(x^0,x^1)}.}

Из того, что $(\wh x,\wh u)$ является оптимальным процессом, сразу следует, что $(\wh x,\wh u)$
доставляет локальный минимум в задаче Лагранжа. Поэтому для $\wh x$ и $\wh u$ выполнены уравнения
\eqref{eqn:lagrangeAdjointEq}, \eqref{eqn:lagrangeTransversal}, \eqref{eqn:lagrangeStat}.
\fns{Мы закрываем глаза на то, что $\wh x$ может быть
кусочно\д гладкой, а не гладкой, как в задаче Лагранжа\ldots}
Всё же уравнение
\eqref{eqn:lagrangeStat} слишком слабое, так как использует лишь локальную минимальность по~$u$.
Вместо этого уравнения имеется более сильное, которое носит название \emph{принципа
максимума Понтрягина}:
\eqn{f(t,\wh x,\wh u)-p(t)\ph(t,\wh x,\wh u)=\minl{v\in U}\bs{f(t,\wh x,v)-p(t)\ph(t,\wh x,v)}.}
Это уравнение соответствует тому, что функция Лагранжа не просто
стационарна по $u$ при фиксированном $x$, а достигает минимума!

\subsection{Доказательство принципа максимума}

Проведем доказательство для более простой задачи.
\eqn{\label{eqn:problemOptSimple}
\bcase{&J(x,u)=\intl{t_0}{t_1}f(t,x,u)\dt\ra\inf,\\
&\dot x=\ph(t,x,u),\\
&x(t_0)=x_0,\\
&u(t) \in U \text{ при всех } t.}}
Предполагается, что $f\in \Cb^1(T;\R^2)$, $\ph\in \Cb^1(T\times\R^2)$, $U \subs \R$\т
замкнутое множество. Решение $x$ ищется в классе кусочно-гладких функций, $u$\т в
классе кусочно\д непрерывных: $x\in \KC^1(T)$, $u\in \KC(T)$.
\fns{Равенство $\dot x=\ph(t,x,u)$ в задаче \eqref{eqn:problemOptSimple} должно выполняться не во всех
точках $t$, а только в тех, в которых функция $u$ непрерывна. Заметим также, что из этого
равенства следует, что $x$~будет $\Cb^1$\д гладкой на тех отрезках, на которых $u$
непрерывна.}

\begin{theorem}
Пусть $(\wh x,\wh u)$\т решение задачи \eqref{eqn:problemOptSimple}. Тогда найдётся функция
$p\in \KC^1(T)$, такая что выполнены условия стационарности по $x$ и
трансверсальности
\eqn{\label{eqn:StatTransv}\bcase{
&\dot p(t)+\ph'_x\br{t,\wh x(t),\wh u(t)} p(t) = f'_x\br{t,\wh x(t),\wh u(t)},\\
&p(t_1)=0,}}
и выполнен принцип максимума Понтрягина
\eqn{f\br{t,\wh x(t),\wh u(t)}-\ph\br{t,\wh x(t),\wh u(t)}p(t) = \minl{v\in U}\hs{f\br{t,\wh x(t),v}- \ph\br{t,\wh x(t),v}p(t)}}
(равенства справедливы для любой точки $t$, в которой $\wh u$ непрерывна).
\end{theorem}
\begin{proof}
По сути дела, условия стационарности и трансверсальности были получены ранее в общем случае.
Действительно, из принципа Лагранжа следует, что
\eqn{\label{eqn:StatTransvLagr}\bcase{
&\dot p(t)+\ph'_x\br{t,\wh x(t),\wh u(t)} p(t) = \la_0 f'_x\br{t,\wh x(t),\wh u(t)},\\
&p(t_1)=0,}}
Покажем, что в нашем случае $\la_0 \neq 0$.
Действительно, если $\la_0=0$, то задача Коши для функции $p(t)$ имеет (единственное по теореме
существования и единственности для ОДУ) решение $p(t) \equiv 0$. Но это противоречит
тому, что хотя бы один из множителей Лагранжа не равен нулю. Итак, можно считать, что $\la_0 = 1$,
и мы приходим к уравнению~\eqref{eqn:StatTransv}.

Перейдем к доказательству принципа максимума. Возьмем $\tau\in \Int T$\т точку
непрерывности для $\wh u$ (ясно, что можно считать $\wh u$ непрерывной на концах
отрезка). Зафиксируем произвольное $v\in U$. Возьмем малое $\la\ge0$ так, чтобы на
отрезке $[\tau-\la,\tau]$ функция $\wh u$ была непрерывна. \emph{Игольчатой вариацией}
называется пара $(x_\la(t),u_\la(t))$, определяемая из равенств
\eqn{u_\la(t)=
\case{v,&t\in[\tau-\la,\tau),\\\wh
u(t),&t\notin[\tau-\la,\tau),}}
\eqn{\bcase{
\dot x_\la(t)&=\ph\br{t,x_\la(t),u_\la(t)},\\
x_\la(t)&=x_0.}}
Почему существует и единственно решение выписанной задачи Коши на $x_\la(t)$? Пусть
$\si_1<\si_2\sles \si_k$\т точки разрыва функции $u_\la$. На отрезке
$[t_0,\si_1]$ мы получаем обычную задачу Коши, решая ее, находим $x_\la(\si_1-0)$.
Далее решаем на отрезке $[\si_1,\si_2]$ задачу $\dot x_\la=\ph(t,x_\la,u_\la)$ с
начальным условием $x_\la(\si_1+0):=x_\la(\si_1-0)$. И так далее мы пройдем весь
отрезок.

Обозначим для краткости
\begin{gather}
\wh\ph(t):=\ph\br{t,\wh x(t),\wh u(t)},\quad \wh\ph'_x(t):=\ph'_x\br{t,\wh x(t),\wh u(t)},\\
\wh f(t):=f\br{t,\wh x(t),\wh u(t)},\quad\wh f'_x(t):=f'_x\br{t,\wh x(t),\wh u(t)}.
\end{gather}

\begin{lemma}

\pt{1} $x_\la(t)\rra \wh x(t)$ на отрезке $T$ при $\la\ra+0$.

\pt{2} $\frac{x_\la(t)-\wh x(t)}{\la}\rra y(t)$ на отрезке $[\tau,t_1]$ при
$\la\ra+0$, где $y(t)$\т некоторая кусочно-гладкая функция, удовлетворяющая условиям
\eqn{\label{eqn:problemOptSimpleYFunc}
\bcase{\dot y(t)&=\wh\ph'_x(t)y(t),\\
y(\tau)&=\ph\br{\tau,\wh x(\tau),v}-\wh\ph(\tau).}}
\end{lemma}
\begin{proof}
Предположим сначала, что функция $\wh u$ непрерывна на $T$. Утверждения о
сходимости выведем из теорем о непрерывной и гладкой зависимости решения от параметров.

\pt1 На отрезке $[t_0,\tau-\la]$ функция $x_\la(t)$ совпадает с $\wh x(t)$, поэтому
доказывать нечего.

Рассмотрим отрезок $[\tau-\la,\tau]$. Определим функцию $Y(t,s,\xi)$ как решение задачи
\eqn{\bcase{&\pf{}{t}Y(t,s,\xi)=\ph\br{t,Y(t,s,\xi),v},\\
&Y\evn{t=s}=\xi.}}
По теореме о непрерывной зависимости решения от начальных условий функция $Y$
непрерывна (на самом деле даже непрерывно дифференцируема!).
\mln{\hm{x_\la(t)-\wh x(t)} \le \hm{x_\la(t)-\wh x(\tau-\la)} + \hm{\wh x(\tau-\la)-\wh x(t)} =\\=
\hm{Y\br{t,\tau-\la,\wh x(\tau-\la)}-Y\br{\tau-\la,\tau-\la,\wh x(\tau-\la)}} +
\hm{\wh x(\tau-\la)-\wh x(t)}.} В силу непрерывности $Y$ и $\wh x$ это выражение стремится к
нулю равномерно на $[\tau-\la,\tau]$.

Рассмотрим отрезок $[\tau,t_1]$. Определим функцию $X(t,\xi)$ как решение задачи
\eqn{\bcase{&\pf{}{t}X(t,\xi)=\ph\br{t,X(t,\xi),\wh u},\\
&X\evn{t=\tau}=\xi.}}
По теореме о гладкой зависимости решения от начальных условий функция
$X(t,\xi)$ непрерывно дифференцируема по совокупности переменных $(t,\xi)$. Обозначим
$\xi_\la:=x_\la(\tau)$. Как мы показали, $\xi_\la\ra\wh x(\tau)$. Поскольку
$x_\la(t)=X(t,\xi_\la)$ и $\wh x(t)=X\br{t,\wh x(\tau)}$, то $x_\la(t)\rra \wh x(t)$.

\pt2 Поскольку $\xi_\la=Y(\tau,\tau-\la,\wh x(\tau-\la))$, то $\xi_\la$
непрерывно дифференцируема по $\la$. Значит, $x_\la(t)=X(t,\xi_\la)$ будет
непрерывно дифференцируемой по совокупности переменных $(t,\la)$. Отсюда
\eqn{\frac{x_\la(t)-\wh x(t)}{\la}\rra
\frac{d}{d\la}x_\la(t)\evn{\la=0}\quad\mbox{на } [\tau,t_1].}

Теперь получим \eqref{eqn:problemOptSimpleYFunc}, преобразовав $y(t)$:
\mln{y(t) = \liml{\la\ra+0}\frac{x_\la(t)-\wh x(t)}\la =
\liml{\la\ra+0}\intl{t_0}{t}\frac{\dot x_\la(s)-\Dot{\wh x}(s)}\la\ds =
\liml{\la\ra+0}\intl{t_0}{t}\frac{\ph\br{s,x_\la(s),u_\la(s)}-\wh\ph(s)}\la\ds =\\=
\liml{\la\ra+0} \frac1\la\intl{\tau-\la}{\tau}\ph\br{s,x_\la(s),u_\la(s)}-\wh\ph(s)\ds +
\liml{\la\ra+0}\intl{\tau}{t}\frac{\ph\br{s,x_\la(s),\wh u(s)}-\wh\ph(s)}\la\ds.}
Из обычной теоремы о среднем следует, что первый предел равен $\ph(\tau,\wh x(\tau),v)-\wh\ph(\tau)$.
Вычислим второй предел.
\eqn{\ph\br{s,x_\la(s),\wh u(s)}-\wh\ph(s) = \ph'_x\br{s,\ta_\la(s),\wh u(s)}\br{x_\la(s)-\wh x(s)},}
где $\ta_\la(s)$ между $x_\la(s)$ и $\wh x(s)$. Поскольку
$x_\la(s)\rra\wh x(s)$, то $\ph'_x\br{s,\ta_\la(s),\wh u(s)}\rra\wh\ph'_x(s)$. Отсюда
\eqn{\liml{\la\ra+0}\intl{\tau}{t}\frac{\ph\br{s,x_\la(s),\wh u(s)}-\wh\ph(s)}\la\ds =
\liml{\la\ra+0}\intl{\tau}{t}\ph'_x\br{s,\ta_\la(s),\wh u(s)}\frac{x_\la(s)-\wh x(s)}\la =
\intl{\tau}{t}\wh\ph'_x(s)y(s)\ds.}
Мы доказали, что
\eqn{y(t)=\ph(\tau,\wh x(\tau),v)-\wh\ph(\tau)+\intl{\tau}{t}\wh\ph'_x(s)y(s)\ds.}
Дифференцируя полученное выражение, получаем \eqref{eqn:problemOptSimpleYFunc}. Лемма доказана в
случае непрерывной $\wh u$. Если же имеются точки разрыва, нужно провести то же
рассуждение на первом отрезке непрерывности, потом на втором (правда, начальное условие
уже может меняться по $\la$, но гладко, так что это не страшно), и так далее пройти весь
отрезок.
\end{proof}

Рассмотрим выражение
\eqn{\Ph(\la):=\intl{t_0}{t_1}f\br{t,x_\la(t),u_\la(t)}-f\br{t,\wh x(t),\wh u(t)}\dt.}
Вычислим производную $\Ph(\la)$ в нуле (заодно доказав, что она существует):
\eqn{\frac{\Ph(\la)-\Ph(0)}\la = \liml{\la\ra+0}\frac1\la\intl{\tau-\la}{\tau}
f\br{t,x_\la(t),v}-\wh f(t)\dt + \liml{\la\ra+0}\intl{\tau}{t_1}\frac{f\br{t,x_\la(t),\wh u(t)}-\wh f(t)}\la\dt.}
Так же как и в лемме (и используя лемму!), мы находим, что
первый предел равен $f\br{\tau,\wh x(\tau),v}\bw-\wh f(\tau)$, а второй предел равен
$\intl{\tau}{t_1}\wh f'_x(t)y(t)\dt$. Выражая $\wh f'_x$ из уравнения стационарности по $x$, получаем
\eqn{\intl{\tau}{t_1}\wh f'_x(t)y(t)dt = \intl{\tau}{t_1}(\dot p+p\wh\ph'_x)\dt =
\intl{\tau}{t_1}(\dot py+p\dot y)dt = p(t_1)y(t_1)-p(\tau)y(\tau).}
Окончательно, используя равенство $p(t_1)=0$ и \eqref{eqn:problemOptSimpleYFunc}, получаем
\eqn{\Ph'(0) = f(\tau,\wh x(\tau),v)-\wh f(\tau)-p(\tau)\bs{\ph\br{\tau,\wh x(\tau),v}-\wh\ph(\tau)}.}

Вспомним, что $(\wh x,\wh u)$ является решением нашей задачи (оптимальным процессом),
поэтому при малых $\la$ будет $\Ph(\la)\ge \Ph(0)=0$, откуда $\Ph'(0)\ge 0$, то есть
\eqn{f\br{\tau,\wh x(\tau),v}-p(\tau)\ph\br{\tau,\wh x(\tau),v}\ge \wh f(\tau) - p(\tau)\wh\ph(\tau).}
Так как $v$ и $\tau$ были произвольными, теорема доказана.
\end{proof}

\section{Теоремы существования}

Ясно, что не всякие экстремальные задачи имеют решение. Например, функция не обязана
достигать минимального значения, если она рассматривается на некомпактном множестве. Или
уравнение Эйлера может не иметь решений, как в следующей задаче:
\eqn{\bcase{
&\intl{0}{1} t^2\dot x^2\dt\ra\inf,\\
&x(0)=0,\;x(1)=1.}}

\subsection{Полунепрерывность}

Классическая теорема существования заключается в том, что непрерывная на компакте функция
достигает минимума и максимума. Обобщим эту теорему, введя понятие полунепрерывности.

Пусть $X$\т топологическое пространство. Будем рассматривать только собственные функции
$f\cln X\ra\ol\R$ (то~есть только функции $f > -\bes$ и $f \not\equiv +\bes$).

\begin{df}
\emph{Лебеговым множеством} функции $f$ уровня $\la$ называется множество
\eqn{\Lc_\la f = \hc{x\in X\cln f(x) \le \la}.}
\end{df}

\begin{df}
Функция $f$ называется \emph{полунепрерывной снизу}, если выполнено одно из следующих
эквивалентных условий:

\textbf{(i)} для любого $\la\in\R$ множество $\Lc_\la f$ замкнуто в $X$,

\textbf{(ii)} $\epig f:=\hc{(\la,x)\in\R\times X\cln f(x)\le\la}$ замкнут в $\R\times X$.
\end{df}

\begin{lemma}
Условия \textbf{(i)} и \textbf{(ii)} эквивалентны.
\end{lemma}
\begin{proof}
Пусть выполнено \textbf{(i)}. Покажем, что множество
$\R\times X\wo\epig f=\hc{(\la,x)\cln f(x)>\la}$ открыто. Возьмем $(\la_0,x_0)$,
для которых $f(x_0)>\la_0$. Тогда найдется $\ep>0$, такой что $f(x_0)>\la_0+\ep$.
Поскольку $X\wo\Lc_{\la_0+\ep} f$ открыто, то найдется окрестность $U$ точки $x_0$,
в которой выполнено неравенство $f(x)>\la_0+\ep$. Тогда $(\la_0-\ep,\la_0+\ep)\times U$
будет окрестностью точки $(\la_0,x_0)$, целиком лежащей в $\R\times X\wo\epig f$.

Обратно: фиксируем $\la_0$. Множество $\hc{(\la_0,x)\cln f(x)\le\la_0}$ замкнуто как
пересечение замкнутых множеств $\epig f$ и $\hc{(\la_0,x)\cln x\in X}$. Значит, замкнуто
и $\Lc_{\la_0} f$.
\end{proof}

Удобно говорить о полунепрерывных функциях в терминах последовательностей. Пусть $X$
обладает таким свойством: $A\subset X$ замкнуто $\Lra$ предел любой фундаментальной
последовательности элементов $A$ лежит в $A$. Легко проверить, что тогда свойства \textbf{(i)} и \textbf{(ii)}
эквивалентны третьему:

\textbf{(iii)} для всех $\wh x\in X$ и для всякой последовательности $\hc{x_n}\ra\wh x$ выполнено $f(\wh x)\le\lliml{n\ra\bes} f(x_n).$

\fns{Указанное свойство пространства $X$ выполнено автоматически, если $X$
метризуемо (то есть топология задается некоторой метрикой). Можно ослабить это требование до
требования первой аксиомы счетности: у любой точки $x\in X$ найдется не более чем счетная
система окрестностей $V_1,V_2\etc$, такая что любая окрестность $x$ содержит какую\д то
из $V_j$. Если формулировать определение полунепрерывности в терминах
последовательностей, то от $X$ надо требовать не компактности, а секвенциальной
компактности (то~есть каждая последовательность должна иметь сходящуюся
подпоследовательность). Тогда мы сможем доказать аналог теоремы Вейерштрасса\ч Лебега (см.~ниже).
Действительно, пусть $x_n\cln f(x_n)\ra\be=\infl{x\in X}f(x)$. Выделим
$x_{n_k}\ra x$. Тогда $f(x)\le \be$, откуда $f(x)=\be$.}

\begin{theorem}[Вейерштрасс\ч Лебег]
Пусть $X$\т компактное топологическое пространство, $f\cln X\bw\ra\ol \R$\т собственная,
полунепрерывная снизу функция. Тогда $f$ ограничена снизу и достигает наименьшего
значения: найдётся $\wh x$, для которого $f(\wh x)=\infl{x\in X} f(x)$.
\end{theorem}
\begin{proof}
Обозначим $U_\la:=X\wo\Lc_\la f$. Эти множества открыты ввиду полунепрерывности функции $f$. Ясно, что
$\cups{n\in\Z}U_n = X$. Выделим конечное подпокрытие $U_{n_1}\sco U_{n_k}$.
Тогда $f$ ограничена снизу числом $\min n_j$. Возьмем $\be:=\infl{x\in X}f(x)$. Если $f(x)>\be$ для всех
$x \in X$, то $\cupl{n=1}{\bes} U_{\be+\frac1n}=X$. Снова выделим конечное подпокрытие
$U_{\be+\frac{1}{n_1}}\sco U_{\be+\frac1{n_s}}$. Но тогда при всех $x$ будет
$f(x)>\be+\min \frac{1}{n_j}$\т противоречие.
\end{proof}

\subsubsection{Принцип компактности}

Пусть $X$\т нормированное пространство.

\begin{df}
Скажем, что $x_n$ \emph{слабо сходится} к $x$,
если для всех $x^*\in X^*$ имеем $\ha{x^*,x_n}\ra\ha{x^*,x}$ (обозначение: $x_n\convw x$).
\end{df}

\begin{df}
Банахово пространство называется \emph{рефлексивным}, если $X^{**}=X$, точнее, если
для всякого $x^{**}\in X^{**}$ существует $x\in X$ такой, что для всех $x^*\in X^*$ выполнено
$\ha{x^{**},x^*}=\ha{x^*,x}$.
\end{df}

Поверим (без доказательства) в следующую теорему:

\begin{theorem}
Пространство рефлексивно тогда и только тогда, когда из любой ограниченной последовательности можно выбрать слабо сходящуюся.
\end{theorem}

\begin{df}
Множество $A\subset X$ называется \emph{секвенциально слабо замкнутым}, если для любой
последовательности $\hc{x_n}\subset A$ из условия $x_n\convw x$ следует $x\in A$.
\end{df}

\begin{df}
Функция $f$ называется \emph{полунепрерывной снизу относительно слабой сходимости}, если
выполнены следующие эквивалентные условия:

\textbf{(i)} для любого $\wh x\in X$ и любой последовательности $\hc{x_n}\convw\wh x$ выполнено $f(\wh x)\le\llim f(x_n),$

\textbf{(ii)} для любого $\la\in\R$ множество $\Lc_\la f$ секвенциально слабо замкнуто,

\textbf{(iii)} множество $\epig f$ секвенциально слабо замкнуто.
\end{df}

Доказательство равносильности \textbf{(i)}\т \textbf{(iii)} остается в качестве упражнения.

Пусть $X$\т банахово, $A\subset X$\т подмножество, $f\cln X\ra\ol\R$\т функция.
Рассмотрим задачу
\eqn{\label{eqn:problemSeq}
\bcase{
&f(x)\ra\inf,\\
&x\in A.}}

\begin{df}
Задача \eqref{eqn:problemSeq} называется \emph{коэрцитивной}, если найдется $\la\in\R$, для
которого множество $\Lc_\la\bw{:=}\hc{x\in A\cln f(x)\le\la}$ непусто и ограничено.
\end{df}

\begin{theorem}[Принцип компактности]\label{thm:Exist}
Пусть $X$\т рефлексивное банахово пространство, $f$\т полунепрерывна снизу относительно слабой сходимости,
$A$\т секвенциально слабо замкнуто и задача~\eqref{eqn:problemSeq} коэрцитивна. Тогда эта задача
имеет решение: существует $\wh x\in A$ такой, что $f(\wh x)=\infl{x\in A}f(x)$.
\end{theorem}
\begin{proof}
Возьмём $\la$, для которого $\Lc_\la$ непусто и ограничено. Обозначим
$\mu:=\infl{x\in A} f(x)\in[-\bes,\la]$. В случае $\mu=\la$ можно взять любое
$\wh x\in\Lc_\la$. Пусть $\mu<\la$. Выберем $\hc{x_n}\subset A\cln f(x_n)\ra\mu$.
Поскольку $\hc{x_n}\subset\Lc_\la$, а $\Lc_\la$ ограничено, то из $\hc{x_n}$ можно выделить
слабо сходящуюся подпоследовательность $x_{n_k}$. Пусть $x_{n_k}\convw\wh x\in X$. Тогда
$\wh x\in A$, $f(\wh x)\le\llim f(x_{n_k})=\mu$, откуда $f(\wh x)=\mu$.
\end{proof}

Теоремы, подобные только что доказанным, особенно удобно применять в выпуклом случае.

\subsubsection{Некоторые факты выпуклого анализа}

Пусть $X$\т линейное пространство. Напомним без доказательства некоторые факты:
\begin{items}{-1}
\item Сумма вида $\suml{j=1}{k} \al_jx_j$ называется \emph{выпуклой комбинацией} точек
$x_j\in X$, если $\al_j\ge 0$ и $\suml{j=1}{k} \al_j=1$.
\item Множество всевозможных выпуклых комбинаций точек $A$
\eqn{\conv A:=\BC{\sum \al_i x_i\cln x_i\in A,\; \al_i \ge 0, \;\sum \al_i = 1}}
является наименьшим выпуклым множеством, содержащим $A$. Это множество называется \emph{выпуклой оболочкой} $A$.
\item Пусть $X$\т нормированное пространство. Если $A$ выпукло, то и $\ol A$ выпукло.
\end{items}

\begin{theorem}[Мазур]
Пусть $X$\т нормированное пространство, $\hc{x_n}\subset X$, $x_n\convw\wh
x$. Тогда найдется последовательность выпуклых комбинаций
$y_n=\suml{j=1}{n}\al_{j,n}x_j$, сходящаяся к $\wh x$.
\end{theorem}
\begin{proof}
Обозначим $C := \ol{\conv\hc{x_n}}$. Множество $C$ выпукло как замыкание выпуклого множества.
Нам надо доказать, что $\wh x \in C$. Если $\wh x\notin C$,
то, по второй теореме отделимости (теорема~\ref{thm:secondSeparationTheorem}), существует $x^*\in X^*$, для
которого $\supl{C}\ha{x^*,x}\bw< \ha{x^*,\wh x}$. Но это невозможно, ибо $\ha{x^*,x_n}\ra\ha{x^*,\wh x}$.
\end{proof}

\begin{imp}
Если $A\subset X$ выпукло и замкнуто, то $A$ секвенциально слабо замкнуто.
\end{imp}
\begin{proof}
Пусть $x_n\in A$, $x_n\convw\wh x$. Построим выпуклые комбинации $y_n=\suml{j=1}{n}\al_{j,n}x_j$,
$y_n\ra\wh x$. В силу выпуклости имеем $y_n\in A$, в силу замкнутости $\wh x\in A$.
\end{proof}

\begin{imp}
Если $f$ выпукла и полунепрерывна снизу, то $f$
полунепрерывна снизу относительно слабой сходимости.
\end{imp}
\begin{proof}
Возьмём $\la\in\R$. Множество $\Lc_\la f$ выпукло и замкнуто, а значит, секвенциально
слабо замкнуто.
\end{proof}

\subsection{Применение принципа полунепрерывности}

Напомним в очередной раз, что $T = [t_0,t_1]$.

\subsubsection{Теорема Тонелли и некоторые контрпримеры}

Рассмотрим простейшую задачу вариационного исчисления
\eqn{\label{eqn:problemVarExist}
\bcase{&J(x)=\intl{t_0}{t_1}L(t,x,\dot x)\dt\ra\inf,\\
&x(t_0)=x_0, \quad x(t_1)=x_1.}}

Мы будем искать решение этой задачи в классе Соболева $\Wb_q^1(T)$. Напомним, что
этот класс состоит из абсолютно непрерывных на отрезке $T$ функций, производная
которых лежит в $L_q(T)$. Норма в $\Wb_q^1$ задается равенством
\eqn{\hn{x}^q_{\Wb_q^1(T)}:=\intl{t_0}{t_1}\hm{x(t)}^q+\hm{\dot x(t)}^q\dt.}

\begin{theorem}[Тонелли]
Пусть выполнены:

\pt{1} условия гладкости: $L\in \Cb(T \times\R^2)$ и при всех $t,x$ функция $L(t,x,\cdot)\in \Cb^1(\R)$,

\pt{2} условие квазирегулярности: при всех $t,x$ функция $L(t,x,\cdot)$ выпукла,

\pt{3} условие роста: существуют $\al>0$, $\be$ и $q>1$ такие, что $L(t,x,p)\ge\al\hm{p}^q+\be$.

Тогда существует решение задачи~\eqref{eqn:problemVarExist} на множестве
$\Ac = \hc{x\in \Wb_q^1(T)\cln x(t_i)=x_i}$, то есть
существует $\wh x\in \Ac$, для которого $J(\wh x)=\infl{\Ac} J(x)$.
\end{theorem}

Мы не будем доказывать эту теорему, тем более что позже будет доказано более общее
утверждение. Заметим лишь, что доказательство теоремы Тонелли состоит в сведении ее к
общей теореме (пусть $X$\т рефлексивное банахово пространство, функция $f$ полунепрерывна
снизу, множество $A$ секвенциально слабо замкнуто, и задача $\hc{f(x)\ra\inf,\; x\in A}$
коэрцитивна; тогда эта задача имеет решение). При этом условие \pt{2} нужно для
полунепрерывности, условие \pt{3}\т для коэрцитивности. Разберём несколько примеров,
показывающих, что условия полунепрерывности, секвенциальной слабой замкнутости и
коэрцитивности существенны.

\begin{ex}\textbf{ (Больц)}
\eqn{\bcase{
J(x)&=\intl{0}{1}(\dot x^2-1)^2+x^2\dt\ra\inf,\\
x(0)&=x(1)=0.}}
Будем искать решение в пространстве $X := \Wb_4^1(0,1)$. Ясно, что $J(x)>0$ для всех
$x$, но для
\eqn{x_n(t)=\intl{0}{t} \sgn\sin(2\pi n\tau)\,d\tau,}
как легко проверить,
$J(x_n)\ra0$. Покажем, что выполнены все условия, кроме полунепрерывности функции. В~нашей задаче
\eqn{\Ac = \hc{x\in X \cln x(0)=x(1)=0}.}
Чуть позже мы докажем неравенство $\hm{x(0)}\le C\hn{x}_X$ для всех $x\in X$. Из
этого неравенства следует, что множество~$\Ac$ замкнуто. Действительно, если $x_n \in \Ac$ и $x_n \ra x$,
то $\hm{x(0)} = \hm{x(0) - x_n(0)} \le \hn{x -x_n} \ra 0$. Далее, поскольку множество~$\Ac$ выпукло,
то оно секвенциально слабо замкнуто.

Теперь покажем коэрцитивность. Для $\la=1$ множество $\hc{x\in \Ac\cln J(x)\le 1}$ непусто
(так как содержит ноль) и ограничено: для $x\in \Ac$ имеем (все интегралы по отрезку $[0,1]$):
\mln{\int\dot x^4-2\dot x^2+1+x^2\dt\le 1 \quad\Lra\quad \int\dot x^4-2\dot x^2+x^2\dt\le0 \quad\Ra\\ \Ra\quad
\int\dot x^4\dt\le\int 2\dot x^2\dt \quad\Ra\quad \int\dot x^4\dt \stackrel{!}{\le}
\int\frac12(4+\dot x^4)\dt \quad\Lra\quad \int\dot x^4\dt\le 4 \quad\Ra\quad \hn{x}_{\Wb_1^4}\le С.}
Переход, отмеченный <<!>>, верен в силу неравенства $ab \le \frac12\hr{a^2+b^2}$, а
последняя импликация верна в силу неравенства
Фридрихса (теорема~\ref{thm:Fridrix}) в $\Ac$: $\int x^4\dt\le C\int\dot x^4\dt$.

Нам осталось доказать неравенство $\hm{x(0)}\le C\hn{x}_X$. Докажем  общее утверждение,
предварив его леммой.

\begin{lemma}
Справедливо неравенство
\eqn{a + b \le 2 (a^p+b^p)^{1/p}.}
\end{lemma}
\begin{proof}
Пусть, для определённости, $a \ge b\ge 0$. Тогда $(a+b)^p \le 2^pa^p \le 2^p(a^p + b^p)$,
и остаётся только возвести это неравенство в степень $\frac1p$.
\end{proof}

\begin{stm}
Имеет место неравенство $\hm{x(0)}\le C(p)\hn{x}_{\Wb_p^1}$ для всех $x\in \Wb_p^1(0,1)$.
\end{stm}
\begin{proof}
Возьмем гладкую функцию $\ph(t)$, изображённую на~рис.~\picref{LocFunction}.
\cpic{4}{LocFunction}{Функция $\ph(t)$}
Поскольку $x(0)=-\intl{0}{1}\frac{d}{dt}(x\ph)\dt$, то (далее все интегралы по отрезку $[0,1]$, интегрируем по $t$):
\mln{\hm{x(0)}=\hm{\int\dot x\ph+x\dot\ph}\le \hr{\int\hm{\dot x}^p}^{1/p}\hr{\int\hm{\ph}^q}^{1/q} +
\hr{\int\hm{x}^p}^{1/p}\hr{\int\hm{\dot\ph}^q}^{1/q} \le \\ \le
C(p)\hs{\hr{\int\hm{\dot x}^p}^{1/p}+\hr{\int\hm{x}^p}^{1/p}}\stackrel{!}{\le}
2C(p)\hr{\int\hm{\dot x}^p+\int\hm{x}^p}^{1/p} = 2C(p)\hn{x}_{\Wb_p^1},}
что и требовалось доказать (переход <<!>> обусловлен предыдущей леммой).
\end{proof}
\end{ex}

\begin{note}
Иногда эту теорему называют теоремой о~сужении на~граничную точку отрезка.
\end{note}

\begin{ex}\textbf{ (Вейерштрасс)}
Положим $T := [0,1]$.
\eqn{\bcase{
J(x)&=\intl{0}{1}t^2\dot x^2\dt\ra\inf,\\
x(0)&=0,\;x(1)=1.}}
Решение <<естественно>> искать в классе
\eqn{W:=\bbc{x\in \AC(T)\cln\hn{x}_W^2:=\intl{0}{1}(t^2\dot x^2+tx^2)\dt<\bes}.}

\begin{note}
Не следует путать класс $W$ с пространством Соболева.
\end{note}

В силу условия $x(1)=1$ очевидно, имеем
$J(x)>0$.
\cpic{2}{WCounterSeq}{Последовательность функций $x_n(t)$}
В то же время, для последовательности
\eqn{x_n(t)=\case{nt,&0\le t\le \frac1n,\\1,&t>\frac1n}}
(см.~рис.~\picref{WCounterSeq}) будет $J(x_n)\ra 0$. Значит, наша задача не имеет решения. Покажем, что выполнены все
условия, кроме секвенциальной слабо замкнутости множества $\Ac:=\hc{x\in W\cln x(0)=0,\;x(1)=1}$.

Установим коэрцитивность. Положим $W_0:=\hc{x\in W\cln x(1)=0}$. Докажем, что
\eqn{\intl{0}{1} tx^2dt\le\frac12\intl{0}{1}t^2\dot x^2\dt}
для всех $x\in W_0$.
Действительно,
\eqn{\begin{aligned}
x(t) &= -\intl t1 \dot x(\tau)\dtau = -\intl t1 \frac{1}\tau\tau\dot x(\tau)\dtau,\\
x(t)^2&\le\bbbr{\intl t1\frac{d\tau}{\tau^2}}\bbbr{\intl t1\tau^2\dot x(\tau)^2\dtau} =
\frac{1-t}{t}\intl t1\tau^2\dot x(\tau)^2\dtau \le \frac{1-t}{t}\intl{0}{1} \tau^2\dot x(\tau)^2\dtau.
\end{aligned}}
Подставляя полученную оценку для $x^2$ в доказываемое неравенство, получаем
\eqn{\intl{0}{1}tx(t)^2\dt\le\intl{0}{1}(1-t)\dt\intl{0}{1}\tau^2\dot x(\tau)^2\dtau =
\frac12\intl{0}{1}\tau^2\dot x(\tau)^2\dtau.}
Теперь заметим, что $\Ac\subset W_0+1$, откуда
\eqn{\BC{x\in\Ac\cln J(x)\le1}\subset \BC{x+1\in W_0+1\cln\intl{0}{1} t^2\dot x^2dt\le 1}\subset
1+\BC{x\in W_0\cln\hn{x}_{W(T)}\le\frac32},}
и коэрцитивность доказана.

Полунепрерывность снизу функционала $J$ следует из его выпуклости по $\dot x$
(подробности см.~ниже в доказательстве теоремы Тонелли).
\end{ex}

\begin{ex}\textbf{ (Гармонический осциллятор)}
\eqn{\bcase{
J(x)&=\intl{0}{T}\dot x^2-x^2\dt\ra\inf,\\
x(0)&=0,\;x(T)=0.}}
В данной задаче $T$\т фиксированное число, большее $\pi$. Решение будем искать
в классе $\Wb_2^1(0,T)$. Выпуклость по~$\dot x$ гарантирует полунепрерывность. Множество
$\hc{x\in \Wb_2^1(0,T)\cln x(0)=x(T)=0}$ является секвенциально слабо замкнутым (как и в
примере Больца). Однако условие коэрцитивности не может быть выполнено, ибо для
$x_n(t)=n\sin\frac{2\pi t}{T}$ будет $J(x_n)\ra-\bes$.
\end{ex}

\subsubsection{Пространства Соболева}

Повторим основные факты про пространства Соболева, известные нам из курса УРЧП.

Пусть $\Om$\т область в $\R^d$. Обозначим $\Cb_0^\bes(\Om):=\hc{\ph\in
\Cb^\bes(\Om)\cln \supp\;\ph\Subset\Om}$\т пространство основных функций. Также
обозначим $\Cb^\bes(\ol\Om):=\Cb(\ol\Om)\cap \Cb^\bes(\Om)$. Чтобы обойти
длинное определение обобщённых функций, дадим следующее

\begin{df}
Функция $v\in L_1(\Om)$ называется \emph{обобщённой производной} функции $u\in L_1(\Om)$
по переменной $x_i$ (обозначение: $v=\pf{u}{x_i}$), если для всех $\ph\in \Cb_0^\bes(\Om)$ выполнено
\eqn{\ints{\Om} v\ph\dx = -\ints{\Om} u\pf{\ph}{x_i}\dx.}
\end{df}

\begin{df}
\emph{Классом Соболева} $\Wb_p^1(\Om)$ называется пространство
\eqn{\Wb_p^1(\Om):=\hc{u\in L_p(\Om)\cln\pf{u}{x_i}\in L_p(\Om)\text{ для всех } i = 1\sco d},}
наделенное нормой
\eqn{\hn{u}^p_{\Wb_p^1(\Om)} := \ints{\Om}\hm{u}^p+\suml{i=1}{d}\hm{\pf{u}{x_i}}^p\dx.}
\end{df}

Напомним без доказательства теорему:
\begin{theorem}
$\Cb^\bes(\ol\Om)$ плотно в $\Wb_p^1(\Om)$.
\end{theorem}

\begin{df}
\emph{Классом Соболева функций, нулевых на границе}, называется замыкание множества
$\Cb_0^\bes(\Om)$ в пространстве $\Wb_p^1(\Om)$. Обозначение: $\os\circ\Wb{}_p^1(\Om)$.
\end{df}

Далее для сокращения записи (в этом параграфе) обозначим $W := \Wb_p^1(\Om)$, $W_0 := \os\circ{\Wb}{}_p^1(\Om)$.

\begin{theorem}
Пространство $W$ банахово.
\end{theorem}
\begin{proof}
Пусть последовательность $u_k$ фундаментальна в $W$. Тогда $u_k$ и $\pf{u_k}{x_j}$
фундаментальны в $L_p$. Значит, $u_k\ra u$ в $L_p$ при $k\ra\bes$, $\pf{u_k}{x_j}\ra v_j$ в $L_p$
при $k\ra\bes$. При этом для любой $\ph\in \Cb_0^\bes$ имеем
\eqn{\ints{\Om} v_j\ph\dx =
\liml{k\ra\bes}\ints{\Om}\pf{u_k}{x_j}\ph\dx = -\liml{k\ra\bes}\ints{\Om}
u_k\pf{\ph}{x_j}\dx = -\ints{\Om} u\pf{\ph}{x_j}\dx,}
откуда следует, что $v_j=\pf{u}{x_j}$. Значит, $u\in W$. Ясно также, что $u_k\ra u$
в пространстве~$W$.
\end{proof}

К этому определению можно подойти по\д другому. Предположим, что граница области
$\pd\Om$ бесконечно гладкая. Для функций $u\in \Cb^\bes(\ol\Om)$ положим
$\ga u:=u\evn{\pd\Om}$. Можно показать, что $\hn{\ga u}_{L_p(\pd\Om)}\le
C(\Om)\hn{u}_W$. Отсюда легко следует, что
оператор $\ga$ можно единственным способом продолжить до непрерывного оператора
$\ga\cln W\ra L_p(\pd\Om)$. После этого полагаем
\eqn{W_0 :=\hc{u\in W \cln\ga u=0}.}
Опять же, примем без доказательства, что такое определение согласуется с определением, данным выше.
\fns{Несмотря на то, что на лекциях определение через $\ga$ было основным, по существу использовалось
исключительно определение через $\Cb_0^\bes$.}

Тот факт, что $u\in W_0$, мы будем записывать в виде $u\evn{\pd\Om}=0$.

Напомним без доказательства ещё две теоремы:

\begin{theorem}[Неравенство Фридрихса]
\label{thm:Fridrix}
Пусть $\Om$\т ограниченная область. Тогда для любой функции
$u\in W_0$ выполняется неравенство
\eqn{\ints{\Om}\hm{u}^p\dx \le C\ints{\Om}\suml{i=1}{d}\hm{\pf{u}{x_j}}^p\dx,}
где $C=C(p,\Om)$.
\end{theorem}

\begin{theorem}
Пусть $\Om$\т ограниченная область. Тогда $W$ компактно вложено в $L_p(\Om)$.
\end{theorem}

Компактная вложенность означает, что любая последовательность элементов $W$,
ограниченная по норме~$W$, содержит подпоследовательность, сходящуюся в норме~$L_p$.
Условие компактной вложенности мы будем обозначать значком $\Subset$.
\fns{Можно понимать условие компактной вложенности буквально. Действительно, условие
$W \Subset L_p$ равносильно тому, что оператор вложения $\iota \cln W\inj L_p$, $\iota\cln x\mapsto x$ является компактным.}

\begin{theorem}
При $p>1$ пространство $W$ рефлексивно.
\end{theorem}
\begin{proof}
Вначале вспомним, что пространство $L_p$ рефлексивно, ибо $L_p^*\cong L_q$ при $\frac1p+\frac1q = 1$. Далее в теореме под $L_p$ всюду
понимается $L_p(\Om)$.

Рассмотрим линейный непрерывный оператор
\eqn{D\cln W \ra L_p^{d+1},\quad u\mapsto\hr{u,\pf{u}{x_1}\sco \pf{u}{x_d}}.}
Легко проверить, что $D W$ замкнуто в $L_p^{d+1}$ (это делается так же, как и при
доказательстве банаховости~$W$).

Нам надо доказать, что из любой ограниченной последовательности можно выбрать слабо
сходящуюся. Пусть $\hn{u_k}_W<C$. Возьмем произвольный функционал $F\in W^*$. Положим
$F_L(D\eta):=F(\eta)$. Определение корректно, так как $D$ инъективно.
Далее, $F_L$ непрерывен, так как
\eqn{\hm{F_L(D\eta)}=\hm{F(\eta)}\le\hn{F}\cdot\hn{\eta}_W \le C\hn{F}\cdot\hn{D\eta}_{L_p^{d+1}}.}
Здесь мы воспользовались неравенством
\eqn{\Br{\int \sum u_i^p \dx}^{1/p} \le C\sum \Br{\int u_i^p \dx}^{1/p}.}
Продолжим $F_L$ на всё пространство $L_p^{d+1}$ по теореме Хана\ч Банаха. Поскольку $(L_p^{d+1})^*\cong L_q^{d+1}$, где
$\frac1p+\frac1q=1$, то найдутся функции $w_0\sco w_d\in L_q$, такие что
для всех $\xi\in L_p^{d+1}$ имеем
\eqn{F_L(\xi)=\ints{\Om}\suml{i=0}{d} w_i\xi_i\dx.}
Отсюда для всех $u\in W$ имеем
\eqn{F(u)=\ints{\Om} \Br{u w_0+\suml{i=1}{d}\pf{u}{x_i}w_i}\dx.}
Теперь ясно, как выбрать слабо сходящуюся подпоследовательность. Так как $\hn{u_k}_{L_p}<C$,
то можно выбрать подпоследовательность $u_k^{(1)}$, слабо сходящуюся в $L_p$. Из неё
выбираем $u_k^{(2)}$, такую что $\pf{u_k^{(2)}}{x_1}$ слабо сходится в $L_p$, и так далее.
Последовательность $u_k^{(d+1)}$ будет слабо сходиться в~$W$.
\end{proof}

\subsubsection{Доказательство теоремы Тонелли}

Рассмотрим экстремальную задачу
\eqn{\label{eqn:problemTonelli}
\bcase{&J(u)=\ints{\Om} L\br{x,u(x),\na u(x)}\dx\ra\inf,\\
&u\evn{\pd\Om}=0,}}
где $\na u=\hr{\pf{u}{x_1}\sco \pf{u}{x_d}}$.

\begin{theorem}[Тонелли]
Пусть $\Om$\т ограниченная область в $\R^d$ и выполнены:

\pt{1} условия гладкости: $L(x,u,p)\in \Cb(\ol\Om\times\R^{d+1})$, $\pf{L}{p_j}\in \Cb(\ol\Om\times\R^{d+1})$,

\pt{2} условие роста: существуют $\al>0$, $\be$, $q\in(1,+\bes)$ такие, что для всех $x,u,p$ выполнено
\eqn{L(x,u,p)\ge\al\hm{p}^q-\be,}
(здесь $\hm{(p_1\sco p_d)}^q=\suml{i=1}{d}\hm{p_i}^q$)

\pt{3} условие квазирегулярности: при всех $x,u$ функция $L(x,u,\cdot)$ выпукла.

Тогда существует решение задачи~\eqref{eqn:problemTonelli} в классе
$\os\circ\Wb{}_q^1(\Om)$.
\end{theorem}
\begin{proof}
Положим $X:=\Wb_q^1(\Om)$, $\Ac:=\os\circ\Wb{}_q^1(\Om)$.
Чтобы применить принцип компактности (теорему \ref{thm:Exist}), нам нужно доказать, что $X$\т рефлексивное
банахово пространство, $\Ac$ секвенциально слабо замкнуто, задача коэрцитивна и что $J$
полунепрерывен снизу относительно слабой сходимости.

\pt{1} Рефлексивность и банаховость $X$ были установлены ранее.

\pt{2} Секвенциальная слабая замкнутость следует из того, что $\Ac$ замкнуто и
выпукло (как замыкание линейного пространства, а, стало быть, выпуклого множества).

\pt{3} Докажем коэрцитивность. Заметим, что $J$ ограничен снизу, так как область ограничена и подинтегральная
функция ограничена снизу. Далее, возьмем достаточно большое $\la$ так, чтобы множество $\Lc_\la:=\hc{u\in \Ac\cln J(u)\le\la}$
было по крайней мере непусто. Докажем, что
$\Lc_\la$ будет ограничено. Пусть $u\in\Lc_\la$. Тогда
\mln{u \in \Lc_\la \quad\Lra\quad J(u)\le\la \quad\Lra\quad \ints{\Om}L\dx \le
\la \quad\Ra\quad \al\ints{\Om}\hm{\na u}^q\dx -\be \mes(\Om) \le \la
\quad\Ra \\ \Ra \quad \ints{\Om}\hm{\na u}^q\le\frac{\la+\be \mes(\Om)}{\al} \quad \Ra \quad
\hn{u}_X^q\le\frac{(C+1)\br{\la+\be \mes(\Om)}}{\al}.}

Что касается полунепрерывности снизу относительно слабой сходимости, то её доказательство
мы вынесем его в отдельную теорему, сохраняя все обозначения.
\end{proof}

\begin{theorem}
В условиях предыдущей теоремы функционал $J$ полунепрерывен снизу относительно слабой
сходимости в $X$.
\end{theorem}
\begin{proof}
Возьмем последовательность $y_k\in X$, слабо сходящуюся к $\wh y$ в $X$. Мы хотим доказать, что
\eqn{J(\wh y)\le\lliml{k\ra\bes} J(y_k)=:\wh J.}
Вначале сделаем несколько простых замечаний.
\begin{items}{-2}
\item Переходя к подпоследовательности, можно считать, что $J(y_k)\ra\wh J$.
\item Поскольку $y_k\convw\wh y$, то $\hn{y_k}_X < C$ для некоторого $C>0$.
\item Поскольку $X\Subset L_q(\Om)$, переходя к подпоследовательности, можно считать $\hn{y_k-\wh y}_{L_q}\ra0$.
\item Еще раз переходя к подпоследовательности, используя теорему Рисса, можно считать, что $y_k\ra\wh y$ почти всюду на~$\Om$.
\item

Поскольку $y_k$ сходятся
к $\wh y$ почти всюду, то по теореме Егорова для всякого $\ep>0$ существует множество~$E_\ep$, такое что
$y_k\rra \wh y$ на $E_\ep$, и при этом $\mes(\Om\wo E_\ep)<\ep$.

Рассмотрим множество:
\eqn{F_\ep:=\hc{x \in \Om \cln \hm{\wh y(x)}+\hm{\na\wh y(x)}<\frac{1}{\ep}}.}
При $k>k(\ep)$, в силу равномерной сходимости, для любого $x\in G_\ep:=E_\ep\cap F_\ep$
будет выполнено неравенство $\hm{y_k(x)}<\frac{2}{\ep}$. Далее, на множестве
\eqn{%M_\ep:=
\hc{(x,y,p)\cln x\in\ol\Om,\;|y|+|p|\le\frac{3}{\ep}}}
непрерывные функции $L$ и $L_p$ ограничены: $|L|+|L_p|<C(\ep)$.

\fns{Обратите внимание, что здесь $L_p$\т это
производная функции $L$ по переменным $p$, то есть вектор
$L_p=\hr{\pf{L}{p_1}\sco \pf{L}{p_d}}$, а совсем не функциональное пространство.}

Итак, мы получили, что $\mes(\Om\wo G_\ep)\to0$ и при всех $k>k(\ep)$ и $x\in G_\ep$ выполнены неравенства
\eqn{
\begin{aligned}
&\hm{L\br{x,\wh y(x),\na\wh y(x)}}<C(\ep), \quad\;\,\hm{L_p\br{x,\wh y(x),\na\wh y(x)}}<C(\ep),\\
&\hm{L\br{x,y_k(x),\na\wh y(x)}}<C(\ep), \quad\hm{L_p\br{x,y_k(x),\na\wh y(x)}}<C(\ep).
\end{aligned}}
%\item Рассмотрим множества
%\eqn{G_\ep:=\hc{x\in\Om\cln\hm{L\br{x,\wh y(x),\na\wh y(x)}}+\hm{L_p\br{x,\wh y(x),\na\wh y(x)}}<\frac{1}{\ep}}.}
%Очевидно, что $\mes(\Om\wo G_\ep)\ra0$ при $\ep\ra0$.
\end{items}

Рассмотрим число
\eqn{\ga_{k,\ep}:=\ints{G_\ep}\br{L_p(\wh x,\wh y,\na\wh y),\na y_k-\na\wh y}\dx.}
Покажем, что $\ga_{k,\ep}\ra0$ при $k\ra\bes$ и фиксированном $\ep>0$.
Действительно, любая ограниченная функция $\ph$ задает на $X$ непрерывный функционал
$u\mapsto\ints{G_\ep}(\ph,\na u)$. Поскольку на $G_\ep$ функция $L_p$ ограничена, а
последовательность $y_k-\wh y$ слабо сходится к нулю, то $\ga_{k,\ep}\ra0$.

Рассмотрим также
\eqn{\al_{k,\ep}:=\ints{G_\ep}\bs{L(x,y_k,\na\wh y)-L(x,\wh y,\na\wh y)}\dx +
\ints{G_\ep}\br{L_p(x,y_k,\na\wh y)-L_p(x,\wh y,\na\wh y),\na y_k-\na\wh y}\dx.}
Покажем, что $\al_{k,\ep}\ra0$ при $k\ra\bes$ и фиксированном $\ep>0$.
Первый интеграл стремится к нулю по теореме Лебега (ибо на $G_\ep$ функция $L$
ограничена, $y_k\ra\wh y$ почти всюду). Второй интеграл имеет вид $(a_k,b_k)_{L_2(\Om)}$,
причем функции $a_k$ стремятся к нулю в $L_r$ по теореме Лебега (мы выбрали $\frac1r+\frac1q=1$),
а функции $b_k$ ограничены в $L_q$, ибо
\eqn{\hn{b_k}_{L_q}=\hn{\na y_k-\na\wh y}_{L_q} \le \hn{y_k}_X+\hn{\wh y}_X.}
По неравенству Гёльдера,
\eqn{\hm{(a_k,b_k)}\le\hn{a_k}_{L_r}\cdot\hn{b_k}_{L_q} \ra 0\quad\mbox{при }k\ra\bes.}

Теперь наконец воспользуемся выпуклостью функции $L(x,u,\cdot)$. Понятно, что для
выпуклой функции $h(\cdot)$, дифференцируемой в $\wh s$, выполняется неравенство
$h(s)\ge h(\wh s)+h'(\wh s)(s-\wh s)$. Применяя его к $L(x,y_k(x),\cdot)$ и $\wh s=\na\wh y(x)$, получим
(для краткости не пишем зависимость от $x$):
\eqn{L(x,y_k,\na y_k)\ge L(x,y_k,\na\wh y)+\br{L_p(x,y_k,\na\wh y),\na y_k-\na\wh y}.}
Добавляя и вычитая дополнительные члены, получим
\mln{L(x,y_k,\na y_k)\ge L(x,\wh y,\na\wh y)+[L(x,y_k,\na\wh y)-L(x,\wh y,\na\wh y)] +\\+
\br{L_p(x,\wh y,\na\wh y),\na y_k-\na\wh y}+\br{L_p(x,y_k,\na\wh y)- L_p(x,\wh y,\na\wh y),\na y_k-\na\wh y}.}
Интегрируя по $G_\ep$, получаем:
\eqn{\ints{G_\ep}L(x,y_k,\na y_k)\dx \ge \ints{G_\ep}L(x,\wh y,\na\wh y)\dx + \al_{k,\ep}+\ga_{k,\ep},}
откуда
\eqn{J(y_k)\ge \ints{G_\ep}L(x,y_k,\na y_k)\dx-\be \mes(\Om\wo G_\ep) \ge
J(\wh y)-\ints{\Om\wo G_\ep} L(x,\wh y,\na\wh y)\dx+\al_{k,\ep}+\ga_{k,\ep}-\be \mes(\Om\wo G_\ep).}

Устремляя $k$ к бесконечности, а $\ep$ к нулю, получим требуемое. Подробнее, нам надо
доказать, что для любого $\de>0$ найдется $k_0$, начиная с которого будет $J(y_k)>
J(\wh y)-\de$. Возьмем $\de>0$. Выберем $\ep>0$ так, чтобы
\eqn{\bbm{\;\ints{\Om\wo G_\ep\mskip-20mu} L(x,\wh y,\na\wh y)\dx}<\frac{\de}{4},}
это вроде можно сделать, поскольку функция $L\br{x,\wh y(x),\na\wh y(x)}$ интегрируема.

\fns{\textbf{Замечание.} Композиция гладкой функции от интегрируемой, конечно, может оказаться
неинтегрируемой. Но в нашем случае функция~$L$ ограничена снизу, так что проблемы могут
быть лишь с $+\bes$. Но поскольку $\wh y$ доставляет минимум нашей задачи, то для неё
значение функционала уж точно не $+\bes$ (например, для $y\equiv0$ получится
конечное значение).

\textbf{Комментарий Юры Малыхина к предыдущему замечанию.}
Саша Словеснов указал мне еще на один баг: при доказательстве теоремы Тоннели
мы в комментарии пишем, что функция $L(t,\wh y,\na\wh y)$ интегрируема,
ибо в точке минимума уж точно значение функционала меньше бесконечности.
Однако при доказательстве теоремы существования мы вовсе не предполагаем,
что $\wh y$\т точка минимума. Мы лишь можем считать, что
$y_k\ra\wh y$, $J(y_k)\ra\inf J$. Отсюда надо бы
ещё вывести $J(\wh y)<\infty$.}

Далее, если нужно, уменьшим $\ep$, чтобы стало $\be\mes(\Om\wo G_\ep) < \frac{\de}{4}$.
Для найденного $\ep$ существует $k_0$,
такое что при $k\ge k_0$ выполняются неравенства $\hm{\al_{k,\ep}}<\frac{\de}4$,
$\hm{\ga_{k,\ep}}<\frac{\de}{4}$. Это $k_0$ как раз то, что нам нужно.
\end{proof}

\section{Вариационные неравенства}

\subsection{Строго выпуклые функции}

Пусть $X$\т нормированное пространство, $A\subset X$, $f\cln X\ra\ol\R$\т собственная функция. Рассмотрим задачу
\eqn{\label{eqn:problemStrongConvex}
\bcase{&f(x)\ra\inf,\\
&x\in A.}}

\begin{theorem}\label{thm:varIneq}
Пусть $A$ выпукло, $f$\т выпукла и дифференцируема по Гато в $\wh x$. Тогда $\wh x$
доставляет (абсолютный) минимум задачи~\eqref{eqn:problemStrongConvex} если и только если
для всех $x\in A$ выполнено
\eqn{\ha{f'(\wh x),x-\wh x}\ge0.}
\end{theorem}
\begin{proof}
Установим <<$\Rightarrow$>>. Возьмем $x\in A$. В силу выпуклости $A$ при всех
$\de\in[0,1]$ будет $\wh x+\de(x-\wh x) \in A$, откуда $\frac{f\br{\wh x+\de(x-\wh x)}-f(\wh x)}{\de}\ge0$.
Переходя к пределу при $\de\ra0$, получаем нужное неравенство.

Обратно, $f\br{\wh x+\de(x-\wh x)}\le\de f(x)+(1-\de)f(\wh x)$, откуда
\eqn{f(x)-f(\wh x)\ge\frac{f\br{\wh x+\de(x-\wh x)}-f(\wh x)}{\de}\ra\ha{f'(\wh x),x-\wh x}\ge 0,}
что и требуется.
\end{proof}

\begin{df}
Функция $f$ называется \emph{строго выпуклой}, если для любых различных $x_1,x_2\in\dom f$ и
любого $\al\in(0,1)$ выполняется неравенство $f\br{\al x_1+(1-\al)x_2}<\al f(x_1)+(1-\al)f(x_2)$.
\end{df}

\begin{theorem}\label{thm:strongConvexity}
Пусть множество $A$ выпукло, $f$ строго выпукла. Тогда задача~\eqref{eqn:problemStrongConvex} имеет
не более одного решения.
\end{theorem}
\begin{proof}
Пусть $\wh x_1$ и $\wh x_2$\т два различных решения. Но тогда $f(\frac{\wh x_1+\wh
x_2}2)<\frac{f(\wh x_1)+f(\wh x_2)}2 = f(\wh x_1)$\т противоречие.
\end{proof}

\subsection{Задача с препятствиями}

Пусть $\Om$\т ограниченная область в $\R^d$. Обозначим для краткости
\eqn{H_0^1 := \os\circ\Wb{}_2^1(\Om).}
Заметим, что в $H_0^1$ можно ввести норму
\eqn{\hn{u}^2_{H_0^1} := \ints{\Om} \hm{\na u}^2\dx,}
которая по неравенству Фридрихса эквивалентна обычной норме пространства~$\Wb_2^1$. Таким образом,
$H_0^1$\т гильбертово пространство относительно скалярного произведения
$(f,g)=\ints{\Om}(\na f,\na g)\dx$.

Применим наши теоремы к следующей задаче.
\eqn{\bcase{
&J(y)=\ints{\Om} L\br{x,y(x),\na y(x)}\dx\ra\inf,\\
&y(x)\evn{\pd\Om}=0,\\
&y(x)\ge\ph(x)\text{ для всех }x\in\Om,}}
где $\ph$\т заданная функция, неположительная на границе.

Более точно, условие $y(x)\evn{\pd\Om}=0$, $y(x)\ge\ph(x)$ для всех $x\in\Om$
записывается в виде $y\in J_\ph$, где
\eqn{J_\ph:=\hc{u\in H_0^1(\Om)\cln u(x)\ge\ph(x)\mbox{ для почти всех }x\in\Om}.}
Сразу заметим, что $J_\ph$ выпукло. Оно также и замкнуто: пусть $u_k\in J_\ph$,
$u_k\ra\wh u$ в $H_0^1$, тогда $u_k\ra\wh u$ в $L_2(\Om)$. Выделяя
подпоследовательность $u_{n_k}$, сходящуюся к $\wh u$ почти всюду, получаем неравенство
$\wh u(x)\ge\ph(x)$ для почти всех $x$.

Частным случаем такой задачи является задача о мембране с препятствием:
\eqn{\label{eqn:problemMembrane}
\bcase{&I(u)=\ints{\Om} \hm{\na u}^2-2u(x)f(x)\dx\ra\inf,\\
&u\in J_\ph.}}
Физический смысл: имеется мембрана, натянутая на $\pd\Om$, $u(x)$\т ее положение
в точке $x$. Также имеется препятствие, задаваемое функцией $\ph(x)$, ниже которого
мембрана не может опускаться. Подействуем на мембрану силой $f(x)$. Из физических законов
следует, что положение мембраны будет определяться из задачи~\eqref{eqn:problemMembrane}.
Кстати, если забыть про $\ph$ и оставить условие $u\evn{\pd\Om}=0$, получится
просто задача о мембране.

\begin{theorem}
Пусть $f\in L_2(\Om)$, $\ph\in \Cb^1(\ol\Om)$, $\ph\evn{\pd\Om}\le0$. Тогда
существует единственное решение $\wh u$ задачи~\eqref{eqn:problemMembrane} в классе
$H_0^1$, причем для всех $u \in J_\ph$ имеем
\eqn{\label{eqn:ineqMembrane}
\ints{\Om}\bs{(\na\wh u(x),\na u(x)-\na\wh u(x))-f(x)(u(x)-\wh u(x))}\dx\ge 0.}
\end{theorem}
\begin{proof}
Чтобы проверить существование, воспользуемся теоремой \ref{thm:Exist}. В данном случае
$X=H_0^1$\т гильбертово, следовательно рефлексивно. Множество $A=J_\ph$, как уже
было сказано, выпукло и замкнуто, следовательно, секвенциально слабо замкнуто. Проверим
коэрцитивность задачи. Возьмем достаточно большое $\la_0$ так, чтобы $\Lc_{\la_0}:=\hc{u\in J_\ph\cln I(u)\le\la_0}$ было непусто. Для произвольного
$u\in\Lc_{\la_0}$ и $\ep>0$ имеем:
\eqn{I(u)\le\la_0 \Lra \ints{\Om}\hm{\na u(x)}^2-2u(x)f(x)\dx\le\la_0
\quad\Ra\quad \ints{\Om}\hm{\na u(x)}^2-\ep\hm{u(x)}^2\dx\le\la_0+\frac{1}{\ep}\ints{\Om}\hm{f(x)}^2\dx.}
Далее, по неравенству Фридрихса, $\ints{\Om} u^2\dx \le C\ints{\Om}\hm{\na u}^2\dx$. Выбирая
$\ep:=\frac{1}{2C}$, получим неравенство
\eqn{\ints{\Om}\hm{\na u(x)}^2\le 2\la_0+4C\ints{\Om} \hm{f(x)}^2\dx.}
Итак, множество $\Lc_{\la_0}$ ограничено.

Проверим полунепрерывность $I$ относительно слабой сходимости. Видно, что $I$ непрерывен
относительно сильной сходимости. Значит, достаточно доказать выпуклость $I$ (ранее мы
установили, что выпуклый непрерывный функционал является полунепрерывным относительно
слабой сходимости). Мы докажем даже, что $I$ является строго выпуклым. Запишем
$I=I_1-I_2$, где $I_2(u)=2\ints{\Om} u(x)f(x)\dx$. Так как $I_2$ линеен, достаточно
установить строгую выпуклость $I_1$.

Возьмем различные $u_1$ и $u_2$ из $H_0^1$ и $\al\in(0,1)$. Докажем, что
$I_1(\al u_1+(1-\al)u_2)<\al I_1(u_1)+(1-\al)I_1(u_2)$. Заметим, что $\na
u_1\ne\na u_2$ (как функции из $L_2(\Om)^d$). В силу неравенства Коши-Буняковского
в $L_2(\Om)^d$ получаем
\eqn{\ints{\Om}(\na u_1,\na u_2)\dx \le \hr{\ints{\Om}\hm{\na u_1}^2\dx}^{1/2}
\hr{\ints{\Om}\hm{\na u_2}^2\dx}^{1/2} \le \frac12 \ints{\Om}\hm{\na u_1}^2\dx + \ints{\Om}\hm{\na u_2}^2\dx.}
Поскольку $\na u_1\ne\na u_2$, то одно из
неравенств будет строгим (если функции пропорциональны с коэффициентом $\la\ne-1$, то
второе, иначе\т первое), откуда $2\ints{\Om}\na u_1\na u_2\dx <
I_1(u_1)+I_1(u_2)$. Далее,
\mln{I_1(\al u_1+(1-\al u_2)) = \al^2\ints{\Om}\hm{\na u_1}^2\dx +
2\al(1-\al)\ints{\Om}\na u_1\na u_2\dx + (1-\al)^2\ints{\Om} \hm{\na u_2}^2\dx < \\<
\al^2 I_1(u_1)+\al(1-\al)(I_1(u_1)+I_1(u_2))+(1-\al)^2I_1(u_2)= \al I_1(u_1)+(1-\al)I_1(u_2).}

Итак, мы доказали строгую выпуклость функционала $I$. Тем самым существование решения
доказано. Единственность решения следует из теоремы \ref{thm:strongConvexity}. Наконец,
неравенство \eqref{eqn:ineqMembrane} следует из теоремы \ref{thm:varIneq}. Надо
лишь проверить, что функционал $I$ дифференцируем по Гато и
\eqn{I'(\wh u)h = 2\ints{\Om}\bs{(\na u,\na h)-f h}\dx.}
Эта проверка остается в качестве упражнения.
\end{proof}

В случае отсутствия препятствия можно получить более простое условие.
\begin{lemma}
Пусть выполнены условия теоремы \ref{thm:varIneq} и $A=X$. Тогда $\wh x$\т минимум если и только если
при всех $\ph\in X$ выполнено $\ha{f'(\wh x),\ph}=0$.
\end{lemma}
\begin{proof}
Положим в неравенстве $\ha{f'(\wh x),x-\wh x}\ge0$ вектор $x$ равным $\wh x\pm\ph$.
Получим $\ha{f'(\wh x),\ph}\ge0$ и $\ha{f'(\wh x),\ph}\le0$, откуда $\ha{f'(\wh
x),\ph}=0$.
\end{proof}
\fns{Неудачно выбрано обозначение $\ph$. Здесь и далее оно будет обозначать НЕ
препятствие, а произвольную функцию из того или иного пространства.}

\begin{imp}
Если в задаче о мембране препятствий нет, то для решения $\wh u$ этой задачи выполнено равенство
\eqn{\ints{\Om}\bs{(\na\wh u,\na\ph)-f\ph}\dx=0}
для всех $\ph\in H_0^1(\Om)$.
\end{imp}

Если взять $\ph\in \Cb_0^\bes(\Om)$, и продолжить её нулем на $\R^d$, то получим
\eqn{\suml{j=1}{d}\ints{\Om}\pf{\wh u}{x_j}\pf{\ph}{x_j}\dx =
-\ints{\Om}\sum_{j=1}^d\frac{\pd^2\wh u}{\pd x_j^2}\ph\dx.}
Следовательно, если решение нашей задачи о мембране является функцией класса
$\Cb^2(\ol\Om)$, то выполняются условия
\eqn{\label{eqn:problemMembraneGen}
\bcase{&\De\wh u =- f,\\
&\wh u\evn{\pd\Om}=0.}}

\begin{df}
Функция $\wh u\in H_0^1(\Om)$ называется \emph{обобщённым решением} задачи
\eqref{eqn:problemMembraneGen}, если для всех $\ph\in H_0^1$ выполнено равенство
\eqn{\ints{\Om}\bs{(\na\wh u,\na\ph)-f\ph}\dx = 0.}
\end{df}

Итак, мы доказали следующую теорему из курса УРЧП:
\begin{theorem}
Для любой $f\in L_2(\Om)$ существует единственное обобщенное решение задачи
\eqref{eqn:problemMembraneGen}.
\end{theorem}
\fns{На самом деле эта теорема очевидна и не требует для доказательства никакой теории.
Она получается как частный случай последней теоремы курса. Вариационные же неравенства
лишь позволяют взглянуть по-другому на задачу \eqref{eqn:problemMembraneGen}.}

Нам хотелось бы обобщить эту теорему на случай $f$ не из $L_2$, а из некоторого
пространства обобщенных функций $H^{-1}$. Определение $H^{-1}$ мы дадим в следующем
параграфе.

\subsection{Пространство $H^{-1}(\Om)$}

Рассмотрим пространство $(H_0^1(\Om))^*$ с обычной нормой
$\hn{x^*}=\supl{\hn{x}=1} \hm{\ha{x^*,x}}$. Рассмотрим в этом пространстве множество
функционалов вида
\eqn{\label{eqn:HminusOneFunc}
\ph\mapsto\ints{\Om} f(x)\ph(x)\dx,\quad f\in L_2(\Om).}
Определим $H^{-1}(\Om)$ как замыкание этого множества.

Эквивалентное определение можно дать так: введём на $L_2(\Om)$ норму
\eqn{\hn{f}_{H^{-1}}:=\supl{\ph\ne0}\frac{\ints{\Om} f(x)\ph(x)\dx}{\hn{\ph}_{H_0^1}}}
и определим $H^{-1}(\Om)$ как пополнение $L_2(\Om)$ по этой норме.

\begin{theorem}\label{thm:HminusOneEquHzeroOneAdj}
$H^{-1}(\Om) =(H_0^1(\Om))^*$.
\end{theorem}
\begin{proof}
Возьмем произвольный функционал $\xi\in(H_0^1)^*$. Так как пространство $H_0^1$
гильбертово, то $\xi$ представляется в виде $\ha{\xi,\ph}=\ints{\Om}\na f\na\ph \dx$
для некоторой $f\in H_0^1$ (пишем $\na f\na\ph$ вместо $(\na f,\na\ph)$ для
краткости). Так как $\Cb_0^\bes$ всюду плотно в $H_0^1$, то можно найти
последовательность $f_n\in \Cb_0^\bes$, $f_n\ra f$. Положим
\eqn{\ha{\xi_n,\ph}:=\ints{\Om}\na f_n\na\ph \dx.}
Для любой $\ph\in \Cb_0^\bes$ мы можем проинтегрировать по частям в $\ha{\xi_n,\ph}$ и
получить равенство
\eqn{\ha{\xi_n,\ph}=-\ints{\Om}\De f_n\ph \dx,}
где $\De=\sum\frac{\pd^2}{\pd x_i^2}$\т обычный оператор Лапласа. Раз это
равенство верно для $\ph\in \Cb_0^\bes$, то оно верно и при всех $\ph\in H_0^1$. Итак,
$\xi_n$ имеют вид \eqref{eqn:HminusOneFunc}. При этом $\xi_n$ сходятся к $\xi$:
\eqn{\hn{\xi_n-\xi}_{(H_0^1)^*} = \supl{\hn{\ph}=1}
\bbm{\ints{\Om}\na\ph(\na f_n-\na f)\dx} \le
\supl{\hn{\ph}=1}\hr{\hn{\ph}_{H_0^1}\cdot \hn{f_n-f}_{H_0^1}}\ra0.}
Значит, множество функционалов вида \eqref{eqn:HminusOneFunc} плотно в $(H_0^1)^*$, что и требовалось.
\end{proof}

Как понимать термин <<обобщенное решение>> задачи \eqref{eqn:problemMembraneGen} для произвольных
$f\in H^{-1}$? Если $f\in H^{-1}=(H_0^1)^*$, будем записывать $\ha{f,\ph}$ в виде
$\ints{\Om} f\ph \dx$ и говорить, что $\wh u$ является обобщенным решением задачи~\eqref{eqn:problemMembraneGen}, если
\eqn{\label{eqn:problemMembraneSol}
\ints{\Om}\na\wh u\na \ph \dx=\ints{\Om} f\ph \dx}
для всех $\ph\in H_0^1$.

\begin{theorem}
Для любой $f\in H^{-1}(\Om)$ существует единственное обобщенное решение задачи
\eqref{eqn:problemMembraneGen}.
\end{theorem}
\begin{proof}
Заметим, что условие \eqref{eqn:problemMembraneSol}  эквивалентно равенству функционалов $f$ и
$\ph\mapsto\ints{\Om}\na u\na\ph \dx$. Определим оператор $-\De\cln H_0^1\ra H^{-1}=(H_0^1)^*$
таким образом: функции $u$ сопоставляется функционал
$\ph\mapsto\ints{\Om}\na u\na\ph \dx$. Получится изоморфизм пространств
$H_0^1\leftrightarrow (H_0^1)^*$ (этот факт верен для любого гильбертова пространства).
Обратный к $-\De$ оператор и будет давать по каждому $f$ обобщенное решение задачи~\eqref{eqn:problemMembraneGen}.
\end{proof}
\fns{Заметим, что в последней теореме мы не использовали по-существу теорему
\ref{thm:HminusOneEquHzeroOneAdj}, а, значит, и пространство $H^{-1}$. Сама же последняя теорема
очевидна и выражает тот факт, что в гильбертовом пространстве $H$ со скалярным
произведением $(\cdot,\cdot)$ каждый функционал $f$ имеет вид $(u,\cdot)$, причем
соответствие $u\leftrightarrow(u,\cdot)$ является изоморфизмом. Почему для этот
изоморфизм мы обозначили как $-\De$? Потому, что для гладких $u$ получается как раз
минус оператор Лапласа:
\eqn{\ints{\Om}\na u\na\ph \dx= \ints{\Om} (-\De u)\ph \dx,\quad f=-\De u.}}

\end{document}
