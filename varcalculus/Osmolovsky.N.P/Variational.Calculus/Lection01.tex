\chapter*{}

\begin{center}
"\textbf{ВАРИАЦИОННОЕ ИСЧИСЛЕНИЕ И ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ}"\\
\textbf{(Осмоловский Н.П.)}\\
\textbf{Второй поток, 2001/2002 уч. год, осенний семестр.} \\
\end{center}

$$$$
\textbf{Лекция 1.}



\subparagraph{1. Задача о брахистохроне}\emph{(1696 г., И.
Бернулли)}. Определить путь, спускаясь  по  которому под действием
собственной тяжести,  тело  $M$,  начав двигаться  из точки $A$,
дойдёт до точки  $B$  за кратчайшее  время.

Решение  задачи - кривая  наискорейшего  спуска, или
\emph{брахистохрона} (циклоида).

{\bf Формализация  задачи :}

%\begin{figure}[htb]
%\Figure{l1_1b}{10.83}{7.32}{Рис~1.1}
%\end{figure}
%\картинка!!!!!!!!!
\textbf{Смотри рисунок $L1-1.pcx$}




 В  точке  $M(x,y)$  по  закону  сохранения  энергии  имеем:
$$
m g h + \frac{m v^2}{2} = 0
$$
(так как  в  точке  $A$  и  потенциальная, и  кинетическая  энергия
равны  нулю).
$$
m=1,\, h=- y \Rightarrow\   \frac{v^2}{2} = gy ;\  v=\sqrt{2gy};
$$
$$
\frac{ds}{dt}=\sqrt{2gy};\  dt=\frac{ds}{\sqrt{2gy}};\   dt= \frac{\sqrt{1+y'^2}}{\sqrt{2gy}}
$$
$$
t=\int\limits_0^{x_1}\frac{\sqrt{1+y'^2}dx}{\sqrt{2gy}} \to
\min     \eqno(a)
$$
$$
y(0) = 0,\quad y(x_1) = y_1. \eqno(b)
$$

Требуется  найти   функцию  $y=y(x)$, $x\in [0, x_1]$  ($x_1$ -
фиксирован), удовлетворяющую  условиям  $(b)$  и  доставляющую
минимум  интегралу  $(a)$.

Решение  (циклоида)  было  дано  самим  И.Бернулли,  а также
Я.Бер\-нул\-ли, Лейбницем  и  Ньютоном.

\subparagraph{2. Простейшая  задача  вариационного  исчисления.} Какому
классу  задач  принадлежит  задача  о  брахистохроне?  Опишем  этот  класс:
$$
\min  J(y(\cdot)) = \int\limits_{x_0}^{x_1}  F (x,
y(x),y'(x))\,dx,  \eqno(*)
$$
$$
y(x_0) = a, \qquad y(x_1) = b. \eqno(**)
$$

Отрезок  $[x_0,x_1]$  фиксирован.  Заданы  также $a$, $b$  и
функция  $F(x,y,z)$. Требуется  найти  функцию  $y(x): [x_0,x_1]
\to \mathbb{R}^1$,  удовлетворяющую \emph{гра\-нич\-ным условиям}
$(**)$ и доставляющую  минимум  интегральному функ\-цио\-на\-лу
$(*)$. Задача $(*)$  и $(**)$  и  есть  простейшая задача
вариационного исчисления.

В  вариационном  исчислении  принято обозначать  независимую
пе\-ре\-мен\-ную через  $x$, а  в  оптимальном  управлении  -
через $t$.  Мы  сразу  примем  обоз\-на\-че\-ния  оптимального
управления  и переформулируем  задачу  сле\-дую\-щим  образом:
\begin{equation}\label{1m1}
\min  J(x(\cdot)) = \int\limits_{t_0}^{t_1} F(t,x(t),u(t)) dt,
\end{equation}
\begin{equation}\label{1m2}
\dot x(t) = u(t),
\end{equation}
\begin{equation}\label{1m3}
x(t_0)=a,\ \  x(t_1)=b,
\end{equation}
\begin{equation}\label{1m4}
(t, x(t), u(t))\in  Q.
\end{equation}
Итак,  вместо  $y(x)$
теперь  мы  пишем $x(t): [t_0,t_1]\to \mathbb{R}^1$. Переменную
$t$ принято  трактовать  как  время.

Отрезок  $[t_0,t_1]$  фиксирован, числа $a$ и $b$ заданы, $Q\in
\mathbb{R}^3$~--- открытое  множество,  служащее  областью
определения  функции $F(t,x,u): Q \to \mathbb{R}$,  которая также
известна. Пока  нам  достаточно  считать,  что  \emph{функция $F$
непрерывна  на  $Q$  вместе  со  своими производными $F_x$ и
$F_u$}.

Итак,  мы  имеем  задачу  на  фиксированном  отрезке $[t_0,t_1]$
с \linebreak  \emph{закреплёнными} \emph{концами}  (согласно
условиям (\ref{1m3})).  Условия  (\ref{1m3}) называются  \emph
{ограничениями } задачи. Условие  (\ref{1m4})  также  является
ограничением,  но  смысл у  него несколько  иной,  чем  у
условий  (\ref{1m3}), поскольку множество  $Q$ открыто. $Q$~---
это, так сказать,  <<вселенная>> данной  задачи, где  всё
разыгрывается. Наконец,  к  условию (\ref{1m2})  можно  пока
относиться как  к обозначению  для производной   $\dot x$,  но
сразу  отметим следующий  факт:  в вариационном  исчислении было
принято \emph{варьировать} (изменять)  функ\-цию  $x(t)$,
поэтому  мы и написали $J(x(\cdot))$.  Задав  $x(\cdot)$,  мы
вычисляем  $\dot x(\cdot)$ и  получаем соответствующее  значение
$J(x(\cdot))$. Но можно посмотреть  иначе:  задав  $u(\cdot)$, мы
можем получить $x(t) = a + \int\limits_{t_0}^{t_1} u(\tau)
d\tau$   и вычислить соот\-ветст\-вую\-щее значение  $J$. Таким
образом, мы  можем  с таким  же  успехом  рассматривать
функционал  $J$ как функционал,  зависящий  от  $u(\cdot) : J =
J(u(\cdot))$,  и варьировать  не $x(\cdot)$,  а  $u(\cdot)$ при
получении необходимых или  достаточных  условий  минимума.
Именно  так предпочитают  делать в оптимальном  управлении,  и
называют функцию  $u(\cdot)$  \emph{управлением}.
Оп\-ти\-маль\-ное управление пошло  дальше,  рассматривая задачу
в пространстве пар функций  $w(\cdot)= (x(\cdot), u(\cdot))$, но
об  этом позднее. Сейчас  лишь  отметим,  что правильный  выбор
переменных  и пространства переменных,  а также  правильная
<<ка\-но\-ни\-за\-ция>> задач  обусловили определённый  прогресс
в оптимальном управлении  по  сравнению с  классическим
вариационным исчислением  (который проявился даже  в  рамках
вариационного ис\-чис\-ле\-ния, т.е  на  уровне задач,
рассматриваемых последним). Мы  будем  считать  себя свободными
в  выборе вариаций $x(\cdot)$  или  $u(\cdot)=\dot x(\cdot)$, в
за\-ви\-си\-мос\-ти  от удобства.

Опишем  теперь  пространство  функций,  в  котором
рассматривается  простейшая  задача.  В вариационном  исчислении
принято   считать,  по  крайней  мере  на  первом  этапе,  что
$\dot x(\cdot)=u(\cdot)$  непрерывна,  и,  сле\-до\-ва\-тель\-но,
$x(\cdot)$ - непрерывно   дифференцируема. Таким  образом,
$$
x(\cdot)\in \mathcal{C}^1([t_0,t_1];\mathbb{R}),
$$
$$
u(\cdot) \in \mathcal{C}([t_0,t_1]; \mathbb{R}).
$$

Напомним,  что
$$
\|u(\cdot)\|_C  =\max_{t\in [t_0,t_1]}  | u(t) |
$$
есть  норма  в  пространстве $\mathcal{C}$  непрерывных  функций,
а
$$
\| x(\cdot) \|_{C^1}  = \max \{ \| x(\cdot) \|_C, \|\dot x(\cdot) \|_C  \}
$$
есть  норма  в  пространстве  $\mathcal{C}^1$ непрерывно
дифференцируемых функций. Пространства  $\mathcal{C}$  и
$\mathcal{C}^1$, снабжённые этими  нормами, являются
\emph{банаховыми},  т.е полными нормированными пространствами.
Следуя традиции,  мы также будем поначалу рассматривать простейшую
задачу  в пространстве непрерывно дифференцируемых функций
$x(\cdot)$. Затем мы расширим  это пространство.

\subparagraph{3. Слабый  минимум.} Пусть  $x^\circ(\cdot)$~---
\emph {допустимая  траектория},  т.е  траектория, удовлетворяющая
ограничениям  простейшей  задачи  и  такая,  что $x^\circ(\cdot)
\in \mathcal{C}^1([t_0,t_1],\mathbb{R})$.  Будем говорить,  что
$x^\circ(\cdot)$ доставляет  \emph{слабый  минимум}  в
простейшей  задаче,  если существует  $\varepsilon>0$  такое,
что  для любой  другой  допустимой траектории $x(\cdot)\in
\mathcal{C}^1([t_0,t_1],\mathbb{R})$, удов\-лет\-во\-ряю\-щей
условиям :
\begin{equation}\label{1m5}
| x(t)-x^\circ(t) |\leqslant \varepsilon;\qquad  |\dot x(t) -
\dot x^\circ(t)| \leqslant \varepsilon,
\end{equation}
выполнено неравенство
$$
J(x(\cdot)) \geqslant J(x^\circ(\cdot)).
$$
Условия  (\ref{1m5})  равносильны  условию
$$
\| x(\cdot) - x^\circ(\cdot) \|_{\mathcal{C}^1} \leqslant
\varepsilon .
$$
Таким  образом,  слабый  минимум  есть  локальный  минимум  в
про\-странст\-ве $\mathcal{C}^1 ([t_0,t_1];\mathbb{R})$.

Часто  для  удобства  траектории  $x^\circ(\cdot)$,  $x(\cdot)$
называют  \emph{точками прост\-ранст\-ва}.  Далее  нас  будет
интересовать  необходимое  условие  слабого  ми\-ни\-му\-ма  в
точке $x^\circ(\cdot)$.

Через  $\delta x(\cdot)$  мы  будем  обозначать  произвольную
функцию в прост\-ранст\-ве  $\mathcal{C}^1 ([t_0,t_1];\mathbb{R})$
и называть её \emph{вариацией}. Соответственно  будем  полагать
$\delta u(t)=\delta \dot x(t),\  t \in  [t_0,t_1]$. Вариацию будем
называть  \emph{допустимой}  (в  точке  $x^\circ(\cdot)$, если
точка $x^\circ(\cdot)+ \delta x(\cdot)$ является допустимой. При
получении  условий  слабого  минимума  мы  будем использовать
вариации $\delta x(\cdot)$  с  малой  нормой  в пространстве
$\mathcal{C}^1 ([t_0,t_1];\mathbb{R}^n)$.  Допустимая вариация
должна удов\-лет\-во\-рять условиям
\begin{equation}\label{1m6}
\delta x(t_0)=\delta x(t_1)=0.
\end{equation}
Если  норма  $\| \delta x \|_{\mathcal{C}^1}$   мала,  то
условие  $(t, x^\circ(t)+ \delta x(t), u^\circ(t)+\delta u(t))
\in Q$ выполнено  автоматически. Обозначим через
$\mathcal{C}_0^1$  подпространство  функций $\delta x(\cdot) \in
\mathcal{C}^1([t_0,t_1];\mathbb{R})$, удовлетворяющих условиям
(6). Слабый  минимум  означает,  что $J(x^\circ+ \delta x) -
J(x^\circ)\geqslant 0$ для    всех достаточно малых  по норме
$\mathcal{C}^1$ вариаций   $\delta x\in \mathcal{C}_0^1$.

\subparagraph{4. Первая  вариация  функционала} Для  краткости
будем  полагать  $(x,u)=w$. Пусть   $u^\circ= \dot x^\circ$, где
$x^\circ$~--- допустимая  траектория (сейчас  нам  важно лишь,
что $(t, x^\circ(t), u^\circ(t))\in Q)$. Пусть  $\delta x(\cdot)
\in \mathcal{C}^1([t_0,t_1],\mathbb{R})$~--- малая  вариация,
положим $\delta u= \delta \dot x, \quad\delta w =(\delta x,\delta
u)$. Согласно теореме  о  среднем существует  функция
$\theta(t),\; 0\leqslant \theta(t) \leqslant 1$  такая,  что
$$
\delta F = F(t, w^\circ(t)+\delta w(t)) - F(t, w^\circ(t))=
\langle F'_w (t, w^\circ(t)+\theta(t) \delta w(t) ), \delta w(t)
\rangle
$$
(предполагается,  что  при  каждом $t$  отрезок  с  концами  $(t,w^\circ(t))$  и  $(t, w^\circ(t)+\theta(t)\delta w(t))$  лежит
в  $Q$,  что  обеспечивается   малостью  вариации   $\delta x$).

Следовательно,
\begin{equation}\label{1m7}
J(x^\circ +\delta x) - J(x^\circ)= \int\limits_{t_0}^{t_1}\langle
F'_w (t,w^\circ(t)), \delta w(t) \rangle dt + r(\delta x),
\end{equation}
где
$$
r(\delta x)= \int\limits_{t_0}^{t_1} \langle (F_w^\theta -
F_w^\circ), \delta w \rangle\, dt.
$$
Здесь  $F_w^\theta  =F'_w (t, w^\circ(t)+ \theta(t)\delta w(t)),\quad
F_w^0 = F'_w (t,w^\circ(t))$.

Ясно,  что  $\| F_w^\theta - F_w^0 \|_\mathcal{C} \to  0$  при
$\|\delta w\|_\mathcal{C} \to 0$. Последнее  имеет  место, если
$\delta u=\delta \dot x$  и  $\|\delta x\|_{\mathcal{C}^1}\to 0$.

Поскольку $ |r(\delta x)| \leqslant \| F_w^\theta - F_w^\circ
\|_\mathcal{C} \|\delta w\|_\mathcal{C} (t_1 - t_0) $  и
$\|\delta w\|_\mathcal{C} \leqslant  2\|\delta
x\|_{\mathcal{C}^1}$ то
\begin{equation}\label{1m8}
|r(\delta x)| = o (\|\delta x\|_{\mathcal{C}^1}).
\end{equation}

Условия  (\ref{1m7})  и  (\ref{1m8})  вместе  означают,  что
выражение
$$
\int\limits_{t_0}^{t_1} \langle F'_w (t, w^\circ(t)), \delta w(t)
\rangle dt = \int\limits_{t_0}^{t_1} (F'_x(t,x^\circ(t),\dot
x^\circ(t)) \delta x(t) +F'_{\dot x} (t, x^\circ(t), \dot
x^\circ(t)) \delta \dot x(t))dt
$$
есть  производная  Фреше  функционала $J(x)$  в  точке
$x^\circ(\cdot)$  (в  пространстве  $\mathcal{C}^1$). Это
выражение называют \emph{первой  вариацией}  функционала $J(x)$
в  точке $x^\circ(\cdot)$. Первую  вариацию  часто обозначают
$\delta J$.  Мы  будем  обозначать  её  $J'(x^\circ; \delta x)$,
а $\delta J$ сохраним  для  обозначения  полного приращения
функ\-цио\-на\-ла:
$$
\delta J= J(x^\circ + \delta x) - J( x^\circ).
$$

\begin{theorem}[необходимое  условие  слабого  минимума]
Если  $x^\circ(\cdot)$~--- точка  слабого  минимума  в
простейшей  задаче,  то  первая вариация  функционала  в  этой
точке  равна  нулю  на  любой вариации  из  $\mathcal{C}_0^1$.
\end{theorem}

\begin{proof}
Пусть  $\bar x(\cdot) \in \mathcal{C}_0^1$.  Положим   $\delta
x=\varepsilon \bar x$. При  всех  достаточно  малых  $\varepsilon$
имеем:
$$
0 \leqslant J(x^\circ + \varepsilon\bar x) - J(x^\circ) =
\int\limits_{t_0}^{t_1} \langle F_w^0,\varepsilon \bar w \rangle
dt + o(\varepsilon),
$$
где  $\bar w=(\bar x,\bar u),\ \bar u=\dot {\bar x}$ (см.
(\ref{1m7}) и (\ref{1m8})). Поскольку   $\varepsilon$~---
произвольного знака,  то отсюда получаем
$$
\int\limits_{t_0}^{t_1} \langle F_w^0, \bar w \rangle\, dt = 0,
$$
или
\begin{equation}\label{1m9}
\int\limits_{t_0}^{t_1} (F_x^0 \bar x + F_{\dot x}^\circ \dot
{\bar x})\, dt  = 0,
\end{equation}
где   $\bar x(\cdot)\in \mathcal{C}_0^1$~--- произвольный элемент.
\end{proof}

\subparagraph{5. Уравнение Эйлера.} Итак,  равенство  нулю
первой  вариации  на  подпространстве  $\mathcal{C}_0^1$ есть
необходимое условие слабого  минимума.  Теперь  нам  предстоит
его проанализировать  и  вывести  из  него  знаменитое
<<урав\-не\-ние Эйлера>>~--- важнейшее  необходимое  условие  в
вариационном ис\-чис\-ле\-нии.

Сначала  мы  пойдём  по  более  лёгкому,  но  не  вполне
<<законному>>  пути,  состоящем  в  интегрировании по  частям
члена
$$
\int\limits_{t_0}^{t_1} F_{\dot x}^\circ \dot {\bar x}\, dt=
F_{\dot x}^\circ \bar x |_{t_0}^{t_1} - \int\limits_{t_0}^{t_1}
(\frac{d}{dt}  F_{\dot x}^\circ) \bar x \,dt= -
\int\limits_{t_0}^{t_1} (\frac{d}{dt} F_{\dot x}^\circ) \bar x\,
dt.
$$
Второе  равенство  имеет  место  в  силу  условий $\bar x(t_0
)=\bar x(t_1)=0$. Первое  имеет  место,  если  предположить,  что
$F_{\dot x}^\circ = F_u(t,x^\circ(t),\dot x^\circ(t))$
диф\-фе\-рен\-ци\-руе\-ма  по  $t$ (оказывается,  что  это
предположение предположением  не  является,  а является  частью
необходимого условия,  но  для  доказательства  этого нужен
другой  путь, который  мы  проделаем  чуть  позже).  Таким
образом,  первая вариация  преобразовалась  к  виду
\begin{equation}\label{1m10}
\int\limits_{t_0}^{t_1} F_{w}^\circ \bar w\, dt =
\int\limits_{t_0}^{t_1} (F_x^\circ - \frac{d}{dt} F_{\dot
x}^\circ) \bar x\, dt.
\end{equation}
Следовательно,
\begin{equation}\label{1m11}
\int\limits_{t_0}^{t_1} (F_x^\circ - \frac{d}{dt} F_{\dot
x}^\circ) \bar x\, dt=0\quad \forall \bar x(\cdot) \in
\mathcal{C}_0^1.
\end{equation}
Считаем,  что  $F_{\dot x}^\circ$   непрерывно  дифференцируема
по  $t$  и, следовательно  функция  $F_x^\circ - \frac{d}{dt}
F_{\dot x}^\circ$  непрерывна  по  $t$.  Тогда  из  (\ref{1m11})
легко следует, что
\begin{equation}\label{1m12}
F_x^\circ - \frac{d}{dt} F_{\dot x}^\circ = 0
\end{equation}
(сформулируйте и докажите  самостоятельно  лемму,  которая здесь
нужна;  она называется  леммой  Лагранжа;  получите  с её помощью
уравнение  Эйлера).  Уравнение  (\ref{1m12})  и  есть уравнение
Эйлера. Подробнее,  оно  имеет  вид:
\begin{equation}\label{1m13}
\frac{d}{dt} F_{\dot x}(t,x(t),\dot x(t))  = F_x(t,x(t),\dot
x(t)).
\end{equation}
(мы  заменили  $x^\circ(t)$  на $x(t)$).  Это -- уравнение
второго  порядка,  для которого  имеется  ещё  два  граничных
условия :
\begin{equation}\label{1m14}
x(t_0 )=a,\ \  x(t_1 )=b.
\end{equation}
Итак,  мы  применили  интегрирование  по  частям  второго  члена
в выражении для  первой  вариации  и  преобразовали  первую
вариацию  по  Лагранжу  к  виду  (\ref{1m10}).

Теперь  мы  применим  \emph{другой  путь},  интегрируя  по частям
первый  член:
$$
\int\limits_{t_0}^{t_1} F_x^\circ \bar x\, dt =
 \int\limits_{t_0}^{t_1} ( \frac{d}{dt} \int\limits_{t_0}^{t} F_x^\circ [\tau] d\tau)  \bar x(t) dt = - \int\limits_{t_0}^{t_1}(\int\limits_{t_0}^t F_x^\circ [\tau] d\tau) \dot {\bar x}(t)\, dt
$$
(равенство  опять  использует  условия  $\bar x(t_0) = \bar x(t_1)=0$).  Здесь
$F_x^\circ [\tau] = F'_x (\tau,x^\circ(\tau),\dot x^\circ(\tau))$.  Таким  образом,
$$
\int\limits_{t_0}^{t_1} \langle F_w^\circ,\bar w\rangle  dt =
\int\limits_{t_0}^{t_1} (- \int\limits_{t_0}^{t} F_x^\circ[\tau]
d\tau + F_{\dot x}^\circ[t])\bar u(t)\, dt, \mbox{  где } \bar u
= \dot {\bar x}.
$$
Это -- преобразование  первой  вариации  \emph{по  Дюбуа -
Реймону}.  Окон\-ча\-тель\-но,  мы  получаем :
\begin{equation}\label{1m15}
\int\limits_{t_0}^{t_1} ( - \int\limits_{t_0}^{t} F_x^\circ d\tau
+ F_{\dot x}^\circ) \bar u(t)\, dt  = 0\ \ \forall \bar u(t)\in
\mathcal{C} _0,
\end{equation}
где
$$
\mathcal{C}_0 =\{\bar
u(t)\in \mathcal{C}([t_0,t_1],\mathbb{R}) \mid
\int\limits_{t_0}^{t_1}\bar u(t)\,dt=0\}
$$
~--- подпространство в
$\mathcal{C}([t_0,t_1],\mathbb{R})$.

Здесь  условие   $\int\limits_{t_0}^{t_1} \bar u(t)\, dt=0$  вытекает  из  условий  $\dot {\bar x} = \bar u$,  $\bar x(t_0)=\bar x(t_1)=0$.

Для  завершения  вывода  уравнения  Эйлера  нам  понадобится
сле\-дую\-щая

\begin{lemma}[Дюбуа - Реймон] Пусть  $f(t)$~--- непрерывная  функция  на
$[t_0 ,t_1]$.  Пусть  для  любой $\bar u(\cdot) \in
\mathcal{C}[t_0,t_1]$ из  условия $\int\limits_{t_0}^{t_1} \bar
u(t)\, dt=0$  следует условие $\int\limits_{t_0}^{t_1} f(t)\bar
u(t)\, dt=0$.  Тогда $f(t)=const$.
\end{lemma}

Абстрактным  аналогом  леммы  Дюбуа-Реймона  является  следующая

\begin{lemma}[о  зависимости  двух  линейных  функционалов]  Пусть  $X$~---
линейное  пространство,  $l: X\to \mathbb{R}$  и  $m : X\to
\mathbb{R}$~--- два линейных функционала.  Если  $m(x)=0$  для
всех  $x\in X$ таких, что $l(x)=0$, то существует $\lambda \in
\mathbb{R}$ такое,  что $m=\lambda l$.
\end{lemma}
\begin{proof}
Если  $l=0$,  то  и  $m=0$  и  тогда  $\lambda$~--- любое. Пусть
$l\neq 0$  и пусть  $x_1$  таков,  что  $l(x_1)=1$. Для
произвольного $x\in X$  положим $x_0 =x - l(x)x_1$. Тогда
$l(x_0)=0$  и,  следовательно  $m(x_0)=0$,  откуда
$m(x)=l(x)m(x_1)$.  Таким  образом,  $\lambda=m(x_1)$.
\end{proof}
Лемма  Дюбуа-Реймона  очевидным  образом  вытекает  из  этой  леммы.
\endinput
