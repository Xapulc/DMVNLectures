\chapter*{Лекция 8}
\section*{Тема: Условия минимума в абстракт\-ных прост\-ранст\-вах
(продолжение)}

\subparagraph{1. Задачи с ограничением типа равенства.}

Пусть $X,Y$ - бана\-ховы пространства, $U\subset X$ - открытое
множество, $f:U\rightarrow\mathbb{R}$ - функцио\-нал,
$g:U\rightarrow Y$ - оператор. Рассмотрим задачу:
\setcounter{equation}{0}
\begin{equation}\label{8m1}
f(x)\rightarrow min, \ \ g(x)=0,\ \ \ x\in U.
\end{equation}
Пусть $x_0$~--- \emph{допустимая точка}, т.е. $x_0\in U,\
g(x_0)=0.$ Предположим, что $f$ и $g$ строго дифференцируемы в
точке $x_0$ (например, достаточно считать, что $f$ и $g$
непрерывно дифференцируемы на $U$, т.е. $f\in C^1(U)$ $ \ g\in
C^1(U,Y)).$

Предположим также, что
$$
g'(x_0)X=Y
$$
~--- выполнено условие Люстерника, и следовательно, по теореме
Люстерни\-ка касательный конус к множеству
$$
M=\{x\in U\ | \ g(x)=0\}
$$
в точке $x_0$ есть подпространство
$$
Ker\ g'(x_0).
$$
Согласно теореме 2 прошлой лекции, необходимое условие
локально\-го минимума в точке  $x_0$ состоит в том, что
\begin{equation}\label{8m2}
\langle f'(x_0),\bar x\rangle=0 \ \ \ \ \forall \bar x \in Ker\
g'(x_0).
\end{equation}
Пусть это условие выполнено. Согласно лемме об аннуляторе ядра
линей\-ного сюрьективного оператора существует $y^*\in Y^*$ такой,
что
\begin{equation}\label{8m3}
f'(x_0)+y^*\circ g'(x_0)=0,
\end{equation}
где $y^*\circ g'(x_0)=[g'(x_0)]^*y^*$ (т.е. $\langle y^*\circ
g'(x_0), x\rangle=\langle y^*,g'(x_0)x\rangle \forall x\in X).$
Итак, необходимое условие \eqref{8m2} мы представили в
\emph{двойственной форме} \eqref{8m3}. Последняя носит название
<<правило множителей Лагранжа>>. Здесь единственным множителем
Лагранжа является линейный функционал $y^*\in Y^*.$ Это условие в
столь общей бесконечномерной задаче с ограниче\-нием типа
равенства впервые было получено Л.А.Люстерником в 1934 году.

Некоторое <<неудобство>> полученного условия состоит в том, что
тре\-буется выполнение условия Люстерника. Формально этого
требования можно избежать в тех случаях, когда известно, что
образ $g'(x_0)X$ замк\-нут. Последнее, как мы узнаем позже, верно
для операторов ограничений равенства в задачах оптимального
управления. Это верно и в случае, когда dim $Y<+\infty.$

В предположении о замкнутости образа $g'(x_0)X$, формально более
слабом, чем условие $g'(x_0)X=Y$, правило множителей Лагранжа,
т.е. необходимое условие локального минимума, формулируют в
следующем виде:

существуют $\alpha\in\mathbb{R}$ и $y^*\in Y^*$,  не равные нулю
одновременно, и такие, что
\begin{equation}\label{8m4}
\alpha f'(x_0)+y^*\circ g'(x_0)=0.
\end{equation}
Если условие Люстерника выполнено, то \eqref{8m4} реализуется с
$\alpha=1$, т.е. в виде \eqref{8m3}.

Если же условие Люстерника не выполнено, то по предположению
образ $g'(x_0)X$ есть замкнутое подпространство в $Y.$  Тогда по
лемме о нетривиальности аннулятора существует $y^*\neq 0$ такой,
что $\langle y^*,g'(x_0)X \rangle=0.$ Условие \eqref{8m4}
реализовалось на этот раз с $\alpha=0.$ Ничего другого, кроме как
констатации факта, что $g'(x_0)X\neq Y$, это условие в данном
случае в себе не несет. По сути, при невыполненом условии
Люстерника мы отказываемся от исследования задачи. Однако,
подобная форма записи необходимого условия оказывается удобной.

Отметим также, что, не ограничивая общности, мы можем считать в
необходимом условии, что $\alpha\geqslant 0$, ибо условие
выдерживает умножение на (-1).

Введем теперь \emph{функцию Лагранжа:}
$$
L(x,\alpha,y^*)=\alpha f(x)+\langle y^*,g(x)\rangle.
$$
Тогда условие \eqref{8m4} можно записать так
$$
L'_x(x_0,\alpha,y^*)=0,
$$
где $L'_x$~--- частная производная Фреше (определяемая
естественным обра\-зом).

Итак, доказана следующая теорема:
\begin{theorem}
(Л.А.Люстерник) Пусть $f$ и $g$ строго дифференцируемы в точке
$x_0\in U$ такой, что $g(x_0)=0$, и пусть образ $g'(x_0)X$
замкнут в $Y$. Пусть $x_0$~--- точка локального минимума в задаче
\eqref{8m1}. Тогда существуют множители Лагранжа
$\alpha\in\mathbb{R}$ и $y^*\in Y^*$ такие, что
\begin{equation}\label{8m5}
\alpha \geqslant 0,
\end{equation}
\begin{equation}\label{8m6}
\alpha + \|y^*\|> 0,
\end{equation}
\begin{equation}\label{8m7}
L'_x(x_0,\alpha,y^*)=0,
\end{equation}
где $L(x_0,\alpha,y^*)=\alpha f(x)+\langle y^*,g(x)\rangle.$

\end{theorem}

Здесь

\eqref{8m5}~--- условие неотрицательности множителя $\alpha$

\eqref{8m6}~--- условие нетривиальности набора $(\alpha, y^*)$

\eqref{8m7}~--- условие стационарности по $x$ функции Лагранжа.

Эта теорема реализует, так называемый, \emph{принцип Лагранжа},
состоя\-щий в том, что если $x_0$~--- точка минимума в задаче с
ограничениями, то она же стационарная точки функции Лагранжа (но
не обязательно точка минимума последней!) в задаче без
ограничений.

\textsl{Задание.} Сформулируйте теорему 1 в случае, когда
$Y=\mathbb{R}^m$ и, сле\-до\-ва\-тель\-но, $g=(g_1,\ldots\,g_m)$ -
конечный набор функционалов над $X$. В этом случае образ $g'(x)X$
автоматически замкнут $\forall x \in U.$

\setcounter{equation}{0} \subparagraph{2. Условия максимума в
гладкой задаче математического про\-грам\-ми\-ро\-ва\-ния.}

Пусть $X$~--- бана\-хово пространство, $U\subset X$ - от\-крытое
множество, на котором заданы функционалы
$f_i:U\rightarrow\mathbb{R},\ \ i=0,\ldots,k,$ и оператор
$g:U\rightarrow Y$, действующий в другое банахово пространство
$Y$. Предположим, что все $f_i$ и $g$ непрерывно диференцируемы
на $U$, причем, образ $g'(x)X$ замкнут в $Y\ \forall x \in U.$
Рассмотрим задачу (*):
\begin{equation*}
f_0(x)\rightarrow min, \ \ f_i(x)\leqslant 0, \ \ i=1,\ldots,k,\ \
g(x)=0,\ \ \ x\in U.
\end{equation*}

Назовем ее \emph{гладкой задачей с ограничениями типа равенства и
типа неравенства}, или \emph{гладкой задачей математического
программирования.}

Пусть $\alpha=(\alpha_0,\ldots,\alpha_k)\in\mathbb{R}^{k+1}, \
y^*\in Y^*.$ Введем функцию Лагранжа задачи (*) :
$$
L(x_0,\alpha,y^*)=\sum_{i=0}^k\alpha_i f_i(x)+\langle y^*,g(x)\rangle.
$$
Назовем $\ \ \alpha_0,\ \ldots\ ,\ \alpha_k,\ y^*\ $
\emph{множителями  Лагранжа}, а через
$\lambda=(\alpha_0,\ldots,\alpha_k,y^*)= (\alpha,y^*)$ будем
обозначать произвольный набор множите\-лей Лагранжа. Таким
образом,
$$
L=L(x,\lambda).
$$
\begin{theorem}
(правило множителей Лагранжа) Пусть $x_0$~--- точка
ло\-каль\-ного минимума в задаче (*). Тогда существуют набор
$$
\lambda=(\alpha_0,\ldots,\alpha_k,y^*)
$$
такой, что выполнены
следующие условия
\begin{equation}\label{81m1}
\alpha_0 \geqslant 0, \ \alpha_1 \geqslant 0,\ldots,\alpha_k
\geqslant0,
\end{equation}
\begin{equation}\label{81m2}
\sum_0^k\alpha_i + \|y^*\|> 0,
\end{equation}
\begin{equation}\label{81m3}
\alpha_if_i(x_0)=0, \ \ i=1,\ldots,k,
\end{equation}
\begin{equation}\label{81m4}
L'_x(x_0,\lambda)=0.
\end{equation}
\end{theorem}

Говорят, что

\eqref{81m1}~--- условия \emph{ неотрицательности},

\eqref{81m2}~--- условие \emph{нетри\-ви\-альности},

\eqref{81m3}~--- условия \emph{дополняющей нежесткости},

\eqref{81m4}~--- условие \emph{ста\-ционарности по $x$} функции
Лагранжа.

Для доказательства теоремы нам понадобится
\begin{lemma}
Пусть $x_0$~--- точка локального минимума в задаче (*). Пусть
$g'(x_0)X=Y$, т.е. для $g$ в $x_0$ выполнено условие Люстерника.
Тогда не существует $\bar x\in X$, удовлетворяющего условиям:
\begin{equation}\label{81m5}
\langle f'_0(x_0),\bar x\rangle<0; \ \ \langle f'_i(x_0),\bar
x\rangle<0, \ \ i\in I,
\end{equation}
\begin{equation}\label{81m6}
g'(x_0)\bar x=0,
\end{equation}
где,
\begin{equation}\label{81m7}
I=\{i\in\{1,\ldots,k\} \ | \ f_i(x_0)=0\}
\end{equation}
~--- множество активных индексов ограничений типа неравенства в
точке $x_0.$
\end{lemma}
\begin{proof}
Пусть $\bar x$ удовлетворяет условиям \eqref{81m5} и \eqref{81m6}.
Согласно теореме Люстерника вектор $\bar x$ (в силу \eqref{81m6})
является касательным к огра\-ничению $g(x)=0$ в точке $x_0.$
Следовательно, существует
$\tilde{x}(\varepsilon):(0,\varepsilon_0)\to X (\varepsilon_0>0)$
такая, что
\begin{equation}\label{81m8}
g(x_0+\varepsilon \bar x+\tilde{x}(\varepsilon))=0,\ \
\|\tilde{x}(\varepsilon)\|=o(\varepsilon).
\end{equation}
Положим $x_\varepsilon=x_0+\varepsilon \bar
x+\tilde{x}(\varepsilon)$. Покажем, что $\{x_\varepsilon\}$
<<нарушает>> минимум в точке $x_0.$ Действительно,
\begin{equation}\label{81m9}
g(x_\varepsilon)=0,\ \ \varepsilon\in (0,\varepsilon_0),
\end{equation}
\begin{equation}\label{81m10}
\|x_\varepsilon-x_0\|\to 0 \ \ (\varepsilon\to +0).
\end{equation}
Пусть $i$ не принадлежит $I,\ i\in \{1,\ldots,k\},$ т.е.
$f_i(x_0)<0$. Тогда из непрерывности $f_i$ в точке $x_0$ в силу
\eqref{81m10} следует, что
$$
f_i(x_\varepsilon)<0
$$ для всех
достаточно малых $\varepsilon>0.$

Пусть теперь $i\in I.$ Тогда $f_i(x_0)=0$ и $\langle
f'_i(x_0),\bar x\rangle<0$  в силу \eqref{81m5}. Следовательно,
$$
f_i(x_\varepsilon)=f_i(x_0+\varepsilon \bar x+\tilde{x}(\varepsilon))=
f_i(x_0)+\langle f_i'(x_0),\varepsilon \bar
x+\tilde{x}(\varepsilon)\rangle +
o(\varepsilon)=\varepsilon\langle f_i'(x_0),\bar
x\rangle+o_1(\varepsilon).
$$

Поскольку $\varepsilon>0$, $\langle f_i'(x_0),\bar x\rangle<0,$
то $f_i(x_\varepsilon)<0$ для всех достаточно малых
$\varepsilon>0.$

Аналогично устанавливается, что $f_0(x_\varepsilon)<f_0(x_0)$ для
всех достаточно малых $\varepsilon>0.$ Но тогда
$\{x_\varepsilon$\} удовлетворяет всем ограничениям и
<<наруша\-ет>> локальный минимум. Лемма доказана.
\end{proof}

Нам понадобится еще одно


\begin{propos}
Пусть $l:X\to\mathbb{R}$~--- ненулевой линейный функционал, т.е.
$l\in X^*, l\neq 0.$ Пусть $K=\{x\in X \ | \ \langle l,
x\rangle>0\}$~--- открытое полупространст\-во. Пусть $m\in K^*,$
т.е. $\langle m,x \rangle\geqslant 0 \ \ \forall x\in K.$ Тогда
существует $\lambda\geqslant 0$ такое, что $m=\lambda l.$
\end{propos}

\begin{proof}
Покажем сначала, что
$$
\langle m,x \rangle=0\ \ \ \forall x\in Ker\ l.
$$
Действительно, пусть $x_0\in Ker\ l$, т.е. $\langle l,x_0
\rangle=0$ и пусть $x_1$  таков, что $\langle l,x_1 \rangle>0$.
Тогда $$x_1+\beta x_0 \in K \ \ \ \forall \beta\in \mathbb{R}.$$
Следовательно,
$$
\langle m,x_1 \rangle+ \beta \langle m,x_0 \rangle\geqslant 0 \ \ \forall \beta\in\mathbb{R}
$$
Это возможно лишь при $\langle m,x_0 \rangle=0$. Итак,
$$
\langle l,x \rangle=0 \ \Rightarrow \ \langle m,x \rangle=0.
$$
Отсюда, как мы знаем, следует существование
$\lambda\in\mathbb{R}$ такого, что $m=\lambda l.$ Поскольку
$$
\langle l,x \rangle>0 \ \Rightarrow \ \langle m,x \rangle\geqslant 0,
$$
то $\lambda\geqslant 0.$
\end{proof}
\begin{proof}
(доказательство теоремы) Пусть $x_0$~--- точка локального
минимума в задаче (*). Рассмотрим два случая.

а) \emph{Невырожденный случай}: $g'(x_0)X=Y$. В этом случае
согласно Лемме система условий \eqref{81m5} и \eqref{81m6}
несовместна. Если среди функционалов $f_i(x_0), i\in I\cup\{0\}$
есть нулевой, то полагая соответствующий ему множитель $\alpha_i$
равным 1, а остальные множители (включая $y^*$) равными нулю,
получае набор $\lambda$ удовлетворяющий всем условиям
\eqref{81m1}-\eqref{81m4} теоремы. Поэтому считаем, что
$$
f_i(x_0)\neq0, \forall i\in I\cup\{0\}.
$$
Тогда все полупространства \eqref{81m5} непусты. Положим
$$
\Omega_i=\{\bar x \ | \ \langle f'_i(x_0),\bar x\rangle<0\}, \ \ i\in I\cup\{0\},
$$
$$
\Omega=\{\bar x \ | \ g'(x_0)=0\}.
$$
Пересечение полупространств
$\Omega_i, \ i\in I\cup\{0\}$ и полупространства $\Omega$ пусто.
При этом, согласно предложению
$$
\Omega_i^*=\Big \{ x^*\in X^* \ | \ \langle x^*,x\rangle =
-\alpha_i \langle f'_i(x_0), x\rangle \ \  \ \forall x\in X,
\text{ где } \alpha_i\geqslant 0\Big \},
$$
т.е. сопряженный конус к полупространству $\Omega_i$ есть луч (с
вершиной в нуле), натянутый на $(-f_i'(x_0)).$

Согласно теореме Дубовицкого-Милютина существуют
$$
x_i^*\in\Omega_i^*, \ \ i\in I\cup\{0\},\ \ \  x^*\in\Omega^*
$$
не все равные нулю и такие, что $$ \sum_{I\cup\{0\}} x_i^*+x^*=0$$
Согласно лемме об ануляторе $x^*={[g'(x_0)]}^*(-y^*)=-y^*\circ
g'(x_0)$ (знак <<->> удобен), где $y^*\in Y^*$, и как мы сказали
выше
$$
x_i^*=-\alpha_if_i'(x_0),\ \ \ \alpha_i\geqslant 0,\ \ \ i\in I\cup\{0\}.
$$

Следовательно,
$$
-\sum_{I\cup\{0\}} \alpha_if_i'(x_0)- y^*\circ
g'(x_0)=0.
$$
Остается положить $\alpha_i=0$ при $i$ не принадлежащем $I$,
$i\neq 0.$ Тогда все условия \eqref{81m1}-\eqref{81m4} теоремы
оказываются выполненными. (Набор $\alpha_i,y^*$ нетривиален, ибо
в противном случае набор $x_i^*,x^*$ тривиален.)

б) \emph{Вырожденный случай}: $g'(x_0)X\neq Y$. В этом случае
образ $L=g'(x_0)X$ есть замкнутое пространство в $Y$, не
совпадаещее с Y. Тогда по лемме о нетривиальности аннулятора
существует функционал $y^*\neq 0,$ аннулирующийся на $L.$
Следовательно, $\langle y^*g'(x_0),x\rangle=0, \ \ \forall x\in
X.$ Положим $\alpha_i=0, \ \ \forall i=0,\ldots,k.$ Тогда набор
$\lambda=(0,\ldots,0,y^*)$ удовлетворяет всем условиям
\eqref{81m1}-\eqref{81m4} теоремы. (В этом случае правило
множителей Лагранжа лишь констатирует тот факт, что $g'(x_0)X\neq
Y$, и мы отказываемся от исследования задачи на минимум.)
\end{proof}

\begin{rems}
Из доказательства видно, что условия теоремы могут быть
ослаблены. А именно, достаточно считать, что в точке $x_0$ все
функционалы $f_i$ дифференцируемы по Фреше, а оператор $g$ строго
диф\-фе\-рен\-ци\-руем, и, кроме того, образ $g'(x_0)X$ замкнут в
$Y$.
\end{rems}

\endinput
