\chapter*{Лекция 9.}
\section*{Тема: Оптимальное управление. Принцип мак\-си\-му\-ма.}


\subparagraph{1. Пример задачи оптимального управления
(А.А.Милютин)} Точка движется по плоскости. Скорость точки может
иметь любое на\-прав\-ле\-ние, но ограничена по величене. Какую
скорость надо сообщить точке в каждый момент времени, чтобы за
кратчайшее время точка перешла бы из положения А в положение В?


Формализуем задачу. Положение точки характеризуется ее
коор\-ди\-на\-та\-ми $(x,y)$. Скорость точки в данный момент
обозначим через $(u,v)(t)$. Если $u=u(t)$ и $v=v(t)$ заданы, то
изменение состояния точки подчинено системе дифференциальных
уравнений
$$
\begin{cases}
\dot{x}=u(t) \\
\dot{y}=v(t) \\
\end{cases}
$$
При этом $u^2+v^2\leqslant const$. Здесь $t$~--- независимая
переменная~--- время, $t\in[t_0,t_1]$. Отрезок $[t_0,t_1]$  не
фиксирован. Требуется минимизировать $t_1-t_0$. Итак, задача
имеет вид
$$
t_1-t_0\rightarrow min
$$
$$
\begin{cases}
\dot{x}=u(t) \\
\dot{y}=v(t) \\
\end{cases}
$$
$$
u^2+v^2\leqslant const
$$
$$
x(t_0)=a_1 \ \ \ \ \ x(t_1)=b_1
$$
$$
y(t_0)=a_2 \ \ \ \ \ y(t_1)=b_2
$$
где $(a_1,a_2)$ и $(b_1,b_2)$~--- координаты А и В соответствено.


Приведенная задача имеет простое решение, и для ее решения не
нужно знать теорию оптимального управления. Однако, если
ограниче\-ние на управление
$$
u^2+v^2\leqslant const
$$
заменить на
$$
\frac{u^2}{a^2}+\frac{v^2}{b^2}\leqslant 1,
$$
то решение становится неочевидным. Наша цель - дать единый
алгоритм, с помощью которого можно решать (но не обязательно
решить!!) любую задачу оптимального управления.

\subparagraph{2. Управляемая система.} Управляемой системой будем
называть пару условий
\setcounter{equation}{0}
\begin{equation}\label{9m1}
\dot{x}=f(t,x,u), \quad u\in U.
\end{equation}
Здесь $U\subset\mathbb{R}^n$~--- произвольное множество, которому
должно принадле\-жать \emph{управление} $u=u(t)$ в каждый момент
времени $t$. Таким образом, $U$ задает \emph{ограничение на
управление}. Компоненты вектора $u=(u_1,\ldots,u_m)$ также
называют \emph{управлениями} или \emph{управляющими параметрами}.
Вектор $x=(x_1,\ldots,x_n)$ характеризует \emph{состояние}
управляемого объекта. В ме\-ха\-ни\-чес\-ких системах обычно $x_i$
- это обобщенные координаты. В оп\-ти\-маль\-ном управлении
$x=x(t)$ называют \emph{фазовой переменной}, или \emph{фазой}.
Урав\-не\-ние $\dot{x}=f(t,x,u)$ описывает <<динамику>> объекта
управления при выбранном управлении $u=u(t)$.


Если задано начальное состояние в момент $t_0\ \ x(t_0)=a$ и
задано управление $u(t)$ на отрезке $[t_0,t_1]$, то (в принципе)
$x(t)$ можно определить как решение задачи Коши
$$\dot{x}=f(t,x,u(t)), \ \ \ x(t_0)=a.$$
(Однако мы не будем интересоваться вопросом о существовании
решения этой задачи.)


Относительно функции $f$ мы будем предполагать, что \emph {она
сама и ее частные производные $f_x$  и $f_t$  непрерывны} по
совокупности переменных.


Пара функций $x(t),u(t)$, определенных на отрезке $[t_0,t_1]$,
называется \emph{траекторией управляемой системы} (1), если
$$
x(t) : [t_0,t_1]\rightarrow\mathbb{R}^n
$$
~--- абсолютно непрерывная функция,
$$
u(t) : [t_0,t_1]\rightarrow\mathbb{R}^m
$$
~--- ограниченная измеримая функция, и при этом почти всюду (п.в.)
на $[t_0,t_1]$ выполнены условия
$$
\dot{x}(t)=f(t,x(t),u(t)), \ \ \ u(t)\in U.
$$
Заметим, что данное определение позволяет менять $u(t)$ на
множестве меры нуль (называя функцию $u(t)$ ограниченной
измеримой, мы имели в виду измеримость и существенную
ограниченность).


С траекторией $(x(t),u(t) \ |\ t\in [t_0,t_1])$ мы будем
связывать набор концевых значений $p=(t_0,x_0,t_1,x_1)$, где
$x_0=x(t_0),\ x_1=x(t_1)$. Мы будем также полагать для краткости
$$
w=(x,u).
$$

Часто вводят открытое множество $Q\subset\mathbb{R}^{1+n+m}$ и
предполагают, что $f$ задана и непрерывна вместо с поизводными
$f_x$ и $f_t$ на $Q$. В определении управляемой системы добавляют
условие
$$
(t,x,u)\in Q.
$$
Предполагают, что это условие выполнено для траектории $x(t),
u(t)$ п.в. на $[t_0,t_1]$. Более того предполагают, что для
каждой траектории существует компакт ${\cal{C}}\subset Q$
(зависящий от траектории) такой, что
$$
(t,x(t),u(t))\in \cal{C}
$$
п.в. на $[t_0,t_1].$ Это означает, что траектория проходит в $Q$
на положительном расстоянии от границы $\partial Q$. Такое
требование предполагается выполненным для любой траектории
управляемой системы. Все дальнейшее изложение можно проводить с
таким дополнительным открытым ограничением в виде $Q$. Однако,
для простоты мы полагаем ниже
$$
Q=\mathbb{R}^{1+m+n}.
$$

\subparagraph{3. Каноническая задача оптимального управления -
задача А.} Эта задача ставится следующим образом: минимизировать
функцию начального и конечного сосотояний, а также начального и
конечного моментов времени
$$
J=F_0(t_0,x_0,t_1,x_1)\rightarrow min,
$$
где по определению $$
x_0=x(t_0), \ \ \ x_1=x(t_1),
$$
при ограничениях на $t_0,x_0,t_1,x_1$ заданных в виде неравенств и
равенств
$$
F(t_0,x_0,t_1,x_1)\leqslant 0, \ \
K(t_0,x_0,t_1,x_1)=0,
$$
 которым должны удовлетворять траектории
$$
(x(t),u(t) \ | \ t\in [t_0,t_1])
$$
управляемой системы
$$
\dot{x}=f(t,x,u), \ \ \ u\in U.
$$
Отрезок $[t_0,t_1]$ $\acute{a}\ priori$ не фиксирован.

Полагая для краткости $$p=(t_0,x_0,t_1,x_1),$$ перепишем задачу в
виде:
$$
J=F_0(p)\rightarrow min, \ \ F(p)\leqslant 0, \ \ K(p)=0,
$$
$$
\dot{x}=f(t,x,u), \ \ \ u\in U.
$$
Здесь $$
F_0:\mathbb{R}^{2+2n}\rightarrow \mathbb{R}
$$
$$
F:\mathbb{R}^{2+2n}\rightarrow \mathbb{R}^k,\ \ F=(F_1,\ldots,F_k)
$$
$$
K:\mathbb{R}^{2+2n}\rightarrow \mathbb{R}^s,\ \ K=(K_1,\ldots,K_s)
$$
$$
f:\mathbb{R}^{1+n+m}\rightarrow \mathbb{R}^n,\ \ f=(f_1,\ldots,f_n)
$$
\begin{propos}
Предполагается, что $F_0,F,K$~--- функции класса $\mathcal{C}^1$,
и, как было сказано, $f$ непрерывна вместе с производными $f_x$ и
$f_t$. Никаких предположений относительно множества
$U\subset\mathbb{R}^n$ не делается.
\end{propos}

Мы уже отметили, что свойства $f$ можно было бы предполагать
вы\-пол\-нен\-ны\-ми на некотором открытом множестве $Q$,
соответственно уточ\-нив понятие допустимой траектории. Аналогично
можно было бы считать, что $F_0,F,K$ определены и непрерывно
дифференцируемы на некотором открытом множестве
$P\subset\mathbb{R}^{2+2n}.$ Мы этого не делаем, чтобы не
от\-вле\-кать\-ся на несущественные детали.

Если $F_0(p)=t_1-t_0$, то есть требуется минимизировать время, то
задача называется задачей \emph{быстродействия}, при этом часто
$t_0$ фиксируют, полагая $t_0=0$ (в этом случае $K_i(p)=t_0$ при
некотором $i$). Может оказаться, что в задаче фиксирован левый
конец $x(t_0)=a$ или правый $x(t_0)=a$, или оба. Такие условия
задаются с помощью функции $K$: $K_i=x_0-a=0$, или $K_j=x_1-b=0$
при некоторых $i,j$. Бывают постановки, когда из точки $x(t_0)=a$
надо попасть на многообразие $\varphi(x(t_1))=0$ или наоборот,
или с многообразия на многообразие. Все эти постановки
охватываются равенством $K(p)=0$.

С помощью равенства $K=0$ можно фиксировать как $t_0$, так и
$t_1$, или $t_0$ и $t_1$, одновременно. В последнем случае имеем
задачу на фиксированном отрезке времени.

Наконец, пусть вместо концевого функционала в задаче присутствует
интегральный функционал
$$
J_\Phi=\int_{t_0}^{t_1}\Phi(t,x,u)dt,
$$
где $\Phi$ непрерывна вместе со своими производными  $\Phi_t$ и
$\Phi_x$. Тогда его можно переписать как концевой с помощью
введения дополнительной фазовой переменой $y$:
$$
\dot{y}=\Phi(t,x,u) \Rightarrow J_\Phi=y_1-y_0,
$$
где $y_1=y(t_1), \ y_0=y(t_0)$.
Заметим, что при этом меняется и управляемая система, приобретая
вид:
$$
\dot{x}=f(t,x,u), \ \ \dot{y}=\Phi(t,x,u),\ \ \ u\in U.
$$
Указаный прием существенно расширяет круг задач, охватываемый
ка\-но\-ни\-чес\-кой задачей.


Траектория $(x(t),u(t) \ | \ t\in [t_0,t_1])$ называется \emph
{допустимой в ка\-но\-ни\-чес\-кой задаче А}, если $x(t)$
абсолютно непрерывна на $[t_0,t_1]$, $u(t)$ ограничена и измерима
на $[t_0,t_1]$ и выполнены все ограничения задачи.


Наша цель сейчас - исследовать каноническую задачу А и получить в
ней необходимое условие минимума - принцип максимума Понтрягина.
Последний является обобщением условия Вейерштрасса на задачи
оп\-ти\-маль\-но\-го управления.


Главное, что отличает задачи оптимального управления от задач
ва\-риа\-цион\-но\-го исчисления - это присутствие ограничения
$u\in U$. Как уже подчеркивалось, в качестве $U$ может выступать
\emph {любое} множество, например двухточечное.

Поэтому нужны новые специальные приемы для исследования задач
оптимального управления. Таких приемов имеется несколько, и они
при\-во\-дят к различным доказательствам принципа максимума. Мы
будем следовать приему и доказательству, рассказанному
А.А.Милютиным на одном из семинаров по оптимальному управлению.
Это доказательство пред\-став\-ляет\-ся нам одним из наиболее
простых.


\subparagraph{4. Каноническая задача $B$.} Оказывается, вовсе не
обязательно рассматривать задачу А в полной общности, ибо имеется
прием сведения ее к более простой задаче - задаче $B$. Последняя
имеет вид :
$$
J=F_0(x_0,x_1)\rightarrow min, \ \ F(x_0,x_1)\leqslant 0, \ \ K(x_0,x_1)=0,
$$
$$
\dot{x}=f(x,u), \ \ \ u\in U,
$$
где по определению
$$
x_0=x(t_0), \ \ \ x_1=x(t_1).
$$
Фунции $F_0,F,K$ непрерывно дифференцируемы в $\mathbb{R}^{2n}$,
$f$ непрерывна вместе с производной $f_u$ в $\mathbb{R}^{n+m}$.


Отрезок $[t_0,t_1]$ по-прежнему \emph{не фиксирован}.


Теперь $f$ не зависит от $t$ явно, т.е. система $\dot{x}=f$
является \emph{автономной}. Кроме того, $F_0,F,K$ не зависят явно
от $t_0,t_1$.


В задаче $B$ траектории допускают сдвиг по времени с сохранением
концов $x_0,x_1$. Действительно, если $(x(t),u(t) \ | \ t\in
[t_0,t_1])$~--- допустимая траектория задачи $B$, то при любом
вещественном $\theta$ траектория
$$
(x(t-\theta),u(t-\theta) \ | \ t\in [t_0+\theta,t_1+\theta])
$$
~--- допустимая траектория той же задачи с теми же концами
$x_0,x_1$. Это касается и оптимальных траекторий задачи $B$.


Переход от задачи А к задаче $B$ достигается с помощью следующего
приема. К системе $\dot{x}=f(t,x,u)$ добавим уравнение
$$
\frac{dt}{d\tau}=1,
$$
считая, что $t=t(\tau)$ - новая фазовая переменая. Функции
$x(\cdot)$ и $u(\cdot)$ также считаем зависящими от $\tau$:
$x=x(\tau), u=u(\tau)$. Положим
\begin{equation}\label{9m2}
t_0=t(\tau_0), \ \ x_0=x(\tau_0), \ \ t_1=t(\tau_1), \ \
x_1=x(\tau_1).
\end{equation}

Приходим к следующей задаче

\subparagraph{Задача $A'$.}

$$
J=F_0(t_0,x_0,t_1,x_1)\rightarrow min, \ \ F(t_0,x_0,t_1,x_1)\leqslant 0,
\ \ K(t_0,x_0,t_1,x_1)=0,
$$
$$
\frac{dx}{d\tau}=f(t,x,u), \ \ \frac{dt}{d\tau}=1,\ \ u\in U,
$$
где $t(\tau), x(\tau)$~--- фазовые переменные, $u(t)$~---
управление, $\tau\in [\tau_0,\tau_1]$,\mbox{ $\tau_0<\tau_1$} - не
фиксированы, концы $t_0,x_0,t_1,x_1$ определены условиями
(\ref{9m2}).

Ясно, что задача А - того же типа, что и задача $B$, и
следовательно в ней есть сдвиг траекторий по времени.

Какова связь между задачами $A$ и $A'$?

Пусть $(x(t),u(t) \ | \ t\in [t_0,t_1])$ - допустимая траектория
задачи А. Ее концы - это набор $(t_0,x_0,t_1,x_1)$, где
$x_0=x(t_0), \ \ \ x_1=x(t_1).$

Положим
$$
\tau_0=t_0,\ \ \ \tau_1=t_1,\ \ \ t(\tau)=\tau.
$$
Тогда
$$
(t(\tau),x(\tau),u(\tau)\ | \ \tau\in [\tau_0,\tau_1])
$$
~--- допустимая траектория задачт $A'$ с теми же концами
$(t_0,x_0,t_1,x_1)$, определенными условиями (\ref{9m1}).

Обратно, пусть имеется допустимая траектория
$$
(t(\tau),x(\tau),u(\tau)\ | \ \tau\in [\tau_0,\tau_1])
$$
в задаче $A'$ с концами $(t_0,x_0,t_1,x_1)$. Тогда
$$
t(\tau)=\tau+const.
$$
Сделав, если надо, сдвиг по времени,
константу можно занулить, т.е. перейти к новой допустимой
траектории в задаче $A'$ с теми же концами, но с функцией
$t(\tau)=\tau$. Для этой траектории положим $t_0=\tau_0$,
$t_1=\tau_1$. Тогда
$$
(x(t),u(t) \ | \ t\in [t_0,t_1])
$$
~--- допустимой траектории задачи $A$ с теми же концами
$(t_0,x_0,t_1,x_1)$, где $x_0=x(t_0), \ \ \ x_1=x(t_1).$

Указаное соответствие между допустимыми траекториями задач $A$ и
$A'$ имеется и для оптимальных траекторий. Поэтому, получив
необходи\-мое условие минимума в задаче $B$, мы легко перепишем
его и как необхо\-димое условие в задаче А - с помощью указаного
приема.


Переписка задач, замена переменых играют в оптимальном
управле\-нии важную роль. Уже столь простой прием замены
независимой пе\-ре\-мен\-ной $t$ принес заметную пользу. Более
серьезная замена времени $t=t(\tau)$ позволит свести задачу к
конечномерной задаче с неравенствами и ра\-венст\-ва\-ми, а затем
воспользоваться правилом множителей Лагранжа. В конечном итоге
это приведет к доказательству принципа максимума. Замена будет
связана с уравнением $\frac{dt}{d\tau}=v$, где $v$
неотрицательная функ\-ция и, следовательно, $t=t(\tau)$ -
монотонная функция. Подобная замена, превращающая независимую
переменную $t$ в фазовую переменную, была предложена
А.Я.Дубовицким и А.А.Милютиным, и была названа ими $v$-заменой.


\subparagraph{5. $v$-замена.} Рассмотрим управляемую систему
задачи $B$:
\begin{equation}\label{9m3}
\dot{x}=f(x,u),\ \ \ u\in U,
\end{equation}
траекторией которой является пара
$$
(x(t),u(t) \ | \ t\in [t_0,t_1]),
$$
где $t_0<t_1$~--- произвольны; $x(t)$ абсолютно непрерывна, а
$u(t)$ ограничена и измерима, причем условия (\ref{9m3}) на
траектории выполнены п.в.


Определим теперь \emph{расширенную управляемую систему} задачи
$B$:
\begin{equation}\label{9m4}
\frac{dx}{d\tau}=vf(x,u), \ \ \ \frac{dt}{d\tau}=v, \ \ \ u\in U,
\ \ \ v\geqslant 0.
\end{equation}
Здесь $\tau$~--- независимая переменная. Траекторией системы
(\ref{9m4}) по оп\-ре\-де\-ле\-нию является набор функций
$$(t(\tau), x(\tau), u(\tau), v(\tau) \ | \ \tau\in[\tau_0,\tau_1])$$
таких, что

$t(\tau), x(\tau)$~--- абсолютно непрерывны,

$u(\tau)$~--- ограничена и измерима,

$v(\tau)$~--- кусочно постоянна, (!!)

(т.е. на $[\tau_0,\tau_1]$ имеется конечное число интервалов,
примыкающих друг к другу, на которых $v(\tau)$ постоянна),
условия (\ref{9m4}) выполнены почти всюду на $[\tau_0,\tau_1]$,
$\tau_0<\tau_1$ - произвольны.

Концы траектории системы (\ref{9m3}) - это $t_0,t_1$ и значения
$$x_0=x(t_0), x_1=x(t_1).$$

Концы траектории системы (\ref{9m4})~--- это $\tau_0,\tau_1$ и
значения
$$
x_0=x(\tau_0), \ \ \ x_1=x(\tau_1),
$$
$$
t_0=t(\tau_0), \ \ \ t_1=t(\tau_1).
$$
\begin{lemma1}
Для любой траектории системы (\ref{9m3}) существует траектория
системы (\ref{9m4}) с теми же $x_0, x_1$.
\end{lemma1}
\begin{proof}
Пусть $$ (x(t),u(t) \ | \ t\in [t_0,t_1])
$$
~--- траектория системы (\ref{9m3}). Положим
$$
\tau_0=t_0, \ \ \tau_1=t_1, \ \ v(\tau)=1, \ \
t(\tau)=\tau.
$$
Тогда
$$
(t(\tau), x(\tau), u(\tau), v(\tau) \ | \ \tau\in[\tau_0,\tau_1])
$$
траектория системы (\ref{9m4}) с теми же $x_0, x_1$.
\end{proof}

Эта лемма элементарна, но в действительности она нам и не
по\-на\-до\-бит\-ся. Понадобится следующая, менее элементарная

\begin{lemma1}
Для любой траектории системы (\ref{9m4}) существует
траек\-то\-рия системы (\ref{9m3}) с теми же $x_0, x_1$.
\end{lemma1}

Для доказательства нам потребуются два предложения.

Пусть функция
$\tilde{v}(\tau):[\tau_0,\tau_1]\rightarrow\mathbb{R}$~---
кусочно постоянна и неот\-ри\-ца\-тель\-на, и пусть
$\tilde{t}(\tau)$ удовлетворяет условиям
$$
\frac{d\tilde{t}(\tau)}{\tau}=\tilde{v}(\tau), \ \ \
\tilde{t}(\tau_0)=t_0,
$$
то есть
$$
\tilde{t}(\tau)=t_0+\int_{\tau_0}^\tau \tilde{v}(s)ds.
$$

%%Здесь должна быть картинка. l13_1.pcx

Таким образом,
$$
\tilde{t}(\tau) : [\tau_0,\tau_1]\rightarrow [t_0,t_1]
$$
<<отображение на>>~--- кусочно-линейная неубывающая функция. Пусть
$$
\Delta^1,\Delta^2,\ldots,\Delta^s
$$
~--- набор всех отрезков постоянства функции $\tilde{t}(\tau)$,
расположенных в естественном порядке. Положим
$$
{\cal{M}}_0=\bigcup_1^s\Delta^k, \ \ \
{\cal{M}}_+=[\tau_0,\tau_1]\backslash{\cal{M}}_0.
$$
${\cal{M}}_+$ состоит из конечного числа интервалов (или
полуинтервалов, когда $\tau_0$ или $\tau_1$ служит одним из
концов) линейного роста функции $\tilde{t}(\tau)$.

Пусть
$$
\tilde{t}(\Delta^k)=\{t^k\}, \ \ \ k=1,\ldots,s
$$
~--- значения функции $\tilde{t}$ на интервалах постоянства. Положим
$$
{\cal{N}}_0=\{t^1,\ldots,t^s\}, \ \ \
{\cal{N}}_+=[t_0,t_1]\backslash{\cal{N}}_0.
$$
Ясно, что
$$
{\cal{N}}_0=\tilde{t}({\cal{M}}_0), \ \ \
{\cal{N}}_+=\tilde{t}({\cal{M}}_+).
$$
Далее, пусть
$$
\tilde{\tau}(t) : [t_0,t_1]\rightarrow[\tau_0,\tau_1],
$$
такова, что
$$
\tilde{t}(\tilde{\tau}(t))=t \ \ \ \ \forall t\in[t_0,t_1],
$$
т.\ е. $\tilde{\tau}$ является правой обратной к
$\tilde{t}(\tau)$. Поскольку $\tilde{t}(\tau)$ отображают <<на>>,
то правая обратная существует. Более того, она определена
однозначно всюду, кроме конечного множества точек
$t^1,\ldots,t^s$, состовляющих мно\-жест\-во $N_0$. Значение в
точке $t^k$ можно выбрать произвольно из отрезка
$\Delta^k:=[\tau_0^k,\tau_1^k],\ \  k=1,\ldots,s$ \, являющегося
полным прообразом $\tilde{t}^{-1}(t_k).$ Для
оп\-ре\-де\-лен\-нос\-ти положим
$$
\tilde{\tau}(t^k)=\tau_0^k, \ \ \ k=1,\ldots,s.
$$
Тогда $\tilde{\tau}(t)$ непрерывна \emph{слева} и
$\tilde{\tau}(t_0)=\tau_0$.

Следующие два предложения будем называть  предложениями о
мо\-но\-тон\-ных кусочно линейных функциях. В них используются
функции $\tilde{t}(\tau)$, $\tilde{\tau}(t)$ и $\tilde{v}(\tau)$,
определенные выше.
\setcounter{proposit}{0}
\begin{proposit}
1. Пусть $\tilde{u}(\tau): [\tau_0,\tau_1]\rightarrow\mathbb{R}^m$
~--- ограниченая измеримая функция такая, что $\tilde{u}(\tau)\in
U$ п.в. на $[\tau_0,\tau_1]$
\end{proposit}
Положим
$$
u(t)=\tilde{u}(\tilde{\tau}(t)), \ \ t\in[t_0,t_1].
$$
Тогда
$u(\tau): [t_0,t_1]\rightarrow\mathbb{R}^m$~--- ограниченная
измеримая функция такая, что $u(t)\in U$ п.в. на $[t_0,t_1]$.

\begin{proof}
Достаточно проверить это утверждение на произвольном интервале
множества $N_+$. Но на таком интервале $\tilde{\tau}(t)$~---
линейная воз\-рас\-таю\-щая функция и тогда измеримость,
ограниченность (существенная) и условие $u(t)\in U$ п.в. -
представляются очевидными.
\end{proof}

Второе, более сложное предложение мы сформулируем и докажем в
начале следующей лекции.
\endinput
