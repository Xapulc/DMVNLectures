\section{Теория Морса}

Пусть $M$ --- гладкое $n$-мерное многообразие, $f$ --- гладкая функция на $M$.

\textbf{Определение.} Точка $P \in M$ называется критической точкой функции $f$, если $\Nabla_P f=0$.

\textbf{Утверждение.} Если $P$ --- критическая точка функции $f$, то  
$\frac{\partial^2f}{\partial x^i \partial x^j}$ --- тензор типа $(0, 2)$.

\textbf{Доказательство.} 
$$
\frac{\partial^2f}{\partial x^{i'} \partial x^{j'}}=\p{}{x^{i'}}\p{}{x^{j'}}f=
\p{}{x^{i'}}\p{f}{x^j}\p{x^j}{x^{j'}}=
\frac{\partial^2f}{\partial x^i \partial x^j}\p{x^i}{x^{i'}}\p{x^j}{x^{j'}}+
\p{f}{x^j}\frac{\partial^2x^j}{\partial x^{i'} \partial x^{j'}}.
$$
Последнее слагаемое равно нулю, поскольку $P$ --- критическая точка. Итак, матрица вторых производных
задает в критической точке квадратичную форму $q_{ij}(P)$.

\textbf{Определение.} Критическая точка $P$ называется невырожденной, если форма $q_{ij}(P)$ 
невырождена.

\textbf{Определение.} Функция $f$ называется функцией Морса, если все ее критические точки невырождены.

\textbf{Определение.} Индексом критической точки $P$ называется число отрицательных собственных 
значений формы $q_{ij}(P)$.

\textbf{Лемма Морса.} Существует достаточно малая окрестность точки $P$ и такие локальные координаты
$y$ в этой окрестности, что в этих координатах $f=f(P)+\sum_{j=1}^n \eps_j y_j^2$, $\eps_j=\pm 1$.

\textbf{Доказательство.}
Пусть $f(P)=0$. Ясно,что общий случай лекго свести к этому. 
Запишем следующее тождество:
\begin{equation}
 f(x)=\int_0^1 \frac{d}{dt}f(tx)dt = \int_0^1 \p{f}{x_j}(tx)x_j dt=\sum_{j=1}^n x_j g_j(x).
\label{Mors}
\end{equation}
Здесь $g_j(x)=\p{f}{x_j}$. Поскольку точка $P$ --- критическая, $g_j(P)=0$. Это значит, что для нее также 
справедливо представление \ref{Mors}. Получаем
$$
 f(x)=\sum_i \sum_j h_{ij}(x)x_i x_j.
$$
При этом $h_{ij}(P)$ --- элементы матрицы $H$ вторых производных. Остается выделить полные квадраты.
Доказательство того, что это можно осуществить проводится по индукции. Пусть
функция $f$ уже приведена к виду 
$$
 f(y)=\pm(y_1)^2\pm\dots\pm(y_{k-1})^2+
	\sum_{\alpha,\beta\ge k}y_\alpha y_\beta H_{\alpha\beta}(y).
$$
Матрица вторых производных --- симметричная матрица. Это значит, что существует 
такая линейная замена переменных, что в одной точке (а именно в $P$) матрица 
вторых производных будет диагональной. Считаем, что координаты $y_i$ уже выбраны 
так. Это значит, что $H_{kk}(P)\ne 0$ в некоторой окрестности точки $P$.
Рассмотрим функцию $q(y)=\sqrt{|H_{kk}(y)|}$  и замену координат
\begin{gather*}
 z_i=y_i, i\ne k \\
 z_k=q(y)\left(y^k+\sum_{i > k} \frac{H_{ik}(y)}{H_{kk}(y)}\right).
\end{gather*}

В достаточно малой окрестности $z_i$ являются локальными координатами. Получаем,
что функция $f$ в новых координатах имеет вид
$$
 f(y)=\pm(z_1)^2\pm\dots\pm(z_{k})^2+
	\sum_{\alpha,\beta\ge k+1}z_\alpha z_\beta H_{\alpha\beta}(z).
$$ 
шаг индукции завершен.

