% File: eg_cyber.tex 
% Description: MathCyb 
% Processed: feb 2005 - nov 2006
% Version: 1
% Typesetting: epsgam
% Edited by:
% Native: Red Hat Linux 7.2
% Code: koi8-r
% Subversion: 0
%---------------------------------------------------------------------------------------------------------
\documentclass[12pt]{report}
\usepackage[T2A]{fontenc}
\usepackage[koi8-r]{inputenc}
\usepackage[russian,english]{babel}
\usepackage{amsmath,amsfonts,amssymb,amscd}
\usepackage{euscript}
\usepackage{caption2}
% 360pt def
\textwidth=380pt
% 568pt def
\textheight=590pt
\frenchspacing
\righthyphenmin=2
\sloppy
\emergencystretch=3pt
\unitlength=1mm

\makeatletter
 % section style rename
 \renewcommand{\section}{\@startsection{section}{1}{\parindent}%
 {3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}{\raggedright\Large\bf}}
 
 % chapter style rename
 \renewcommand{\@makechapterhead}[1]{%
  \vspace*{50 pt}
  {\parindent=0 pt%
   \raggedright \huge\bf
   Глава{} % 
    \thechapter \par 
    \vspace{20 pt} 
    \Huge \bf #1\par 
    \nopagebreak 
    \vspace{40 pt} 
  }    
 }
 
 % chapter* style rename
 \renewcommand{\@makeschapterhead}[1]{%
  \vspace*{50 pt}%
  {\parindent=0pt 
  \raggedright 
    \Huge \bf #1\par 
    \nopagebreak 
    \vspace{40 pt}}}
 
\makeatother





\newcommand{\rf}{см. \!}
\newcommand{\Rf}{См. \!}
\newcommand{\etc }{т.~д. }
\newcommand{\ie }{т.~е. }
\newcommand{\const}{\rm const} 
\newcommand{\diag}{\rm diag} 
\newcommand{\real}{\rm Re\:} 
\newcommand{\rank}{\rm rank} 
\newcommand{\tr}{\rm tr} 
\newcommand{\grad}{\mathop{\rm grad}\nolimits} 



\begin{document} 
\Russian
\pagestyle{plain}


\renewcommand{\bibname}{Литература}
\renewcommand{\chaptername}{Глава}
\renewcommand{\thesection}{\S\;\thechapter.\arabic{section}.\!}
\renewcommand{\figurename}{Рис.}

\newtheorem{theorem}{Теорема}
\renewcommand{\thetheorem}{\arabic{theorem}.}
\newtheorem{pro}{Утверждение}
\renewcommand{\thepro}{\arabic{pro}.}
\newtheorem{lemma}{Лемма}
\renewcommand{\thelemma}{\arabic{lemma}.}
\newtheorem{corollary}{Следствие}
\renewcommand{\thecorollary}{\arabic{corollary}.}

\begin{titlepage}
\begin{center}
{$\rightrightarrows$}

\vspace{3cm}

{\Large\bf О.~Б.~Лупанов}

\vspace{2cm}

{\Huge\bfЭлементы математической}

\bigskip

{\Huge\bfкибернетики}

\vspace{2cm}

\vspace{2cm}

Конспект лекций\\
\bigskip
Версия 1.0

\vspace{4cm}

% epsgam logo ---------------------------------------------
\begin{center}
\begin{picture}(10,15)
 \put(3,10){\large$\varepsilon$}
 \put(5,8){$\gamma$}
\end{picture}
\end{center}
% epsgam logo ---------------------------------------------

\end{center}
\end{titlepage}


\begin{flushright}
\it
Памяти\\
Олега Борисовича\\
Лупанова
\end{flushright}

% preface
\section*{Предисловие к версии 1.0}
Данный конспект подготовлен на основе записей лекций одноименного курса 
естественно--научного содержания, который был прочитан автором осенью 2003 года.

Деление текста на главы и параграфы, теоремы и утверждения, примеры и доказательства 
во многом условно. 
Этому есть две причины. Во--первых, в оригинале изложение практически не структурировалось,
а во--вторых, несколько лекций указанного курса в порядке замены читал Н.~П.~Редькин,
поэтому и для удобства изучения, и для приведения к единому стилю (так, например,
у одного лектора тест был набором строк, а у другого~--- набором столбцов матрицы с 
закономерным транспонированием всего куска текста, посвященного тестам) были
сделаны некоторые перестановки и переименования. Схемы, корректирующиеся относительно
замыкания/размыкания, были отнесены к теме о контроле работы схем вообще.

В приложении приведены определения некоторых редко встречающихся (в том числе и в 
этом повествовании) отношений и задачи, предлагавшиеся на экзамене. Коллекция, как видно, пока невелика.
Приведена также программа курса по состоянию на 2003--2004 учебный год.
Замечания и дополнения активно приветствуются здесь: epsgam@yandex.ru.

Искренняя благодарность Диме Алашкевичу, любезно предоставившему в свое время
записи первой лекции, сдуру прогулянной мной по случаю первого сентября.

\begin{flushright}
\it
Юрий "epsgam" Епишин,\\
Зеленоград, ноябрь 2006
\end{flushright}

%1
\chapter{Дизъюнктивные нормальные формы}
%
\section{Основные понятия}
Будем называть выражение ${x^{\sigma_1}_{i_1}\&x^{\sigma_2}_{i_2}\&\, \cdots \&\,x^{\sigma_k}_{i_k}}$
{\itэлементарной конъюнкцией,} если все ${i_1, \ldots, i_k}$ различны, в противном случае~--- 
{\itобобщенной конъюнкцией.} Так, например, допускается обобщенная конъюнкция вида $x_i \overline{x_i}$.
Считаем, $1$~--- конъюнкция длины нуль.

{\itДизъюнктивная нормальная форма (ДНФ)}~--- дизъюнкция попарно различных конъюнкций
(в таком случае, $x_1 x_2 \lor x_2 x_1$ ДНФ не является). {\itОбобщенная ДНФ}~--- дизъюнкция
обобщенных конъюнкций (слагаемые могут повторяться). {\itПустая ДНФ\/} тождественно равна нулю.
Определим {\itсовершенную ДНФ\/} булевой функции $f(x_1, \ldots, x_n)$ как разложение
$$
{
  \bigvee\limits_{\substack{
    (\sigma_1, \ldots, \sigma_n),\\
    f(\sigma_1, \ldots, \sigma_n)=1}}
   x^{\sigma_1}_1 \& \cdots \& x^{\sigma_n}_n.
}
$$
Рассмотрим сложности ДНФ:

1) $L_D(F)$~--- число символов переменных в ДНФ $F$. Например, ${L_D(x_1 x_2) = 2}$.
Если $F$~--- пустая ДНФ (или тождественно равная $1$), то ${L_D(F) = 0}$.
Так, ${L_D(F_1) = 5}$ для ${F_1 = x_1 x_2 \lor x_2 x_3 \lor x_4}$;

2) $L'_D(F)$~--- число слагаемых в ДНФ. Например, ${L'_D(F_1) = 3}$.
Если $F$~--- пустая ДНФ, то ${L'_D(F) = 0}$, однако ${L'_D(1) = 1}$.
 

\begin{pro}
Пусть $F'$~--- обобщенная ДНФ. Тогда существует такая ДНФ $F$, что:

1) $F$ и $F'$ эквивалентны, \ie реализуют одну и ту же функцию;

2) ${L_D(F) \leqslant L_D(F')}$, и ${L'_D(F) \leqslant L'_D(F')}$.
\end{pro}
{\bfДоказательство} основывается на правилах упрощения типа ${x_i\overline{x_i} = 0}$,
${K \lor K = K}$.

Обозначим ${L_D(f) = \min\limits_{F(f)} L_D(F)}$. Здесь минимум берется по всем ДНФ $F$,
реализующим булеву функцию $f$. Затем ${L_D(n) = \max\limits_{f(x_1, \ldots, x_n)} L_D(f)}$.
Аналогично вводятся $L'_D(f)$ и $L'_D(n)$. 


\begin{theorem}
${L'_D(n) = 2^{n-1}}$, 
\quad
${L_D(n) = n 2^{n-1}}$. 
\end{theorem}
{\bfДоказательство.} Справедлива следующая
\begin{lemma}
Для любой функции $f(x_1, \ldots, x_n)$ существует ДНФ $F$ такая, что ${L'_D(F) \leqslant 2^{n-1}}$.
\end{lemma}
{\bfДокажем} индукцией по $n$. Пусть ${n=1}$. Все функции одной переменной таковы: $0, 1, x, \overline{x}$, 
и для них выполнено ${L'_D(F) \leqslant 1}$. Допустим, что неравенство справедливо для $n$. Покажем,
что оно справедливо и для $n+1$:
$$
{
 f(x_1, \ldots, x_n, x_{n+1}) = 
  x_{n+1} f(x_1, \ldots, x_n, 1) \lor \overline{x_{n+1}} f(x_1, \ldots, x_n, 0)
}
.
$$
По предположению индукции для функций $f(x_1, \ldots, x_n, 1)$ и $f(x_1, \ldots, x_n, 1)$ найдутся ДНФ 
с числом слагаемых, не превышающим $2^{n-1}$. Поэтому сложность ДНФ функции $f(x_1, \ldots, x_n, x_{n+1})$
будет максимум вдвое больше, не превысив тем самым $2^n$. Лемма доказана.

Вернемся к доказательству теоремы. Из утверждения леммы следует, что 
${L'_D(f) \leqslant 2^{n-1}}$, поэтому для другой меры сложности справедлива
оценка ${L_D(f) \leqslant n2^{n-1}}$. Далее соответственно
$$
{
 L'_D(n) \leqslant 2^{n-1}, 
 \quad
 L_D(n) \leqslant n2^{n-1}
}
.
$$
Чтобы доказать теорему, осталось найти такую функцию, на которой достигается равенство.
Рассмотрим, например, 
$$
  l_n(x_1, \ldots, x_n) = x_1 \oplus \cdots \oplus x_n.
$$ 
На соседних наборах $l_n$
принимает различные значения, значит каждое слагаемое в ДНФ должно содержать все переменные.
Ну а поскольку единиц у функции $l_n$ ровно $2^{n-1}$, то ${L'_D(l_n) = 2^{n-1}}$ и 
${L_D(l_n) = n2^{n-1}}$. Теорема доказана.

Введем несколько определений.
{\itМинимальной ДНФ\/} для функции $f$ будем называть ту ДНФ, на которой достигается величина $L_D(f)$.
Определим также: конъюнкция $K$ {\itдопустима\/} для функции $f$, если ${K \leqslant f}$;
конъюнкция $K$ {\itминимальна\/} для функции $f$, если она допустима для $f$, но при удалении любого 
множителя перестает быть допустимой. Таким образом, минимальная ДНФ состоит только из минимальных 
конъюнкций. {\itТупиковая ДНФ\/} для функции $f$ состоит только из минимальных конъюнкций, но при 
удалении любой конъюнкции перестает реализовывать $f$. Так, минимальная ДНФ является тупиковой.
А~{\itсокращенная ДНФ\/} для функции $f$ состоит из {\bfвсех} минимальных конъюнкций функции $f$. 

Пусть $N_f$~--- множество наборов, на которых функция $f$ принимает единичные значения.
С~геометрической точки зрения это определенное множество вершин $n$--мерного куба.
В~таком случае конъюнкции ${K = x^{\sigma_1}_{i_1} \cdots x^{\sigma_k}_{i_k}}$ будет
соответствовать подкуб размерности $(n-k)$, то есть ${N_K \subseteq N_f}$.
Если $K$ еще и минимальна, то подкуб будет максимальной размерности.


Важно получить для каждой конкретной функции список всех минимальных ДНФ. Построить минимальную
конъюнкцию можно следующим способом: если ${f(\tilde\sigma) = 1}$, 
где ${\tilde\sigma = (\sigma_1, \ldots, \sigma_n)}$, то конъюнкция 
$x^{\sigma_1}_1 \cdots x^{\sigma_n}_n$ допустима для $f$. Вычеркивая переменные до тех пор пока 
конъюнкция не перестанет быть допустимой, придем к минимальной конъюнкции.

Рассмотрим некоторые примеры.

1. Пусть
$$
\varphi(x_1, x_2, x_3) = 
\left\{
 \begin{array}{cl}
   0, & \: (x_1, x_2, x_3) = (0,0,0), (1,1,1), \\
   1, & \: (x_1, x_2, x_3) \ne (0,0,0), (1,1,1) . 
 \end{array}
\right.
$$
Минимальными конъюнкциями (см.~рис.~1) будут ${K_1 = \overline{x_1} x_3}$,  ${K_2 = \overline{x_1} x_2}$, 
${K_3 = x_2 \overline{x_3}}$, ${K_4 = x_1 \overline{x_3}}$, ${K_5 = x_1 \overline{x_2}}$, 
${K_6 = \overline{x_2} x_3}$. Тупиковые (но не минимальные) ДНФ: 
${K_1 \lor K_3 \lor K_4 \lor K_6}$, ${K_1 \lor K_2 \lor K_4 \lor K_5}$, ${K_2 \lor K_3 \lor K_5 \lor K_6}$.
А~минимальными ДНФ на равных условиях являются ${K_1 \lor K_3 \lor K_5}$ и ${K_2 \lor K_4 \lor K_6}$.

% figure 1
% check for black dots on the cube
\begin{figure}
 \begin{center}
 \begin{picture}(80,65)
 \put(10,3)
 {
  \begin{picture}(60,60)
   % bottom left
   \put(0,0){\line(1,0){40}}
   \put(0,0){\line(0,1){40}}
   \put(0,0){\line(2,1){20}}
   % top right
   \put(60,50){\line(-1,0){40}}
   \put(60,50){\line(0,-1){40}}
   \put(60,50){\line(-2,-1){20}}
   % particullary
   \thicklines
   \put(0,40){\line(1,0){40}}
   \put(0,40){\line(2,1){20}}
   \put(20,10){\line(1,0){40}}
   \put(20,10){\line(0,1){40}}
   \put(40,0){\line(0,1){40}}
   \put(40,0){\line(2,1){20}}
   % spots
   \put(0,40){\circle*{2}}
   \put(20,10){\circle*{2}}
   \put(20,50){\circle*{2}}
   \put(40,0){\circle*{2}}
   \put(40,40){\circle*{2}}
   \put(60,10){\circle*{2}}
   % labels
   \put(42,36){\sf\small(101)}  
   \put(42,-4){\sf\small(100)}  
   %    
   \put(62,52){\sf\small(111)}  
   \put(62,12){\sf\small(110)}  
   %
   \put(-10,42){\sf\small(001)}  
   \put(-10,-4){\sf\small(000)}  
   %
   \put(10,52){\sf\small(011)}  
   \put(10,12){\sf\small(010)}  
   %
   \put(5,46){\small $\sf K_1$}  
   \put(28,42){\small $\sf K_6$}  
   \put(15,29){\small $\sf K_2$}  
   \put(53,3){\small $\sf K_4$}  
   \put(28,6){\small $\sf K_3$}  
   \put(41,20){\small $\sf K_5$}  
   
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~1\end{center}
\end{figure}

2. Пусть
$$
{
 \psi(x_1, \ldots, x_n) = \varphi(x_1, x_2, x_3)\,l_{n-3}(x_4, \ldots, x_n)
 . 
}
$$
Функция $\psi$ принимает единичные значения только на таких наборах $(\sigma_1, \ldots, \sigma_n)$, что
${(\sigma_1, \sigma_2, \sigma_3) \ne (0,0,0), (1,1,1)}$, и среди $\sigma_4, \ldots, \sigma_n$ нечетное 
число единиц. Выделим трехмерные подкубы, зафиксировав последние $n-3$ переменные. \glqqЧетных\grqq{}
и \glqqнечетных\grqq{} подкубов будет по $2^{n-4}$ штук. Для каждого из нечетных трехмерных подкубов необходимо
произвести выбор среди двух минимальных и трех тупиковых ДНФ (см.~предыдущий пример). Значит, число
всех минимальных ДНФ функции $\psi$ составит $2^{2^{n-4}}$, а тупиковых~--- соответственно $5^{2^{n-4}}$.
А отношение количества тупиковых ДНФ к количеству минимальных будет 
$(5/2)^{2^{n-4}}$.

Вообще, если $m(f)$~--- число минимальных ДНФ функции $f$, а $t(f)$~--- число тупиковых ДНФ, 
и ${m(n) = \max\limits_{f(x_1, \ldots, x_n)} m(f)}$, ${t(n) = \max\limits_{f(x_1, \ldots, x_n)} t(f)}$,
то 
$$
{
 m(n) \geqslant 2^{2^{n-4}}, \quad t(n) \geqslant 5^{2^{n-4}} 
 .
}
$$
Обозначив ${\displaystyle h(f) = \frac{t(f)}{m(f)}}$ и ${h(n) = \max\limits_{f(x_1, \ldots, x_n)} h(f)}$,
получим, что справедлива оценка
$$
{
 h(n) \geqslant \left(\frac{5}{2}\right)^{2^{n-4}} 
 .
}
$$

%
\section{Преобразования ДНФ}
Будем придерживаться двух основных операций:

1) ${Kx \lor K\overline{x} = K}$, где $K$~--- конъюнкция;

2) ${K'x \lor K''\overline{x} \geqslant K'K''}$, где $K'$ и $K''$~--- конъюнкции. В~самом деле, 
${K'K'' = K'K''x \lor K'K''\overline{x} \leqslant K'x \lor K''\overline{x}}$.
Условимся говорить в этом случае, что конъюнкция $K'K''$ получена из $K'x$ и $K''\overline{x}$ 
в результате {\itобобщенного склеивания.}

Определим {\itпучок\/} $P_{\tilde\alpha}$ набора ${\tilde\alpha = (\alpha_1, \ldots, \alpha_n)} \in N_f$ 
как множество всех минимальных конъюнкций функции $f$, которые принимают единичные значения на наборе 
$\tilde\alpha$. Тогда 
$$
  \bigcup\limits_{\tilde\alpha \in N_f} P_{\tilde\alpha}
$$
есть множество всех минимальных конъюнкций функции $f$. 

Считаем, что конъюнкция $K$ {\itпоглощает\/} конъюнкцию $K'$, если ${K \geqslant K'}$. В~частности, если
${K = x^{\sigma_1}_{i_1} \cdots x^{\sigma_k}_{i_k}}$, то 
${K' = x^{\sigma_1}_{i_1} \cdots x^{\sigma_k}_{i_k} x^{\sigma_{k+1}}_{i_{k+1}} \cdots x^{\sigma_l}_{i_l}}$.

Назовем ДНФ ${F = K_1 \lor \ldots \lor K_s}$ {\itзамкнутой,} если для любых двух конъюнкций $K_i$ и $K_j$
из $F$,
к которым можно применить операцию обобщенного склеивания, полученная в результате конъюнкция поглощается
некоторой конъюнкцией $K_h$ из $F$, \ie ${K_i = K'x}$, ${K_j = K''\overline{x}}$, и  
${K'K'' \leqslant K_h}$.

Например, ДНФ ${x_1 x_2 \lor \overline{x_1} x_3 \lor x_2 x_3}$ замкнута, поскольку 
$$
  x_1 x_2 \lor \overline{x_1} x_3 \geqslant x_2 x_3.
$$

\begin{pro}[основная лемма о замкнутой ДНФ]
Пусть ДНФ ${F = K_1 \lor \cdots \lor K_s}$ функции $f(x_1, \ldots, x_n)$ замкнута. 
Тогда для любой допустимой конъюнкции $K$ функции $f$ существует такая конъюнкция $K_i$ из $F$, что
${K \leqslant K_i}$.
\end{pro}
{\bfДокажем} методом \glqqот противного\grqq{}. Предположим, что $K$ не поглощается конъюнкцией из $F$.
Пусть ${{\mathfrak M} = \{K'_1, \ldots, K'_z\}}$~--- множество конъюнкций, обладающих свойствами: 
1) они содержат только $x_1, \ldots, x_n$; 
2) ${K'_j \leqslant K}$, ${j = \overline{1,z}}$;
3) всякая $K'_j$ не поглощается никакой $K_i$ из $F$. Множество ${\mathfrak M}$ непусто, так как содержит $K$. 
Выберем в ${\mathfrak M}$ конъюнкцию $K^\circ$ наибольшей длины. Покажем, что $K^\circ$ не содержит некоторую 
переменную $x_l$, ${l \in \overline{1,n}}$. В~самом деле, допустим, что это не так, и 
${K^\circ = x^{\alpha_1}_1 \cdots x^{\alpha_n}_n}$. Но тогда ${f(\alpha_1, \ldots, \alpha_n) = 1}$,
поскольку ${K^\circ \geqslant K_i}$, ${i = \overline{1,n}}$ по свойству 3 множества ${\mathfrak M}$.
А~значит найдется такая конъюнкция $K_j$, ${j \in \overline{1,n}}$, что 
${K_j(\alpha_1, \ldots, \alpha_n) = 1}$, и так как она заведомо не большей длины, чем $K^\circ$, то 
${K^\circ \leqslant K_j}$. Это противоречит свойству 3 множества ${\mathfrak M}$. 
Итак, $K^\circ$ не содержит $x_l$. 

Конъюнкция $K^\circ x_l$ из--за большей длины не принадлежит множеству ${\mathfrak M}$, однако свойства 1 и 2
выполнены, поскольку ${K^\circ x_l \leqslant K^\circ \leqslant K}$. Следовательно, не должно выполняться 
свойство 3, то есть ${K^\circ x_l \leqslant K_i}$ для
некоторой ${K_i \in {\mathfrak M}}$. Покажем, что $K_i$ содержит $x_l$. Если допустить, что это не так, то
$K^\circ$ будет поглощаться конъюнкцией $K_i$, ведь ${K^\circ x_l \leqslant K_i}$. Выходит, что 
${K_i = K' x_l}$.

Аналогично, ${K^\circ \overline{x_l} \not\in {\mathfrak M}}$, и ${K^\circ \overline{x_l} \leqslant K_j}$ для
некоторой ${K_j \in {\mathfrak M}}$. Затем так же приходим к ${K_j = K'' \overline{x_l}}$.

Применим теперь операцию обобщенного склеивания к $K_i$ и $K_j$: ${K'K'' \leqslant K_h}$ для
некоторого ${K_h \in F}$ в силу замкнутости $F$. А~так как ${K^\circ \leqslant K'}$ и
${K^\circ \leqslant K''}$, то ${K^\circ \leqslant K'K'' \leqslant K_h}$, то есть $K^\circ$  
поглощается некоторой $K_h$ из $F$. Противоречие с построением множества $\mathfrak M$. Утверждение доказано.

На основе следующей теоремы можно построить алгоритм поиска сокращенной ДНФ.

\begin{theorem}
Замкнутая ДНФ $F$ функции $f$ содержит {\bfвсе} минимальные конъюнкции функции $f$.
\end{theorem}
{\bfДоказательство.} Пусть ${F = K_1 \lor \cdots \lor K_s}$ cостоит из минимальных конъюнкций и допустим, 
$K$~--- минимальная конъюнкция функции $f$, не входящая в $F$. Согласно основной лемме о
замкнутой ДНФ $K$ поглощается некоторой $K_i$ из $F$. В силу минимальности $K_i$ получим,
что ${K = K_i}$. Теорема доказана.

Аналогично ДНФ определяется и {\itКНФ~--- конъюнктивная нормальная форма:}
${D_1 \& \cdots \& D_s}$, где дизъюнкции 
${D_i = x_{i1}^{\sigma_{i1}} \lor \cdots \lor x_{ik}^{\sigma_{ik}}}$.

\begin{pro}
При раскрытии скобок в произвольной КНФ получается обобщенная замкнутая ДНФ.
\end{pro}
{\bfСхема доказательства.}
Рассмотрим типичную ситуацию при перемножении скобок:
выражение вида ${K'x_i \lor K''\overline{x_i}}$, где ${K' = x_j^{\sigma} \tilde K}$ и 
${K'' = x_h^{\tau} \Hat K}$, может быть получено из
${(x_i \lor x_h^{\tau} \cdots)\&(\overline{x_i} \lor x_j^{\sigma} \cdots)}$.
Результат обобщенного склеивания $x_j^{\sigma} \tilde K x_h^{\tau} \Hat K$ будет
полгощаться, например, конъюнкцией $x_j^{\sigma} x_h^{\tau} \tilde K$. Так получим
замкнутую ДНФ.

Обратимся снова к терминологии. Будем говорить, что минимальная конъюнкция $K$ функции $f$ входит
в {\itядро\/} функции $f$, если существует набор $\tilde\alpha$ из $N_f$ такой, что $K$~--- единственная
минимальная конъюнкция функции $f$, обращающаяся в 1 на наборе $\tilde\alpha$.

Определим так называемый тип {\itсуммы тупиковых\/} ($\Sigma T$). $\Sigma T$~--- дизъюнкция
минимальных конъюнкций, входящих хотя бы в одну тупиковую ДНФ данной функции.

Пусть $K$~--- минимальная конъюнкция функции $f(x_1, \ldots, x_n)$, набор $\tilde\alpha$ таков, что
${K(\tilde\alpha) = 1}$. Будем называть $\tilde\alpha$ {\itрегулярным\/} относительно $K$,
если существует набор ${\tilde\beta_{\alpha} \in N_f}$, но ${K(\tilde\beta_{\alpha}) = 0}$, что
${P_\alpha \subseteq P_{\beta_\alpha}}$. Минимальная конъюнкция $K$ называется {\itрегулярной,} 
если любой набор $\tilde\alpha$ для которого ${K(\tilde\alpha) = 1}$, регулярен относительно $K$.

\begin{theorem}
Конъюнкция $K$ не входит в ДНФ типа $\Sigma T$ тогда и только тогда, когда $K$ регулярна.
\end{theorem} 
{\bfДоказательство.}
1. Пусть $K$ регулярна. Это означает, что для любого набора ${\tilde\alpha \in N_K}$, существует
такой набор ${\tilde\beta_{\alpha} \in N_f}$, ${\tilde\beta_{\alpha} \not\in N_K}$, что
${P_\alpha \subseteq P_{\beta_\alpha}}$. Допустим, что $K$ входит в ДНФ типа $\Sigma T$. Пусть
эта тупиковая ДНФ такова: ${K \lor K^{(1)} \lor \cdots \lor K^{(l)}}$. Из связи между пучками
наборов $\tilde\alpha$ и $\tilde\beta_\alpha$ следует, что среди $K, K^{(1)}, \ldots, K^{(l)}$ 
обязана существовать такая конъюнкция $K_{(\alpha)}$, что 
${K_{(\alpha)}(\tilde\alpha) = 1}$, ${K_{(\alpha)}(\tilde\beta_\alpha) = 1}$, причем отличная 
от $K$, так как ${K(\tilde\beta_\alpha) \ne 1}$. Таким образом, каждый набор $\tilde\alpha$ будет
\glqqобслуживаться\grqq{}, кроме собственно $K$, еще и некоторой конъюнкцией из $K^{(1)}, \ldots, K^{(l)}$.
Значит, если удалить $K$, то ДНФ будет по--прежнему реализовывать ту же функцию. Это противоречит
тупиковости ДНФ. Следовательно, $K$ не входит в ДНФ типа $\Sigma T$.

2. Пусть $K$ нерегулярна. Это означает, что существует такой нерегулярный относительно $K$ набор 
$\tilde\alpha$, что ${K(\tilde\alpha) = 1}$. Нерегулярность набора $\tilde\alpha$ в свою очередь 
подразумевает, что для любого такого набора ${\tilde\beta \in N_f}$, что ${K(\tilde\beta) = 0}$,
можно указать конъюнкцию ${K_{(\beta)} \in P_{\beta_\alpha}}$, которая обращается в нуль на наборе 
$\tilde\alpha$. Построим ДНФ следующим образом: для каждого такого набора ${\tilde\beta \in N_f}$, 
что ${K(\tilde\beta) = 0}$, образуем такую конъюнкцию $K_{(\beta)}$, что 
${K_{(\beta)}(\tilde\beta) = 1}$, ${K_{(\beta)}(\tilde\alpha) = 0}$. Затем возьмем дизъюнкцию
конъюнкций $K_{(\beta)}$ и конъюнкции $K$. Если из полученной ДНФ и можно удалять конъюнкции,
сохраняя при этом реализуемую функцию, то только отличные от $K$, так как это единственная 
конъюнкция, принимающая единичное значение на наборе $\tilde\alpha$. В~итоге получится ДНФ 
типа $\Sigma T$. 
Теорема доказана.

Рассмотрим конъюнкцию $K$ функции $f$ и множество всех таких минимальных конъюнкций $K'$ функции $f$, 
для которых существует набор $\tilde\beta_{K'}$ такой, что ${K(\tilde\beta_{K'}) = 1}$ и
${K'(\tilde\beta_{K'}) = 1}$. Это множество конъюнкций называется {\itокрестностью ранга 1\/} конъюнкции $K$.
Будем обозначать эту 1--окрестность через $U_K^{(1)}$.
 
К~примеру, для функции ${f = K_1 \lor K_2 \lor K_3}$, где ${K_1 = x_1 x_2}$, ${K_2 = \overline{x_1} x_3}$,
${K_3 = x_2 x_3}$, $K_3$ входит в 1--окрестность $K_1$, а в 1--окрестность $K_3$ входят $K_1$ и $K_2$.

{\itОкрестность ранга\/} $r$ определим по индукции: допустим, определена $U_K^{(r-1)}$, тогда
$$
{
  \displaystyle U_K^{(r)} = \bigcup\limits_{K' \in U_K^{(r-1)}} U_{K'}^{(1)}.
}
$$

Так, если в последнем примере ${U_{K_1}^{(1)} = \{K_1, K_3\}}$, то уже ${U_{K_1}^{(2)} = \{K_1, K_3, K_2\}}$.

Возможна ситуация, когда на каждом новом шаге новых конъюнкций не появляется. Для выяснения регулярности
конъюнкции необходимо знать ее окрестность ранга 2~--- это локальная процедура. А~вот задача о
вхождении произвольной конъюнкции в сумму минимальных конъюнкций нелокальна.

Рассмотрим, например, функцию $f(x_1, \ldots, x_n)$ с множеством $N_f$ вида цепи
$$
  \Tilde\alpha_0 = (0,0,0, \ldots, 0,0),
$$
$$
  \Tilde\alpha_1 = (1,0,0, \ldots, 0,0),
$$
$$
  \Tilde\alpha_2 = (1,1,0, \ldots, 0,0),
$$
$$
  \cdots
$$
$$
  \Tilde\alpha_{n-1} = (1,1,1, \ldots, 1,0),
$$
$$
  \Tilde\alpha_n = (1,1,1, \ldots, 1,1).
$$
Тогда ${K_1 = \overline{x_2}\overline{x_3}\cdots\overline{x_n}}$, 
${K_2 = \overline{x_1}\overline{x_3}\cdots\overline{x_n}}, \ldots,
{K_n = \overline{x_1}\overline{x_2}\cdots\overline{x_{n-1}}}$. 
Геометрическая интерпретация ДНФ представлена на рис.~2. Существует две возможности в зависимости от
четности $n$. Пусть ${n=2m-1}$. В~этом случае имеется только одна минимальная ДНФ, обслуживающая 
все $2m$ наборов: она состоит из конъюнкций с нечетными номерами. Покажем, что любая ДНФ, содержащая
конъюнкцию с четным номером, не будет минимальной.

% figure 2
% check for black dots on the cube
%\begin{figure}
 \begin{center}
 \begin{picture}(50,10)
 \put(-1,2)
 {
  \begin{picture}(50,10)
   % bottom left
   \put(0,0){\line(1,0){10}}
   \put(10,0){\line(1,0){10}}
   \put(20,0){\line(1,0){5}}
   \put(40,0){\line(-1,0){5}}
   \put(50,0){\line(-1,0){10}}
   % spots
   \put(0,0){\circle*{1}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle*{1}}
   \put(40,0){\circle*{1}}
   \put(50,0){\circle*{1}}
   % labels
   \put(-1,-4){\small $\Tilde\alpha_0$}  
   \put(9,-4){\small $\Tilde\alpha_1$}  
   \put(19,-4){\small $\Tilde\alpha_2$}  
   \put(37,-4){\small $\Tilde\alpha_{n-1}$}  
   \put(49,-4){\small $\Tilde\alpha_n$}  
   %
   \put(28,-1){\small $\cdots$}  
   %
   \put(3,1){\small $K_1$}  
   \put(13,1){\small $K_2$}  
   \put(43,1){\small $K_n$}  
   
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~2\end{center}
%\end{figure}

Допустим, что это не так, и конъюнкция $K_{2t}$ входит в минимальную ДНФ. Конъюнкция $K_{2t}$ обслуживает
наборы $\Tilde\alpha_{2t-1}$ и $\Tilde\alpha_{2t}$. Наборы 
${\Tilde\alpha_0, \ldots, \Tilde\alpha_{2t-2}}$, 
располагающиеся до них, обслуживаются 
$$
  \left\lceil\frac{2t-1}{2}\right\rceil = t
$$
конъюнкциями, а наборы ${\Tilde\alpha_{2t+1}, \ldots, \Tilde\alpha_{2m-1}}$, располагающиеся
после, обслуживаются 
$$
  \left\lceil\frac{2m-2t-1}{2}\right\rceil = m-t
$$ 
конъюнкциями.
Следовательно, всего конъюнкций в ДНФ будет по крайней мере ${t + (m-1) + 1 = m+1}$. А~минимальная
ДНФ содержит их ровно $m$. Противоречие.

Но для выяснения вопроса четности $n$ необходимо дойти до ближайшего конца ДНФ.
Даже если рассматривать окрестности фиксированного ранга $r$, то ${n > 2r+2}$, и так установить
четность нельзя. Этим объясняется нелокальность данной задачи.

%
\section{Градиентный алгоритм построения минимальной ДНФ}
Пусть ${N_f = \{\Tilde\alpha_0, \ldots, \Tilde\alpha_s\}}$ и ${K_1, \ldots, K_t}$~--- минимальные
конъюнкции. Требуется минимизировать их количество. 
Построим матрицу ${A = (a_{ij})}$ с $t$ строками и $s$ столбцами так, что ${a_{ij} = K_i(\Tilde\alpha_j)}$.
Выберем строку матрицы $A$, которая содержит наибольшее число единиц. Пусть ее номер $i_0$.
Теперь вычеркнем из матрицы $i_0$--ю строку и столбцы, соответствующие наборам, обслуживающимся
конъюнкцией $K_{i_0}$. К~полученной матрице будем применять те же рассуждения пока возможно.
Это один из так называемых {\itжадных\/} алгоритмов.

Рассмотрим случай нерациональности градиентного алгоритма.
На рис.~3 изображена ситуация, когда множество $N_f$ представлено целиком $k$--мерным подкубом
и еще несколькими наборами, ему не принадлежащими. Жадный градиентный алгоритм в 
первую очередь начнет обрабатывать подкуб, хотя понятно, что можно сразу включить в минимальную
ДНФ конъюнкции, которые обслуживают наборы, не принадлежащие подкубу.

% figure 3
\begin{figure}
 \begin{center}
 \begin{picture}(60,35)
 \put(8,15)
 {
  \begin{picture}(40,35)
   % sub-cube
   \put(0,0){\line(2,1){20}}
   \put(0,0){\line(2,-1){20}}
   \put(40,0){\line(-2,1){20}}
   \put(40,0){\line(-2,-1){20}}
   % others
   \put(0,0){\line(0,1){10}}
   \put(40,0){\line(0,1){10}}
   \put(20,10){\line(2,1){10}}
   \put(20,-10){\line(2,-1){10}}
   % spots
   \put(0,0){\circle*{1}}
   \put(20,10){\circle*{1}}
   \put(20,-10){\circle*{1}}
   \put(40,0){\circle*{1}}
   \put(0,10){\circle*{1}}
   \put(40,10){\circle*{1}}
   \put(30,15){\circle*{1}}
   \put(30,-15){\circle*{1}}
   % labels
   \put(19,-1){${\mathbb E}_2^k$}  
   \put(-15,-2){\footnotesize $(1,1,0,0)$}  
   \put(41,-2){\footnotesize $(1,1,1,1)$}  
   \put(7,-14){\footnotesize $(1,1,0,1)$}  
   \put(7,13){\footnotesize $(1,1,1,0)$}  
   \put(-15,10){\footnotesize $(0,1,0,0)$}  
   \put(41,10){\footnotesize $(0,1,1,1)$}  
   \put(31,16){\footnotesize $(1,0,1,0)$}  
   \put(31,-16){\footnotesize $(1,0,0,1)$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~3\end{center}
\end{figure}


%
\section{Монотонные функции}
Установим отношение порядка следующим образом: 
$$
  (\alpha_0,\ldots,\alpha_n)=\Tilde\alpha \leqslant \Tilde\beta=(\beta_1,\ldots,\beta_n),
$$
если ${\alpha_i \leqslant \beta_i}$ для каждого ${i=\overline{1,n}}$. Для любого набора $\Tilde\alpha$
справедливо ${\Tilde 0 \leqslant \Tilde\alpha \leqslant \Tilde 1}$. Функция $f(x_1,\ldots,x_n)$ 
{\itмонотонна,} если для всех таких наборов $\Tilde\alpha$ и $\Tilde\beta$, что 
${\Tilde\alpha \leqslant \Tilde\beta}$, выполнено ${f(\Tilde\alpha) \leqslant f(\Tilde\beta)}$.
Будем рассматривать монотонные функции отличные от константы.

\begin{pro}
Всякая минимальная конъюнкция не содержит отрицаний переменных.
\end{pro}
{\bfСхема доказательства.}
Предположим, что $\overline{x_{i_k}}$ входит в минимальную конъюнкцию 
${x_{i_1}^{\sigma_1} \cdots \overline{x_{i_k}} \cdots x_{i_s}^{\sigma_s}}$ функции $f$.
Тогда если ${\Tilde\alpha = (\sigma_1, \ldots, 0, \ldots, \sigma_s)}$, то ${f(\Tilde\alpha) = 1}$.
Но ${\Tilde\alpha \leqslant \Tilde\alpha' = (\sigma_1, \ldots, 1, \ldots, \sigma_s)}$, значит
${f(\Tilde\alpha') = 1}$, и конъюнкция ${x_{i_1}^{\sigma_1} \cdots x_{i_k} \cdots x_{i_s}^{\sigma_s}}$
тоже допустима. Операция склеивания даст в результате
${x_{i_1}^{\sigma_1} \cdots x_{i_{k-1}}^{\sigma_{k-1}} x_{i_{k+1}}^{\sigma_{k+1}} \cdots x_{i_s}^{\sigma_s}}$.
Если отрицания в конъюнкции еще остались, удалим их таким же образом. 

\begin{pro}
Всякая минимальная конъюнкция входит в ядро функции.
\end{pro}
{\bfДоказательство.}
Пусть ${K = x_{i_1} \cdots x_{i_k}}$~--- некоторая минимальная конъюнкция. Согласно предыдущему
утверждению отрицаний в ней нет. Построим набор, на котором $K$ принимала бы единичное значение, а
все остальные минимальные конъюнкции~--- нулевое. Будем считать, что ${i_1 < \cdots < i_k}$.
Пусть двоичный набор $\Tilde\alpha$ таков, что в нем все позиции, кроме $i_1, \ldots, i_k$ нулевые.
Тогда, естественно, ${K(\Tilde\alpha) = 1}$. Возьмем любую другую минимальную конъюнкцию
${K' = x_{j_1} \cdots x_{j_s}}$. Покажем, что среди переменных $x_{j_1}$, $\ldots$, $x_{j_s}$ обязательно
найдется не входящая в ${x_{i_1}, \ldots, x_{i_k}}$. Это и будет означать, что ${K'(\Tilde\alpha) = 0}$.
Предположим противное: все переменные ${x_{j_1}, \ldots, x_{j_s}}$ входят в список 
${x_{i_1}, \ldots, x_{i_k}}$. Возможны два случая: либо эти наборы переменных просто совпадают,
чего не может быть, так как ${K \ne K'}$, либо включение строгое, что также приводит к противоречию,
поскольку в этом случае конъюнкцию $K'$ можно получить из $K$ удалением переменной, хотя $K$ минимальна.
Утверждение доказано.

{\footnotesize\bigskip
Таким образом, у монотонной функции сокращенная ДНФ (состоящая из всех минимальных конъюнкций)
является единственной минимальной. (У~линейной функции совершенная ДНФ есть одновременно
и сокращенная, и минимальная.)

}

%2
\chapter{Контактные схемы}
%
\section{Основные понятия}
Граф, в котором выделены некоторые вершины и ребрам которого приписана нагрузка, будем называть 
{\itконтактной схемой,} выделенные вершины~--- {\itполюсами\/} контактной схемы, а ребра~--- ее 
{\itконтактами.} Пусть $a$ и $b$~--- 
полюсы контактной схемы. Определим {\itфункцию проводимости\/} $f_{a,b}$ контактной схемы следующим образом:
${f_{a,b} = 1}$, если ${a = b}$; ${f_{a,b} = 0}$, если ${a \ne b}$, но нет цепей, соединяющих полюсы
$a$ и $b$; в остальных случаях $f_{a,b}$ есть дизъюнкция по всем цепям, соединяющим $a$ и $b$, конъюнкций 
символов, приписанных ребрам цепей.

Рассмотрим произвольную булеву функцию $f(x_1, \ldots, x_n)$. Если ${f \equiv 0}$, то сопоставим ей
контактную схему, состоящую только из отличных друг от друга полюсов $a$ и $b$ и не содержащую контактов.
Если ${f \not\equiv 0}$, то представим $f$ в виде совершенной ДНФ 
$$
{
  \bigvee\limits_{\substack{
    (\sigma_1, \ldots, \sigma_n),\\
    f(\sigma_1, \ldots, \sigma_n)=1}}
   x^{\sigma_1}_1 \cdots x^{\sigma_n}_n.
}
$$
Каждому слагаемому вида $x_1^{\sigma_1} \cdots x_n^{\sigma_n}$ поставим в соответствие цепь (\rf рис.~4),

% figure 4
%\begin{figure}
 \begin{center}
 \begin{picture}(52,8)
 \put(0,0)
 {
  \begin{picture}(51,8)
   % poles
   \put(5,3){\circle{2}}
   \put(16,3){\circle*{1}}
   \put(23,2){$\cdots$}  
   \put(36,3){\circle*{1}}
   \put(47,3){\circle{2}}
   % lines
   \put(6,3){\line(1,0){15}}
   \put(46,3){\line(-1,0){15}}
    % labels
   \put(1,3){\small $a$}  
   \put(49,3){\small $b$}  
   \put(9,5){\small $x_1^{\sigma_1}$}  
   \put(39,5){\small $x_n^{\sigma_n}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~4\end{center}
%\end{figure}

\noindent
а затем объединим все полученные цепи по полюсам $a$ и $b$. При этом функция проводимости $f_{a,b}$ будет
реализовывать функцию $f$. Следовательно, любая функция ${f \in P_2}$ реализуема контактной схемой.

Введем понятие сложности контактной схемы $S$. Сложностью $L_K(S)$ будем считать число контактов в $S$. 
Затем ${L_K(f) = \min\limits_{S(f)} L_K(S)}$ (здесь минимум берется по всем контактным схемам, реализующим
функцию $f$), и ${L_K(n) = \max\limits_{f(x_1, \ldots, x_n)} L_K(f)}$~--- функция Шеннона, оценивающая
наименьшее число контактов, с помощью которых можно реализовать контактную схему для любой $f$. 



%
\section{Оценки сложности контактных схем}
Совершенная ДНФ функции $f(x_1, \ldots, x_n)$ содержит не более $2^n$ слагаемых. Поэтому в контактной
схеме, реализующей функцию $f$, будет не более $n2^2$ контактов, \ie справедлива оценка
$$
 L_K(n) \leqslant n 2^n 
 .
 \eqno(1)
$$

Обозначим через $Q_n$ систему конъюнкций вида 
$$
  \{x_1^{\sigma_1} \cdots x_n^{\sigma_n} | (\sigma_1, \ldots, \sigma_n ) \in {\mathbb E}_N^2\}.
$$ 
Всего конъюнкций будет ${|Q_n| = 2^n}$. Построим контактную схему, реализующую $Q_n$,
и покажем, что ${L_K(Q_n) \leqslant 2^{n+1} - 2}$.

Пусть ${n=1}$: $x_1$ и $\overline{x_1}$ реализуются контактной схемой (\rf рис.~5)

% figure 5
%\begin{figure}
 \begin{center}
 \begin{picture}(19,18)
 \put(-3,0)
 {
  \begin{picture}(18,16)
   % poles
   \put(5,8){\circle{2}}
   \put(16,13){\circle{2}}
   \put(16,3){\circle{2}}
   % lines
   \put(6,9){\line(2,1){8}}
   \put(6,7){\line(2,-1){8}}
    % labels
   \put(1,7){\small $a$}  
   \put(18,13){\small $b_1$}  
   \put(18,1){\small $b_2$}  
   \put(9,13){\small $x_1$}  
   \put(9,1){\small $\overline{x_1}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~5\end{center}
%\end{figure}

\noindent
сложности 2. Предположим, что $Q_k$ реализованы до ${k = n - 1}$ включительно. Так, конъюнкция 
${x_2^{\sigma_2} \cdots x_n^{\sigma_n}}$ реализована схемой $S_1$ сложности не более ${2^n - 2}$.
Построим теперь схему $S$, реализующую $Q_n$, следующим образом. Возьмем два экземпляра схем $S_1$.
Занумеруем полюсы $b$ одной схемы как $b_1, \ldots, b_{2^{n-1}}$, а другой --- как
$b'_1, \ldots, b'_{2^{n-1}}$. Вершины, бывшие ранее полюсами $a$, соединим контактами 
$x_1$ и $\overline{x_1}$ с новым полюсом $a$ (\rf рис.~6). 
Оценим сложность: 
$$
 L_K(S) = 2 L_K(S_1) + 2 \leqslant 2 (2^n - 2) + 2 = 2^{n+1} - 2
 .
$$
Значит, ${L_K(Q_n) \leqslant 2^{n+1} - 2}$.

% figure 6
\begin{figure}
 \begin{center}
 \begin{picture}(50,50)
 % pole a
 \put(1,24){\small $a$}
 \put(6,25){\line(1,3){5}}
 \put(6,25){\line(1,-3){5}}
 \put(5,25){\circle{2}}
 \put(10,31){\small $x_1$}  
 \put(10,16){\small $\overline{x_1}$}  
 \put(20,24){$S$}  
 % upper S1 
 \put(10,30)
 {
  \begin{picture}(31,20)
   % lines - triangle
   \put(0,10){\line(2,1){20}}
   \put(0,10){\line(2,-1){20}}
   \put(20,0){\line(0,1){20}}
   % lines - outputs
   \put(20,3){\line(1,0){5}}
   \put(20,17){\line(1,0){5}}
   % poles
   \put(26,3){\circle{2}}
   \put(26,17){\circle{2}}
   \put(0,10){\circle*{1}}
    % labels
    % \put(-4,9){\small $a$}  
   \put(29,2){\small $b_{2^{n-1}}$}
   \put(29,16){\small $b_1$}    
   \put(23,9){$\vdots$}  
   \put(13,9){$S_1$}  
  \end{picture}
 } 
 % lower S1
 \put(10,0)
 {
  \begin{picture}(31,20)
   % lines - triangle
   \put(0,10){\line(2,1){20}}
   \put(0,10){\line(2,-1){20}}
   \put(20,0){\line(0,1){20}}
   % lines - outputs
   \put(20,3){\line(1,0){5}}
   \put(20,17){\line(1,0){5}}
   % poles
   \put(26,3){\circle{2}}
   \put(26,17){\circle{2}}
   \put(0,10){\circle*{1}}
    % labels
    % \put(-4,9){\small $a$}  
   \put(29,2){\small $b'_{2^{n-1}}$}
   \put(29,16){\small $b'_1$}    
   \put(23,9){$\vdots$}  
   \put(13,9){$S_1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~6\end{center}
\end{figure}

Построенная схема $S$ носит название {\itразделительного контактного дерева.} Функция проводимости
между его любыми двумя полюсами--выходами тождественно равна нулю.

Отметим в схеме $S$ те цепи, которые соответствуют конъюнкциям, содержащимся в совершенной ДНФ
функции $f(x_1, \ldots, x_n)$, их полюсы--выходы отождествим и обозначим через $b$. Тогда между 
полюсами $a$ и $b$ будет реализована функция $f$. Поэтому
$$
 L_K(n) \leqslant 2^{n+1} - 2 
 .
 \eqno(2)
$$

%
\section{Метод Шеннона}
\begin{theorem}
Справедлива более точная оценка:
$$
 L_K(n) \lesssim \frac{2^{n+2}}{n} 
 .
 \eqno(3)
$$
\end{theorem} 
{\bfДоказательство.} Пусть ${V_n = \{f(x_1, \ldots, x_n)| f \in P_2\}}$. Тогда ${|V_n| = 2^{2^n}}$.
\begin{lemma}
$$
 L_K(V_n) \leqslant 2\cdot2^{2^n}
 .
 \eqno(4)
$$
\end{lemma}
{\bfДоказательство леммы.} Рассмотрим две контактные схемы: $(1,k)$--полюсную $A$ и $(l,1)$--полюсную $B$.
Пусть $A$ реализует функцию $g_i(x_1, \ldots, x_n)$ между полюсами $a$ и $b_i$, а
$B$ реализует функцию $f_j(x_1, \ldots, x_n)$ между полюсами $d_j$ и $b$. Предполагаем также, что
схема $A$ обладает свойством разделительности, \ie ${g_{b',b''} \equiv 0}$ для любых различных $b'$ и $b''$.
Объединим схемы $A$ и $B$ следующим образом: $i$--й полюс--выход $A$ соединим с $j(i)$--м 
полюсом--входом $B$ (\rf рис.~7). Покажем, что в полученной таким образом контактной схеме $S$ 
функция проводимости будет ${\displaystyle f_{a,b}(x_1, \ldots, x_n) = \bigvee\limits_{i=1}^k g_i \& f_{j(i)}}$.

% figure 7
\begin{figure}
 \begin{center}
 \begin{picture}(100,30)
  % i -> j(i)    
 \qbezier(39,12)(49,17)(60,17)
 \put(48,20){$S$}  
 % lefter A 
 \put(0,0)
 {
  \begin{picture}(45,30)
   % lines - triangle
   \put(1,16){\line(2,1){29}}
   \put(1,14){\line(2,-1){29}}
   \put(30,0){\line(0,1){30}}
   % lines - outputs (from btm to top)
   \put(30,3){\line(1,0){5}}
   \put(30,12){\line(1,0){5}}
   \put(30,27){\line(1,0){5}}
   % curve (dotted)
   \qbezier[50](1,15)(20,20)(30,12)
   % poles
   \put(0,15){\circle{2}}
   \put(36,3){\circle{2}}
   \put(36,12){\circle{2}}
   \put(36,27){\circle{2}}
    % labels
   \put(-4,14){\small $a$}  
   \put(38,26){\small $b_1$}    
   \put(38,9){\small $b_i$}    
   \put(38,2){\small $b_k$}
   \put(33,18){\small $\vdots$}  
   \put(33,6){\small $\vdots$}  
   \put(21,8){$A$}  
  \end{picture}
 } 
 % righter B 
 \put(55,0)
 {
  \begin{picture}(45,30)
   % lines - triangle
   \put(39,16){\line(-2,1){29}}
   \put(39,14){\line(-2,-1){29}}
   \put(11,0){\line(0,1){30}}
   % lines - outputs (from btm to top)
   \put(11,3){\line(-1,0){5}}
   \put(11,17){\line(-1,0){5}}
   \put(11,27){\line(-1,0){5}}
   % curve (dotted)
   \qbezier[50](11,17)(20,5)(38,15)
   % poles
   \put(40,15){\circle{2}}
   \put(5,3){\circle{2}}
   \put(5,17){\circle{2}}
   \put(5,27){\circle{2}}
    % labels
   \put(42,14){\small $b$}  
   \put(0,26){\small $d_1$}    
   \put(0,13){\small $d_{j(i)}$}    
   \put(0,2){\small $d_l$}
   \put(7,20){\small $\vdots$}  
   \put(7,8){\small $\vdots$}  
   \put(21,15){$B$}  
  \end{picture}
 } 

 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~7\end{center}
\end{figure}

Поскольку схема $B$ свойством разделительности, вообще говоря, не обладает, возможны случаи, когда
в $B$ от $d_{j(i)}$ к $b$ ведет не одна цепь, когда есть возвраты в схему $A$ и \etc Но так как
схема $A$ является разделительной, то функция проводимости всей такой \glqqдлинной\grqq{} цепи
в итоге занулится. Однако можно разбить \glqqдлинную\grqq{} цепь на пары отрезков, целиком лежащих 
в $A$ и $B$, поэтому в логической сумме останутся только слагаемые вида ${g_i \& f_{j(i)}}$.

Вернемся к доказательству леммы. Докажем (4) по индукции. Пусть ${n = 1}$, и
${V_1 = \{0, 1, x, \overline{x}\}}$. Все функции из $V_1$ реализуемы контактной схемой, 
изображенной на рис.~8, 
% figure 8
%\begin{figure}
 \begin{center}
 \begin{picture}(40,15)
 \put(0,0)
 {
  \begin{picture}(40,15)
   % poles
   \put(5,10){\circle{2}}
   \put(15,10){\circle{2}}
   \put(25,10){\circle{2}}
   \put(35,10){\circle{2}}
   \put(20,0){\circle{2}}
   % lines
   \put(20,1){\line(1,2){4}}
   \put(21,1){\line(3,2){13}}
   \put(16,7){\vector(1,-2){3}}
    % labels
   \put(4,12){\small $0$}
   \put(14,12){\small $1$}
   \put(24,12){\small $x$}
   \put(34,12){\small $\overline{x}$}
   \put(20,6){\small $x$}
   \put(29,3){\small $\overline{x}$}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~8\end{center}
%\end{figure}

\noindent
сложности 2 (здесь между входом $1$ и полюсом--выходом нет контакта), значит (4) выполнено. 
Предположим, что (4) справедливо для всех размерностей,
которые меньше $n$, и функции от $n-1$ переменной реализует контактная схема $S_{n-1}$
с $2^{2^{n-1}}$ входами и одним выходом. Рассмотрим представление
$$
  f(x_1, \ldots, x_n) = x_n f(x_1, \ldots, x_{n-1}, 1) \lor \overline{x_n} f(x_1, \ldots, x_{n-1}, 0)
  .
$$

% figure 9
\begin{figure}
 \begin{center}
 \begin{picture}(65,30)
 % |>
 \put(0,0)
 {
  \begin{picture}(65,30)
   % lines - triangle
   \put(54,16){\line(-2,1){29}}
   \put(54,14){\line(-2,-1){29}}
   \put(26,0){\line(0,1){30}}
   % lines - from the new pole
   \put(6,15){\line(3,1){14}}
   \put(6,15){\line(3,-1){14}}
   % lines - outputs (from btm to top)
   \put(26,3){\line(-1,0){5}}
   \put(26,10){\line(-1,0){5}}
   \put(26,20){\line(-1,0){5}}
   \put(26,27){\line(-1,0){5}}
   % curve (dotted)
   \qbezier[50](26,10)(35,5)(54,15)
   \qbezier[50](26,20)(40,9)(54,15)
   % poles
   \put(5,15){\circle{2}}
   \put(55,15){\circle{2}}
   \put(20,3){\circle{2}}
   \put(20,10){\circle*{1}}
   \put(20,20){\circle*{1}}
   \put(20,27){\circle{2}}
    % labels
   \put(27,21){\scriptsize $f(\Tilde x, 1)$}    
   \put(27,11){\scriptsize $f(\Tilde x, 0)$}
   \put(22,5){\small $\vdots$}  
   \put(22,13){\small $\vdots$}  
   \put(22,22){\small $\vdots$}  
   \put(41,15){$S_{n-1}$}  
   \put(10,19){\small $x_n$}  
   \put(10,9){\small $\overline{x_n}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~9\end{center}
\end{figure}

Добавим к $S_{n-1}$ еще один полюс и соединим его контактами $x_n$ и $\overline{x_n}$ со входами, 
отвечающими функциям ${f(\Tilde x, 1) = f(x_1, \ldots, x_{n-1}, 1)}$ и
${f(\Tilde x, 0) = f(x_1, \ldots, x_{n-1}, 0)}$ соответственно. Полученная контактная схема $S$ 
(\rf рис.~9) будет
реализовывать функцию $f(x_1, \ldots, x_n)$. Оценим ее сложность. Добавленных контактов~--- по два
на каждую функцию из $V_n$. Если ${f(\Tilde x, 1) \equiv 0}$,
то контакт $x_n$ можно не добавлять в схему. Всего таких возможностей $2^{2^{n-1}}$ (количество
функций от $n-1$ переменной). Аналогично для $f(\Tilde x, 0)$. Итого удастся сэкономить 
$2\cdot2^{2^{n-1}}$ контактов. Итак, верхняя оценка сложности схемы $S$ складывается из 
оценки сложности $S_{n-1}$ и числа добавленных контактов за исключением сэкономленных:
$$
 L_K(S) \leqslant 2 \cdot 2^{2^{n-1}} + 2 \cdot 2^{2^n} - 2 \cdot 2^{2^{n-1}} = 2 \cdot 2^{2^n}
 .
$$
Лемма доказана.

Вернемся к доказательству теоремы. Рассмотрим функцию $f(x_1, \ldots, x_n)$.
Зафиксируем произвольное $k$.
Разложим функцию $f$ по группе переменных набора ${(x_1, \ldots, x_{n-k}, x_{n-k+1}, \ldots, x_n)}$:
$$
 f = \bigvee\limits_{(\sigma_1, \ldots, \sigma_{n-k})} 
 x_1^{\sigma_1} \cdots x_{n-k}^{\sigma_{n-k}} f(\sigma_1, \ldots, \sigma_{n-k}, x_{n-k+1}, \ldots, x_n)
 .
$$
По переменным ${(x_1, \ldots, x_{n-k})}$ построим $(1, 2^{n-k})$--полюсное 
разделительное контактное дерево $S_1$, а по ${(x_{n-k+1}, \ldots, x_n)}$ построим $(2^{2^k}, 1)$--полюсную
контактную схему $S_2$, реализующую $V_k$. Соединим, полюсы--выходы $S_1$ с полюсами--входами $S_2$ так,
чтобы цепь, реализующая ${x_1^{\sigma_1} \cdots x_{n-k}^{\sigma_{n-k}}}$, оказалась соединенной с цепью, 
реализующей ${f(\sigma_1, \ldots, \sigma_{n-k}, x_{n-k+1}, \ldots, x_n)}$. Согласно установленному выше,
функцией проводимости полученной схемы $\Hat S$ будет функция ${f(x_1, \ldots, x_n)}$. Из оценок (2) и (4)
получим:
$$
 L_K(\Hat S) \leqslant 2^{n-k+1} - 2 + 2 \cdot 2^{2^k}
 .
$$
В~качестве $k$ выберем ${\lfloor\log_2 (n - 2\log_2 n)\rfloor}$. Тогда
$$
 2^{n-k+1} - 2 + 2 \cdot 2^{2^k} < \frac{2^{n+2}}{n - 2\log_2 n} - 2 + \frac{2^{n+1}}{n^2}
 .
$$
При ${n \to \infty}$ правая часть мажорируется величиной ${\displaystyle\frac{2^{n+2}}{n}}$.
Теорема доказана.


% par
\section{Случай неразделительных схем}
Введем понятие {\itрасстояния\/} между наборами. Если ${\Tilde\alpha = (\alpha_1, \ldots, \alpha_q)}$ и
${\Tilde\beta = (\beta_1, \ldots, \beta_q)}$, то $\rho(\Tilde\alpha, \Tilde\beta)$~--- число разрядов,
по которым отличаются $\Tilde\alpha$ и $\Tilde\beta$. {\itЕдиничный шар\/} с центром в $\Tilde\alpha_0$~--- это
множество всех таких наборов  $\Tilde\alpha$, что ${\rho(\Tilde\alpha, \Tilde\alpha_0) \leqslant 1}$, \ie
единичный шар содержит ровно $q+1$ наборов. {\itЕдиничная сфера\/} с центром в $\Tilde\alpha_0$~--- это
соответственно множество всех таких наборов $\Tilde\alpha$, что ${\rho(\Tilde\alpha, \Tilde\alpha_0) = 1}$.
Из теории кодирования известно, что множество всех наборов длины ${2^t - 1}$ можно разбить на
попарно не пересекающиеся единичные шары.
\begin{lemma}
Если ${r = 2^t}$, то множество всех наборов длины $r$ можно разбить на попарно не пересекающиеся
единичные сферы.
\end{lemma}
{\bfДоказательство.} Разобьем множество наборов длины $r-1$ на попарно не пересекающиеся единичные шары.
Пусть ${\Tilde\alpha' = (\alpha_1, \ldots, \alpha_{r-1})}$~--- центр одного из шаров. Образуем центры сфер
${\Tilde\alpha'_0 = (\alpha_1, \ldots, \alpha_{r-1}, 0)}$ и 
${\Tilde\alpha'_1 = (\alpha_1, \ldots, \alpha_{r-1}, 1)}$. Если центров шаров было 
${2^{r-1}}/r$, то центров сфер будет вдвое больше: ${2^r}/r$.
Покажем, что единичные сферы с центрами в $\Tilde\alpha'_0$ и $\Tilde\alpha'_1$, во--первых, попарно не 
пересекаются, а во-вторых, каждый набор длины $r$ попадает в какую--либо сферу.

1) Существует две возможности: а) центры сфер образованы из центров различных шаров и б) центры сфер
образованы из центра одного и того же шара. Рассмотрим случай а). Пусть центры шаров
${\Tilde\alpha' = (\alpha_1, \ldots, \alpha_{r-1})}$ и ${\Tilde\beta' = (\beta_1, \ldots, \beta_{r-1})}$,
${\Tilde\alpha' \ne \Tilde\beta'}$. Тогда ${\rho(\Tilde\alpha', \Tilde\beta') \geqslant 3}$, поскольку
единичные шары по условию не пересекаются. И~если $\Tilde\alpha''$, $\Tilde\beta''$~--- центры сфер,
совпадающие с $\Tilde\alpha'$ и $\Tilde\beta'$ по первым ${r-1}$ компонентам,
то и подавно ${\rho(\Tilde\alpha'', \Tilde\beta'') \geqslant 3}$, откуда следует, что сферы не пересекаются. 

Рассмотрим случай б). Пусть центры сфер
${(\alpha_1, \ldots, \alpha_{r-1}, 0)}$ и ${(\alpha_1, \ldots, \alpha_{r-1}, 1)}$. Перечислим все наборы,
которые попадут в эти сферы:
$$
  (\overline{\alpha_1}, \alpha_2, \ldots, \alpha_{r-1}, 0), \quad (\overline{\alpha_1}, \alpha_2, \ldots, \alpha_{r-1}, 1),
$$
$$
  (\alpha_1, \overline{\alpha_2}, \ldots, \alpha_{r-1}, 0), \quad (\alpha_1, \overline{\alpha_2}, \ldots, \alpha_{r-1}, 1),
$$
$$
  \cdots \quad \cdots
$$  
$$  
  (\alpha_1, \alpha_2, \ldots, \overline{\alpha_{r-1}}, 0), \quad (\alpha_1, \alpha_2, \ldots, \overline{\alpha_{r-1}}, 1),
$$
$$
  (\alpha_1, \alpha_2, \ldots, \alpha_{r-1}, 1), \quad (\alpha_1, \alpha_2, \ldots, \alpha_{r-1}, 0).
$$
Наборы из разных сфер имеют либо совпадающие первые $r-1$ компонент, а последние~--- отличающиеся,
либо наоборот, совпадающие последние, а первые $r-1$~--- отличающиеся. Но одновременно совпадать
первые $r-1$ компонент и последние не могут. Итак, общих точек у сфер нет.

2) Так как количество сфер ${2^r}/r$, а каждая сфера содержит $r$ наборов, то
всего $2^r$ наборов размещено в сферах. Это в точности количество всех двоичных наборов длины $r$.
Значит, каждый набор длины $r$ находится в одной из сфер. Лемма доказана.

Пусть ${(\alpha_1, \alpha_2, \ldots, \alpha_r)}$~--- центр одной из сфер. Сфера содержит $r$ наборов
$$
  (\overline{\alpha_1}, \alpha_2, \ldots, \alpha_r),
  (\alpha_1, \overline{\alpha_2}, \ldots, \alpha_r), \ldots,
  (\alpha_1, \alpha_2, \ldots, \overline{\alpha_r})
  .
$$
Рассмотрим {\itхарактеристическую функцию\/} сферы --- функцию, принимающую единичное значение на
указанных наборах, и нулевую в остальных случаях:
$$
  \varphi(x_1, \ldots, x_r) = 
  x_1^{\overline{\alpha_1}} x_2^{\alpha_2} \cdots x_r^{\alpha_r} \lor
  x_1^{\alpha_1} x_2^{\overline{\alpha_2}} \cdots x_r^{\alpha_r} \lor \cdots \lor
  x_1^{\alpha_1} x_2^{\alpha_2} \cdots x_r^{\overline{\alpha_r}}
  .
$$
Характеристическая функция сферы с центром ${(\alpha_1, \alpha_2, \ldots, \alpha_r)}$ обладает следующими
свойствами.

1) ${\varphi(x_1, \ldots, x_r) x_i^{\overline{\alpha_i}} = 
  x_1^{\alpha_1} \cdots x_{i-1}^{\alpha_{i-1}} x_i^{\overline{\alpha_i}} x_{i+1}^{\alpha_{i+1}} \cdots x_r^{\alpha_r}}$,
  ${i \in \overline{1,r}}$.

2) ${\varphi(x_1, \ldots, x_r) x_i^{\overline{\alpha_i}} x_j^{\overline{\alpha_j}} = 0}$, ${i \ne j}$. 

Функция $\varphi(x_1, \ldots, x_r)$ реализуется контактной схемой сложности $r^2$. На выходе этой
схемы построим $(1, 2^q)$--полюсное разделительное контактное дерево $S_q$ по переменным $(y_1, \ldots, y_q)$.
К каждому выходу $S_q$ навесим $r$ контактов 
${x_1^{\overline{\alpha_1}}, \ldots, x_r^{\overline{\alpha_r}}}$ (\rf рис.~10).

% figure 10
\begin{figure}
 \begin{center}
 \begin{picture}(52,50)
 % ufo
 \put(0,-3)
 {
  \begin{picture}(50,50)
   % lines - triangle
   \put(5,15){\line(1,0){40}}
   \put(5,15){\line(1,1){20}}
   \put(45,15){\line(-1,1){20}}
   % curves - "head"
   \qbezier(25,35)(15,43)(24,49)
   \qbezier(25,35)(35,43)(26,49)
   % lines - hands/legs
   \put(0,5){\line(1,2){5}}
   \put(10,5){\line(-1,2){5}}
   \put(40,5){\line(1,2){5}}
   \put(50,5){\line(-1,2){5}}
   % poles
   \put(25,50){\circle{2}}
   \put(25,35){\circle*{1}}
   \put(5,15){\circle*{1}}
   \put(45,15){\circle*{1}}
   \put(0,4){\circle{2}}
   \put(10,4){\circle{2}}
   \put(40,4){\circle{2}}
   \put(50,4){\circle{2}}
    % labels
   \put(24,41){\small $\varphi$}    
   \put(23,22){$S_q$}    
   \put(-2,10){\footnotesize $x_1^{\overline{\alpha_1}}$}
   \put(8,10){\footnotesize $x_r^{\overline{\alpha_r}}$}
   \put(3,6){\small $\cdots$}  
   \put(22,6){$\cdots$}  
   \put(38,10){\footnotesize $x_1^{\overline{\alpha_1}}$}
   \put(48,10){\footnotesize $x_r^{\overline{\alpha_r}}$}
   \put(43,6){\small $\cdots$}  
   \put(2,16){\small $1$}  
   \put(46,16){\small $2^q$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~10\end{center}
\end{figure}

Всего у полученной схемы $S$ будет ${r 2^q}$ полюсов--выходов, и реализовывать она будет
всевозможные конъюнкции вида 
$$
  \varphi(x_1, \ldots, x_r) \cdot y_1^{\beta_1} \cdots y_q^{\beta_q} \cdot x_i^{\overline{\alpha_i}} = 
  x_1^{\alpha_1} \cdots x_{i-1}^{\alpha_{i-1}} x_i^{\overline{\alpha_i}} x_{i+1}^{\alpha_{i+1}} \cdots x_r^{\alpha_r} \cdot 
  y_1^{\beta_1} \cdots y_q^{\beta_q}
  .
$$
Используем (2) в оценке сложности $S$:
$$
  L_K(S) \leqslant r^2 + 2^{q+1} - 2 + r 2^q
  .
  \eqno(5)
$$

Схемы аналогичные $S$ построим параллельно для каждой из ${2^r}/r$ сфер. Так будут покрыты
все наборы длины $r$: при подстановке набора из $i$--й сферы в функцию, реализованную $j$--й схемой,
получится нуль, и только если подставить этот набор в функцию, реализованную $i$--й схемой, получится
некоторая конъюнкция $y_1^{\beta_1} \cdots y_q^{\beta_q}$. Из (5) следует, что сложность такой
схемы будет оцениваться сверху величиной 
$$
  \left(r^2 + 2^{q+1} - 2 + r 2^q\right) \frac{2^r}{r}
  .
$$
Выберем ${r = 2^t}$, где ${t = \lceil\log_2\log_2 n\rceil}$, ${n=r+q}$.
Тогда слагаемое $r 2^q$ будет главной частью асимптотики сомножителя при ${r \to \infty}$. 
 
Заметим, что сложность схемы $S$ (асимптотически $2^n$) меньше сложности разделительного контактного дерева, 
но вместе с тем, видно, что свойством разделительности $S$ не обладает: в пределах одного пучка 
$(x_1^{\overline{\alpha_1}}, \ldots, x_r^{\overline{\alpha_r}})$ функция проводимости между любыми
двумя полюсами--выходами этого пучка ненулевая. Однако, можно считать, что схема $S$ обладает свойством
{\itослабленной разделительности.} Это означает, что если разбить полюсы--выходы на попарно не 
пересекающиеся подмножества
и объединить полюсы--выходы в каждом подмножестве (так, например, объединить полюсы--выходы
$x_i^{\overline{\alpha_i}}$ из всех пучков), то полученная схема будет реализовывать дизъюнкции
конъюнкций, относящихся к указанным подмножествам, и будет кроме того обладать свойством
разделительности (что следует из свойства 2 характеристической функции). 

% table 1
\begin{figure}
 \begin{center}
 \begin{picture}(110,55)
 % table
 \put(0,0)
 {
  \begin{picture}(110,55)
   % lines
   \put(80,0){\line(0,1){55}}
   \thicklines
   \put(30,0){\line(0,1){55}}
   \put(0,40){\line(1,0){110}}
   % dotteds
   \qbezier[40](35,20)(55,20)(75,20)
   \qbezier[13](95,38)(95,30)(95,25)
   \put(84,19){\small $f(\sigma_1, \ldots, \sigma_n)$}    
   % texts
   % first column
   \put(3,47){\small $x_{n-k+1}, \ldots, x_n$}    
   \put(9,35){\small $0, \ldots, 0$}    
   \put(14,26){\small $\vdots$}    
   \put(3,19){\small $\sigma_{n-k+1}, \ldots, \sigma_n$}    
   \put(14,10){\small $\vdots$}    
   \put(9,2){\small $1, \ldots, 1$}    
   % second column
   \put(31,52){\footnotesize $\Tilde\alpha^{(1)}$}    
   \put(32,49){\footnotesize $0$}    
   \put(32,45){\tiny $\vdots$}    
   \put(32,41){\footnotesize $0$}    
    \put(38,45){\small $\cdots$}    
   \put(46,52){\footnotesize $\Tilde\alpha^{(1)}$}    
   \put(47,49){\footnotesize $1$}    
   \put(47,45){\tiny $\vdots$}    
   \put(47,41){\footnotesize $1$}    
    \put(52,45){\small $\cdots$}    
   \put(59,52){\footnotesize $\Tilde\alpha^{(r)}$}    
   \put(60,49){\footnotesize $0$}    
   \put(60,45){\tiny $\vdots$}    
   \put(60,41){\footnotesize $0$}    
    \put(66,45){\small $\cdots$}    
   \put(74,52){\footnotesize $\Tilde\alpha^{(r)}$}    
   \put(75,49){\footnotesize $1$}    
   \put(75,45){\tiny $\vdots$}    
   \put(75,41){\footnotesize $1$}    
   % third column
    \put(85,45){\small $\cdots$}    
   \put(94,52){\footnotesize $\sigma_1$}    
   \put(95,46){\footnotesize $\vdots$}    
   \put(92,42){\footnotesize $\sigma_{n-k}$}    
    \put(101,45){\small $\cdots$}    

  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Табл.~1\end{center}
\end{figure}


% par
\section{Асимптотически наилучший метод}
Рассмотрим произвольную функцию $f(x_1, \ldots, x_n)$. 
Выделим среди ее переменных $r$ первых $x_1, \ldots, x_r$,
где ${r=2^t}$ для некоторого $t$, и $k$ последних $x_{n-k+1}, \ldots, x_n$. 
Согласно лемме, множество наборов длины $r$ разбивается на попарно не пересекающиеся единичные сферы.
Обозначим центры этих сфер через $(\alpha_1, \ldots, \alpha_r)$, а $r$ наборов, в них содержащихся, через
$$
{
 \Tilde\alpha^{(1)}=(\overline{\alpha_1}, \ldots, \alpha_r), \ldots,
 \Tilde\alpha^{(r)}=(\alpha_1, \ldots, \overline{\alpha_r})
 .
}
$$
Зададим функцию $f$ с помощью таблицы (\rf табл.~1). 
В~этой таблице по числу сфер ${2^r}/r$ вертикальных полос, каждая из
которых содержит значения, принимаемые функцией $f$ на наборах вида 
${(\Tilde\alpha^{(j)}, \sigma_{r+1}, \ldots, \sigma_{n-k}, \sigma_{n-k+1}, \ldots, \sigma_n)}$,
где $\Tilde\alpha^{(j)}$~--- всевозможные наборы, содержащиеся в данной сфере, 
${(\sigma_{r+1}, \ldots, \sigma_{n-k}) = (0, \ldots, 0), \ldots, (1, \ldots, 1)}$,
а ${(\sigma_{n-k+1}, \ldots, \sigma_n)}$ фиксированы. Всего к каждой сфере будет относиться
$r2^{n-k-r}$ наборов длины $n-k$.

Выберем теперь параметр $s$ и разделим таблицу на горизонтальные полосы высоты $s$. Высота
нижней полосы пусть будет ${s' \leqslant s}$. Таких горизонтальных полос в таблице окажется
$$
\displaystyle p = \left\lceil\frac{2^k}{s}\right\rceil \leqslant \frac{2^k}{s} + 1.
$$ 
Рассмотрим клетку
таблицы с координатами $(i,j)$, где $j$~--- номер сферы, и построим функцию $f_{ij}(\Tilde x)$, 
которая совпадает с $f$ на наборах клетки $(i,j)$ и равна нулю в противном случае. Следовательно
$$
 f(\Tilde x) = \bigvee\limits_{(i,j)} f_{ij}(\Tilde x)
 .
$$
Клетка $(i,j)$ размера ${s \times r2^{n-k-r}}$ содержит максимум $2^s$ различных столбцов.
Зафиксируем некоторый столбец $\Tilde\tau$ клетки, и пусть, аналогично, $f_{ij\Tilde\tau}$ совпадает
с $f_{ij}$ на столбце $\Tilde\tau$ и равна нулю на других наборах. Тогда
$$
 f_{ij}(\Tilde x) = \bigvee\limits_{\Tilde\tau} f_{ij\Tilde\tau}(\Tilde x)
 .
$$
Если ${\Tilde\tau \ne \Tilde\tau'}$, то множества им соответствующих столбцов не пересекаются.
Представим 
$$
 f_{ij\Tilde\tau}(x_1, \ldots, x_n) 
    = f_{ij\Tilde\tau}^{(1)}(x_{n-k+1}, \ldots, x_n) f_{ij\Tilde\tau}^{(2)}(x_1, \ldots, x_{n-k})
 ,
$$
где функция $f_{ij\Tilde\tau}^{(1)}$ дает значение на наборе $\Tilde\tau$,
а функция $f_{ij\Tilde\tau}^{(2)}$ тождественно единична на столбцах, содержащих набор $\Tilde\tau$.

Пусть ${\varphi(x_1, \ldots, x_r)}$~--- характеристическая функция сферы номер $j$. Реализуем ее схемой,
на выходе которой построим разделительное контактное дерево по переменным $x_{r+1}, \ldots, x_{n-k}$.
Получим схему, аналогичную изображенной на рис.~10. Зафиксируем набор $\Tilde\tau$ и соединим выходы
полученной схемы, соответствующие набору $\Tilde\tau$. Теперь схема будет реализовывать функцию 
$f_{ij\Tilde\tau}^{(2)}$. Для $\Tilde\tau'$ отличного от $\Tilde\tau$ поступим так же. В~итоге 
при фиксированных $i$ и $j$ получим реализацию всех функций $f_{ij\Tilde\tau_q}^{(2)}$ одной и той же 
схемой, соответствующей $j$--й сфере. Условимся обозначать эту схему $S_{ij}$. Из (5) следует, что
$$
  L_K(S_{ij}) \leqslant r^2 + 2^{n-k-r}2 + r 2^{n-k-r}
  .
  \eqno(6)
$$

Функцию $f_{ij\Tilde\tau}^{(1)}$ реализуем схемой с помощью ДНФ сложности не более $s k$ и соединим
со схемой $S_{ij}$. Всего при фиксированных $i$ и $j$ сложность схемы $S_{ij}$ возрастет на
$s k 2^s$, поскольку $2^s$~--- число функций $f_{ij\Tilde\tau}^{(2)}$. Объединим теперь полученные
схемы по всем $i$ и $j$ в схему $S$. В силу (6)
$$
  L_K(S) \leqslant \left(r^2 + 2^{n-k-r}2 + r 2^{n-k-r} + k s 2^s\right)\left(\frac{2^k}{s} + 1\right)\frac{2^r}{r}
  .
  \eqno(7)
$$
Подберем параметры $k$, $s$ и ${r=2^t}$ с тем, чтобы главными частями асимптотики правой части (7) 
при ${n \to \infty}$ были $r 2^{n-k-r}$ и ${2^k}/s$. Положим
$$
  k = \left\lceil 2\log_2 n\right\rceil,
  \quad
  r = 2^{\left\lceil \frac{1}{2}\log_2 n\right\rceil}, 
  \quad
  s = 2^{\left\lceil n - 2\sqrt{n}\right\rceil}.
$$  
Сравним рост слагаемых первой скобки:
$$
  \frac{k s 2^s}{r 2^{n-k-r}} \asymp 
  \frac{(\log_2 n) n 2^n n^2 2^{\sqrt{n}}}{2^{2\sqrt{n}} 2^n \sqrt{n}} \to 0,
  \quad n \to \infty 
  .
$$
Действительно, главная часть асимптотики правой части (7) при ${n \to \infty}$ есть
$$
  r 2^{n-k-r} \frac{2^k}{s} \frac{2^r}{r} = \frac{2^n}{s}
  ,
$$
следовательно 
$$
  L_K(S) \lesssim \frac{2^n}{n}
  ,
$$
а значит, в классе контактных схем
$$
  L_K(n) \lesssim \frac{2^n}{n}
  .
$$

Для почти всех функций эту сложность уменьшить нельзя. Приведем неконструктивное доказательство этого факта.
Обозначим через $N(n,h)$ число функций $f(x_1, \ldots, x_n)$, которые можно реализовать контактной схемой 
сложности не более $h$, а через $N'(n,h)$ число функций $f(x_1, \ldots, x_n)$, реализуемых контактной схемой 
сложности в точности $h$. Но тогда ${N(n,h) = N'(n,h)}$, поскольку схемой большей сложности, чем данная, 
можно реализовать всегда. Наконец, $N''(n,h)$~--- число {\bfсхем} сложности в точности $h$, реализующих
функцию $f(x_1, \ldots, x_n)$. Справедливо соотношение
$$
  N(n,h) = N'(n,h) \leqslant N''(n,h)
  .
$$
Если для некоторого $h_0$ выполнено ${N(n,h_0) < 2^{2^n}}$, то ${L_K(n) > h_0}$. Поэтому будем доказывать,
что ${N''(n,h_0) < 2^{2^n}}$. Оценим величину $N''(n,h)$. Сложность $h$ есть по сути дела число ребер
графа с занумерованными вершинами. В таком случае вершин будет $2h+2$, в том числе и полюсы~--- вершины
с номерами 1 и 2. Оценим количество $\Gamma(h)$ графов. Назовем пару вершин графа {\itсортом\/} ребер. Всего
сортов ${B = C_{2h+2}^2 = (h+1)(2h+1) = 2h^2 + 3h + 1}$. Тогда
$$
  \Gamma(h) = H_B^h = C_{B+h-1}^h = C_{2h^2 + 4h}^h \leqslant 
$$
$$
  \leqslant C_{6h^2}^h < \frac{(6h^2)^h}{h!} < \frac{(6h^2)^h}{(h/A)^h} = (6Ah)^h
  .
$$
Следовательно, число схем
$$
  N''(n,h) \leqslant \Gamma(h) (2n)^h \leqslant (6Ah)^h (2n)^h = (12 A n h)^h
  ,
$$
где ${(2n^h)}$~--- варианты в зависимости от нагрузки ($x_i$ или $\overline{x_i}$) ребер графа.
Пусть $\varepsilon$~--- произвольное положительное число. Положим
${h_0 = (1-\varepsilon) 2^n/n}$ и оценим
$$
  \log_2\left(\frac{N''(n,h_0)}{2^{2^n}}\right) = \log_2 N''(n,h_0) - 2^n \leqslant 
  h_0\log_2 (12 A n h_0) - 2^n =
$$
$$
  = (1-\varepsilon)\frac{2^n}{n}\left(\log_2 (12 A) + \log_2 (1-\varepsilon) + n\right) - 2^n =
$$
$$
  = C\frac{2^n}{n} + (1-\varepsilon)2^n - 2^n = C\frac{2^n}{n} - \varepsilon 2^n
  .
$$
Величина ${C 2^n /n - \varepsilon 2^n}$ стремится к $-\infty$ при ${n \to \infty}$
для любого фиксированного $\varepsilon$. Следовательно, для любого ${\varepsilon > 0}$ при достаточно 
больших $n$ выполнено ${N''(n, h_0) < 2^{2^n}}$. Отсюда вытекает нижняя оценка сложности в
классе контактных схем. В~итоге имеем
$$
  L_K(n) \sim \frac{2^n}{n}
  .
$$

% par
\section{Метод каскадов}
Зафисируем порядок переменных в функции $f(x_1, \ldots, x_n)$. Введем классы $G_i$. Пусть
${G_0 = \{g_{0,1}(x_1, \ldots, x_n) = f(x_1, \ldots, x_n)\}}$. Затем $G_1$ образован всевозможными
различными функциями из ${g_{0,1}(0, x_2, \ldots, x_n)}$ и ${g_{0,1}(1, x_2, \ldots, x_n)}$. Будем
обозначать их $g_{1,1}$, $g_{1,2}$ и \etc При таком порядке переменных класс $G_{n-1}$ всегда будет 
подмножеством ${\{0, 1, x_n, \overline{x_n}\}}$. 

Построение контактной схемы сводится к следующему. Сначала контактами $x_n$ и $\overline{x_n}$, 
выходящими из полюса $a$, реализуются функции одной переменной из $G_{n-1}$. Затем для каждой 
${g_{n-2,i} \in G_{n-2}}$, согласно разложению 
${g_{n-2,i}(x_{n-1}, x_n) = x_{n-1}g_{n-2,i}(1, x_n) \lor \overline{x_{n-1}}g_{n-2,i}(0, x_n)}$,
добавим контакты $x_{n-1}$ и $\overline{x_{n-1}}$ к соответствующим выходам уже построенной схемы и 
соединим их. Аналогично для $G_{n-3}$ и \etc

Рассмотрим пример. 
Пусть 
$$
  f(x_1, \ldots, x_n) = l_n(x_1, \ldots, x_n) = x_1 \oplus \cdots \oplus x_n.
$$ 
Тогда
${G_0 = \{g_{0,1}\}}$, где
$$
  g_{0,1}(x_1, \ldots, x_n) = x_1 \oplus \cdots \oplus x_n;
$$
${G_1 = \{g_{1,1}, g_{1,2}\}}$, где
$$
  g_{1,1}(x_2, \ldots, x_n) = x_2 \oplus \cdots \oplus x_n,
  \quad
  g_{1,2}(x_2, \ldots, x_n) = x_2 \oplus \cdots \oplus x_n \oplus 1;
$$
${G_2 = \{g_{2,1}, g_{2,2}\}}$, где
$$
  g_{2,1}(x_3, \ldots, x_n) = x_3 \oplus \cdots \oplus x_n,
  \quad
  g_{2,2}(x_3, \ldots, x_n) = x_3 \oplus \cdots \oplus x_n \oplus 1
$$ 
и \etc Наконец, ${G_{n-1} = \{x_n, \overline{x_n}\}}$. 
Реализующая контактная схема $S$ изображена на рис.~11.
Ее сложность 
$$
 L_K(S) = 2 \cdot 2 + (n-2) \cdot 4 = 4n-4.
$$

Обозначим ${A_i = |G_i|}$. Тогда ${A_0 = 1}$, и кроме того справедлива оценка ${A_{i+1} \leqslant 2A_i}$.
Но вместе с тем видно, что ${A_{n-1} \leqslant 4}$ и ${A_{n-2} \leqslant 16}$, \ie в общем случае
${A_{n-j} \leqslant 2^{2^j} = p_2(j)}$. В~методе каскадов на каждом шаге тратится по два контакта,
поэтому 
$$
  L_K(S) \leqslant 2A_0 + \cdots + 2A_{n-1} < 4 + 2\sum\limits_{i=1}^{n-1}A_i.
$$
Обозначим ${i_0 = \lceil n - \log_2 n + 1 \rceil}$. Тогда 
$$
  n - \log_2 n + 1 < i_0 \leqslant n - \log_2 n + 2.
$$ 
Разобьем сумму надвое:
$$
  L_K(S) < 4 + 2\sum\limits_{i=1}^{n-1}A_i = 4 + 2\sum\limits_{i=1}^{i_0}A_i + 2\sum\limits_{i=i_0 + 1}^{n-1}A_i \leqslant
$$
$$  
  \leqslant
  4 + \sum\limits_{i=1}^{i_0}2 \cdot 2^i + \sum\limits_{i=i_0 + 1}^{n-1}2 \cdot 2^{2^{n-i}}
  \leqslant
  4 + 8 \frac{2^n}{n} + o(2^n) \lesssim 8 \frac{2^n}{n}.
$$

% figure 11
\begin{figure}
 \begin{center}
 \begin{picture}(30,55)
 % cascade for l_n
 \put(3,2)
 {
  \begin{picture}(20,45)
   % from bottom...
   \put(0,5){\line(0,1){10}}
   \put(20,5){\line(0,1){10}}
   \put(11,1){\line(2,1){9}}
   \put(9,1){\line(-2,1){9}}
   \put(0,5){\line(2,1){20}}
   \put(20,5){\line(-2,1){20}}
   % ...to top
   \put(0,30){\line(0,1){10}}
   \put(20,30){\line(0,1){10}}
   \put(11,44){\line(2,-1){9}}
   \put(9,44){\line(-2,-1){9}}
   \put(0,30){\line(2,1){20}}
   \put(20,30){\line(-2,1){20}}
   % poles
   \put(10,0){\circle{2}}
   \put(10,45){\circle{2}}
   \put(0,5){\circle*{1}}
   \put(0,15){\circle*{1}}
   \put(0,30){\circle*{1}}
   \put(0,40){\circle*{1}}
   \put(20,5){\circle*{1}}
   \put(20,15){\circle*{1}}
   \put(20,30){\circle*{1}}
   \put(20,40){\circle*{1}}
    % labels
   \put(11,47){\small $a$}    
   \put(11,-5){\small $b$}    
   \put(23,22){$S$}    
   \put(2,43){\footnotesize $\overline{x_n}$}
   \put(15,43){\footnotesize $x_n$}
   \put(15,0){\footnotesize $\overline{x_1}$}
   \put(2,0){\footnotesize $x_1$}
   \put(-8,33){\footnotesize $\overline{x_{n-1}}$}
   \put(21,33){\footnotesize $\overline{x_{n-1}}$}
   \put(-4,8){\footnotesize $\overline{x_2}$}
   \put(21,8){\footnotesize $\overline{x_2}$}
   \put(5,38){\footnotesize $x_{n-1}$}
   \put(10,30){\footnotesize $x_{n-1}$}
   \put(5,13){\footnotesize $x_2$}
   \put(11,6){\footnotesize $x_2$}
   \put(10,21){$\vdots$}  
  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~11\end{center}
\end{figure}

\begin{pro}
Невозможно построить разделительную схему менее сложной, чем разделительное контактное дерево.
\end{pro}
{\bfДоказательство.}
Пусть дана разделительная схема $S$ для ${K_n = \{x^{\sigma_1}_1 \cdots x^{\sigma_n}_n\}}$.
Покажем, что ${L(S) \geqslant 2^{n+1} - 2}$.

Пусть схема имеет $2^n$ выходов. Докажем, что внутренних вершин не менее $2^n - 1$. Это будет
означать, что всего вершин не менее $2^{n+1} - 1$, и в силу связности, схема будет содержать
не менее $2^{n+1} - 2$ контактов.

Рассмотрим таблицу, в которой строки соответствуют наборам 
${\Tilde\alpha_1, \ldots, \Tilde\alpha_{2^n}}$ длины $n$, а столбцы --- внутренним вершинам 
${b_1, \ldots, b_n}$. Занумеруем выходы схемы как ${D_1, \ldots, D_{2^n}}$. Возьмем $j$--ю
строку и $i$--й столбец и рассмотрим цепи от вершины $b_i$ ко всем возможным выходам.
Если соответствующие этим цепям конъюнкции единичны на наборе $\Tilde\alpha_j$, то в силу 
разделительности схемы, выходов, соединенных проводящей цепью с $b_i$, может быть
не более одного. Если такой выход $D_h$ найдется, отметим его на пересечении $j$--й строки и 
$i$--го столбца таблицы.

Цепь, соединяющая полюс--вход схемы с выходом $D_h$, должна иметь длину не менее $n$, и
в ней должны встречаться все переменные. Возьмем на этой цепи некоторую внутреннюю вершину,
отстоящую от $D_h$ на 1, и обозначим ее $b_{s_1}$. Проводящий контакт между ней и $D_h$
обозначим $x^{\sigma_1}_{i_1}$. Всего этим контактом будет проводиться $2^{n-1}$ наборов
вида ${(\alpha_1, \ldots, \alpha_{i_1 - 1}, \sigma_1, \alpha_{i_1 + 1}, \ldots, \alpha_n)}$.
Значит, в $s_1$--м столбце таблицы $D_h$ встречается $2^{n-1}$ раз.

Сдвинемся еще на один контакт от выхода $D_h$ к некоторой внутренней вершине $b_{s_2}$.
По тем же причинам $s_2$--й столбец таблицы будет содержать по меньшей мере $2^{n-2}$ записей $D_h$.
В~итоге в $s_n$--м столбце $D_h$ встречается ${2^0 = 1}$ раз. Всего название одного выхода
встречается не менее ${2^{n-1} + 2^{n-2} + \cdots + 2^0 = 2^n - 1}$ раз, а соответственно,
всех выходов~--- не менее ${(2^n + 1)2^n}$ раз. По сути дела, это значит, что площадь таблицы
не менее ${(2^n + 1)2^n}$. Но число строк таблицы известно и равно $2^n$, поэтому столбцов
должно быть не менее ${2^n - 1}$.
Утверждение доказано.

% par
\section{Нижние оценки сложности. Принцип немонотонности}
Пусть контакная схема $S$ реализует функцию $f(x_1, \ldots, x_n)$, причем, схема $S$ такова, что
по некоторой переменной $x_i$ она содержит только замыкающие контакты (\ie в схеме нет
контактов $\overline{x_i}$). Тогда для наборов 
$$
 \Tilde\sigma_0 = (\sigma_1, \ldots, \sigma_{n-1}, 0, \sigma_{n+1}, \ldots, \sigma_n),
 \quad
 \Tilde\sigma_1 = (\sigma_1, \ldots, \sigma_{n-1}, 1, \sigma_{n+1}, \ldots, \sigma_n)
$$
справедливо ${f(\Tilde\sigma_0) \leqslant f(\Tilde\sigma_1)}$. Другими словами, если схема $S$ 
по переменной $x_i$ содержит только контакты вида $x_i$, то функция $f$ не убывает по переменной $x_i$.
Следовательно, если функция, реализуемая схемой $S$ не является неубывающей по переменной $x_i$,
то схема $S$ содержит хотя бы один размыкающий контакт $\overline{x_i}$.

Аналогично, если функция, реализуемая схемой $S$, не является невозрастающей по переменной $x_i$,
то схема $S$ содержит хотя бы один замыкающий контакт $x_i$. Если функция является одновременно
невозрастающей и неубывающей по переменной $x_i$, то схема $S$ должна содержать и замыкающий $x_i$,
и размыкающий $\overline{x_i}$ контакты хотя бы один раз. 

Рассмотрим пример. 
Пусть $S_n^1(x_1, \ldots, x_n)$~--- функция, принимающая единичное значение
только на $n$ наборах с ровно одной единицей. Покажем, что ${L_K(S_n^1) = 3n-2}$.

В~самом деле, функция $S_n^1$ реализуется всевозможными конъюнкциями вида
${\overline{x_1} \cdots \overline{x_{i-1}} x_i \overline{x_{i+1}} \cdots \overline{x_n}}$.
Контакная схема сложности $3n-2$ представлена на рис.~12. Справедлива верхняя оценка
${L_K(S_n^1) \leqslant 3n-2}$. Получим нижнюю оценку. Докажем, что ${L_K(S_3^1) \geqslant 7}$.
Предположим обратное: для реализации функции $S_3^1$ схемой достаточно шести контактов.
Это означает, что по каждой из переменных $x_1$, $x_2$, $ x_3$ должен быть как размыкающий 
так и замыкающий контакт. Рассмотрим два случая.

1) К~некоторому полюсу примыкают два размыкающих контакта, например $\overline{x_1}$ и 
$\overline{x_2}$. Функция должна принимать единичное значение на наборе ${(0,0,1)}$,
значит должна быть цепь ${\overline{x_1}\overline{x_2}x_3}$, чего в данной ситуации быть
не может.

2) К~каждому полюсу примыкает не более одного размыкающего контакта. Значит, существует размыкающий
контакт, например $\overline{x_3}$, не примыкающий ни к одному из полюсов. Функция должна принимать 
единичное значение на наборе ${(1,0,0)}$, значит должна быть цепь $x_1\overline{x_2}\overline{x_3}$.
Но с другой стороны, в схеме из шести контактов должна быть цепь 
$\overline{x_1}x_2\overline{x_3}$, соответствующая набору ${(0,1,0)}$. Однако, тогда 
функция не будет единичной на наборе ${(0,0,1)}$. Полученное противоречие показывает недостаточность
шести контактов.

Докажем еще один факт, относящийся к функции $S_n^1$: по всем переменным кроме, быть может, двух
схема, реализующая $S_n^1$, имеет три контакта. Допустим, что, наоборот, существует три переменные,
обозначим их $x_i$, $x_j$, $x_k$, по каждой из которых схема имеет два контакта. Подставив вместо
остальных переменных функции $S_n^1$ нули, получим функцию ${S_3^1(x_i, x_j, x_k)}$. В~схеме при
замене контакта единицей будут отождествлены концы ребра, а при замене нулем~--- просто удалено
соответствующее ребро. Таким образом, получим для $S_3^1$ схему сложности 6. Противоречие.

% figure 12
\begin{figure}
 \begin{center}
 \begin{picture}(30,70)
 % cascade for S_n^1
 \put(5,3)
 {
  \begin{picture}(20,65)
   % from bottom...
   \put(14,1){\line(-3,2){14}}
   \put(15,1){\line(0,1){9}}
   \put(0,10){\line(0,1){10}}
   \put(15,10){\line(-3,2){15}}
   \put(15,10){\line(0,1){10}}
   % ...to top
   \put(0,30){\line(0,1){10}}
   \put(15,30){\line(-3,2){15}}
   \put(15,30){\line(0,1){10}}
   \put(0,40){\line(0,1){10}}
   \put(15,40){\line(-3,2){15}}

   \put(15,40){\line(0,1){10}}
   \put(0,50){\line(0,1){9}}
   \put(15,50){\line(-3,2){14}}
   % poles
   \put(15,0){\circle{2}}
   \put(0,60){\circle{2}}
   \put(0,10){\circle*{1}}
   \put(0,20){\circle*{1}}
   \put(0,40){\circle*{1}}
   \put(0,50){\circle*{1}}
   \put(15,50){\circle*{1}}
   \put(15,40){\circle*{1}}
   \put(15,30){\circle*{1}}
   \put(15,10){\circle*{1}}
    % labels
   \put(1,62){\small $\alpha$}    
   \put(16,-4){\small $\beta$}    
   \put(20,22){$S$}    
   %
   \put(16,44){\footnotesize $\overline{x_2}$}
   \put(16,34){\footnotesize $\overline{x_3}$}
   \put(16,14){\footnotesize $\overline{x_{n-1}}$}
   \put(16,4){\footnotesize $\overline{x_n}$}
   %
   \put(-5,54){\footnotesize $\overline{x_1}$}
   \put(-5,44){\footnotesize $\overline{x_2}$}
   \put(-5,34){\footnotesize $\overline{x_3}$}
   \put(-8,14){\footnotesize $\overline{x_{n-1}}$}
   %
   \put(6,57){\footnotesize $x_1$}
   \put(6,47){\footnotesize $x_2$}
   \put(6,37){\footnotesize $x_2$}
   \put(4,11){\footnotesize $x_{n-1}$}
   \put(6,2){\footnotesize $x_n$}
   %
   \put(7,23){$\vdots$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~12\end{center}
\end{figure}

Покажем теперь, что 
$$
  L_K(l_n) \geqslant 4n - 4,
  \eqno(8)
$$
где, напомним, ${l_n = x_1 \oplus \cdots \oplus x_n}$.

Введем обозначения: $m_i(S)$~--- число контактов (нагрузка) по переменной $x_i$ ($x_i$ или $\overline{x_i}$)
в схеме $S$, \ie 
$$
  L_K(S) = \sum\limits_{i=1}^n m_i(S)
$$ 
для функции $f(x_1, \ldots, x_n)$. Пусть 
$$
  m(S) = \max\limits_{i=\overline{1,n}} m_i(S),
  \quad
  m(f) = \min\limits_{S = S(f)} m(S).
$$ 
В~данном случае будем обозначать 
также ${\mu(n) = m(l_n)}$ и ${\lambda(n) = L_K(l_n)}$.

Заметим сначала, что ${L_K(l_n) = L_K(l_n + 1)}$. Чтобы убедиться в этом, достаточно заменить
в контактной схеме каждую переменную ее отрицанием.

Отметим некоторые свойства $\mu(n)$.

1$^\circ$. 
$$
  \mu(n+1) \geqslant \mu(n).
$$
Действительно, рассмотрим схему $S$ для $l_{n+1}$,
на которой достигается минимум $\mu(n+1)$: ${\mu(n+1) = m(S)}$, следовательно 
${m_{n+1}(S) \geqslant m_i(S)}$ для всех ${i=\overline{1,n}}$. Подставим в $S$ вместо $x_{n+1}$ 
некоторую константу, например нуль. Получим некоторую схему $S'$ для функции $l_n$. Тогда
${L_K(S') = m_1(S) + \cdots + m_n(S)}$, поскольку ${m_i(S) = m_i(S')}$ для ${i \ne n+1}$.
Отсюда получаем, что 
$$
  m(S') = \max\limits_{i=\overline{1,n}} m_i(S) \leqslant m_{n+1}(S) = \mu(n+1),
$$
\ie требуемое неравенство.

2$^\circ$. 
$$
  \lambda(n) \geqslant \mu(n) + \lambda(n-1).
$$  
Пусть $S$~--- минимальная схема для $l_n$:
$$
 \lambda(n) = L_K(S) = m_1(S) + \cdots + m_n(S).
$$
Выберем наиболее нагруженную переменную: пусть
$$
  m_n(S) = \max\limits_{i=\overline{1,n}} m_i(S).
$$ 
Подставим теперь в $S$ вместо $x_n$
некоторую константу~--- получим схему $S'$ для $l_{n-1}$. Аналогично 
$$
  L_K(S') = m_1(S) + \cdots + m_{n-1}(S) \geqslant \lambda(n-1).
$$  
По предположению ${m(S) = m_n(S)}$,
и кроме того ${m_n(S) \geqslant \mu(n)}$. Окончательно получаем требуемое
$$
  L_K(S) = m_n(S) + L_K(S') \geqslant \mu(n) + \lambda(n-1).
$$

Для $l_2$ известно, что ${\lambda(2) = 4}$ и ${\mu(2) = 2}$. Однако для ${n=3}$ существует схема $\Hat S$
(\rf рис.~13), имеющая по каждой переменной нагрузку 3, значит ${\mu(3) = 3}$ 
(если бы ${\mu(3) = 4}$, то неравенство ${\lambda(n) \geqslant 4n-4}$
далее можно было доказать по индукции). Схема имеет цепи $\overline{x_1} x_2 x_3$, 
$\overline{x_1} \overline{x_2} \overline{x_3}$, $x_1 \overline{x_2} x_3$, $x_1 x_2 \overline{x_3}$ и
реализует функцию ${x_1 \oplus x_2 \oplus x_3 \oplus 1}$.

Покажем, что с тем же распределением контактов, что и в $\Hat S$, однородную функцию реализовать нельзя.
Предположим, что это не так, и схемой типа $\Hat S$ реализуется функция ${x_1 \oplus x_2 \oplus x_3}$.
Цепи $x_1 \overline{x_2} \overline{x_3}$, $\overline{x_1} x_2 \overline{x_3}$, 
$\overline{x_1} \overline{x_2} x_3$, $x_1 x_2 x_3$ будут также использовать по два 
замыкающих и по два размыкающих контакта по каждой переменной. Но ни к одному из полюсов не может
примыкать два размыкающих контакта, поскольку в противном случае не будет реализована цепь, содержащая
эти контакты. Поэтому существует размыкающий контакт, например $\overline{x_3}$, который не примыкает
ни к одному из полюсов. Он содержится как в цепи $x_1 \overline{x_3} \overline{x_2}$, так и в цепи
$\overline{x_1} \overline{x_3} x_2$. Но тогда не остается вариантов для такого размещения цепи
$\overline{x_1} \overline{x_2} x_3$, чтобы ни к одному из полюсов не примыкало более одного размыкающего
контакта. Противоречие.

Докажем, что ${\mu(4) \geqslant 4}$. Предположим, что ${\mu(4) \leqslant 3}$, \ie распределение контактов
следующее: $x_i$, $\overline{x_i}$, $x_i^{\alpha_i}$ для ${i=\overline{1,4}}$, и реализуется в этом
случае функция ${x_1 \oplus \cdots \oplus x_4 \oplus \varepsilon}$. Подставив вместо переменной $x_4$ 
константу $\varepsilon$, придем к схеме типа $\Hat S$, реализующей функцию ${x_1 \oplus x_3 \oplus x_3}$,
что по ранее доказанному, неверно. Аналогично докажем, что ${\lambda(3) \geqslant 8}$. Предположим, что 
${\lambda(3) \leqslant 7}$. Без ограничения общности считаем, что в результате использования контактов
$x_1$, $\overline{x_1}$, $x_2$, $\overline{x_2}$, $x_3$, $\overline{x_3}$ и $x_3^\sigma$ реализуется функция
${x_1 \oplus x_2 \oplus x_3 \oplus \varepsilon}$. Если ${\varepsilon = 0}$, то получаем противоречие с
доказанным ранее; если ${\varepsilon = 1}$, то вместо $x_1$ подставим $\overline{x_1}$~--- распределение
контактов не изменится, а реализуемая функция изменится на ${x_1 \oplus x_2 \oplus x_3}$, что опять--таки
невозможно. Итак, ${\mu(4) \geqslant 4}$ и ${\lambda(3) \geqslant 8}$.

Теперь неравенство (8) доказывается по индукции. Базисом является случай ${n=4}$ (но не ${n=3}$, как было
отмечено выше): 
$$
  \lambda(4) \geqslant \mu(4) + \lambda(3) \geqslant 4 + 8 = 4 \cdot 4 - 4.
$$
Допустим теперь, что ${\lambda(n) \geqslant 4n-4}$ для ${n \geqslant 5}$. Тогда
$$
  \lambda(n+1) \geqslant \mu(n+1) + \lambda(n) \geqslant 
$$
$$  
  \geqslant \mu(4) + 4n - 4 \geqslant 4 + 4n - 4 = 4(n+1) - 4,
$$
что и доказывает справедливость оценки (8).

% figure 13
\begin{figure}
 \begin{center}
 \begin{picture}(55,30)
 % counter-scheme
 \put(3,0)
 {
  \begin{picture}(50,30)
   % 
   \put(15,0){\line(-3,2){14}}
   \put(15,0){\line(3,2){15}}
   \put(30,10){\line(-1,0){29}}
   \put(30,10){\line(-3,2){15}}
   \put(30,10){\line(3,2){14}}
   \put(15,20){\line(-3,-2){14}}
   \put(15,20){\line(1,0){29}}
   \put(15,20){\line(3,2){15}}
   \put(30,30){\line(3,-2){14}}
   % poles
   \put(0,10){\circle{2}}
   \put(45,20){\circle{2}}
   \put(15,0){\circle*{1}}
   \put(15,20){\circle*{1}}
   \put(30,10){\circle*{1}}
   \put(30,30){\circle*{1}}
    % labels
   \put(-4,7){\small $\alpha$}
   \put(47,21){\small $\beta$}
   \put(6,25){$\Hat S$}
   %
   \put(5,2){\footnotesize $x_1$}
   \put(23,2){\footnotesize $x_2$}
   %
   \put(14,11){\footnotesize $x_3$}
   %
   \put(5,17){\footnotesize $\overline{x_1}$}
   \put(22,16){\footnotesize $\overline{x_2}$}
   \put(38,12){\footnotesize $\overline{x_3}$}
   %
   \put(29,21){\footnotesize $x_1$}
   %
   \put(19,26){\footnotesize $x_2$}
   \put(38,26){\footnotesize $x_3$}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~13\end{center}
\end{figure}


%3
\chapter{Параллельно--последовательные схемы}

% par
\section{Основные понятия}
Определим {\itпараллельно--последовательную схему ($\pi$--схему)\/} следующим образом.
Пусть одно ребро есть параллельно--последовательная сеть. Если $A$ и $B$~--- параллельно--последовательные
сети, то и параллельное, и последовательное их соединения также являются параллельно--последовательными
сетями. Других параллельно--последовательных сетей нет. 
Параллельно--последовательная схема ($\pi$--схема) есть схема, 
сеть которой является параллельно--последовательной. Параллельно--последовательным схемам можно
поставить в соответствие формулы $F_A$ и $F_B$, тогда ${F_A \lor F_B}$ будет отвечать параллельному их 
соединению, а ${F_A \& F_B}$~--- последовательному. Если вхождение переменной $x_i$~--- это число
символов $x_i$ и $\overline{x_i}$ в схеме, то под {\itрасширенным вхождением переменной\/} 
будем понимать формулу, содержащую кроме этой переменной и другие переменные внутри текущих скобок.

Сложность $L_{\pi}(S)$ $\pi$--схемы $S$ определяется как число входящих в схему символов 
переменных (но не как число операций). Затем 
$$
  L_{\pi}(f) = \min\limits_{S = S(f)} L_{\pi}(S).
$$ 
Принимаем, что 
${L_{\pi}(0) = 0}$ и ${L_{\pi}(1) = 0}$. Можно сразу считать, что формулы, соответствующие $\pi$--схемам,
приведены к такому виду, в котором либо не содержатся константы 0 и 1, либо не содержатся переменные.
Если $\pi$--схеме $S$ соответствует формула $\Phi$, реализующая функцию $f$, то сложность $L(\Phi)$
формулы $\Phi$ определяется так же, как сложность $L_{\pi}(S)$ схемы $S$, и аналогично
$$
  L(f) = \min\limits_{\Phi = \Phi(f)} L(S).
$$

% par
\section{Нижние оценки сложности. Методы Субботовской и Храпченко}

\begin{theorem}
Пусть $f(x_1, \ldots, x_n)$~--- произвольная булева функция, существенно зависящая от двух и более переменных.
Тогда найдется переменная $x_j$ такая, что 
$$
  L(f) \geqslant \frac{1}{1-\frac{1}{n}} L(f |_{x_j = \alpha})
  \eqno(9)
$$
для любого ${\alpha \in \{0,1\}}$, и
$$
  L(f) \geqslant \frac{1}{1-\frac{3}{2n}} L(f |_{x_j = \beta}),
  \eqno(10)
$$
где ${\beta \in \{0,1\}}$~--- некоторая константа.
\end{theorem} 
{\bfДоказательство.} 1. Пусть $m$~--- число вхождений переменной $x_j$ в произвольной минимальной 
формуле $\Phi$ сложности $L(f)$, тогда 
$$
  m \geqslant \frac{L(f)}{n}.
$$
Подставив константу вместо переменной $x_j$, получим некоторую формулу $\Phi^*$. В~результате ее
упрощения может получиться константа (тогда (9) выполняется автоматически), а общем же случае
по сравнению с $\Phi$ сложность уменьшится по крайней мере на $m$:
$$
{
  L(f |_{x_j = \alpha}) \leqslant L(\Phi^*) \leqslant L(f) - \frac{L(f)}{n}.
}
$$
Отсюда вытекает оценка (9).

2. Аналогично, возьмем минимальную формулу $\Phi$ функции $f$ с числом вхождений переменной $x_j$ 
равным $m$, по причине чего 
$$
  m \geqslant \frac{L(f)}{n}.
$$ 
Рассмотрим какое--либо
вхождение переменной $x_j$. Его общий вид таков: ${x_j^\sigma \circ \Psi}$, где $\Psi$~--- некоторая
подформула, $\circ$~--- либо конъюнктивная, либо дизъюнктивная операция. 
Покажем, что для различных вхождений $x_j$ соответствующие формулы $\Psi$ не пересекаются.
Предположим, что это не так, и $\Psi$ содержит некоторую подформулу $\Psi'$ того же вида, \ie
${\Psi' = x_j^\alpha \circ' \Psi^*}$. Получается, что формула $\Phi$ допускает упрощения
по переменной $x_j$, что само по себе противоречит минимальности формулы $\Phi$.

Найдется такое значение 
$x_j$, при котором формула ${x_j^\sigma \circ \Psi}$ обратится в константу. При этом сложность
уменьшится, во-первых, как минимум на $m$, и во-вторых (в отличие от случая 1), как минимум на
$m/2$ благодаря подформуле $\Psi$. Значит в итоге уменьшение составит $3m/2$ и более, откуда
$$
{
  L(f |_{x_j = \beta}) \leqslant L(f) - \frac{3}{2n} L(f).
}
$$
Теорема доказана.

\begin{corollary}
$$
{
  n^{3/2} \smallfrown L(l_n), \quad l_n(x_1, \ldots, x_n) = x_1 \oplus \cdots \oplus x_n.
}
$$
\end{corollary}
{\bfДоказательство.}
Согласно (10)
$$
{
  L(l_n) \geqslant \frac{1}{1-\frac{3}{2n}} L(f |_{x_j = \beta})
}
$$
для некоторых $\beta$ и $x_j$. В~результате замены одной из переменных константой формула
станет реализовывать либо функцию $l_{n-1}$, либо функцию $\overline{l_{n-1}}$, поэтому есть 
смысл применить оценку (10) и для $L(f |_{x_j = \beta})$:
$$
{
  L(l_n) \geqslant \frac{1}{1-\frac{3}{2n}} \cdot \frac{1}{1-\frac{3}{2(n-1)}} \cdots 
  \frac{1}{1-\frac{3}{2 \cdot 2}} \cdot 1,
}
$$
где 1 есть сложность реализации $x_i$ или $\overline{x_i}$. Так как
$$
{
  \frac{1}{1+x} \geqslant e^{-x},
}
$$
то
$$
{
  L(l_n) \geqslant \exp\left(\frac{3}{2}\sum\limits_{i=2}^n \frac{1}{i}\right) \geqslant
  \exp\left(\frac{3}{2}\int\limits_2^n \frac{1}{x}\,dx\right) = \frac{n^{3/2}}{2\sqrt{2}}.
}
$$
Следствие доказано.

{\itСечением\/} $T$ параллельно--последовательной схемы $S$ будем называть такое подмножество 
контактов схемы,
что любая цепь схемы $S$ содержит хотя бы один контакт из $T$. Под цепью понимаем любую
несамоперескающуюся цепь в $S$. {\itТупиковое сечение\/} при удалении произвольного
контакта перестает быть сечением.

\begin{lemma}
Любая цепь и любое тупиковое сечение произвольной $\pi$--схемы содержат ровно один общий контакт.
\end{lemma}
{\bfДокажем} индукцией по числу контактов схемы. Для схемы с одним контактом утверждение
леммы выполняется тривиальным образом. Предположим, что оно верно для схемы с не более чем
$m$ контактами. Рассмотрим схему $S$ сложности $m+1$. Существует две возможности.

1) Схема $S$ представляет собой последовательное соединение схем меньшей сложности.
Если взять цепь, соединяющую полюсы схемы, то по предположению индукции она будет пересекать 
тупиковое сечение одной из схем (оно в этом случае будет тупиковым сечением и для всей схемы $S$).

2) Схема $S$ является параллельным соединением схем меньшей сложности. В~этом случае 
тупиковое сечение схемы $S$ будет тупиковым сечением для каждой из параллельно соединенных
схем меньшей сложности. А~для схем меньшей сложности справедливо предположение индукции.
Лемма доказана.

Пусть $N_f^1$~--- произвольное подмножество множества $N_f$ единиц функции $f$, а
$N_f^0$~--- произвольное подмножество множества ${{\mathbb E}_2^n \setminus N_f}$ нулей функции $f$.
Обозначим через $R_f$ множество пар ${(\Tilde\sigma, \Tilde\sigma')}$ соседних наборов 
${\Tilde\sigma \in N_f^1}$, ${\Tilde\sigma' \in N_f^0}$. 
Пару ${(\Tilde\sigma^{(0)}, \Tilde\sigma^{(1)})}$, где 
${\Tilde\sigma^{(0)} \in N_f^0}$, ${\Tilde\sigma^{(1)} \in N_f^1}$, будем называть 
{\itребром по $j$--му направлению,} если эти наборы отличаются только по $j$--й компоненте. 

\begin{theorem}
Для произвольной функции $f(x_1, \ldots, x_n)$ и подмножеств $N_f^0$ и $N_f^1$ справедливо 
$$
  L(f) \geqslant \frac{|R_f|^2}{|N_f^0| \cdot |N_f^1|}.
  \eqno(11)
$$
\end{theorem} 
{\bfДоказательство.} 
Обозначим через $m_j$ число контактов по $j$--й переменной в $\pi$--схеме $S$, реализующей функцию $f$.
Будем считать, что $S$~--- минимальная схема, \ie ${L(S) = L(f)}$. Пусть ${\Tilde\sigma^0 \in N_f^0}$,
${\Tilde\sigma^1 \in N_f^1}$. Набору ${\Tilde\sigma^1 = (\sigma_1^1, \ldots, \sigma_n^1)}$ поставим 
в соответствие какую--либо цепь в $S$, содержащую 
контакты ${x_1^{\sigma_1^1}, \ldots, x_n^{\sigma_n^1}}$. Аналогично, набору 
${\Tilde\sigma^0 = (\sigma_1^0, \ldots, \sigma_n^0)}$ ставится в соответствие какое--либо тупиковое 
сечение схемы $S$. Если ${(\Tilde\sigma^0,\Tilde\sigma^1) \in R_f}$, сопоставим паре 
$(\Tilde\sigma^0,\Tilde\sigma^1)$ контакт с номером $i$, принадлежащий и цепи, и тупиковому сечению
(по лемме~4 он определен единственным образом). Все контакты $j$--й переменной занумеруем следующим
образом: ${1, 2, \ldots, m_j}$. Причем $i$--му контакту $j$--й переменной может соответствовать 
несколько пар $(\Tilde\sigma^0,\Tilde\sigma^1)$. Общее число подобных пар обозначим через $a_{ji}$.
Пусть число ребер, которым сопоставлены контакты $j$--й переменной, есть
$$
  r_j = \sum\limits_{i=1}^{m_j} a_{ji},
$$ 
тогда
$$
{
  |R_f| = \sum\limits_{j=1}^n r_j, \quad L(S) = \sum\limits_{j=1}^n m_j.
}
$$
Построим соответствующие множествам $N_f^1$ и $N_f^0$ матрицы $M^1$ и $M^0$.

1. $M^1$~--- матрица цепей (${|N_f^1| \times n}$). Заменим $j$--ю компоненту набора $\Tilde\sigma^1$
на противоположную. Обозначим полученный в результате набор через $\Tilde\tau$. Если $\Tilde\tau$
содержится в $N_f^0$, то ему соответствует некоторое тупиковое сечение, которое в свою очередь по
лемме~4 пересекает цепь $\Tilde\sigma^1$ по единственному контакту, например, $i$--му. Итак, если
${\Tilde\tau \in N_f^0}$, то в $j$--м разряде строки $\Tilde\sigma^1$ ставится $i$, иначе 
ставится прочерк.

2. $M^0$~--- матрица тупиковых сечений (${|N_f^0| \times n}$). Аналогично заполним эту матрицу.
Инвертируем $j$--ю компоненту набора $\Tilde\sigma^0$ и обозначим полученный набор через $\Tilde\rho$. 
Если $\Tilde\rho$ содержится в $N_f^1$, то ему соответствует некоторая цепь, которая пересекает 
тупиковое сечение $\Tilde\sigma^0$ по контакту номер $i'$. Если ${\Tilde\rho \in N_f^1}$, то 
в $j$--м разряде строки $\Tilde\sigma^0$ ставится $i'$, иначе ставится прочерк.

3. Построим теперь матрицу $N$ размера ${|N_f^0|\cdot|N_f^1| \times n}$. В~$j$--м разряде строки
$(\Tilde\sigma^0, \Tilde\sigma^1)$ ставится или пара $(i', i)$ для номеров $i'$, $i$ соответственно из 
матриц $M^0$, $M^1$, или прочерк.

Номер $i$ встречается в $j$--м столбце матрицы $M^1$ ровно $a_{ji}$ раз. Аналогично для номера $i'$ 
и матрицы $M^0$. Соответственно, в $j$--м столбце матрицы $N$ дубль $(i, i)$ встречается $a^2_{ji}$ раз.
Причем, разные дубли не могут встречаться в одной и той же строке матрицы $N$, так как иначе цепь
и тупиковое сечение перескались бы по нескольким контактам, что невозможно. Тогда общее число дублей 
$(k_j, k_j)$ в $j$--м столбце есть $a^2_{j k_j}$, а всего различных дублей в матрице $N$ будет
$$
  \sum\limits_{j=1}^{n} \sum\limits_{i=1}^{m_j} a^2_{ji}.
$$ 
И~их число не должно
превышать число всех строк:
$$
{
  \sum\limits_{j=1}^{n} \sum\limits_{i=1}^{m_j} a^2_{ji} \leqslant |N_f^0|\cdot|N_f^1|.
}
$$
Применим для
$$
{
  |R_f|^2 = \left(\sum\limits_{j=1}^n r_j\right)^2 = 
   \left(\sum\limits_{j=1}^{n} \sum\limits_{i=1}^{m_j} a_{ji}\right)^2
}
$$
неравенство Коши --- Буняковского:
$$
{
  |R_f|^2 \leqslant 
   \left(\sum\limits_{j=1}^{n} \sum\limits_{i=1}^{m_j} a^2_{ji} \right) 
   \left(\sum\limits_{j=1}^{n} \sum\limits_{i=1}^{m_j} 1\right)
   \leqslant
   |N_f^0| \cdot |N_f^1| \cdot L(S).
}
$$
Отсюда следует (11). Теорема доказана.

Рассмотрим пример. 
Пусть 
$$
  N^0 = \{(\sigma_1, \ldots, \sigma_n)|\sigma_1 \oplus \cdots \oplus \sigma_n = 0\}
$$ 
и   
$$
  N^1 = \{(\sigma_1, \ldots, \sigma_n)|\sigma_1 \oplus \cdots \oplus \sigma_n = 1\}
$$ 
для линейной
функции $l_n(x_1, \ldots, x_n)$. Следовательно, ${|N^0| = |N^1| = 2^{n-1}}$. Поэтому число пар
\glqqчетных\grqq{} и \glqqнечетных\grqq{} наборов будет равно $2^{n-1} n$, \ie ${|R| = 2^{n-1} n}$.
Значит, согласно теореме~6 имеем следующую нижнюю оценку сложности: ${L(l_n) \geqslant n^2}$.

Пусть ${n = 2^m}$ для некоторого $m$. Отметим справедливость равенства
$$
  l_{n_1 + n_2}(x_1, \ldots, x_n) = l_{n_1}(x_1, \ldots, x_{n_1}) \oplus l_{n_2}(x_{n_1 + 1}, \ldots, x_{n_2}) = 
$$
$$  
  = l_{n_1}(x_1, \ldots, x_{n_1}) \overline{l_{n_2}(x_{n_1 + 1}, \ldots, x_{n_2})} \lor
  \overline{l_{n_1}(x_1, \ldots, x_{n_1})} l_{n_2}(x_{n_1 + 1}, \ldots, x_{n_2}).
$$
Отсюда
$$
{
  L(l_{n_1 + n_2}) \leqslant 2L(l_{n_1}) + 2L(l_{n_2}),
}
$$
или в случае ${n = 2^m}$:
$$
{
  L(l_{2^{m+1}}) \leqslant 4L(l_{2^m}).
}
$$
По индукции можно доказать, что
$$
{
  L(l_{2^m}) \leqslant 4^m.
}
$$
В самом деле, ${L(l_{2^0}) = 1}$, и индукционный переход:
$$
{
  L(l_{2^{m+1}}) \leqslant 4L(l_{2^m}) \leqslant 4^{m+1}.
}
$$

Пусть ${2^m < n \leqslant 2^{m+1}}$. Представим $l_n$ в виде
$$
{
  l_n(x_1, \ldots, x_n) = l_{2^{m+1}}(x_1, \ldots, x_n, 0, \ldots, 0).
}
$$
Тогда
$$
{
  L(l_n) \leqslant L(l_{2^{m+1}}) \leqslant 4^{m+1} = (2^{m+1})^2 < 4n^2.
}
$$
Поэтому имеем, что в общем случае
$$
{
  n^2 \leqslant L(l_n) \leqslant 4n^2,
}
$$
хотя, впрочем, можно показать, что существует более точная верхняя оценка:
$$
{
  L(l_n) < \frac{9}{8} n^2.
}
$$

Пусть ${n = 2m+1}$. Введем функцию $\Hat f$ такую, что
$$
{
  \Hat f(\Tilde\sigma) = 
    \left\{
    \begin{array}{cl}
      0, & \: \sigma_1 + \cdots + \sigma_n \geqslant m+1, \\
      1, & \: \sigma_1 + \cdots + \sigma_n \leqslant m. 
    \end{array}
    \right.
}
$$
Для двоичных наборов $\Tilde\sigma$, аналогично, ${|N^0| = |N^1| = 2^{n-1}}$. 
Ребер, соответствующих ${\sigma_1 + \cdots + \sigma_n = m+1}$,
будет
$$
{
  |R| = C_{2m+1}^{m+1}(m+1) \sim C \frac{2^{2m+1}}{\sqrt{m}}(m+1) \sim C 2^{2m+1}\sqrt{m},
}
$$
где ${C = \const}$. По теореме~6 нижняя оценка
$$
{
  \frac{|R|^2}{|N^0||N^1|} \sim \frac{(C 2^{2m+1}\sqrt{m})^2}{(2^{2m})^2} \sim 4Cm \sim 2Cn
}
$$
получается линейной.

{\footnotesize\bigskip
Вообще говоря, сложность схемы оценивается снизу величиной
$$
{
  C'\left(\frac{n}{\log_2 n}\right)^2,
}
$$
где ${C' = \const}$ (оценка Нечипорука).

}



%4
\chapter{Системы эквивалентных преобразований}
Будем рассматривать формулы над множеством ${\{\&, \lor, \neg, x, 0, 1\}}$,
удовлетворяющие следующим правилам. 

1$^\circ$. ${(x_1 \& x_2) = (x_2 \& x_1)}$.

2$^\circ$. ${(x_1 \lor x_2) = (x_2 \lor x_1)}$.

3$^\circ$. ${((x_1 \& x_2) \& x_3) = (x_1 \& (x_2 \& x_3))}$.

4$^\circ$. ${((x_1 \lor x_2) \lor x_3) = (x_1 \lor (x_2 \lor x_3))}$.

5$^\circ$. ${((x_1 \lor x_2) \& x_3) = ((x_1 \& x_3) \lor (x_2 \& x_3))}$.

6$^\circ$. ${(x_1 \& x_1) = x_1}$.

7$^\circ$. ${(x_1 \lor x_1) = x_1}$.

8$^\circ$. ${\overline{(\overline{x_1})} = x_1}$.

9$^\circ$. ${\overline{(x_1 \lor x_2)} = (\overline{x_1} \& \overline{x_2})}$.

10$^\circ$. ${\overline{(x_1 \& x_2)} = (\overline{x_1} \lor \overline{x_2})}$.

11$^\circ$. ${(x_1 \& \overline{x_1}) = 0}$.

12$^\circ$. ${(x_1 \lor \overline{x_1}) = 1}$.

13$^\circ$. ${(x_1 \& 1) = x_1}$.

14$^\circ$. ${(x_1 \lor 1) = 1}$.

15$^\circ$. ${(x_1 \& 0) = 0}$.

16$^\circ$. ${(x_1 \lor 0) = x_1}$.

17$^\circ$. ${\overline{0} = 1}$.

18$^\circ$. ${\overline{1} = 0}$.

Каждое правило считаем схемой правила, \ie имеем в виду, что вместо любой из переменных 
можно подставить формулу. Обозначим систему правил 1$^\circ$~--~18$^\circ$ через $\Delta$.

Пусть {\bfвсе} переменные формулы $F$ содержатся в некотором множестве $X$. Тогда формула $\Hat F$~---
{\itканоническая\/} для $F$ относительно $X$, если выполнена одна из возможностей: 
1) $\Hat F$ реализует нуль; 2) $\Hat F$ есть содержащая все переменные из $X$ ДНФ (определенная
однозначно с точностью до ассоциативности и коммутативности) ненулевой функции, реализуемой формулой $F$. 

\begin{lemma}
Если все переменные формулы $F$ содержатся в множестве $X$, тогда $F$ относительно $X$ можно 
преобразовать в каноническую формулу $\Hat F$ при помощи правил системы $\Delta$.
\end{lemma} 
{\bfДоказательство.}
Разберем все возможные ситуации, возникающие в процессе преобразования формулы $F$.

1) Перенесем все отрицания со скобок на переменные по правилам 9$^\circ$ и 10$^\circ$.

2) Уничтожим двойные отрицания с помощью правила 8$^\circ$.

3) Уничтожим отрицания над константами с помощью правил 17$^\circ$ и 18$^\circ$.

4) Раскроем скобки, применив, по возможности правило 5$^\circ$, и получим представление 
${A_1 \lor \cdots \lor A_s}$.

5) Уничтожим пары вида ${x_i \& \overline{x_i}}$ с помощью правил 1$^\circ$, 3$^\circ$ и 11$^\circ$.

6) Уничтожим по правилу 15$^\circ$ конъюнкции, содержащие нуль.

7) Уничтожим по правилу 16$^\circ$ конъюнкции в виде нуля, и если в результате этого получим нуль, то
каноническая формула получена.

8) Уничтожим единицы в конъюнкциях согласно правилу 13$^\circ$.

9) Уничтожим повторяющиеся множители согласно правилу 6$^\circ$.

10) Если необходимо, дополним конъюнкции до полной длины: пусть, к примеру, конъюнкция $K$ не содержит
переменной ${x_i \in X}$, тогда
$$
\begin{CD}
  K @>{13^\circ}>> K \& 1 @>{12^\circ}>> K \& (x_i \lor \overline{x_i}) 
  @>{5^\circ}>> (K \& x_i) \lor (K \& \overline{x_i}).
\end{CD}
$$
Аналогично поступим для других переменных, пока не будет достигнута необходимая длина конъюнкции.

11) Наконец, руководствуясь правилом 7$^\circ$, уничтожим повторяющиеся конюнкции. 
В результате получим каноническую формулу. Лемма доказана.

\begin{theorem}
Система правил $\Delta$ является полной.
\end{theorem} 
{\bfДоказательство.} Пусть $F_1$ и $F_2$~--- эквивалентные формулы, \ie реализующие с точностью до
несущественной переменной одну и ту же функцию $f$, соответственно $X_1$ и $X_2$~--- множества всех
переменных формул $F_1$ и $F_2$. Построим множество ${X = X_1 \bigcup X_2}$. Преобразуем
согласно лемме~5 формулы $F_1$ и $F_2$ в канонические $\Hat F_1$ и $\Hat F_2$ относительно $X$.
Но по определению формулы $\Hat F_1$ и $\Hat F_2$ совпадают либо как нулевые, либо как совершенные
ДНФ функции $f$, поэтому формулу $F_1$ можно преобразовать в $F_2$ и наоборот. Теорема доказана.

Заметим, что в $k$--значной логике существуют конечные системы функций, для которых {\bfне существует}
полной системы эквивалентных преобразований. Однако для {\bfполной} конечной системы функций полная
система эквивалентных преобразований существует всегда.

Рассмотрим теперь случай контактных схем. Будем называть две контакные схемы {\itэквивалентными,} если
количества их полюсов совпадают, между полюсами одной схемы и полюсами другой схемы существует 
взаимно--однозначное соответствие и функции проводимости совпадают для соответствующих пар полюсов. 
Например, схемы $S_1$ и $S_2$ на рис.~14 эквивалентны.
 
% figure 14
\begin{figure}
 \begin{center}
 \begin{picture}(30,10)
 \put(-2,0)
 {
  \begin{picture}(30,10)
   % 
   \put(1,6){\line(2,1){8}}
   \put(1,4){\line(2,-1){8}}
   % 
   \put(21,6){\line(2,1){8}}
   \put(21,4){\line(2,-1){8}}
   \put(30,1){\line(0,1){8}}
   %
   \put(0,5){\circle{2}}
   \put(10,0){\circle{2}}
   \put(10,10){\circle{2}}
   %
   \put(20,5){\circle{2}}
   \put(30,0){\circle{2}}
   \put(30,10){\circle{2}}
   %labels
   \put(3,8){\sf\footnotesize $x$}  
   \put(3,0){\sf\footnotesize $x$}  
   \put(5,4){\sf\footnotesize $S_1$}  
   %
   \put(23,8){\sf\footnotesize $x$}  
   \put(23,0){\sf\footnotesize $x$}  
   \put(31,4){\sf\footnotesize $x$}  
   \put(25,4){\sf\footnotesize $S_2$}  
   
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~14\end{center}
\end{figure}

Определим {\itподсхему контактной схемы\/} как некоторое подмножество контактов контактной схемы.
При этом полюсами подсхемы будут: 1) все полюсы контактной схемы, принадлежащие данной подсхеме;
2) вершины общие для контактов из подсхемы и контактов не из подсхемы; 3) возможно, некоторые
другие вершины. Так, если существует контактная схема, содержащая подсхему $S$ с полюсами 
$\alpha$, $\beta$ и $\gamma$, то при замене $S$ на эквивалентную ей схему 
$S'(\alpha', \beta', \gamma')$ получится контактная схема эквивалентная исходной.

Рассмотрим правила преобразования эквивалентных подсхем.

1$^\circ$. Изолированная вершина может быть как добавлена в схему, так и удалена из схемы.

2$^\circ$. \Rf рис.~15. Средняя вершина, заметим, не полюс подсхемы по определению.

% figure 15
%\begin{figure}
 \begin{center}
 \begin{picture}(60,5)
 \put(3,2)
 {
  \begin{picture}(50,5)
   % 
   \put(1,0){\line(1,0){9}}
   \put(19,0){\line(-1,0){9}}
   % 
   \put(31,0){\line(1,0){9}}
   \put(49,0){\line(-1,0){9}}
   %
   \put(0,0){\circle{2}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle{2}}
   %
   \put(30,0){\circle{2}}
   \put(40,0){\circle*{1}}
   \put(50,0){\circle{2}}
   %labels
   \put(-3,2){\sf\small $1$}  
   \put(21,2){\sf\small $2$}  
   \put(4,1){\sf\footnotesize $x_1$}  
   \put(14,1){\sf\footnotesize $x_2$}  
   %
   \put(23,-1){\sf $\sim$}  
   %
   \put(27,2){\sf\small $1$}  
   \put(51,2){\sf\small $2$}  
   \put(34,1){\sf\footnotesize $x_2$}  
   \put(44,1){\sf\footnotesize $x_1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~15\end{center}
%\end{figure}

% figure 16
%\begin{figure}
 \begin{center}
 \begin{picture}(60,5)
 \put(3,2)
 {
  \begin{picture}(50,5)
   % 
   \put(1,0){\line(1,0){9}}
   \put(19,0){\line(-1,0){9}}
   % 
   %\put(31,0){\line(1,0){9}}
   %\put(49,0){\line(-1,0){9}}
   %
   \put(0,0){\circle{2}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle{2}}
   %
   \put(30,0){\circle{2}}
   %\put(40,0){\circle*{1}}
   \put(50,0){\circle{2}}
   %labels
   \put(-3,2){\sf\small $1$}  
   \put(21,2){\sf\small $2$}  
   \put(4,1){\sf\footnotesize $x_1$}  
   \put(14,1){\sf\footnotesize $\overline{x_1}$}  
   %
   \put(23,-1){\sf $\sim$}  
   %
   \put(27,2){\sf\small $1$}  
   \put(51,2){\sf\small $2$}  
   %\put(34,1){\sf\footnotesize $x_2$}  
   %\put(44,1){\sf\footnotesize $x_1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~16\end{center}
%\end{figure}

3$^\circ$. \Rf рис.~16.

4$^\circ$. \Rf рис.~17.

% figure 17
%\begin{figure}[!h]
 \begin{center}
 \begin{picture}(60,12)
 \put(3,0)
 {
  \begin{picture}(50,10)
   % 
   \put(1,5){\line(1,0){18}}
   % 
   \put(31,6){\line(2,1){9}}
   \put(31,4){\line(2,-1){9}}
   \put(49,6){\line(-2,1){9}}
   \put(49,4){\line(-2,-1){9}}
   %
   \put(0,5){\circle{2}}
   \put(20,5){\circle{2}}
   %
   \put(30,5){\circle{2}}
   \put(40,0){\circle*{1}}
   \put(40,10){\circle*{1}}
   \put(50,5){\circle{2}}
   %labels
   \put(-3,7){\sf\small $1$}  
   \put(21,7){\sf\small $2$}  
   \put(9,6){\sf\footnotesize $x_1$}  
   %
   \put(23,4){\sf $\sim$}  
   %
   \put(27,7){\sf\small $1$}  
   \put(51,7){\sf\small $2$}  
   \put(32,0){\sf\footnotesize $x_1$}  
   \put(32,9){\sf\footnotesize $x_1$}  
   \put(45,0){\sf\footnotesize $x_2$}  
   \put(45,9){\sf\footnotesize $\overline{x_2}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~17\end{center}
%\end{figure}

5$^\circ$. \Rf рис.~18. Это так называемое схемное правило. Здесь возможно отождествление некоторых 
полюсов.

% figure 18
%\begin{figure}[!h]
 \begin{center}
 \begin{picture}(40,10)
 \put(3,0)
 {
  \begin{picture}(30,10)
   % 
   \put(1,6){\line(2,1){8}}
   \put(1,4){\line(2,-1){8}}
   % 
   \put(21,6){\line(2,1){8}}
   \put(30,1){\line(0,1){8}}
   %
   \put(0,5){\circle{2}}
   \put(10,0){\circle{2}}
   \put(10,10){\circle{2}}
   %
   \put(20,5){\circle{2}}
   \put(30,0){\circle{2}}
   \put(30,10){\circle{2}}
   %labels
   \put(3,10){\sf\footnotesize $x_1$}  
   \put(3,0){\sf\footnotesize $x_1$}  
   \put(-3,1){\sf\small $1$}  
   \put(12,10){\sf\small $2$}  
   \put(12,-2){\sf\small $3$}  
   %
   \put(13,4){\sf $\sim$}  
   %
   \put(23,10){\sf\footnotesize $x_1$}  
   \put(31,4){\sf\footnotesize $x_1$}  
   \put(17,1){\sf\small $1$}  
   \put(32,10){\sf\small $2$}  
   \put(32,-2){\sf\small $3$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~18\end{center}
%\end{figure}

6$^\circ_m$. \Rf рис.~19. Возможность устранения циклов. Здесь внутренние вершины цикла не соединяются
с какими--либо другими вершинами.

% figure 19
%\begin{figure}[!h]
 \begin{center}
 \begin{picture}(50,25)
 \put(-2,0)
 {
  \begin{picture}(45,25)
   % 
   \put(9,19){\line(-2,-1){9}}
   \put(11,19){\line(2,-1){9}}
   \put(0,15){\line(0,-1){10}}
   \put(20,15){\line(0,-1){10}}
   \put(0,5){\line(2,-1){9}}
   % 
   \put(10,20){\circle{2}}
   \put(45,10){\circle{2}}
   %
   \put(0,5){\circle*{1}}
   \put(0,15){\circle*{1}}
   \put(20,15){\circle*{1}}
   %labels
   \put(2,18){\sf\footnotesize $x_1$}  
   \put(15,18){\sf\footnotesize $x_m$}  
   \put(-4,8){\sf\footnotesize $x_2$}  
   \put(21,8){\sf\footnotesize $x_{m-1}$}  
   \put(3,0){\sf\footnotesize $x_3$}  
   \put(12,2){\sf $\cdots$}  
   \put(12,21){\sf\small $1$}  
   %
   \put(34,9){\sf $\sim$}  
   %
   \put(47,11){\sf\small $1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~19\end{center}
%\end{figure}

Указанные переменные можно заменить на любые другие переменные (или их отрицания) 
вне зависимости от того, входят 
они в контактную схему или нет. Обозначим систему правил
${\gamma_m =\{1^\circ, 2^\circ, 3^\circ, 4^\circ, 5^\circ, 6^\circ_1, \ldots, 6^\circ_m\}}$.

Выведем некоторые следствия из системы $\gamma_m$.

7$^\circ$. \Rf рис.~20. Правый конец контакта в данном случае является \glqqвременным полюсом\grqq{}. 
Определение полюсов подсхемы это допускает.

% figure 20
%\begin{figure}
 \begin{center}
 \begin{picture}(30,5)
 \put(-2,0)
 {
  \begin{picture}(30,5)
   % 
   \put(1,0){\line(1,0){9}}
   %
   \put(0,0){\circle{2}}
   \put(10,0){\circle*{1}}
   %
   \put(30,0){\circle{2}}
   %labels
   \put(1,2){\sf\small $1$}  
   \put(5,1){\sf\footnotesize $x_1$}  
   %
   \put(18,-1){\sf $\sim$}  
   %
   \put(31,2){\sf\small $1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~20\end{center}
%\end{figure}

Вывод правила представлен на рис.~21.

% figure 21
%\begin{figure}
 \begin{center}
 \begin{picture}(60,12)
 \put(0,2)
 {
  \begin{picture}(60,10)
   % 1
   \put(1,5){\line(1,0){9}}
   \put(13,4){\sf $\sim$}  
   \put(13,7){\sf\footnotesize $6_1^0$}  
   % 2
   \put(21,5){\line(1,0){9}}
   \qbezier(21,4)(23,0)(20,0)
   \qbezier(19,4)(17,0)(20,0)
   \put(33,4){\sf $\sim$}  
   \put(33,7){\sf\footnotesize $5^0$}  
   % 3
   \put(41,5){\line(1,0){9}}
   \qbezier(41,4)(45,1)(50,5)
   \put(53,4){\sf $\sim$}  
   \put(53,7){\sf\footnotesize $6_2^0$}  
   % poles
   % 1
   \put(0,5){\circle{2}}
   \put(10,5){\circle*{1}}
   % 2
   \put(20,5){\circle{2}}
   \put(30,5){\circle*{1}}
   % 3
   \put(40,5){\circle{2}}
   \put(50,5){\circle*{1}}
   % 4
   \put(60,5){\circle{2}}
   %labels
   % 1
%   \put(1,7){\sf\small $1$}  
   \put(4,6){\sf\footnotesize $x_1$}  
   % 2
%   \put(21,7){\sf\small $1$}  
   \put(24,6){\sf\footnotesize $x_1$}  
   \put(23,1){\sf\footnotesize $x_1$}  
   % 3
%   \put(41,7){\sf\small $1$}  
   \put(44,6){\sf\footnotesize $x_1$}  
   \put(44,0){\sf\footnotesize $x_1$}  
   % 4
   \put(61,7){\sf\small $1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~21\end{center}
%\end{figure}

8$^\circ$. \Rf рис.~22.

% figure 22
%\begin{figure}
 \begin{center}
 \begin{picture}(60,5)
 \put(3,2)
 {
  \begin{picture}(50,5)
   % 
   \put(1,0){\line(1,0){9}}
   \put(19,0){\line(-1,0){9}}
   % 
   \put(31,0){\line(1,0){18}}
   %\put(49,0){\line(-1,0){9}}
   %
   \put(0,0){\circle{2}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle{2}}
   %
   \put(30,0){\circle{2}}
   %\put(40,0){\circle*{1}}
   \put(50,0){\circle{2}}
   %labels
   \put(-3,2){\sf\small $1$}  
   \put(21,2){\sf\small $2$}  
   \put(4,1){\sf\footnotesize $x_1$}  
   \put(14,1){\sf\footnotesize $x_1$}  
   %
   \put(23,-1){\sf $\sim$}  
   %
   \put(27,2){\sf\small $1$}  
   \put(51,2){\sf\small $2$}  
   %\put(34,1){\sf\footnotesize $x_2$}  
   \put(39,1){\sf\footnotesize $x_1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~22\end{center}
%\end{figure}

Вывод правила представлен на рис.~23.

% figure 23
%\begin{figure}
 \begin{center}
 \begin{picture}(60,12)
 \put(0,5)
 {
  \begin{picture}(60,10)
   % 1
   \put(1,0){\line(1,0){9}}
   \put(19,0){\line(-1,0){9}}
   \put(23,-1){\sf $\sim$}  
   \put(23,2){\sf\footnotesize $5^0$}  
   % 2
   \put(39,-1){\line(-2,-1){9}}
   \qbezier(31,1)(35,6)(39,1)
   \put(43,-1){\sf $\sim$}  
   \put(43,2){\sf\footnotesize $7^0$}  
   % 3
   \put(51,0){\line(1,0){8}}
   % poles
   % 1
   \put(0,0){\circle{2}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle{2}}
   % 2
   \put(30,0){\circle{2}}
   \put(30,-5){\circle*{1}}
   \put(40,0){\circle{2}}
   % 3
   \put(50,0){\circle{2}}
   \put(60,0){\circle{2}}
   %labels
   % 1
   \put(4,1){\sf\footnotesize $x_1$}  
   \put(14,1){\sf\footnotesize $x_1$}  
   % 2
   \put(35,4){\sf\footnotesize $x_1$}  
   \put(33,-1){\sf\footnotesize $x_1$}  
   % 3
   \put(54,1){\sf\footnotesize $x_1$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~23\end{center}
%\end{figure}

9$^\circ$. \Rf рис.~24.

% figure 24
%\begin{figure}
 \begin{center}
 \begin{picture}(50,12)
 \put(-2,2)
 {
  \begin{picture}(50,10)
   % 1
   \put(1,5){\line(1,0){9}}
   \put(10,5){\line(2,1){9}}
   \put(10,5){\line(2,-1){9}}
   % 2
   \put(31,6){\line(2,1){9}}
   \put(31,4){\line(2,-1){9}}
   \put(40,10){\line(1,0){9}}
   \put(40,0){\line(1,0){9}}
   % 1
   \put(0,5){\circle{2}}
   \put(10,5){\circle*{1}}
   \put(20,0){\circle{2}}
   \put(20,10){\circle{2}}
   % 2
   \put(30,5){\circle{2}}
   \put(40,0){\circle*{1}}
   \put(40,10){\circle*{1}}
   \put(50,0){\circle{2}}
   \put(50,10){\circle{2}}
   %labels
   % 1
   \put(0,7){\sf\small $1$}  
   \put(22,9){\sf\small $2$}  
   \put(22,-2){\sf\small $3$}  
   \put(4,6){\sf\footnotesize $x_1$}  
   \put(13,9){\sf\footnotesize $x_2$}  
   \put(13,-1){\sf\footnotesize $\overline{x_2}$}  
   %
   \put(23,4){\sf $\sim$}  
   % 2
   \put(30,7){\sf\small $1$}  
   \put(52,9){\sf\small $2$}  
   \put(52,-2){\sf\small $3$}  
   \put(33,9){\sf\footnotesize $x_1$}  
   \put(33,0){\sf\footnotesize $x_1$}  
   \put(44,11){\sf\footnotesize $x_2$}  
   \put(44,-3){\sf\footnotesize $\overline{x_2}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~24\end{center}
%\end{figure}

Вывод правила представлен на рис.~25.

% figure 25
%\begin{figure}
 \begin{center}
 \begin{picture}(130,12)
 \put(-2,2)
 {
  \begin{picture}(130,10)
   % 1
   \put(1,5){\line(1,0){9}}
   \put(10,5){\line(2,1){9}}
   \put(10,5){\line(2,-1){9}}
   % 2
   \put(31,6){\line(2,1){9}}
   \put(31,4){\line(2,-1){9}}
   \put(50,5){\line(-2,1){10}}
   \put(50,5){\line(-2,-1){10}}
   \put(50,5){\line(2,1){9}}
   \put(50,5){\line(2,-1){9}}
   % 3
   \put(71,6){\line(2,1){9}}
   \put(71,4){\line(2,-1){9}}
   \put(80,0){\line(1,0){19}}
   \put(80,10){\line(1,0){19}}
   \put(90,5){\line(2,1){9}}
   \put(90,5){\line(2,-1){9}}
   % 4
   \put(111,6){\line(2,1){9}}
   \put(111,4){\line(2,-1){9}}
   \put(120,0){\line(1,0){9}}
   \put(120,10){\line(1,0){9}}
   %poles
   % 1
   \put(0,5){\circle{2}}
   \put(10,5){\circle*{1}}
   \put(20,0){\circle{2}}
   \put(20,10){\circle{2}}
   % 2
   \put(30,5){\circle{2}}
   \put(40,0){\circle*{1}}
   \put(40,10){\circle*{1}}
   \put(50,5){\circle*{1}}
   \put(60,0){\circle{2}}
   \put(60,10){\circle{2}}
   % 3
   \put(70,5){\circle{2}}
   \put(80,0){\circle*{1}}
   \put(80,10){\circle*{1}}
   \put(90,5){\circle*{1}}
   \put(100,0){\circle{2}}
   \put(100,10){\circle{2}}
   % 4
   \put(110,5){\circle{2}}
   \put(120,0){\circle*{1}}
   \put(120,10){\circle*{1}}
   \put(130,0){\circle{2}}
   \put(130,10){\circle{2}}
   %sims
   \put(23,4){\sf $\sim$}  
   \put(23,7){\sf\footnotesize $4^0$}  
   %
   \put(63,4){\sf $\sim$}  
   \put(63,7){\sf\footnotesize $5^0$}  
   \put(63,1){\sf\footnotesize $5^0$}  
   %
   \put(103,4){\sf $\sim$}  
   \put(103,7){\sf\footnotesize $2^0$}  
   %labels
   % 1
   \put(4,6){\sf\footnotesize $x_1$}  
   \put(13,9){\sf\footnotesize $x_2$}  
   \put(13,-1){\sf\footnotesize $\overline{x_2}$}  
   % 2
   \put(33,9){\sf\footnotesize $x_1$}  
   \put(33,0){\sf\footnotesize $x_1$}  
   \put(44,9){\sf\footnotesize $x_2$}  
   \put(44,-1){\sf\footnotesize $\overline{x_2}$}  
   \put(54,9){\sf\footnotesize $x_2$}  
   \put(54,-1){\sf\footnotesize $\overline{x_2}$}  
   % 3
   \put(73,9){\sf\footnotesize $x_1$}  
   \put(73,0){\sf\footnotesize $x_1$}  
   \put(84,11){\sf\footnotesize $x_2$}  
   \put(84,-3){\sf\footnotesize $\overline{x_2}$}  
   \put(90,7){\sf\footnotesize $x_2$}  
   \put(90,1){\sf\footnotesize $\overline{x_2}$}  
   % 4
   \put(113,9){\sf\footnotesize $x_1$}  
   \put(113,0){\sf\footnotesize $x_1$}  
   \put(124,11){\sf\footnotesize $x_2$}  
   \put(124,-3){\sf\footnotesize $\overline{x_2}$}  
   
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~25\end{center}
%\end{figure}

9$^\circ_m$. \Rf рис.~26. Это своего рода обобщение правила 9$^\circ$.

% figure 26
%\begin{figure}
 \begin{center}
 \begin{picture}(110,12)
 \put(-2,2)
 {
  \begin{picture}(110,10)
   % 1
   \put(1,5){\line(1,0){19}}
   \put(30,5){\line(1,0){10}}
   \put(40,5){\line(2,1){9}}
   \put(40,5){\line(2,-1){9}}
   \put(23,4){\sf $\cdots$}  
   % 2
   \put(61,6){\line(2,1){9}}
   \put(61,4){\line(2,-1){9}}
   \put(70,10){\line(1,0){10}}
   \put(90,10){\line(1,0){19}}
   \put(70,0){\line(1,0){10}}
   \put(90,0){\line(1,0){19}}
   \put(83,9){\sf $\cdots$}  
   \put(83,-1){\sf $\cdots$}  
   %poles
   % 1
   \put(0,5){\circle{2}}
   \put(10,5){\circle*{1}}
   \put(40,5){\circle*{1}}
   \put(50,0){\circle{2}}
   \put(50,10){\circle{2}}
   % 2
   \put(60,5){\circle{2}}
   \put(70,0){\circle*{1}}
   \put(70,10){\circle*{1}}
   \put(100,0){\circle*{1}}
   \put(100,10){\circle*{1}}
   \put(110,0){\circle{2}}
   \put(110,10){\circle{2}}
   %labels
   % 1
   \put(0,7){\sf\small $1$}  
   \put(52,9){\sf\small $2$}  
   \put(52,-2){\sf\small $3$}  
   \put(4,6){\sf\footnotesize $x_1$}  
   \put(14,6){\sf\footnotesize $x_2$}  
   \put(31,6){\sf\footnotesize $x_{m-1}$}  
   \put(43,9){\sf\footnotesize $x_m$}  
   \put(43,-1){\sf\footnotesize $\overline{x_m}$}  
   %
   \put(53,4){\sf $\sim$}  
   % 2
   \put(60,7){\sf\small $1$}  
   \put(112,9){\sf\small $2$}  
   \put(112,-2){\sf\small $3$}  
   \put(63,9){\sf\footnotesize $x_1$}  
   \put(63,0){\sf\footnotesize $x_1$}  
   \put(73,11){\sf\footnotesize $x_2$}  
   \put(73,-3){\sf\footnotesize $x_2$}  
   \put(91,11){\sf\footnotesize $x_{m-1}$}  
   \put(91,-3){\sf\footnotesize $x_{m-1}$}  
   \put(103,11){\sf\footnotesize $x_m$}  
   \put(103,-3){\sf\footnotesize $\overline{x_m}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~26\end{center}
%\end{figure}

Один шаг вывода правила представлен на рис.~27. 
Далее повторяется аналогичная последовательность действий.

% figure 27
%\begin{figure}
 \begin{center}
 \begin{picture}(135,35)
 \put(-1,3)
 {
  \begin{picture}(135,30)
   %lines
   % 1
   \put(11,25){\line(1,0){14}}
   \put(40,25){\line(1,0){5}}
   \put(45,25){\line(2,1){9}}
   \put(45,25){\line(2,-1){9}}
   \put(30,24){\sf $\cdots$}  
   % 2
   \put(66,25){\line(1,0){14}}
   \put(95,25){\line(1,0){5}}
   \put(100,25){\line(2,1){9}}
   \put(100,25){\line(2,-1){9}}
   \put(110,20){\line(1,0){9}}
   \put(110,30){\line(1,0){9}}
   \put(85,24){\sf $\cdots$}  
   % 3
   \put(6,5){\line(1,0){14}}
   \put(35,5){\line(1,0){5}}
   \put(40,5){\line(2,1){9}}
   \put(40,5){\line(2,-1){9}}
   \put(50,0){\line(1,0){9}}
   \put(50,10){\line(1,0){9}}
   \put(25,4){\sf $\cdots$}  
   % 4
   \put(71,5){\line(1,0){14}}
   \put(100,5){\line(1,0){5}}
   \put(105,5){\line(2,1){9}}
   \put(105,5){\line(2,-1){9}}
   \put(115,0){\line(1,0){19}}
   \put(115,10){\line(1,0){19}}
   \put(90,4){\sf $\cdots$}  
   %poles
   % 1
   \put(10,25){\circle{2}}
   \put(20,25){\circle*{1}}
   \put(45,25){\circle*{1}}
   \put(55,20){\circle{2}}
   \put(55,30){\circle{2}}
   % 2
   \put(65,25){\circle{2}}
   \put(75,25){\circle*{1}}
   \put(100,25){\circle*{1}}
   \put(110,20){\circle*{1}}
   \put(110,30){\circle*{1}}
   \put(120,20){\circle{2}}
   \put(120,30){\circle{2}}
   % 3
   \put(5,5){\circle{2}}
   \put(15,5){\circle*{1}}
   \put(40,5){\circle*{1}}
   \put(50,0){\circle*{1}}
   \put(50,10){\circle*{1}}
   \put(60,0){\circle{2}}
   \put(60,10){\circle{2}}
   % 4
   \put(70,5){\circle{2}}
   \put(80,5){\circle*{1}}
   \put(105,5){\circle*{1}}
   \put(115,0){\circle*{1}}
   \put(115,10){\circle*{1}}
   \put(125,0){\circle*{1}}
   \put(125,10){\circle*{1}}
   \put(135,0){\circle{2}}
   \put(135,10){\circle{2}}
   %labels
   % 1
   \put(14,26){\sf\footnotesize $x_1$}  
   \put(48,29){\sf\footnotesize $x_m$}  
   \put(48,19){\sf\footnotesize $\overline{x_m}$}  
   % 1->2
   \put(58,24){\sf $\sim$}  
   \put(58,27){\sf\footnotesize $9^0$}  
   % 2
   \put(69,26){\sf\footnotesize $x_1$}  
   \put(100,29){\sf\footnotesize $x_{m-1}$}  
   \put(100,20){\sf\footnotesize $x_{m-1}$}  
   \put(113,31){\sf\footnotesize $x_m$}  
   \put(113,17){\sf\footnotesize $\overline{x_m}$}  
   % 2->3
   \put(123,24){\sf $\sim$}  
   \put(123,27){\sf\footnotesize $2^0$}  
   % 2->3 again
   \put(-2,4){\sf $\sim$}  
   \put(-2,7){\sf\footnotesize $2^0$}  
   % 3
   \put(9,6){\sf\footnotesize $x_1$}  
   \put(41,0){\sf\footnotesize $\overline{x_m}$}  
   \put(41,9){\sf\footnotesize $x_m$}  
   \put(51,11){\sf\footnotesize $x_{m-1}$}  
   \put(51,-2){\sf\footnotesize $x_{m-1}$}  
   % 3->4
   \put(63,4){\sf $\sim$}  
   \put(63,7){\sf\footnotesize $9^0$}  
   % 4
   \put(74,6){\sf\footnotesize $x_1$}  
   \put(105,9){\sf\footnotesize $x_{m-2}$}  
   \put(105,0){\sf\footnotesize $x_{m-2}$}  
   \put(118,-3){\sf\footnotesize $\overline{x_m}$}  
   \put(118,11){\sf\footnotesize $x_m$}  
   \put(126,11){\sf\footnotesize $x_{m-1}$}  
   \put(126,-2){\sf\footnotesize $x_{m-1}$}  
  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~27\end{center}
%\end{figure}

Рассмотрим теперь обобщения правил 1$^\circ$~--~6$^\circ$ на случай цепей $I$ вида
$x^{\sigma_1}_1 x^{\sigma_2}_2 \cdots x^{\sigma_n}_n$.

I. Удаление и добавление изолированной вершины. Это правило неизменно переносится на случай цепей.

II. Эквивалентность цепей $I$ и $\Tilde I$ с теми же, но расставленными в другом порядке контактами.

III. \Rf рис.~28. Здесь ${I_1, I_2, \ldots, I_{2^n}}$~--- всевозможные $n$--контактные цепи,
выходящие из вершины, не являющейся полюсом.

% figure 28
%\begin{figure}
 \begin{center}
 \begin{picture}(75,20)
 \put(0,5)
 {
  \begin{picture}(75,15)
   %lines
   % 1
   \put(15,15){\line(-1,-1){14}}
   \put(15,15){\line(-1,-3){5}}
   \put(15,15){\line(1,-1){14}}
   \put(18,-1){\sf $\cdots$}  
   % 2
   \put(63,4){\sf $\cdots$}  
   %poles
   % 1
   \put(0,0){\circle{2}}
   \put(10,0){\circle{2}}
   \put(30,0){\circle{2}}
   \put(15,15){\circle*{1}}
   % 2
   \put(45,5){\circle{2}}
   \put(55,5){\circle{2}}
   \put(75,5){\circle{2}}
   %labels
   % 1
   \put(0,-5){\sf\small $1$}  
   \put(10,-5){\sf\small $2$}  
   \put(30,-5){\sf\small $2^n$}  
   \put(4,8){\sf\footnotesize $I_1$}  
   \put(14,8){\sf\footnotesize $I_2$}  
   \put(24,8){\sf\footnotesize $I_{2^n}$}  
   %
   \put(35,4){\sf $\sim$}  
   % 2
   \put(45,0){\sf\small $1$}  
   \put(55,0){\sf\small $2$}  
   \put(75,0){\sf\small $2^n$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~28\end{center}
%\end{figure}


Докажем правило III индукцией по $n$. При ${n=1}$ имеем в точности правило 3$^\circ$. 
Предположим, что III справедливо для цепей длины $n-1$, и покажем, что оно справедливо также
для цепей длины $n$. 
% figure 29
 \begin{center}
 \begin{picture}(50,20)
 \put(-2,5)
 {
  \begin{picture}(50,15)
   %lines
   \put(25,15){\line(-2,-1){20}}
   \put(25,15){\line(2,-1){20}}
   \put(25,15){\line(-1,-2){5}}
   \put(5,5){\line(-1,-1){4}}
   \put(5,5){\line(1,-1){4}}
   \put(20,5){\line(-1,-1){4}}
   \put(20,5){\line(1,-1){4}}
   \put(45,5){\line(-1,-1){4}}
   \put(45,5){\line(1,-1){4}}
   \put(30,-1){\sf $\cdots$}  
   %poles
   \put(0,0){\circle{2}}
   \put(10,0){\circle{2}}
   \put(15,0){\circle{2}}
   \put(25,0){\circle{2}}
   \put(40,0){\circle{2}}
   \put(50,0){\circle{2}}
   \put(5,5){\circle*{1}}
   \put(20,5){\circle*{1}}
   \put(45,5){\circle*{1}}
   \put(25,15){\circle*{1}}
   %labels
   \put(-1,-5){\sf\small $1$}  
   \put(9,-5){\sf\small $2$}  
   \put(14,-5){\sf\small $3$}  
   \put(24,-5){\sf\small $4$}  
   \put(35,-5){\sf\small $2^n - 1$}  
   \put(49,-5){\sf\small $2^n$}  
   \put(9,10){\sf\footnotesize $I'_1$}  
   \put(24,10){\sf\footnotesize $I'_2$}  
   \put(37,10){\sf\footnotesize $I'_{2^{n-1}}$}  
  \end{picture}
 } 
 \end{picture} 
 \begin{center}\small Рис.~29\end{center}
 \end{center}
 
Все цепи сгруппируем парами вида
$x^{\sigma_1}_1 \cdots x^{\sigma_{n-1}}_{n-1} x^{\sigma_n}_n$ и 
$x^{\sigma_1}_1 \cdots x^{\sigma_{n-1}}_{n-1} \overline{x^{\sigma_n}_n}$,
и к каждой такой паре применим правило 9$^\circ_n$. В~результате получится схема, общий вид
которой представлен на рис.~29. Использовав теперь правило 3$^\circ$ и предположение индукции, 
получим требуемое. Заметим, что некоторые из полюсов $1, 2, \ldots, 2^n$ могут совпадать.

IV. Пусть
$$
  x_1 = \bigvee\limits_{(\sigma_2, \ldots, \sigma_n)} x_1 x^{\sigma_2}_2 \cdots x^{\sigma_n}_n,
$$ 
и $I'_1, I'_2, \ldots, I'_{2^{n-1}}$~--- цепи, соответствующие этим конъюнкциям, тогда
имеет место правило, представленное на рис.~30.

% figure 30
%\begin{figure}
 \begin{center}
 \begin{picture}(40,15)
 % 
 \put(0,3)
 {
  \begin{picture}(40,10)
   % lines 
   \put(1,5){\line(1,0){8}}
   % curve 
   \qbezier(21,6)(30,15)(39,6)
   \qbezier(21,6)(30,10)(39,6)
   \qbezier(21,4)(30,-5)(39,4)
   % poles
   \put(0,5){\circle{2}}
   \put(10,5){\circle{2}}
   \put(20,5){\circle{2}}
   \put(40,5){\circle{2}}
   %
   \put(13,4){\sf $\sim$}  
   % labels
   \put(-2,7){\sf\small $1$}  
   \put(10,7){\sf\small $2$}  
   \put(18,7){\sf\small $1$}  
   \put(40,7){\sf\small $2$}  
   \put(29,3){$\vdots$}  
   \put(4,6){\footnotesize $x_1$}    
   \put(33,11){\footnotesize $I'_1$}    
   \put(33,4){\footnotesize $I'_2$}    
   \put(33,-3){\footnotesize $I'_{2^{n-1}}$}    
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~30\end{center}
%\end{figure}

Докажем правило IV так же индукцией по $n$. Случай ${n=2}$ есть в точности правило 4$^\circ$. 
Предположим, что правило справедливо для $n-1$, и покажем, что оно справедливо также для $n$. 
В~схеме для $n-1$ заменим каждый контакт $x^{\sigma_{n-1}}_{n-1}$ по правилу 4$^\circ$,
полагая вместо переменной $x_2$ переменную $x_n$. С полученными в результате цепями
поступим так, как изображено на рис.~31. 

% figure 31
%\begin{figure}
 \begin{center}
 \begin{picture}(115,30)
 \put(-2,3)
 {
  \begin{picture}(115,25)
   %lines
   % 1
   \put(1,20){\line(1,0){14}}
   \put(25,20){\line(1,0){5}}
   \put(30,20){\line(2,1){10}}
   \put(30,20){\line(2,-1){10}}
   \put(40,25){\line(2,-1){9}}
   \put(40,15){\line(2,1){9}}
   \put(18,19){\sf $\cdots$}  
   % 2
   \put(61,20){\line(1,0){14}}
   \put(85,20){\line(1,0){5}}
   \put(90,20){\line(2,1){10}}
   \put(90,20){\line(2,-1){10}}
   \put(100,25){\line(2,-1){9}}
   \put(100,15){\line(2,1){9}}
   \put(78,19){\sf $\cdots$}  
   % 3
   \put(40,0){\line(-2,1){9}}
   \put(40,10){\line(-2,-1){9}}
   \put(40,0){\line(1,0){5}}
   \put(40,10){\line(1,0){5}}
   \put(55,0){\line(1,0){24}}
   \put(55,10){\line(1,0){24}}
   \put(48,-1){\sf $\cdots$}  
   \put(48,9){\sf $\cdots$}  
   %poles
   % 1
   \put(0,20){\circle{2}}
   \put(10,20){\circle*{1}}
   \put(30,20){\circle*{1}}
   \put(40,25){\circle*{1}}
   \put(40,15){\circle*{1}}
   \put(50,20){\circle{2}}
   % 2
   \put(60,20){\circle{2}}
   \put(70,20){\circle*{1}}
   \put(90,20){\circle*{1}}
   \put(100,25){\circle*{1}}
   \put(100,15){\circle*{1}}
   \put(110,20){\circle{2}}
   % 3
   \put(30,5){\circle{2}}
   \put(40,10){\circle*{1}}
   \put(40,0){\circle*{1}}
   \put(60,10){\circle*{1}}
   \put(60,0){\circle*{1}}
   \put(70,10){\circle*{1}}
   \put(70,0){\circle*{1}}
   \put(80,10){\circle{2}}
   \put(80,0){\circle{2}}
   %labels
   % 1
   \put(4,21){\sf\footnotesize $x_1$}  
   \put(29,24){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(29,14){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(43,24){\sf\footnotesize $x_n$}  
   \put(43,14){\sf\footnotesize $\overline{x_n}$}  
   % 1->2
   \put(53,19){\sf $\sim$}  
   \put(53,22){\sf\footnotesize $2^0$}  
   % 2
   \put(64,21){\sf\footnotesize $x_1$}  
   \put(104,24){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(104,14){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(92,24){\sf\footnotesize $x_n$}  
   \put(92,14){\sf\footnotesize $\overline{x_n}$}  
   % 2->3
   \put(113,19){\sf $\sim$}  
   \put(113,22){\sf\footnotesize $9^0_n$}  
   % 2->3 again
   \put(23,4){\sf $\sim$}  
   \put(23,7){\sf\footnotesize $9^0_n$}  
   % 3
   \put(33,9){\sf\footnotesize $x_1$}  
   \put(33,0){\sf\footnotesize $x_1$}  
   \put(61,12){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(61,-4){\sf\footnotesize $x_{n-1}^{\sigma_{n-1}}$}  
   \put(73,11){\sf\footnotesize $x_n$}  
   \put(73,-3){\sf\footnotesize $\overline{x_n}$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~31\end{center}
%\end{figure}

Далее используем предположение индукции.

% figure 32
%\begin{figure}
 \begin{center}
 \begin{picture}(140,15)
 \put(-4,3)
 {
  \begin{picture}(140,10)
   %lines
   % 1
   \put(10,0){\line(-2,1){9}}
   \put(10,10){\line(-2,-1){9}}
   \put(10,0){\line(1,0){5}}
   \put(10,10){\line(1,0){5}}
   \put(25,0){\line(1,0){14}}
   \put(25,10){\line(1,0){14}}
   \put(18,9){\sf $\cdots$}  
   \put(18,-1){\sf $\cdots$}  
   % 2
   \put(60,10){\line(-2,-1){9}}
   \put(60,10){\line(0,-1){10}}
   \put(60,0){\line(1,0){5}}
   \put(60,10){\line(1,0){5}}
   \put(75,0){\line(1,0){14}}
   \put(75,10){\line(1,0){14}}
   \put(68,9){\sf $\cdots$}  
   \put(68,-1){\sf $\cdots$}  
   % 3
   \put(110,10){\line(-2,-1){9}}
   \put(110,10){\line(0,-1){10}}
   \put(110,0){\line(1,0){5}}
   \put(110,10){\line(1,0){5}}
   \put(125,0){\line(1,0){14}}
   \put(125,10){\line(1,0){14}}
   \put(118,9){\sf $\cdots$}  
   \put(118,-1){\sf $\cdots$}  
   %poles
   % 1
   \put(0,5){\circle{2}}
   \put(10,0){\circle*{1}}
   \put(10,10){\circle*{1}}
   \put(30,0){\circle*{1}}
   \put(30,10){\circle*{1}}
   \put(40,0){\circle{2}}
   \put(40,10){\circle{2}}
   % 2
   \put(50,5){\circle{2}}
   \put(60,0){\circle*{1}}
   \put(60,10){\circle*{1}}
   \put(80,0){\circle*{1}}
   \put(80,10){\circle*{1}}
   \put(90,0){\circle{2}}
   \put(90,10){\circle{2}}
   % 3
   \put(100,5){\circle{2}}
   \put(110,0){\circle*{1}}
   \put(110,10){\circle*{1}}
   \put(130,0){\circle*{1}}
   \put(130,10){\circle*{1}}
   \put(140,0){\circle{2}}
   \put(140,10){\circle{2}}
   %labels
   % 1
   \put(3,9){\sf\footnotesize $x_1$}  
   \put(3,0){\sf\footnotesize $x_1$}  
   \put(11,11){\sf\footnotesize $x_2$}  
   \put(11,-3){\sf\footnotesize $x_2$}  
   \put(33,11){\sf\footnotesize $x_n$}  
   \put(33,-3){\sf\footnotesize $x_n$}  
   % 1->2
   \put(43,4){\sf $\sim$}  
   \put(43,7){\sf\footnotesize $5^0$}  
   % 2
   \put(53,9){\sf\footnotesize $x_1$}  
   \put(61,11){\sf\footnotesize $x_2$}  
   \put(61,4){\sf\footnotesize $x_1$}  
   \put(61,-3){\sf\footnotesize $x_2$}  
   \put(83,11){\sf\footnotesize $x_n$}  
   \put(83,-3){\sf\footnotesize $x_n$}  
   % 2->3
   \put(93,4){\sf $\sim$}  
   \put(93,7){\sf\footnotesize $2^0$}  
   % 3
   \put(103,9){\sf\footnotesize $x_1$}  
   \put(111,11){\sf\footnotesize $x_2$}  
   \put(111,4){\sf\footnotesize $x_2$}  
   \put(111,-3){\sf\footnotesize $x_1$}  
   \put(133,11){\sf\footnotesize $x_n$}  
   \put(133,-3){\sf\footnotesize $x_n$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~32\end{center}
%\end{figure}

V. Схемное правило полностью аналогичное 5$^\circ$ с той лишь разницей, что вместо
контакта $x_1$ рассматривается цепь $I$. Вывод этого правила состоит в последовательном
применении ряда эквивалентностей, схожих с изображенной на рис.~32.

VI. Удаление цепи, являющейся циклом.


\begin{theorem}
Любые две эквивалентные контактные схемы, все переменные которых содержатся в множестве
${\{x_1, \ldots, x_n\}}$, можно преобразовать друг в друга с помощью правил системы $\gamma_n$.
\end{theorem}
{\bfДоказательство.}
Используем тот же подход, что был применен в случае формул и системы правил $\Delta$.
Введем определение. Пусть дана контактная схема $S$ с переменными из ${\{x_1, \ldots, x_n\}}$
и полюсами ${\alpha_1, \ldots, \alpha_s}$. Построим контактную схему $S'$ следующим образом.
Полюсы схемы $S'$ есть полюсы схемы $S$. Для любых двух полюсов $\alpha_i$ и $\alpha_j$ схемы $S$ 
представим их проводимость $f_{ij}$ в виде совершенной ДНФ по всем переменным ${x_1, \ldots, x_n}$,
и в схеме $S'$ соединим полюсы $\alpha_i$ и $\alpha_j$ цепями, соответствующими всем конъюнкциям
совершенной ДНФ. Полученная схема $S'$ называтся {\itканонической контактной схемой\/} для схемы $S$.
Понятно, что у эквивалентных контактных схем канонические схемы совпадают. В~этом смысле
осталось показать, что любую контактную схему $S$ можно преобразовать в каноническую с помощью
системы правил $\gamma_n$ (системы правил I~--~VI для цепей контактов).

Заменим каждый контакт схемы $S$ системой параллельно соединенных цепей по правилу IV.
Полученная контактная схема будет содержать вершины трех типов: полюсы, бывшие внутренние
вершины и вершины между контактами внутри цепей. Будем уничтожать бывшие внутренние
вершины. Рассмотрим бывшую вершину $\beta$. Предположим, что из нее выходит $t$ цепей $I_i$
к вершинам ${\delta_1, \ldots, \delta_t}$. Выберем одну из $\delta_j$ и применим правило V
(\rf рис.~33).

% figure 33
%\begin{figure}
 \begin{center}
 \begin{picture}(45,20)
 % 'drops'
 \put(1,2)
 {
  \begin{picture}(45,15)
   % lines 
   \put(0,0){\line(0,1){15}}
   % curve 
   \qbezier(0,0)(5,5)(10,0)
   \qbezier(0,0)(10,10)(20,0)
   \qbezier(0,0)(20,20)(40,0)
   % poles
   \put(0,0){\circle*{1}}
   \put(10,0){\circle*{1}}
   \put(20,0){\circle*{1}}
   \put(40,0){\circle*{1}}
   \put(0,15){\circle*{1}}
    % labels
   \put(28,-1){$\cdots$}  
   \put(-3,7){\footnotesize $I_i$}    
   \put(5,-1){\footnotesize $I_i$}    
   \put(15,5){\footnotesize $I_i$}    
   \put(35,6){\footnotesize $I_i$}    
   \put(1,15){\small $\beta$}  
   \put(-3,-3){\small $\delta_1$}  
   \put(11,-3){\small $\delta_2$}  
   \put(21,-3){\small $\delta_3$}  
   \put(41,-3){\small $\delta_t$}  
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~33\end{center}
%\end{figure}

Таким же образом поступим с цепями других сортов произвольной фиксированной вершины $\beta$.
Используем правило 7$^\circ$ и добавим к $\beta$ все недостающие цепи в одном экземпляре.
Теперь у вершины $\beta$ будут цепи по одной каждого сорта. Воспользовавшись правилом III,
удалим внутреннюю вершину $\beta$, а также все ей подобные вершины. В~результате в схеме
соединятся цепями будут только полюсы. Однако, возможны циклы. Пусть, например, полюсы
$\alpha_i$ и $\alpha_j$ соединены цепью $I$, проходящей, возможно, и через другие полюсы.
Добавим еще одну прямую цепь $I$, соединяющую полюсы $\alpha_i$ и $\alpha_j$. Одинаковые
цепи между некоторыми полюсами переведем в циклы по правилу V, а сами циклы устраним
в соответствии с правилом VI. В~итоге схема примет вид канонической.
Теорема доказана.

Рассмотрим контактную схему $S$ с проводимостью $f(x_1, \ldots, x_n)$. Пусть $\Tilde\sigma$~---
произвольный набор из ${\mathbb E}_2^n$. Построим на основе $S$ граф $G$, соответствующий значению 
$f(\Tilde\sigma)$. Введем для графа $G$ функции 
$$
{
 \varphi_n(S, \Tilde\sigma) = p + q + r\!\!\!\pmod{2},
 \quad
 \varphi_n(S) = \bigoplus\limits_{\Tilde\sigma} \varphi_n(S, \Tilde\sigma),
}
$$
где $p$~--- число вершин, $q$~--- число ребер, $r$~--- число граней графа $G$.
Например, схеме $S$, изображенной на рис.~34,\;а, при ${\Tilde\sigma = (0,1,1)}$
соответствует граф $G$ (\rf рис.~34,\;б), и в этом случае
${\varphi_n(S, \Tilde\sigma) = 4 + 3 + 1\!\pmod{2} = 0}$.

% figure 34
\begin{figure}
 \begin{center}
 \begin{picture}(55,25)
 % 'diamonds'
 \put(-2,5)
 {
  \begin{picture}(55,25)
   % .
   \put(10,0){\line(-1,1){10}}
   \put(10,0){\line(1,1){10}}
   \put(10,20){\line(-1,-1){10}}
   \put(10,20){\line(1,-1){10}}
   \put(0,10){\line(1,0){20}}
   %
   \put(45,0){\line(-1,1){10}}
   \put(45,20){\line(1,-1){10}}
   \put(35,10){\line(1,0){20}}
   % poles
   \put(0,10){\circle*{1}}
   \put(10,0){\circle*{1}}
   \put(20,10){\circle*{1}}
   \put(10,20){\circle*{1}}
   %
   \put(35,10){\circle*{1}}
   \put(45,0){\circle*{1}}
   \put(55,10){\circle*{1}}
   \put(45,20){\circle*{1}}
    % labels
   \put(1,15){\footnotesize $x_1$}
   \put(16,15){\footnotesize $x_2$}
   \put(9,11){\footnotesize $x_3$}
   \put(2,2){\footnotesize $\overline{x_1}$}
   \put(15,2){\footnotesize $\overline{x_2}$}
   % picnums
   \put(10,-5){\small\it а)}
   \put(45,-5){\small\it б)}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~34\end{center}
\end{figure}

\begin{lemma}
Правила 1$^\circ$ --- 5$^\circ$ не изменяют значение функции $\varphi_n(S)$.
\end{lemma}
{\bfДоказательство.}
1$^\circ$. Пусть схема $S''$ получена из схемы $S'$ путем удаления изолированной вершины.
Соответствующие схемам графы обозначим через $G''$ и $G'$. Если $(p,q,r)$~--- параметры графа
$G'$, то параметрами графа $G''$ станут $(p-1,q,r-1)$. Их сумма по модулю 2, как видно, 
останется прежней.

2$^\circ$. Рассмотрим теперь цепь схемы $S'$, соединяющую вершины $\alpha$ и $\beta$ и
состоящую, например, из контактов $x_1$ и $x_2$. В схеме $S''$ эти контакты следуют в обратном
порядке. Тогда при подстановке наборов $(0,0,\sigma_3, \ldots, \sigma_n)$ и
$(1,1,\sigma_3, \ldots, \sigma_n)$ соответствующие графы будут идентичны.
А при подстановке набора $(0,1,\sigma_3, \ldots, \sigma_n)$ (или, скажем, $(1,0,\sigma_3, \ldots, \sigma_n)$)
графы хотя и могут измениться, но их параметры $(p,q,r)$ сохранятся.

3$^\circ$. Допустим, что правило применяется по переменной $x_1$. При подстановке в схемы 
$S'$ и $S''$ набора $(0,\sigma_2, \ldots, \sigma_n)$ (или $(1,\sigma_2, \ldots, \sigma_n)$)
соответствующие графы $G'$ и $G''$ имеют параметры $(p,q,r)$ и ${(p-1,q-1,r)}$, как видно,
одинаковой суммы.

4$^\circ$. Аналогично, подставив в схемы $S'$ и $S''$ набор $(0,\sigma_2, \ldots, \sigma_n)$,
получим графы $G'$ и $G''$ параметров $(p,q,r)$ и ${(p+2,q+1,r+1)}$,
а подставив набор $(1,\sigma_2, \ldots, \sigma_n)$~--- графы
параметров $(p,q,r)$ и ${(p+2,q+2,r)}$. Сумма снова будет одинаковой.

5$^\circ$. В~данном случае, подставив набор $(1,\sigma_2, \ldots, \sigma_n)$, получим графы, 
имеющие одни и те же параметры $(p,q,r)$,
а при подстановке набора $(0,\sigma_2, \ldots, \sigma_n)$ графы будут и вовсе одинаковыми.
Лемма доказана.

Покажем, что подобное утверждение для правила 6$^\circ_n$ не имеет места.
Если подставить в схемы $S'$ и $S''$ набор $(1,1, \ldots, 1)$, соответствующие графы $G'$ и $G''$ 
будут иметь параметры $(p,q,r)$ и ${(p-(n-1),q-n,r)}$ неодинаковой суммы по модулю 2.
Если это набор $(1, \ldots, 1,0,1, \ldots, 1)$, графы будут иметь параметры $(p,q,r)$ 
и ${(p-(n-1),q-(n-1),r)}$ одинаковой суммы. Сумма также будет одинаковой и при подстановке
набора $(1, \ldots, 1,0,1, \ldots, 1,0,1, \ldots, 1)$, хотя при этом граф $G''$ будет иметь
две компоненты связности (одна из которых, возможно, не содержит ребер).

Таким образом, можно сделать вывод, что
${\varphi_n(S', \Tilde\sigma) \ne \varphi_n(S'', \Tilde\sigma)}$ только для набора
${\Tilde\sigma = (1,1, \ldots, 1)}$, следовательно 
$$
 \varphi_n(S') = \varphi_n(S'') + 1\!\!\!\pmod{2}
$$ 
для правила 6$^\circ_n$.
Вместе с тем, если добавить несущественную переменную $x_{n+1}$ для функции $\varphi_{n+1}$ 
в правиле 6$^\circ_n$, то на наборах $(1, \ldots, 1, 1)$ и $(1, \ldots, 1, 0)$ произойдет
удвоение значений, \ie ${\varphi_{n+1}(S') = \varphi_{n+1}(S'')}$.

\begin{theorem}
Не существует полной конечной системы правил в случае произвольного числа переменных.
\end{theorem}
{\bfДокажем} методом \glqqот противного\grqq{}. Допустим, что $\Gamma$~--- полная конечная 
система преобразований такая, что каждое ее правило содержит произвольное конечное число 
переменных. Пусть число переменных $\Gamma$ есть $N$. Рассмотрим правило 6$^\circ_{N+1}$. 
По предположению оно выводимо из системы $\Gamma$. Но в силу полноты системы $\gamma_N$, 
правило 6$^\circ_{N+1}$ выводимо и из $\gamma_N$. Правила системы $\gamma_N$ (и в том числе 
правило 6$^\circ_N$) не изменяют значение функции $\varphi_{N+1}$. Следовательно, каждое правило, 
выводимое из системы $\gamma_N$, должно сохранять значение функции $\varphi_{N+1}$. 
Однако, это не так: выводимое из $\gamma_N$ правило 6$^\circ_{N+1}$ не сохраняет значение 
$\varphi_{N+1}$. Теорема доказана.




%5
\chapter{Контроль работы схем}

% par
\section{Самокорректирующиеся контактные схемы}
Рассмотрим произвольный контакт $x^{\sigma}_i$ контактной схемы. Напомним, что разомкнуть этот контакт~---
значит удалить ребро с нагрузкой $x^{\sigma}_i$, замкнуть контакт~--- отождествить концы того же ребра.
Можно построить такую схему, которая самокорректировалась бы относительно замыкания/размыкания контакта
$x^{\sigma}_i$. В самом деле, если заменить этот контакт на \glqqромб\grqq{}, изображенный на рис.~35,
то замыкание/размыкание контакта $x^{\sigma}_i$ уже не повлияет на работу схемы. Аналогично, если в произвольной
контактной схеме каждый контакт заменить на соответствующий \glqqромб\grqq{}, получим самокорректировку
относительно одного замыкания/размыкания. Если теперь требуется защитить схему от $a$ замыканий и $b$ 
размыканий, то согласно той же логике, каждый контакт $x^{\sigma}_i$ придется заменять многомерным
\glqqромбом\grqq{} с $a+1$ параллельно соединенными цепями длины $b+1$.

% figure 35
\begin{figure}
 \begin{center}
 \begin{picture}(20,25)
 % single diamond
 \put(3,1)
 {
  \begin{picture}(15,20)
   % .
   \put(4,1){\line(-1,2){4}}
   \put(6,1){\line(1,2){4}}
   \put(4,19){\line(-1,-2){4}}
   \put(6,19){\line(1,-2){4}}
   % poles
   \put(5,0){\circle{2}}
   \put(5,20){\circle{2}}
   \put(0,10){\circle*{1}}
   \put(10,10){\circle*{1}}
    % labels
   \put(9,4){\footnotesize $x^{\sigma}_i$}
   \put(9,15){\footnotesize $x^{\sigma}_i$}
   \put(-2,15){\footnotesize $x^{\sigma}_i$}
   \put(-2,4){\footnotesize $x^{\sigma}_i$}
   \put(6,21){\small $\alpha$}
   \put(6,-3){\small $\beta$}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~35\end{center}
\end{figure}

Рассмотрим процесс построения самокорректирующейся контактной схемы асимптотически наилучшим способом.
Вспомним, что использовалось табличное задание функции $f$ (\rf табл.~1) и затем разложение  
$$
 f(x_1, \ldots, x_n) = \bigvee\limits_{(i,j)} f_{ij}(x_1, \ldots, x_n)
$$
для $i$--й горизонтальной и $j$--й вертикальной полос. Схема представляла собой следующее: 
характеристическая функция по переменным ${x_1, \ldots, x_r}$, 
разделительное контактное дерево по переменным ${x_{r+1}, \ldots, x_{n-k}}$ и, наконец,
пучки контактов ${x_{n-k+1}, \ldots, x_n}$. Причем, именно на пучки контактов пришлась
главная часть асимптотики. В~пучках для каждого номера $h$ собрали в полюс--выход $c$ все контакты 
$x_h^{\overline{\alpha_h}}$, выходящие из некоторых полюсов ${b_1, \ldots, b_t}$.

1. Случай одного замыкания. Вне пучков будем дублировать контакты последовательно. На асимптотике
сложности всей схемы это никак не отразится. С~каждым из пучков поступим так: 
вставим еще один промежуточный контакт $x_h^{\overline{\alpha_h}}$ перед полюсом $c$ (\rf рис.~36). 
Проводимость останется той же, зато схема станет устойчивой к замыканию одного контакта.
Сложность схемы асимптотически не увеличится: всего добавится 
$$
 r = 2^{\lceil\frac{1}{2}\log_2 n\rceil}
$$ 
контактов на каждый полюс $c$, что есть $o({2^n}/n)$.

% figure 36
\begin{figure}
 \begin{center}
 \begin{picture}(60,35)
 % 
 \put(4,0)
 {
  \begin{picture}(50,35)
   % 
   \put(25,1){\line(0,1){13}}
   \put(25,15){\line(-5,3){25}}
   \put(25,15){\line(5,3){25}}
   \put(25,15){\line(-2,3){10}}
   \put(0,30){\line(0,1){5}}
   \put(15,30){\line(0,1){5}}
   \put(50,30){\line(0,1){5}}
   % poles
   \put(25,0){\circle{2}}
   \put(25,15){\circle*{1}}
   \put(0,30){\circle*{1}}
   \put(15,30){\circle*{1}}
   \put(50,30){\circle*{1}}
    % labels
   \put(-4,31){\small $b_1$}
   \put(11,31){\small $b_2$}
   \put(51,31){\small $b_t$}
   \put(27,13){\small $d$}
   \put(27,-2){\small $c$}
   \put(18,6){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(7,16){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(39,17){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(22,22){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(30,29){$\cdots$}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~36\end{center}
\end{figure}

2. Случай одного размыкания. Вне пучков дублируем контакты параллельно. 
В пучках заменим сходящиеся к полюсу $c$ контакты $x_h^{\overline{\alpha_h}}$ на цикл (\rf рис.~37). 
Такая схема устойчива к размыканию одного контакта.
Аналогично, сложность схемы асимптотически не увеличится.

% figure 37
\begin{figure}
 \begin{center}
 \begin{picture}(60,20)
 % 
 \put(4,0)
 {
  \begin{picture}(50,20)
   % 
   \put(24,1){\line(-5,3){24}}
   \put(26,1){\line(5,3){24}}
   \put(0,15){\line(0,1){5}}
   \put(15,15){\line(0,1){5}}
   \put(50,15){\line(0,1){5}}
   \put(0,15){\line(1,0){15}}
   \put(15,15){\line(1,0){10}}
   \put(40,15){\line(1,0){10}}
   % poles
   \put(25,0){\circle{2}}
   \put(0,15){\circle*{1}}
   \put(15,15){\circle*{1}}
   \put(50,15){\circle*{1}}
    % labels
   \put(-4,17){\small $b_1$}
   \put(11,17){\small $b_2$}
   \put(51,17){\small $b_t$}
   \put(26,-3){\small $c$}
   \put(7,1){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(39,2){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(4,17){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(18,17){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(42,17){\footnotesize $x^{\overline{\alpha_h}}_h$}
   \put(30,14){$\cdots$}
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}\small Рис.~37\end{center}
\end{figure}

Рассмотрим другой подход. Пусть неисправность (любого рода) в контактной схеме появляется с 
вероятностью ${p = \const}$. Требуется построить схему, которая работала бы правильно почти всегда.
Возьмем, к примеру, простейшую схему, изображенную на рис.~35. 

1) Если ${x^{\sigma}_i = 1}$, то неисправность~--- размыкание. Следовательно, корректно работать
контакт будет с вероятностью $1-p$. Цепь замкнута, когда замкнуты оба контакта, поэтому цепь будет
разомкнутой с вероятностью $1 - (1-p)^2$. Вся схема окажется разомкнутой с вероятностью
$(1 - (1-p)^2)^2$. Итак, вероятность некорректной работы схемы при ${x^{\sigma}_i = 1}$ 
меньше $4p^2$.

2) Если ${x^{\sigma}_i = 0}$, неисправность~--- замыкание. Цепь будет замкнутой с вероятностью 
$p^2$ и разомкнутой с вероятностью $1 - p^2$. Вся схема окажется разомкнутой с вероятностью
$(1-p^2)^2$, и замкнутой с вероятностью $1 - (1-p^2)^2$. Итак, вероятность некорректной работы 
схемы при ${x^{\sigma}_i = 0}$ меньше $2p^2$.

Таким образом, в любом случае вероятность ошибки в одном контакте ${x^{\sigma}_i}$ не превышает $4p^2$
Повторяя описанную процедуру, можно добиться, чтобы вероятность ошибки в одном контакте
${P_{err}(x^{\sigma}_i) < p c^N}$, где, считаем, ${4p = c < 1}$.
Если теперь необходимо построить контактную схему $S$, реализующую функцию $f(x_1, \ldots, x_n)$,
чтобы ${P_{err}(S) < \varepsilon}$, то выберем параметр $N$ таким, что
$$
  p c^N < \frac{\varepsilon}{n 2^n}.
$$ 
Каждый контакт заменим подсхемой с вероятностью
ошибки меньше ${\varepsilon/(n 2^n)}$. Тогда
$$
{
  P_{err}(S) < L(S) \frac{\varepsilon}{n 2^n} \leqslant \varepsilon
}
$$
при ${L(S) \leqslant n 2^n}$ и ${p < 1/4}$.

% par
\section{Тупиковый тест}
Допустим, $S_0$~--- исправная контактная схема, реализующая функцию $f_0$, а ${S_1, \ldots, S_q}$~---
неисправные состояния той же схемы, реализующие, соответственно, функции ${f_1, \ldots, f_q}$.
Требуется, анализируя $f_j$, определить неисправность. Можно, например, подстановкой тех или иных
наборов в функцию проводимости проверять замкнут или разомкнут соответствующий контакт. 

Формально, 
имеется таблица $M$, в которой по столбцам выписаны значения каждой из функций ${f^{(1)}, \ldots, f^{(t)}}$ 
на наборах ${\alpha_1, \ldots, \alpha_s}$, причем все столбцы различны. Множество наборов, по которым можно 
различить все функции, называется {\itтестом. Минимальный тест}~--- тест, содежащий наименьшее
число наборов. {\it Тупиковый тест}~--- тест, который при удалении любого набора перестает быть тестом.
Минимальный тест является также и тупиковым.

Пусть $A(M)$~--- длина минимального теста для таблицы $M$. Тогда
$$
  log_2 t \leqslant A(M) \leqslant t - 1.
  \eqno(12)
$$

Докажем нижнюю оценку в (12). Предположим, что тест содержит ${k < \log_2 t}$ наборов.
Но тогда различных столбцов ${t > 2^k}$, чего не может быть, поскольку по условию все
столбцы различны. Остается только возможность, когда в точности ${t = 2^k}$.

В доказательстве верхней оценки в (12) используется
\begin{theorem}
Для произвольной булевой матрицы $M$, содержащей $m$ попарно различных столбцов,
существует тест, длина которого не превосходит $m-1$.
\end{theorem} 
{\bfДокажем} индукцией по числу столбцов. Если столбец один, то тест пустой. Если столбцов
два, то обязательно найдется строка, по которой они отличаются. Предположим, что утверждение
теоремы имеет место для числа столбцов равного $k$ и менее. Покажем его справедливость для
$k+1$ столбцов. Возьмем произвольную $j$--ю строку $S_j$, в которой различны, например, первая и вторая 
компоненты. Будем считать для определенности, что первая компонента нулевая, а вторая единичная.
Рассмотрим теперь матрицы $M_0$ и $M_1$, составленные соответственно из $m_0$ столбцов матрицы $M$ с нулевой
и $m_1$ столбцов с единичной $j$--й компонентой. Понятно, что ${m_i \leqslant k}$, ${i = \overline{1,2}}$
и ${m_0 + m_1 = k+1}$. Тогда по предположению индукции существуют тесты $T_0$ для $M_0$ и $T_1$ для $M_1$ 
такие, что 
$$
{
  |T_0| \leqslant m_0 - 1, \quad |T_1| \leqslant m_1 - 1.
}
$$
Пусть ${T = T_0 \cup T_1 \cup \{S_j\}}$. Покажем, что $T$~--- тест для $M$. Действительно, 
рассмотрим произвольные столбцы $\Hat A$ и $\Hat B$ матрицы $M$. Если их компоненты из $S_j$
неодинаковы, то столбцы уже различены с помощью $T$, если обе их компоненты из $S_j$ нулевые 
(единичные), то столбцы содержатся в $M_0$ ($M_1$) и различены по предположению индукции.
Оценим длину теста: ${|T| \leqslant m_0 - 1 + m_1 - 1 + 1 = k}$. Теорема доказана.



% par
\section{Диагностические тесты для контактных схем}
Рассмотрим произвольную контактную схему $S$, в которой между полюсами $a$ и $b$ реализуется 
некоторая функция проводимости ${f_{a,b}(x_1, \ldots, x_n)}$. В~результате неисправности схема $S$
преобразуется в некоторую схему $S'$, реализующую функцию неисправности ${g_{a,b}(x_1, \ldots, x_n)}$.
Выпишем значения функции $f$ и всех попарно различных функций неисправности ${g_1, \ldots, g_l}$ 
по столбцам таблицы (\rf табл.~2).

% table 2
\begin{figure}
 \begin{center}
 \begin{picture}(70,30)
 % table
 \put(-2,0)
 {
  \begin{picture}(70,30)
   % lines
   \put(40,0){\line(0,1){30}}
   \put(50,0){\line(0,1){30}}
   \put(65,0){\line(0,1){30}}
   \thicklines
   \put(30,0){\line(0,1){30}}
   \put(0,20){\line(1,0){80}}
   % texts
   % first column
   \put(2,24){\small $x_1, \ldots, x_{n-1},x_n$}    
   \put(34,24){\small $f$}
   \put(44,24){\small $g_1$}
   \put(55,24){\small $\cdots$}
   \put(69,24){\small $g_l$}
   \put(8,14){\small $0, \ldots, 0, 0$}    
   \put(15,7){\small $\vdots$}    
   \put(8,1){\small $1, \ldots, 1, 1$}    
  \end{picture}
 } 
 \end{picture} 
 \end{center}
 \begin{center}Табл.~2\end{center}
\end{figure}

{\itПолным диагностическим тестом\/} $T$ для контактной схемы $S$ называется множество наборов такое, 
что для любой пары функций ${\{g, g'\} \subset \{f, g_1, \ldots, g_l\}}$ найдется элемент
${\Tilde\sigma \in T}$, ${g(\Tilde\sigma) \ne g'(\Tilde\sigma)}$. Понятно, что множество всех
$2^n$ наборов тривиальным образом является полным диагностическим тестом.
Длина $D(T)$ полного диагностического теста $T$ есть число наборов теста. Определим также 
$$
  D(S) = \min\limits_{T = T(S)} D(T).
$$ 
Здесь минимум берется по всем 
полным диагностическим тестам $T$ для схемы $S$. Аналогично,
$$
{
  D(f) = \min\limits_{S = S(f)} D(S), 
  \quad  
  D(n) = \max\limits_{f(x_1, \ldots, x_n)} D(f).
}
$$

\begin{theorem}
${D(n) = 2^n}$ для любого ${n \in \mathbb N}$.
\end{theorem} 
{\bfДоказательство.}
Поскольку $D(n)$~--- максимум, взятый по всем функциям $f$, то достаточно показать, что для любой 
контактной схемы $S$, реализующей функцию 
${f(\Tilde x) = l_n(\Tilde x) = x_1 \oplus \cdots \oplus x_n}$, всякий полный диагностический тест
содержит все $2^n$ наборов (максимально возможное количество).

1. Пусть ${f(\Tilde\sigma) = 1}$. Следовательно, если схема $S$ исправна, между ее полюсами 
должна существовать цепь $Z$ с контактами ${x^{\sigma_1}_1, \ldots, x^{\sigma_n}_n}$.
Если предположить, что в цепи $Z$ отсутствует один из контактов, например, $x^{\sigma_1}_1$,
то получится, что наборам ${\Tilde\sigma = (\sigma_1, \sigma_2, \ldots, \sigma_n)}$ и
${\Tilde\sigma' = (\overline{\sigma_1}, \sigma_2, \ldots, \sigma_n)}$ соответствует 
единичная проводимость. Но это неверно, так как ${f(\Tilde\sigma) \ne f(\Tilde\sigma')}$.
Значит, все контакты ${x^{\sigma_1}_1, \ldots, x^{\sigma_n}_n}$ содержатся в $Z$.
Разомкнем теперь все контакты схемы $S$ кроме контактов цепи $Z$. Полученная схема будет
иметь функцию неисправности ${g(\Tilde x) = x^{\sigma_1}_1 \cdots x^{\sigma_n}_n}$, 
и чтобы отличить $g$ от нуля необходимо включить набор $\Tilde\sigma$ в тест.
Аналогично придется поступить с каждым ${\Tilde\sigma \in N_f}$, а это $2^{n-1}$ наборов.

2. Пусть ${f(\Tilde\sigma) = 0}$. Если схема $S$ исправна, в ней будут 
разомкнуты контакты ${x^{\overline{\sigma_1}}_1, \ldots, x^{\overline{\sigma_n}}_n}$.
Найдется такое множество контактов схемы $S$, которое образует сечение схемы, но, сечение, возможно, 
нетупиковое. Однако, \glqqлишние\grqq{} контакты нетупикового сечения можно удалить за
конечное число шагов, поэтому будем заранее считать сечение тупиковым. Обозначим его через $A$.
Допустим, что какой--то из контактов системы 
${x^{\overline{\sigma_1}}_1, \ldots, x^{\overline{\sigma_n}}_n}$, например, $x^{\overline{\sigma_1}}_1$
не содержится в $A$. Аналогично, получим противоречие, поскольку по предположению
проводимость на наборах ${\Tilde\sigma = (\sigma_1, \sigma_2, \ldots, \sigma_n)}$ и
${\Tilde\sigma' = (\overline{\sigma_1}, \sigma_2, \ldots, \sigma_n)}$ должна быть нулевая,
хотя ${f(\Tilde\sigma) \ne f(\Tilde\sigma')}$.
Значит, все контакты ${x^{\overline{\sigma_1}}_1, \ldots, x^{\overline{\sigma_n}}_n}$ 
содержатся в тупиковом сечении $A$. Предположим теперь, что все контакты вне $A$ 
неисправны и разомкнуты. Это означает, что функция неисправности принимает нулевое значение на
наборе $\Tilde\sigma$, а на остальных наборах она единична. Таким образом, чтобы отличить 
функцию ${x^{\overline{\sigma_1}}_1 \lor \cdots \lor x^{\overline{\sigma_n}}_n}$ от единицы,
нужно обязательно включить набор $\Tilde\sigma$ в тест. И~так для всех наборов
${\Tilde\sigma \in {\mathbb E}_2^n \setminus N_f}$, которых тоже $2^{n-1}$. 
Следовательно, в сумме тест обязан содержать $2^n$ наборов. 
Теорема доказана.


% par
\section{Задача на покрытие и градиентный алгоритм ее решения}
В общем случае постановка задачи такова. Имеется множество ${S = \{a_1, \ldots, a_n\}}$.
Пусть семейство ${S_1, \ldots, S_k}$ подмножеств множества $S$ таково, что
$$
{
  \bigcup\limits_{i=1}^{k} S_i = S. 
}
$$
В~этом случае семейство множеств ${S_1, \ldots, S_k}$ называется {\itпокрытием $S$.}
Будем говорить, что строка $A$ {\itпокрывает столбец\/} $B$ булевой матрицы, если элемент,
находящийся в строке $A$ и столбце $B$, равен 1. В~противном случае строка $A$ {\itне 
покрывает столбец\/} $B$. Подмножество строк матрицы, покрывающее все ее столбцы, называется
{\itпокрытием матрицы. Минимальное покрытие~---} покрытие, содержащее наименьшее возможное
число строк. Задача на покрытие состоит в нахождении минимального покрытия.

Рассмотрим градиентный алгоритм построения минимального покрытия $\EuScript R$ булевой
матрицы $T$.

0. $T$~--- исходная матрица, ${{\EuScript R} = \emptyset}$.

1. Выберем в $T$ строку $A$, покрывающую наибольшее число столбцов. Включим $A$ в $\EuScript R$.

2. Вычеркнем из $T$ все столбцы, покрытые строкой $A$, и вычеркнем также саму строку $A$. 
Если матрица $T$ оказалась пустой, то выполнять 3. 
Если матрица $T$ содержит непокрытые столбцы, то выполнять 1.

3. Алгоритм завершен, в качестве покрытия возьмем полученное множество $\EuScript R$.

\begin{theorem}
Пусть булева матрица $T$ имеет $M$ строк и $N$ столбцов, причем, каждый столбец содержит 
не менее $P$ единиц. Тогда для ${R = |{\EuScript R}|}$ градиентный алгоритм гарантирует оценку
$$
  R \leqslant \frac{M}{P}\left(\ln\frac{PN}{M} + 1\right) + 1.
  \eqno(13)
$$
\end{theorem} 
{\bfДоказательство.}
Обозначим через $\beta_t$ долю охваченных алгоритмом столбцов матрицы $T$ после $t$--го шага.
Считаем, ${\beta_0 = 0}$. Переставим на первые места $\beta_t N$ охваченных алгоритмом столбцов
и $t$ строк с единицами. Тогда в правой нижней подматрице размера ${(M-t) \times (1-\beta_t)N}$ 
не менее $(1-\beta_t)NP$ единичных элементов. Следовательно, найдется еще не охваченная алгоритмом
строка матрицы $T$, содержащая по меньшей мере ${(1-\beta_t)NP/(M-t)}$ единиц.
Выберем эту строку на $(t+1)$--м шаге алгоритма. Тогда в силу
$$
{
  \frac{(1-\beta_t)NP}{M-t} \geqslant \frac{(1-\beta_t)NP}{M},
}
$$
получим
$$
{
  \beta_{t+1} N \geqslant \beta_t N + (1-\beta_t)\frac{NP}{M}.
}
$$
Отсюда
$$
  \beta_{t+1} \geqslant \left(1 - \frac{P}{M}\right)\beta_t + \frac{P}{M}.
  \eqno(14)
$$
Докажем по индукции справедливость равенства 
$$
  \beta_t \geqslant 1 - \left(1 - \frac{P}{M}\right)^t
  \eqno(15)
$$
для всех целых ${t \geqslant 0}$. При ${t = 0}$ имеем ${\beta_0 \geqslant 0}$, что верно. 
Предположим, что (15) справедливо для $t$, и докажем его справедливость для $t+1$.
Согласно (14)
$$
{
  \beta_{t+1} \geqslant \left(1 - \frac{P}{M}\right)\beta_t + \frac{P}{M} \geqslant
  \left(1 - \frac{P}{M}\right)\left(1 - \left(1 - \frac{P}{M}\right)^t\right) + \frac{P}{M} 
  \geqslant
}
$$
$$
{
  \geqslant
  1 - \frac{P}{M} - \left(1 - \frac{P}{M}\right)^{t+1} + \frac{P}{M} = 
  1 - \left(1 - \frac{P}{M}\right)^{t+1}.
}
$$
Таким образом, (15) выполняется для всех целых ${t \geqslant 0}$.

Как уже было сказано, после $t_0$--го шага алгоритма неохваченных столбцов будет не более 
$N(1 - \beta_{t_0})$. Следовательно, на них алгоритмом будет потрачено не более $N(1 - \beta_{t_0})$
строк матрицы $T$. Это очень грубая оценка. Значит, в общей сложности использованных строк
$$
{
  R \leqslant t_0 + N(1 - \beta_{t_0}).
}
$$
Возьмем 
$$
  t_0 = \lceil\frac{M}{P}\ln\frac{PN}{M}\rceil,
$$ 
тогда
$$
{
  \frac{M}{P}\ln\frac{PN}{M} \leqslant t_0 < \frac{M}{P}\ln\frac{PN}{M} + 1.
}
$$
В силу (15) имеем
$$
  R \leqslant 
  \frac{M}{P}\ln\frac{PN}{M} + 1 + N\left(1 - \frac{P}{M}\right)^{t_0} 
  \leqslant
$$
$$  
  \leqslant
  \frac{M}{P}\ln\frac{PN}{M} + 1 + N\left(1 - \frac{P}{M}\right)^{\frac{M}{P}\ln\frac{PN}{M}}.
$$
Последнее равно
$$
  \frac{M}{P}\ln\frac{PN}{M} + 1 + 
   N\exp\left(\ln\left(1 - \frac{P}{M}\right)\frac{M}{P}\ln\frac{PN}{M}\right) <
$$
$$   
  < \frac{M}{P}\ln\frac{PN}{M} + 1 + N\frac{M}{PN} = \frac{M}{P}\left(\ln\frac{PN}{M} + 1\right) + 1,
$$
поскольку 
$$
  \ln\left(1 - \frac{P}{M}\right)\frac{M}{P} < -1.
$$
Теорема доказана.

Ранее было отмечено, что градиентный алгоритм в силу своей жадности рационален 
далеко не всегда. Действительно, рассмотрим матрицу
$$
\left(
 \begin{array}{ccccccccc}
   1 & \cdots & 1 & & & & & &\\
   & & & 1 & \cdots & 1 & & &\\
   & & & & & & 1 & \cdots & 1\\
   0 & & 1 & 0 & & 1 & 0 & & 1\\
   \vdots & \cdots & \vdots & \vdots & \cdots & \vdots & \vdots & \cdots & \vdots\\
   0 & & 1 & 0 & & 1 & 0 & & 1\\
 \end{array}
\right).
$$
В~ней $m+3$ строк и $3\cdot2^m$ столбцов. В~трех верхних строках по $2^m$ единиц, 
а в $m$ нижних по столбцам трижды размещены наборы единичного куба ${\mathbb E}_2^m$.
Понятно, что минимальное покрытие матрицы состоит из трех ее верхних строк.
Градиентный же алгоритм в первую очередь начнет работать по $m$ нижним строкам матрицы,
поэтому в результате получится покрытие, включающее все $m+3$ строк.

{\footnotesize\bigskip
Отметим связь задачи на покрытие с дизъюнктивными нормальными формами.
Пусть столбцы $\Hat A_i$ и $\Hat A_j$ булевой матрицы различаются на наборах
${\Tilde\alpha_{ij1}, \Tilde\alpha_{ij2}, \ldots, \Tilde\alpha_{ijs_{ij}}}$.
Образуем {\bfформальные} дизъюнкции и перемножим их:
$$
{
  \bigwedge\limits_{i,j} \left(\Tilde\alpha_{ij1} \lor \cdots \lor \Tilde\alpha_{ijs_{ij}}\right).
}
$$
Формально преобразуем полученное выражение в \glqqДНФ\grqq{}. При этом конъюнкции
будут соответствовать тестам, а минимальные конъюнкции~--- тупиковым тестам.

}


% ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ checked


%-------------------------------------------------------------------------------------- elder



% appendix
\chapter*{Приложение А}

% from Yablonskii 
\section*{Некоторые отношения (извлечение из~\cite{yablonskii})}

1. Отношение 
$$
 f(x) \smallfrown g(x)
$$ 
при ${x \to a}$ имеет место, если существуют такие положительные константы 
${C_1 \geqslant 1}$ и ${C_2 \leqslant 1}$
и окрестность точки $a$, в которой (кроме, быть может, точки $a$) выполняется
$$
 f(x) \leqslant C(x) g(x),
$$
где
$$
C(x) = 
\left\{
 \begin{array}{cl}
   C_1, & \: g(x) > 0, \\
   1,   & \: g(x) = 0, \\ 
   C_2, & \: g(x) < 0.
 \end{array}
\right.
$$

2. Отношение 
$$
 f(x) \asymp g(x)
$$ 
при ${x \to a}$ имеет место, если при ${x \to a}$ одновременно выполнены 
$$
 f(x) \smallfrown g(x),
 \quad
 g(x) \smallfrown f(x).
$$

3. Отношение 
$$
 f(x) \lesssim g(x)
$$ 
при ${x \to a}$ имеет место, если для любого ${\varepsilon > 0}$
существует такая окрестность точки $a$, в которой (кроме, быть может, точки $a$) выполняется
$$
 f(x) \leqslant C_{\varepsilon}(x) g(x),
$$
где
$$
C_{\varepsilon}(x) = 
\left\{
 \begin{array}{cl}
   1+\varepsilon, & \: g(x) > 0, \\
   1,       & \: g(x) = 0, \\ 
   1-\varepsilon, & \: g(x) < 0.
 \end{array}
\right.
$$


% appendix
\chapter*{Приложение Б}

% curriculum 
\section*{Программа курса}

1. Дизъюнктивные нормальные формы (ДНФ). Допустимые и минимальные конъюнкции. 
Тупиковые, минимальные и сокращенные ДНФ. Геометрическая интерпретация.

2. Оценки сложности ДНФ ($L_D(n)$ и $L'_D(n)$).

3. Замкнутые ДНФ. Методы получения сокращенной ДНФ. Градиентный алгоритм.

4. Критерий вхождения минимальной конъюнкции в ДНФ типа суммы тупиковых ($\Sigma T$).

5. Окрестность ранга $r$. Отсутствие критерия ранга $r$ вхождения минимальной конъюнкции
в ДНФ типа суммы монотонных.

6. Контактные схемы. Простейшие методы синтеза. Контактное дерево. Свойство разделительности.

7. Реализации всех конъюнкций контактной схемы со сложностью $2^n(1 + o(1))$.
Свойство ослабленной разделительности.

8. Асимптотически наилучший метод синтеза контактных схем.

9. Нижняя оценка функции $L_K(n)$. Асимптотика $L_K(n)$.

10. Метод каскадов для контактных схем.

11. Доказательство минимальности контактной схемы для линейной функции.

12. Нижняя оценка вида $Cn^{3/2}$ для сложности реализации линейной функции контактными схемами.

13. Нижняя оценка вида $n^2$ для сложности реализации линейной функции контактными схемами. 

14. Доказательство минимальности контактного дерева в классе разделительных схем.

15. Самокорректирующиеся контактные схемы. Корректировка одного замыкания/размыкания.

16. Надежные контактные схемы из ненадежных элементов.

17. Эквивалентные преобразования формул над $\{\&, \lor , \neg, x, 0, 1\}$.

18. Эквивалентные преобразования контактных схем. Система правил $\gamma_n$. Производные правила (для цепей).
Полнота $\gamma_n$ для схем над переменными $\{x_1, \ldots, x_n\}$.

19. Отсутствие полной конечной системы правил преобразования контактных схем.

20. Тесты. Таблицы неисправностей. Тривиальные оценки длины теста. 
Длина минимального теста для почти всех таблиц.

21. Градиентный алгоритм построения тестов. Оценка длины.

22. Диагностический тест. Доказательство соотношения ${D(n) = 2^n}$.


% appendix
\chapter*{Приложение В}

% ex
\section*{Некоторые задачи, предлагавшиеся на экзамене}

1. Найти число функций $f(x_1, \ldots, x_n)$, на которых достигается оценка ${L_D(f) = n 2^{n-1}}$
(Ю.~В.~Таранников, 2003--2004 учебный год).


%--------------------------------------------------------------------------------


\begin{thebibliography}{99}
\bibitem{aleshin}
Алешин~С.~В. Распознавание динамических образов. Часть I.~--- М.: Изд--во МГУ, 1996.

\bibitem{kasami}
Касами~Т., Токура~Н., Ивадари~Ё., Инагаки~Я. Теория кодирования.~--- М.: Мир, 1978.

\bibitem{yablonskii}
Яблонский~С.~В. Введение в дискретную математику.~--- М.: Высшая школа, 2001.

\end{thebibliography}

\vspace{2cm}




% copyrights------------------------------------------
\begin{center}
$\leftleftarrows$
\end{center}

\vspace{4cm}




    
\end{document}

%-----------------------------------------------------------------------------------

